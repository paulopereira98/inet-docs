<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>INET Framework for OMNeT++/OMNEST: inet::tcp::TcpConnection Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="opp.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classinet_1_1tcp_1_1_tcp_connection.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classinet_1_1tcp_1_1_tcp_connection-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inet::tcp::TcpConnection Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manages a TCP connection.  
 <a href="classinet_1_1tcp_1_1_tcp_connection.html#details">More...</a></p>

<p><code>#include &lt;TcpConnection.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for inet::tcp::TcpConnection:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classinet_1_1tcp_1_1_tcp_connection.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af5b229735766bd9041d5a794f04ec588"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af5b229735766bd9041d5a794f04ec588">getSocketId</a> () const</td></tr>
<tr class="separator:af5b229735766bd9041d5a794f04ec588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0416c97da1b894d6199f133509e8ada3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a> (int newSocketId)</td></tr>
<tr class="separator:a0416c97da1b894d6199f133509e8ada3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac422487d46d2dacc3ed94fa0702751fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac422487d46d2dacc3ed94fa0702751fb">getListeningSocketId</a> () const</td></tr>
<tr class="separator:ac422487d46d2dacc3ed94fa0702751fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af209b5ccd11645d1816564b597712672"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af209b5ccd11645d1816564b597712672">getLocalAddr</a> () const</td></tr>
<tr class="separator:af209b5ccd11645d1816564b597712672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add71f2e3347bdefbd5aee066dd887376"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#add71f2e3347bdefbd5aee066dd887376">getRemoteAddr</a> () const</td></tr>
<tr class="separator:add71f2e3347bdefbd5aee066dd887376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6387021ac53e8b9ad12a72865560ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html">TcpSackRexmitQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ade6387021ac53e8b9ad12a72865560ab">getRexmitQueue</a> () const</td></tr>
<tr class="separator:ade6387021ac53e8b9ad12a72865560ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a97ba97acbd81b0f689af1978c5bd02c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a> = -1</td></tr>
<tr class="separator:a97ba97acbd81b0f689af1978c5bd02c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ce9072da1e00dd840db1ddd1322534"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">listeningSocketId</a> = -1</td></tr>
<tr class="separator:a48ce9072da1e00dd840db1ddd1322534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0709b8c1e83b2b343bfb76ac5adb1df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a></td></tr>
<tr class="separator:af0709b8c1e83b2b343bfb76ac5adb1df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7166c0d1e3090b61c90b179c82f60730"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a></td></tr>
<tr class="separator:a7166c0d1e3090b61c90b179c82f60730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad4561cfa55aeae815b09a98e464dc79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> = -1</td></tr>
<tr class="separator:aad4561cfa55aeae815b09a98e464dc79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76dc793cff441a2e7b3c206c8389dea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a> = -1</td></tr>
<tr class="separator:ad76dc793cff441a2e7b3c206c8389dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ecf5464de1b085c557ac7d2d15220d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">ttl</a> = -1</td></tr>
<tr class="separator:a5ecf5464de1b085c557ac7d2d15220d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae756c38799f1d6fdb05f536dd924a3c0"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">dscp</a> = -1</td></tr>
<tr class="separator:ae756c38799f1d6fdb05f536dd924a3c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a740f9d67c4d45e9037f2b12b392568c4"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">tos</a> = -1</td></tr>
<tr class="separator:a740f9d67c4d45e9037f2b12b392568c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e2a54894d305fb793ce1c5fa00ed70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html">TcpSackRexmitQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a> = nullptr</td></tr>
<tr class="separator:a37e2a54894d305fb793ce1c5fa00ed70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a5e2b660adffd4b9119385c39871371ea"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5e2b660adffd4b9119385c39871371ea">tcpConnectionAddedSignal</a></td></tr>
<tr class="separator:a5e2b660adffd4b9119385c39871371ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29c1ca6f5d0e6bd292dc0e482cda96b"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab29c1ca6f5d0e6bd292dc0e482cda96b">stateSignal</a> = registerSignal(&quot;state&quot;)</td></tr>
<tr class="separator:ab29c1ca6f5d0e6bd292dc0e482cda96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0def5a11ed40d33fa6821c79cc1b2533"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0def5a11ed40d33fa6821c79cc1b2533">sndWndSignal</a> = registerSignal(&quot;sndWnd&quot;)</td></tr>
<tr class="separator:a0def5a11ed40d33fa6821c79cc1b2533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c980dc89305fbe03d5450934859d1f4"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7c980dc89305fbe03d5450934859d1f4">rcvWndSignal</a> = registerSignal(&quot;rcvWnd&quot;)</td></tr>
<tr class="separator:a7c980dc89305fbe03d5450934859d1f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78cd9a6e338d5c03499b44727b6829e"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad78cd9a6e338d5c03499b44727b6829e">rcvAdvSignal</a> = registerSignal(&quot;rcvAdv&quot;)</td></tr>
<tr class="separator:ad78cd9a6e338d5c03499b44727b6829e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f4034777ecaed134ee827b75c30a3aa"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1f4034777ecaed134ee827b75c30a3aa">sndNxtSignal</a> = registerSignal(&quot;sndNxt&quot;)</td></tr>
<tr class="separator:a1f4034777ecaed134ee827b75c30a3aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8999bc036241c07295cea07f6b069c2"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac8999bc036241c07295cea07f6b069c2">sndAckSignal</a> = registerSignal(&quot;sndAck&quot;)</td></tr>
<tr class="separator:ac8999bc036241c07295cea07f6b069c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3547269704c3b79daf67827bb5eefd8"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac3547269704c3b79daf67827bb5eefd8">rcvSeqSignal</a> = registerSignal(&quot;rcvSeq&quot;)</td></tr>
<tr class="separator:ac3547269704c3b79daf67827bb5eefd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f034cb5f674f2554d4d3b59477b7d8"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69f034cb5f674f2554d4d3b59477b7d8">rcvAckSignal</a> = registerSignal(&quot;rcvAck&quot;)</td></tr>
<tr class="separator:a69f034cb5f674f2554d4d3b59477b7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b59c4b6eca46a2a341d73178ade5934"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a> = registerSignal(&quot;unacked&quot;)</td></tr>
<tr class="separator:a0b59c4b6eca46a2a341d73178ade5934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f76b4e941cbbe2ef203bf27a8173a2"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">dupAcksSignal</a> = registerSignal(&quot;dupAcks&quot;)</td></tr>
<tr class="separator:aa7f76b4e941cbbe2ef203bf27a8173a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f29c42a316c329683196e9d7ace718"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa0f29c42a316c329683196e9d7ace718">pipeSignal</a> = registerSignal(&quot;pipe&quot;)</td></tr>
<tr class="separator:aa0f29c42a316c329683196e9d7ace718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff166b9e7e6ee791b56a161fc8dd86d3"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aff166b9e7e6ee791b56a161fc8dd86d3">sndSacksSignal</a> = registerSignal(&quot;sndSacks&quot;)</td></tr>
<tr class="separator:aff166b9e7e6ee791b56a161fc8dd86d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dcf210a8d13372804d8011739117f97"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6dcf210a8d13372804d8011739117f97">rcvSacksSignal</a> = registerSignal(&quot;rcvSacks&quot;)</td></tr>
<tr class="separator:a6dcf210a8d13372804d8011739117f97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3b4ea0c2712f557e5a68165b8b082e"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aec3b4ea0c2712f557e5a68165b8b082e">rcvOooSegSignal</a> = registerSignal(&quot;rcvOooSeg&quot;)</td></tr>
<tr class="separator:aec3b4ea0c2712f557e5a68165b8b082e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc96352a49004dc0f7125028939c117"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0bc96352a49004dc0f7125028939c117">rcvNASegSignal</a> = registerSignal(&quot;rcvNASeg&quot;)</td></tr>
<tr class="separator:a0bc96352a49004dc0f7125028939c117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c00a2d63feb44e9c7d5ae6bf0a2af6"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a18c00a2d63feb44e9c7d5ae6bf0a2af6">sackedBytesSignal</a> = registerSignal(&quot;sackedBytes&quot;)</td></tr>
<tr class="separator:a18c00a2d63feb44e9c7d5ae6bf0a2af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c136fdf02b4cdaa010d86105aac3f9"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97c136fdf02b4cdaa010d86105aac3f9">tcpRcvQueueBytesSignal</a> = registerSignal(&quot;tcpRcvQueueBytes&quot;)</td></tr>
<tr class="separator:a97c136fdf02b4cdaa010d86105aac3f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542b0e99a7d17e907190003038443894"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a542b0e99a7d17e907190003038443894">tcpRcvQueueDropsSignal</a> = registerSignal(&quot;tcpRcvQueueDrops&quot;)</td></tr>
<tr class="separator:a542b0e99a7d17e907190003038443894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2eacb280f6191279ce691f539f6828b"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2eacb280f6191279ce691f539f6828b">tcpRcvPayloadBytesSignal</a> = registerSignal(&quot;tcpRcvPayloadBytes&quot;)</td></tr>
<tr class="separator:ab2eacb280f6191279ce691f539f6828b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:add469419d8eb883b3a7d655085148950"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html">TcpSendQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#add469419d8eb883b3a7d655085148950">getSendQueue</a> () const</td></tr>
<tr class="separator:add469419d8eb883b3a7d655085148950"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac48ba16894a94587859b0bbfb3f36add"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html">TcpReceiveQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac48ba16894a94587859b0bbfb3f36add">getReceiveQueue</a> () const</td></tr>
<tr class="separator:ac48ba16894a94587859b0bbfb3f36add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dc4f2c22057776204f1195c3ef070bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html">TcpAlgorithm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6dc4f2c22057776204f1195c3ef070bc">getTcpAlgorithm</a> () const</td></tr>
<tr class="separator:a6dc4f2c22057776204f1195c3ef070bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">FSM transitions: analysing events and executing state transitions</div></td></tr>
<tr class="memitem:afcf0d25d019cbe6eed624fa9e6644fc8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#afcf0d25d019cbe6eed624fa9e6644fc8">preanalyseAppCommandEvent</a> (int commandCode)</td></tr>
<tr class="memdesc:afcf0d25d019cbe6eed624fa9e6644fc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps app command codes (msg kind of app command msgs) to TCP_E_xxx event codes.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#afcf0d25d019cbe6eed624fa9e6644fc8">More...</a><br /></td></tr>
<tr class="separator:afcf0d25d019cbe6eed624fa9e6644fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8279e9052ae1d273ace989e9ab659c8"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition</a> (const <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event)</td></tr>
<tr class="memdesc:ad8279e9052ae1d273ace989e9ab659c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implemements the pure TCP state machine.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">More...</a><br /></td></tr>
<tr class="separator:ad8279e9052ae1d273ace989e9ab659c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a759a1d53d5b30d2a1f5f14bb76bf55a4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered</a> (int <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>, int oldState, <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> event)</td></tr>
<tr class="memdesc:a759a1d53d5b30d2a1f5f14bb76bf55a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform cleanup necessary when entering a new state, e.g.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">More...</a><br /></td></tr>
<tr class="separator:a759a1d53d5b30d2a1f5f14bb76bf55a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processing app commands. Invoked from processAppCommand().</div></td></tr>
<tr class="memitem:a68dc46455682e7d2ac229f09371342b5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a68dc46455682e7d2ac229f09371342b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a975935f14abb62e23aa2dd2a279f4971"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a975935f14abb62e23aa2dd2a279f4971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9d893e816312584dc9124d5443c7ff"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7a9d893e816312584dc9124d5443c7ff">process_ACCEPT</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a7a9d893e816312584dc9124d5443c7ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7160020102c9f27f6c1e3b1698ee5ac"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:ab7160020102c9f27f6c1e3b1698ee5ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a8e7dbde1f4102cec960e9566af010"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:ac9a8e7dbde1f4102cec960e9566af010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b488f6cdc47ab4b57e2e5ee898b8b61"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2b488f6cdc47ab4b57e2e5ee898b8b61">process_ABORT</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a2b488f6cdc47ab4b57e2e5ee898b8b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6307696102916780d29b5d74ae12930e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6307696102916780d29b5d74ae12930e">process_DESTROY</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a6307696102916780d29b5d74ae12930e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13569e009cba1a7f52fdb59c2b85066f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a13569e009cba1a7f52fdb59c2b85066f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e62607e3fbab7f504b3f7dab879bf67"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e62607e3fbab7f504b3f7dab879bf67">process_QUEUE_BYTES_LIMIT</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a1e62607e3fbab7f504b3f7dab879bf67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ac9ad945591c08823ca4c196003a1ae"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a4ac9ad945591c08823ca4c196003a1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85992dfca295a0ab3240f0ec1650ebd6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a85992dfca295a0ab3240f0ec1650ebd6">process_OPTIONS</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event, <a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr class="separator:a85992dfca295a0ab3240f0ec1650ebd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processing TCP segment arrivals. Invoked from processTCPSegment().</div></td></tr>
<tr class="memitem:ae57488043d7b7533872cac4a73ba5907"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae57488043d7b7533872cac4a73ba5907">tryFastRoute</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:ae57488043d7b7533872cac4a73ba5907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shortcut to process most common case as fast as possible.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ae57488043d7b7533872cac4a73ba5907">More...</a><br /></td></tr>
<tr class="separator:ae57488043d7b7533872cac4a73ba5907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b4b186dcd43ec3845c26afb0d9a4b7"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest)</td></tr>
<tr class="memdesc:ad4b4b186dcd43ec3845c26afb0d9a4b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process incoming TCP segment.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">More...</a><br /></td></tr>
<tr class="separator:ad4b4b186dcd43ec3845c26afb0d9a4b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8582acc0ba4d4850f124b4d7aef643c1"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest)</td></tr>
<tr class="separator:a8582acc0ba4d4850f124b4d7aef643c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de94d23a73961fbca3b3530b296732d"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> srcAddr, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> destAddr)</td></tr>
<tr class="separator:a5de94d23a73961fbca3b3530b296732d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a729b16908c898a0ccf73af5c736f1ee2"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest)</td></tr>
<tr class="separator:a729b16908c898a0ccf73af5c736f1ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fb3bba962a1f9b37c4139066fd5851"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="separator:a89fb3bba962a1f9b37c4139066fd5851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae287c8e1cff764dfb16a88b6f979a9ad"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">processRstInSynReceived</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="separator:ae287c8e1cff764dfb16a88b6f979a9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e61db9d8578ff50bec8d72fe818aa5f"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="separator:a1e61db9d8578ff50bec8d72fe818aa5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processing of TCP options. Invoked from readHeaderOptions(). Return value indicates whether the option was valid.</div></td></tr>
<tr class="memitem:a95b7233ca8183973b60c88e1f955993c"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a95b7233ca8183973b60c88e1f955993c">processMSSOption</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_max_segment_size.html">TcpOptionMaxSegmentSize</a> &amp;option)</td></tr>
<tr class="separator:a95b7233ca8183973b60c88e1f955993c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c7bc93c84a410a40ceefee26e61196"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c7bc93c84a410a40ceefee26e61196">processWSOption</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_window_scale.html">TcpOptionWindowScale</a> &amp;option)</td></tr>
<tr class="separator:a93c7bc93c84a410a40ceefee26e61196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98ad81d8ce1e5dbfd40bd83a34b6d340"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a98ad81d8ce1e5dbfd40bd83a34b6d340">processSACKPermittedOption</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_sack_permitted.html">TcpOptionSackPermitted</a> &amp;option)</td></tr>
<tr class="separator:a98ad81d8ce1e5dbfd40bd83a34b6d340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df8bb6e00976c6ebdd69c2f5ece8fe0"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_sack.html">TcpOptionSack</a> &amp;option)</td></tr>
<tr class="separator:a3df8bb6e00976c6ebdd69c2f5ece8fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34be7e48b4ab7e1c189665d61b1e9e47"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a34be7e48b4ab7e1c189665d61b1e9e47">processTSOption</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_timestamp.html">TcpOptionTimestamp</a> &amp;option)</td></tr>
<tr class="separator:a34be7e48b4ab7e1c189665d61b1e9e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a2c501d49303a5912f9d792ddabd2ddfb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp.html">Tcp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a> = nullptr</td></tr>
<tr class="separator:a2c501d49303a5912f9d792ddabd2ddfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ef478c5f1fb691510da2b4b6a47cd9"><td class="memItemLeft" align="right" valign="top">cFSM&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a></td></tr>
<tr class="separator:aa3ef478c5f1fb691510da2b4b6a47cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0055a12446dba0c431b0fd1b46a2a72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html">TcpStateVariables</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> = nullptr</td></tr>
<tr class="separator:ab0055a12446dba0c431b0fd1b46a2a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5a106f1b332763f61f14022eeb80ed8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html">TcpSendQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a> = nullptr</td></tr>
<tr class="separator:af5a106f1b332763f61f14022eeb80ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa817b5fce2fa957353f76dc00bb59060"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html">TcpReceiveQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a> = nullptr</td></tr>
<tr class="separator:aa817b5fce2fa957353f76dc00bb59060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaae281a0487887d96eb74249ad0fdeb9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html">TcpAlgorithm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a> = nullptr</td></tr>
<tr class="separator:aaae281a0487887d96eb74249ad0fdeb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9427c96c47960d86c30f2addbee224c0"><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a> = nullptr</td></tr>
<tr class="separator:a9427c96c47960d86c30f2addbee224c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c09509eed5568d9ca764207707c20d"><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a> = nullptr</td></tr>
<tr class="separator:ac7c09509eed5568d9ca764207707c20d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaf1fe106e54ec80d28d242823e55ce7"><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a> = nullptr</td></tr>
<tr class="separator:afaf1fe106e54ec80d28d242823e55ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae726cf09a498dcd0b25a8f57f6aa3d99"><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a> = nullptr</td></tr>
<tr class="separator:ae726cf09a498dcd0b25a8f57f6aa3d99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Processing timeouts. Invoked from processTimer().</h2></td></tr>
<tr class="memitem:ac16044dfebbb178c5941ab62380b8601"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck</a> ()</td></tr>
<tr class="memdesc:ac16044dfebbb178c5941ab62380b8601"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send ACK.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">More...</a><br /></td></tr>
<tr class="separator:ac16044dfebbb178c5941ab62380b8601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d63bfdd2c222e3898a922e1cd35c117"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData</a> (uint32_t congestionWindow)</td></tr>
<tr class="memdesc:a2d63bfdd2c222e3898a922e1cd35c117"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: Send data from sendQueue, at most congestionWindow.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">More...</a><br /></td></tr>
<tr class="separator:a2d63bfdd2c222e3898a922e1cd35c117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53293619e77207f0f2efb029da9ea37c"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">sendProbe</a> ()</td></tr>
<tr class="memdesc:a53293619e77207f0f2efb029da9ea37c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends 1 bytes as "probe", called by the "persist" mechanism.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">More...</a><br /></td></tr>
<tr class="separator:a53293619e77207f0f2efb029da9ea37c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c2dec9ae82329e76fa37c0bf6ea730"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment</a> (bool called_at_rto)</td></tr>
<tr class="memdesc:a93c2dec9ae82329e76fa37c0bf6ea730"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: retransmit one segment from snd_una.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">More...</a><br /></td></tr>
<tr class="separator:a93c2dec9ae82329e76fa37c0bf6ea730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d92cf8b5ea339a828b34b33fc102a3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData</a> ()</td></tr>
<tr class="memdesc:a69d92cf8b5ea339a828b34b33fc102a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: retransmit all from snd_una to snd_max.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">More...</a><br /></td></tr>
<tr class="separator:a69d92cf8b5ea339a828b34b33fc102a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e2c7e2c00d063a782808ab9f3bbccf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a> (uint32_t seqNo)</td></tr>
<tr class="memdesc:aa9e2c7e2c00d063a782808ab9f3bbccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends RST.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">More...</a><br /></td></tr>
<tr class="separator:aa9e2c7e2c00d063a782808ab9f3bbccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0164100bb7b0722aafb91edadc87b903"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0164100bb7b0722aafb91edadc87b903">sendRst</a> (uint32_t seq, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest, int srcPort, int destPort)</td></tr>
<tr class="memdesc:a0164100bb7b0722aafb91edadc87b903"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends RST; does not use connection state.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a0164100bb7b0722aafb91edadc87b903">More...</a><br /></td></tr>
<tr class="separator:a0164100bb7b0722aafb91edadc87b903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247e7362ec8ea0956d44f5c97aeffa24"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">sendRstAck</a> (uint32_t seq, uint32_t ack, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest, int srcPort, int destPort)</td></tr>
<tr class="memdesc:a247e7362ec8ea0956d44f5c97aeffa24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends RST+ACK; does not use connection state.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">More...</a><br /></td></tr>
<tr class="separator:a247e7362ec8ea0956d44f5c97aeffa24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c6979d1519488109b9a8fc029081a2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin</a> ()</td></tr>
<tr class="memdesc:ab2c6979d1519488109b9a8fc029081a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends FIN.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">More...</a><br /></td></tr>
<tr class="separator:ab2c6979d1519488109b9a8fc029081a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed176ad4551f8571d4fc13cb9480eda"><td class="memItemLeft" align="right" valign="top">virtual uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a> (uint32_t bytes)</td></tr>
<tr class="memdesc:a1ed176ad4551f8571d4fc13cb9480eda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends one segment of 'bytes' bytes from snd_nxt, and advances snd_nxt.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">More...</a><br /></td></tr>
<tr class="separator:a1ed176ad4551f8571d4fc13cb9480eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a149bc4c48129dc7b91263b0171189a64"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:a149bc4c48129dc7b91263b0171189a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: adds control info to segment and sends it to IP.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">More...</a><br /></td></tr>
<tr class="separator:a149bc4c48129dc7b91263b0171189a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac60a7ea5cb157c0bb34372eca11b40c2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer</a> ()</td></tr>
<tr class="memdesc:ac60a7ea5cb157c0bb34372eca11b40c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: start SYN-REXMIT timer.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">More...</a><br /></td></tr>
<tr class="separator:ac60a7ea5cb157c0bb34372eca11b40c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c251d96c91f8ac882ea64ea0e6a1d7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae9c251d96c91f8ac882ea64ea0e6a1d7">signalConnectionTimeout</a> ()</td></tr>
<tr class="memdesc:ae9c251d96c91f8ac882ea64ea0e6a1d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: signal to user that connection timed out.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ae9c251d96c91f8ac882ea64ea0e6a1d7">More...</a><br /></td></tr>
<tr class="separator:ae9c251d96c91f8ac882ea64ea0e6a1d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48d27c4c68b12165dc4c94aad7e2d9d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief</a> () const</td></tr>
<tr class="memdesc:ad48d27c4c68b12165dc4c94aad7e2d9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: prints local/remote addr/port and app gate index/socketId.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">More...</a><br /></td></tr>
<tr class="separator:ad48d27c4c68b12165dc4c94aad7e2d9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dce56cbb130a9eff691579cb479fdd7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars</a> ()</td></tr>
<tr class="memdesc:a5dce56cbb130a9eff691579cb479fdd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: update receiver queue related variables and statistics - called before setting rcv_wnd.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">More...</a><br /></td></tr>
<tr class="separator:a5dce56cbb130a9eff691579cb479fdd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69317f3325bcf935665f7c88f776b4de"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:a69317f3325bcf935665f7c88f776b4de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: returns true when receive queue has enough space for store the tcpHeader.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">More...</a><br /></td></tr>
<tr class="separator:a69317f3325bcf935665f7c88f776b4de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b36439caaec220aebab659e5c6ff4d8"><td class="memItemLeft" align="right" valign="top">virtual unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd</a> ()</td></tr>
<tr class="memdesc:a9b36439caaec220aebab659e5c6ff4d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: update receive window (rcv_wnd), and calculate scaled value if window scaling enabled.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">More...</a><br /></td></tr>
<tr class="separator:a9b36439caaec220aebab659e5c6ff4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6a60e79915ff54a4a91715cb6318593"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, bool doAlways=false)</td></tr>
<tr class="memdesc:af6a60e79915ff54a4a91715cb6318593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: update window information (snd_wnd, snd_wl1, snd_wl2)  <a href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">More...</a><br /></td></tr>
<tr class="separator:af6a60e79915ff54a4a91715cb6318593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd54e2ff988fa1dc58b8f25bd082ab86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#afd54e2ff988fa1dc58b8f25bd082ab86">TcpConnection</a> ()</td></tr>
<tr class="separator:afd54e2ff988fa1dc58b8f25bd082ab86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a079bdd1e862ec5da660cfc6297bc2ecb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a079bdd1e862ec5da660cfc6297bc2ecb">TcpConnection</a> (const <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a> &amp;other)</td></tr>
<tr class="separator:a079bdd1e862ec5da660cfc6297bc2ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256303f27b17cc11775ea6b34d995c8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a256303f27b17cc11775ea6b34d995c8f">initialize</a> ()</td></tr>
<tr class="separator:a256303f27b17cc11775ea6b34d995c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad00520df766c10bd488edb877824256f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection</a> (<a class="el" href="classinet_1_1tcp_1_1_tcp.html">Tcp</a> *mod, int <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>)</td></tr>
<tr class="memdesc:ad00520df766c10bd488edb877824256f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The "normal" constructor.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">More...</a><br /></td></tr>
<tr class="separator:ad00520df766c10bd488edb877824256f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a456bd2fe74982d05486d3d0008d72f2b"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection</a> ()</td></tr>
<tr class="memdesc:a456bd2fe74982d05486d3d0008d72f2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">More...</a><br /></td></tr>
<tr class="separator:a456bd2fe74982d05486d3d0008d72f2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a686df2fe88381a7c9cf9a8eeddc2ec7a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a686df2fe88381a7c9cf9a8eeddc2ec7a">getLocalPort</a> () const</td></tr>
<tr class="separator:a686df2fe88381a7c9cf9a8eeddc2ec7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab88f9d9402f1880f539445494e530403"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab88f9d9402f1880f539445494e530403">getLocalAddress</a> () const</td></tr>
<tr class="separator:ab88f9d9402f1880f539445494e530403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858aeec76abf6854ca70aa6fb1e7778f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a858aeec76abf6854ca70aa6fb1e7778f">getRemotePort</a> () const</td></tr>
<tr class="separator:a858aeec76abf6854ca70aa6fb1e7778f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e9de588872ff2e32f4b72f92b26790"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af4e9de588872ff2e32f4b72f92b26790">getRemoteAddress</a> () const</td></tr>
<tr class="separator:af4e9de588872ff2e32f4b72f92b26790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76270b2436749dcdde9c22b4553f6082"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a76270b2436749dcdde9c22b4553f6082">segmentArrivalWhileClosed</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest)</td></tr>
<tr class="memdesc:a76270b2436749dcdde9c22b4553f6082"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method gets invoked from TCP when a segment arrives which doesn't belong to an existing connection.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a76270b2436749dcdde9c22b4553f6082">More...</a><br /></td></tr>
<tr class="separator:a76270b2436749dcdde9c22b4553f6082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27c319b03d76159b21f347b1eaf9533"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad27c319b03d76159b21f347b1eaf9533">process_TIMEOUT_2MSL</a> ()</td></tr>
<tr class="separator:ad27c319b03d76159b21f347b1eaf9533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6714ac3137d36f95dc2deaf8ba1c16"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB</a> ()</td></tr>
<tr class="separator:a6f6714ac3137d36f95dc2deaf8ba1c16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aed4b95f11d1397db07461cd7c997ee"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8aed4b95f11d1397db07461cd7c997ee">process_TIMEOUT_FIN_WAIT_2</a> ()</td></tr>
<tr class="separator:a8aed4b95f11d1397db07461cd7c997ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0930df856c9fb347f5acb3182346e2f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT</a> (<a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;event)</td></tr>
<tr class="separator:af0930df856c9fb347f5acb3182346e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44320887baf414d8265c95fa11bba60"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa44320887baf414d8265c95fa11bba60">cloneListeningConnection</a> ()</td></tr>
<tr class="memdesc:aa44320887baf414d8265c95fa11bba60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: clone a listening connection.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#aa44320887baf414d8265c95fa11bba60">More...</a><br /></td></tr>
<tr class="separator:aa44320887baf414d8265c95fa11bba60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a634fbbac40c82d92c32505d377132"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection</a> (<a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a> *listenerConn)</td></tr>
<tr class="separator:a19a634fbbac40c82d92c32505d377132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559d4b4984ef8f4957dba6d2ee2002dc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection</a> (<a class="el" href="classinet_1_1_tcp_open_command.html">TcpOpenCommand</a> *openCmd)</td></tr>
<tr class="memdesc:a559d4b4984ef8f4957dba6d2ee2002dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: creates send/receive queues and tcpAlgorithm.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">More...</a><br /></td></tr>
<tr class="separator:a559d4b4984ef8f4957dba6d2ee2002dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3139ca6cfa7eb5d610c9ef391f282f1f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">configureStateVariables</a> ()</td></tr>
<tr class="memdesc:a3139ca6cfa7eb5d610c9ef391f282f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: set snd_mss, rcv_wnd and sack in newly created state variables block.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">More...</a><br /></td></tr>
<tr class="separator:a3139ca6cfa7eb5d610c9ef391f282f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741bf838feb4b009c6e0da096815b21d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum</a> ()</td></tr>
<tr class="memdesc:a741bf838feb4b009c6e0da096815b21d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: generates ISS and initializes corresponding state variables.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">More...</a><br /></td></tr>
<tr class="separator:a741bf838feb4b009c6e0da096815b21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a776e9ca5b96407bb3aa8f29e65087901"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a776e9ca5b96407bb3aa8f29e65087901">isSegmentAcceptable</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader) const</td></tr>
<tr class="memdesc:a776e9ca5b96407bb3aa8f29e65087901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: check if segment is acceptable (all bytes are in receive window)  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a776e9ca5b96407bb3aa8f29e65087901">More...</a><br /></td></tr>
<tr class="separator:a776e9ca5b96407bb3aa8f29e65087901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1322918e1985b3e30c63a82c62834b4c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn</a> ()</td></tr>
<tr class="memdesc:a1322918e1985b3e30c63a82c62834b4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send SYN.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">More...</a><br /></td></tr>
<tr class="separator:a1322918e1985b3e30c63a82c62834b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69abf2064bebb5deaf8169d034cfca86"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck</a> ()</td></tr>
<tr class="memdesc:a69abf2064bebb5deaf8169d034cfca86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send SYN+ACK.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">More...</a><br /></td></tr>
<tr class="separator:a69abf2064bebb5deaf8169d034cfca86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b550d07dd3ddf8fcd0294dbfe9ffb55"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:a4b550d07dd3ddf8fcd0294dbfe9ffb55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: readHeaderOptions (Currently only EOL, NOP, MSS, WS, SACK_PERMITTED, SACK and TS are implemented)  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">More...</a><br /></td></tr>
<tr class="separator:a4b550d07dd3ddf8fcd0294dbfe9ffb55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a1f002d9ffdc83267c750151631bda"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions</a> (const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:a88a1f002d9ffdc83267c750151631bda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: writeHeaderOptions (Currently only EOL, NOP, MSS, WS, SACK_PERMITTED, SACK and TS are implemented)  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">More...</a><br /></td></tr>
<tr class="separator:a88a1f002d9ffdc83267c750151631bda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8c2448573eb3e4c89ac289595e12598"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">addSacks</a> (const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:aa8c2448573eb3e4c89ac289595e12598"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: adds SACKs to segments header options field.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">More...</a><br /></td></tr>
<tr class="separator:aa8c2448573eb3e4c89ac289595e12598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f166dcdb24cb42e0824417b3a089f4"><td class="memItemLeft" align="right" valign="top">virtual uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97f166dcdb24cb42e0824417b3a089f4">getTSval</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader) const</td></tr>
<tr class="memdesc:a97f166dcdb24cb42e0824417b3a089f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: get TSval from segments TS header option.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a97f166dcdb24cb42e0824417b3a089f4">More...</a><br /></td></tr>
<tr class="separator:a97f166dcdb24cb42e0824417b3a089f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7209422a6ff4647d622520ef2762e8"><td class="memItemLeft" align="right" valign="top">virtual uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7b7209422a6ff4647d622520ef2762e8">getTSecr</a> (const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader) const</td></tr>
<tr class="memdesc:a7b7209422a6ff4647d622520ef2762e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: get TSecr from segments TS header option.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a7b7209422a6ff4647d622520ef2762e8">More...</a><br /></td></tr>
<tr class="separator:a7b7209422a6ff4647d622520ef2762e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f6b1407d6fb4da74a027d4f4c22aad"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad9f6b1407d6fb4da74a027d4f4c22aad">isToBeAccepted</a> () const</td></tr>
<tr class="memdesc:ad9f6b1407d6fb4da74a027d4f4c22aad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: returns true if the connection is not yet accepted by the application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ad9f6b1407d6fb4da74a027d4f4c22aad">More...</a><br /></td></tr>
<tr class="separator:ad9f6b1407d6fb4da74a027d4f4c22aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef5d6ef72325ff4100c61f54aa718083"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aef5d6ef72325ff4100c61f54aa718083">sendToIP</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *pkt, const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> src, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> dest)</td></tr>
<tr class="memdesc:aef5d6ef72325ff4100c61f54aa718083"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send IP packet.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#aef5d6ef72325ff4100c61f54aa718083">More...</a><br /></td></tr>
<tr class="separator:aef5d6ef72325ff4100c61f54aa718083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab77b0cf9754e394332dd36cc610e3bfc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a> (cMessage *msg)</td></tr>
<tr class="memdesc:ab77b0cf9754e394332dd36cc610e3bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends packet to application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">More...</a><br /></td></tr>
<tr class="separator:ab77b0cf9754e394332dd36cc610e3bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2969ad9d4633f46f1193733a2adc211a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a> (int code, const int id=0)</td></tr>
<tr class="memdesc:a2969ad9d4633f46f1193733a2adc211a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends status indication (TCP_I_xxx) to application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">More...</a><br /></td></tr>
<tr class="separator:a2969ad9d4633f46f1193733a2adc211a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6c500012de26b9f25cd1d339a77d50"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp</a> ()</td></tr>
<tr class="memdesc:a6d6c500012de26b9f25cd1d339a77d50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends TCP_I_AVAILABLE indication with <a class="el" href="classinet_1_1_tcp_available_info.html" title="Class generated from inet/transportlayer/contract/tcp/TcpCommand.msg:161 by opp_msgtool.">TcpAvailableInfo</a> to application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">More...</a><br /></td></tr>
<tr class="separator:a6d6c500012de26b9f25cd1d339a77d50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7441e1e51cc3a6df1edaf9e1447f1dbd"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp</a> ()</td></tr>
<tr class="memdesc:a7441e1e51cc3a6df1edaf9e1447f1dbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends TCP_I_ESTABLISHED indication with <a class="el" href="classinet_1_1_tcp_connect_info.html" title="Class generated from inet/transportlayer/contract/tcp/TcpCommand.msg:176 by opp_msgtool.">TcpConnectInfo</a> to application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">More...</a><br /></td></tr>
<tr class="separator:a7441e1e51cc3a6df1edaf9e1447f1dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb71143849cc54f0d0dabdc196dc7213"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp</a> ()</td></tr>
<tr class="memdesc:adb71143849cc54f0d0dabdc196dc7213"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: sends data or data notification to application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">More...</a><br /></td></tr>
<tr class="separator:adb71143849cc54f0d0dabdc196dc7213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae487487c5d3aee8af6dda153cfd62086"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">printSegmentBrief</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader)</td></tr>
<tr class="memdesc:ae487487c5d3aee8af6dda153cfd62086"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: prints important header fields.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">More...</a><br /></td></tr>
<tr class="separator:ae487487c5d3aee8af6dda153cfd62086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f713d3c35004f40eef567f610f83127"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a> (int <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>)</td></tr>
<tr class="memdesc:a3f713d3c35004f40eef567f610f83127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: returns name of TCP_S_xxx constants.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">More...</a><br /></td></tr>
<tr class="separator:a3f713d3c35004f40eef567f610f83127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18db3914f2cb5e1f599724fbcb824b05"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">eventName</a> (int event)</td></tr>
<tr class="memdesc:a18db3914f2cb5e1f599724fbcb824b05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: returns name of TCP_E_xxx constants.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">More...</a><br /></td></tr>
<tr class="separator:a18db3914f2cb5e1f599724fbcb824b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae23542545db9c2091cd2c533dec08989"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a> (int code)</td></tr>
<tr class="memdesc:ae23542545db9c2091cd2c533dec08989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: returns name of TCP_I_xxx constants.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">More...</a><br /></td></tr>
<tr class="separator:ae23542545db9c2091cd2c533dec08989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3c48dbf55f9af32596348733448c5c"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b3c48dbf55f9af32596348733448c5c">optionName</a> (int option)</td></tr>
<tr class="memdesc:a9b3c48dbf55f9af32596348733448c5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: returns name of TCPOPTION_xxx constants.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a9b3c48dbf55f9af32596348733448c5c">More...</a><br /></td></tr>
<tr class="separator:a9b3c48dbf55f9af32596348733448c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Various getters</h2></td></tr>
<tr class="memitem:a7d264e9a009c667862516aa6b82faf49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7d264e9a009c667862516aa6b82faf49">getFsmState</a> () const</td></tr>
<tr class="separator:a7d264e9a009c667862516aa6b82faf49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a782499aa10f8b3086f02542da75b7057"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html">TcpStateVariables</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a782499aa10f8b3086f02542da75b7057">getState</a> () const</td></tr>
<tr class="separator:a782499aa10f8b3086f02542da75b7057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a109be81527af372058453485a4298d13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html">TcpStateVariables</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a109be81527af372058453485a4298d13">getState</a> ()</td></tr>
<tr class="separator:a109be81527af372058453485a4298d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bf84c088151099a830610063f65144a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html">TcpSendQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2bf84c088151099a830610063f65144a">getSendQueue</a> ()</td></tr>
<tr class="separator:a2bf84c088151099a830610063f65144a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a512b4ba9fb2b016c81fde971c85600b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html">TcpSackRexmitQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a512b4ba9fb2b016c81fde971c85600b8">getRexmitQueue</a> ()</td></tr>
<tr class="separator:a512b4ba9fb2b016c81fde971c85600b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab04b9670c2ff4b91ff915de2eee5628b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html">TcpReceiveQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab04b9670c2ff4b91ff915de2eee5628b">getReceiveQueue</a> ()</td></tr>
<tr class="separator:ab04b9670c2ff4b91ff915de2eee5628b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ff49994434ad3b62b56139e0d69b7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html">TcpAlgorithm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a94ff49994434ad3b62b56139e0d69b7f">getTcpAlgorithm</a> ()</td></tr>
<tr class="separator:a94ff49994434ad3b62b56139e0d69b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b066f60365c79be25993f90a70d2c3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1tcp_1_1_tcp.html">Tcp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b066f60365c79be25993f90a70d2c3b">getTcpMain</a> ()</td></tr>
<tr class="separator:a4b066f60365c79be25993f90a70d2c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41b2cd9b54a275b28246d319ba690d7"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer</a> (cMessage *msg)</td></tr>
<tr class="memdesc:aa41b2cd9b54a275b28246d319ba690d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process self-messages (timers).  <a href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">More...</a><br /></td></tr>
<tr class="separator:aa41b2cd9b54a275b28246d319ba690d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62437fe059a142794609ed08cde88375"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *tcpSegment, const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;tcpHeader, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> srcAddr, <a class="el" href="classinet_1_1_l3_address.html">L3Address</a> destAddr)</td></tr>
<tr class="memdesc:a62437fe059a142794609ed08cde88375"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process incoming TCP segment.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">More...</a><br /></td></tr>
<tr class="separator:a62437fe059a142794609ed08cde88375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97136ad66744c500a7c4f41e12dc27dd"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a97136ad66744c500a7c4f41e12dc27dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process commands from the application.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">More...</a><br /></td></tr>
<tr class="separator:a97136ad66744c500a7c4f41e12dc27dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a664c9361c7066546477350ca08f1d07d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a664c9361c7066546477350ca08f1d07d">handleMessage</a> (cMessage *msg)</td></tr>
<tr class="separator:a664c9361c7066546477350ca08f1d07d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6da67049d73d31f5cc957232e8c3600"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost</a> (uint32_t seqNum)</td></tr>
<tr class="memdesc:ac6da67049d73d31f5cc957232e8c3600"><td class="mdescLeft">&#160;</td><td class="mdescRight">For SACK TCP.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">More...</a><br /></td></tr>
<tr class="separator:ac6da67049d73d31f5cc957232e8c3600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f756bb8ffed7eb3412c399405d942c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a10f756bb8ffed7eb3412c399405d942c">setPipe</a> ()</td></tr>
<tr class="memdesc:a10f756bb8ffed7eb3412c399405d942c"><td class="mdescLeft">&#160;</td><td class="mdescRight">For SACK TCP.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a10f756bb8ffed7eb3412c399405d942c">More...</a><br /></td></tr>
<tr class="separator:a10f756bb8ffed7eb3412c399405d942c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a218e86e3d8517cfa1f09c432bd3db31d"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">nextSeg</a> (uint32_t &amp;seqNum)</td></tr>
<tr class="memdesc:a218e86e3d8517cfa1f09c432bd3db31d"><td class="mdescLeft">&#160;</td><td class="mdescRight">For SACK TCP.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">More...</a><br /></td></tr>
<tr class="separator:a218e86e3d8517cfa1f09c432bd3db31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac07f0b0d5d9b7e0e3a677e6d458cf98c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac07f0b0d5d9b7e0e3a677e6d458cf98c">sendDataDuringLossRecoveryPhase</a> (uint32_t congestionWindow)</td></tr>
<tr class="memdesc:ac07f0b0d5d9b7e0e3a677e6d458cf98c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send data during Loss Recovery phase (if SACK is enabled).  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ac07f0b0d5d9b7e0e3a677e6d458cf98c">More...</a><br /></td></tr>
<tr class="separator:ac07f0b0d5d9b7e0e3a677e6d458cf98c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc4b52c9e9becab1674bdbf2e7b4164e"><td class="memItemLeft" align="right" valign="top">virtual uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase</a> (uint32_t seqNum)</td></tr>
<tr class="memdesc:acc4b52c9e9becab1674bdbf2e7b4164e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send segment during Loss Recovery phase (if SACK is enabled).  <a href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">More...</a><br /></td></tr>
<tr class="separator:acc4b52c9e9becab1674bdbf2e7b4164e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac98e6eb26dabef91260e4ea36e70ccbd"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">sendOneNewSegment</a> (bool fullSegmentsOnly, uint32_t congestionWindow)</td></tr>
<tr class="memdesc:ac98e6eb26dabef91260e4ea36e70ccbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: send one new segment from snd_max if allowed (RFC 3042).  <a href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">More...</a><br /></td></tr>
<tr class="separator:ac98e6eb26dabef91260e4ea36e70ccbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77fb1b6498d8690a77d6a7cb4ca7cc5"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af77fb1b6498d8690a77d6a7cb4ca7cc5">isSendQueueEmpty</a> ()</td></tr>
<tr class="memdesc:af77fb1b6498d8690a77d6a7cb4ca7cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: checks if send queue is empty (no data to send).  <a href="classinet_1_1tcp_1_1_tcp_connection.html#af77fb1b6498d8690a77d6a7cb4ca7cc5">More...</a><br /></td></tr>
<tr class="separator:af77fb1b6498d8690a77d6a7cb4ca7cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2592b559e4749d06295c427e1d058368"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2592b559e4749d06295c427e1d058368">convertSimtimeToTS</a> (simtime_t simtime)</td></tr>
<tr class="memdesc:a2592b559e4749d06295c427e1d058368"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: converts a given simtime to a timestamp (TS).  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a2592b559e4749d06295c427e1d058368">More...</a><br /></td></tr>
<tr class="separator:a2592b559e4749d06295c427e1d058368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721f2b63af31fd3349d206fae64a20fe"><td class="memItemLeft" align="right" valign="top">static simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a721f2b63af31fd3349d206fae64a20fe">convertTSToSimtime</a> (uint32_t timestamp)</td></tr>
<tr class="memdesc:a721f2b63af31fd3349d206fae64a20fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility: converts a given timestamp (TS) to a simtime.  <a href="classinet_1_1tcp_1_1_tcp_connection.html#a721f2b63af31fd3349d206fae64a20fe">More...</a><br /></td></tr>
<tr class="separator:a721f2b63af31fd3349d206fae64a20fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages a TCP connection. </p>
<p>This class itself implements the TCP state machine as well as handling control PDUs (SYN, SYN+ACK, RST, FIN, etc.), timers (2MSL, CONN-ESTAB, FIN-WAIT-2) and events (OPEN, SEND, etc) associated with TCP state changes.</p>
<p>The implementation largely follows the functional specification at the end of RFC 793. Code comments extensively quote RFC 793 to make it easier to understand.</p>
<p><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html" title="Manages a TCP connection.">TcpConnection</a> objects are not used alone &ndash; they are instantiated and managed by a TCP module.</p>
<p><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html" title="Manages a TCP connection.">TcpConnection</a> "outsources" several tasks to objects subclassed from <a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html" title="Send queue that manages Chunks.">TcpSendQueue</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html" title="Receive queue that manages Chunks.">TcpReceiveQueue</a> and <a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html" title="Abstract base class for TCP algorithms which encapsulate all behaviour during data transfer state: fl...">TcpAlgorithm</a>; see overview of this with TCP documentation.</p>
<p>Connection variables (TCB) are kept in <a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html" title="Contains state variables (&quot;TCB&quot;) for TCP.">TcpStateVariables</a>. <a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html" title="Abstract base class for TCP algorithms which encapsulate all behaviour during data transfer state: fl...">TcpAlgorithm</a> implementations can extend <a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html" title="Contains state variables (&quot;TCB&quot;) for TCP.">TcpStateVariables</a> to add their own stuff (see <a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html#aaf98b08619b50bf06bb949d67f0c1512" title="Create state block (TCB) used by this TCP variant.">TcpAlgorithm::createStateVariables()</a> factory method.)</p>
<p>The "entry points" of TCPConnnection from TCP are:</p><ul>
<li><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7" title="Process self-messages (timers).">processTimer(cMessage *msg)</a>: handle self-messages which belong to the connection</li>
<li>processTCPSegment(TcpHeader *tcpSeg, Address srcAddr, Address destAddr): handle segment arrivals</li>
<li><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd" title="Process commands from the application.">processAppCommand(cMessage *msg)</a>: process commands which arrive from the application (TCP_C_xxx)</li>
</ul>
<p>All three methods follow a common structure:</p>
<ol type="1">
<li>dispatch to specific methods. For example, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd" title="Process commands from the application.">processAppCommand()</a> invokes one of <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a> or <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, etc., and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375" title="Process incoming TCP segment.">processTCPSegment()</a> dispatches to <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a> or <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>. Those methods will do the REAL JOB.</li>
<li>after they return, we'll know the state machine event (TcpEventCode, TCP_E_xxx) for sure, so we can:</li>
<li>invoke <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8" title="Implemements the pure TCP state machine.">performStateTransition()</a> which executes the necessary state transition (for example, TCP_E_RCV_SYN will take the state machine from TCP_S_LISTEN to TCP_S_SYN_RCVD). No other actions are taken in this step.</li>
<li>if there was a state change (for example, we entered the TCP_S_ESTABLISHED state), <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8" title="Implemements the pure TCP state machine.">performStateTransition()</a> invokes <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4" title="Perform cleanup necessary when entering a new state, e.g.">stateEntered()</a>, which performs some necessary housekeeping (cancel the CONN-ESTAB timer).</li>
</ol>
<p>When the CLOSED state is reached, TCP will delete the <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html" title="Manages a TCP connection.">TcpConnection</a> object. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afd54e2ff988fa1dc58b8f25bd082ab86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd54e2ff988fa1dc58b8f25bd082ab86">&#9670;&nbsp;</a></span>TcpConnection() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inet::tcp::TcpConnection::TcpConnection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a079bdd1e862ec5da660cfc6297bc2ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a079bdd1e862ec5da660cfc6297bc2ecb">&#9670;&nbsp;</a></span>TcpConnection() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inet::tcp::TcpConnection::TcpConnection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;{} <span class="comment">// FIXME kludge</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a456bd2fe74982d05486d3d0008d72f2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a456bd2fe74982d05486d3d0008d72f2b">&#9670;&nbsp;</a></span>~TcpConnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inet::tcp::TcpConnection::~TcpConnection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">delete</span> cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">delete</span> cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keyword">delete</span> cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keyword">delete</span> cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa8c2448573eb3e4c89ac289595e12598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8c2448573eb3e4c89ac289595e12598">&#9670;&nbsp;</a></span>addSacks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> inet::tcp::TcpConnection::addSacks </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: adds SACKs to segments header options field. </p>
<div class="fragment"><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;{</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a> options_len = <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(0);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a> used_options_len = tcpHeader-&gt;getHeaderOptionArrayLength();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">bool</span> dsack_inserted = <span class="keyword">false</span>; <span class="comment">// set if dsack is subsets of a bigger sack block recently reported</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    uint32_t start = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    uint32_t end = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// delete old sacks (below rcv_nxt), delete duplicates and print previous status of sacks_array:</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keyword">auto</span> it = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.begin();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Previous status of sacks_array: \n&quot;</span> &lt;&lt; ((it != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.end()) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t EMPTY\n&quot;</span>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">while</span> (it != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.end()) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(it-&gt;getEnd(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>) || it-&gt;empty()) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;\t SACK in sacks_array: &quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; it-&gt;str() &lt;&lt; <span class="stringliteral">&quot; delete now\n&quot;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            it = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.erase(it);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;\t SACK in sacks_array: &quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; it-&gt;str() &lt;&lt; endl;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            ASSERT(<a class="code" href="namespaceinet_1_1tcp.html#a540240a4946cc48d695af1083f88a05b">seqGE</a>(it-&gt;getStart(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>));</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            it++;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (used_options_len &gt; <a class="code" href="namespaceinet_1_1tcp.html#a8fa2795781fd0df1ea479f2e72d3642d">TCP_OPTIONS_MAX_SIZE</a> - <a class="code" href="namespaceinet_1_1tcp.html#a44d1be9a5e80c9a4d00b6aa721d3e040">TCP_OPTION_SACK_MIN_SIZE</a>) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Failed to addSacks - at least 10 free bytes needed for SACK - used_options_len=&quot;</span> &lt;&lt; used_options_len &lt;&lt; endl;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">// reset flags:</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a> = 0;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a> = 0;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">return</span> *tcpHeader;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (start != end) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a>) { <span class="comment">// SequenceNo &lt; rcv_nxt</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="comment">// RFC 2883, page 3:</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">// &quot;(3) The left edge of the D-SACK block specifies the first sequence</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">// number of the duplicate contiguous sequence, and the right edge of</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">// the D-SACK block specifies the sequence number immediately following</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="comment">// the last sequence in the duplicate contiguous sequence.&quot;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(start, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>, end))</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                end = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            dsack_inserted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            Sack nSack(start, end);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.push_front(nSack);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;inserted DSACK entry: &quot;</span> &lt;&lt; nSack.str() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            uint32_t contStart = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#ad2b50ef2e9dba9f55f1b909e0b628b91">getLE</a>(start);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            uint32_t contEnd = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a4e186216aa94206fd4b1458f5bbf385f">getRE</a>(end);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            Sack newSack(contStart, contEnd);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.push_front(newSack);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Inserted SACK entry: &quot;</span> &lt;&lt; newSack.str() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// RFC 2883, page 3:</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">// &quot;(3) The left edge of the D-SACK block specifies the first sequence</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">// number of the duplicate contiguous sequence, and the right edge of</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">// the D-SACK block specifies the sequence number immediately following</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">// the last sequence in the duplicate contiguous sequence.&quot;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">// &quot;* The first SACK block (i.e., the one immediately following the</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// kind and length fields in the option) MUST specify the contiguous</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// block of data containing the segment which triggered this ACK,</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// unless that segment advanced the Acknowledgment Number field in</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">// the header.  This assures that the ACK with the SACK option</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">// reflects the most recent change in the data receiver&#39;s buffer</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="comment">// queue.&quot;</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// &quot;* The first SACK block (i.e., the one immediately following the</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">// kind and length fields in the option) MUST specify the contiguous</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="comment">// block of data containing the segment which triggered this ACK,&quot;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// RFC 2883, page 3:</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// &quot;(4) If the D-SACK block reports a duplicate contiguous sequence from</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">// a (possibly larger) block of data in the receiver&#39;s data queue above</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">// the cumulative acknowledgement, then the second SACK block in that</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// SACK option should specify that (possibly larger) block of data.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="comment">// (5) Following the SACK blocks described above for reporting duplicate</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// segments, additional SACK blocks can be used for reporting additional</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">// blocks of data, as specified in RFC 2018.&quot;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">// &quot;* The SACK option SHOULD be filled out by repeating the most</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="comment">// recently reported SACK blocks (based on first SACK blocks in</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">// previous SACK options) that are not subsets of a SACK block</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">// already included in the SACK option being constructed.&quot;</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        it = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.begin();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">if</span> (dsack_inserted)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            it++;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">for</span> (; it != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.end(); it++) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            ASSERT(!it-&gt;empty());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keyword">auto</span> it2 = it;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            it2++;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">while</span> (it2 != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.end()) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">if</span> (it-&gt;contains(*it2)) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;sack matched, delete contained : a=&quot;</span> &lt;&lt; it-&gt;str() &lt;&lt; <span class="stringliteral">&quot;, b=&quot;</span> &lt;&lt; it2-&gt;str() &lt;&lt; endl;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    it2 = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.erase(it2);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    it2++;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> n = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.size();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> maxnode = ((<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="namespaceinet_1_1tcp.html#a8fa2795781fd0df1ea479f2e72d3642d">TCP_OPTIONS_MAX_SIZE</a> - used_options_len).get()) - 2) / 8; <span class="comment">// 2: option header, 8: size of one sack entry</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (n &gt; maxnode)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        n = maxnode;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">if</span> (dsack_inserted)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.pop_front(); <span class="comment">// delete DSACK entry</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment">// reset flags:</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a> = 0;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a> = 0;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">return</span> *tcpHeader;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> optArrSize = tcpHeader-&gt;getHeaderOptionArraySize();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> optArrSizeAligned = optArrSize;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(used_options_len).get() % 4 != 2) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        used_options_len++;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        optArrSizeAligned++;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">while</span> (optArrSize &lt; optArrSizeAligned) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop());</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        optArrSize++;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    ASSERT(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(used_options_len).get() % 4 == 2);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    TcpOptionSack *option = <span class="keyword">new</span> TcpOptionSack();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    option-&gt;setLength(8 * n + 2);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    option-&gt;setSackItemArraySize(n);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// write sacks from sacks_array to options</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> counter = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">for</span> (it = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.begin(); it != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.end() &amp;&amp; counter &lt; n; it++) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        ASSERT(it-&gt;getStart() != it-&gt;getEnd());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        option-&gt;setSackItem(counter++, *it);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// independent of &quot;n&quot; we always need 2 padding bytes (NOP) to make: (used_options_len % 4 == 0)</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    options_len = used_options_len + <a class="code" href="namespaceinet_1_1tcp.html#ae9c6e08735ee777f9cf7afeaefd5ff3f">TCP_OPTION_SACK_ENTRY_SIZE</a> * n + <a class="code" href="namespaceinet_1_1tcp.html#a04ee56c7b417ea59a1fd3856beeb284e">TCP_OPTION_HEAD_SIZE</a>; <span class="comment">// 8 bytes for each SACK (n) + 2 bytes for kind&amp;length</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    ASSERT(options_len &lt;= <a class="code" href="namespaceinet_1_1tcp.html#a8fa2795781fd0df1ea479f2e72d3642d">TCP_OPTIONS_MAX_SIZE</a>); <span class="comment">// Options length allowed? - maximum: 40 Bytes</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    tcpHeader-&gt;appendHeaderOption(option);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    tcpHeader-&gt;setHeaderLength(<a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a> + tcpHeader-&gt;getHeaderOptionArrayLength());</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    tcpHeader-&gt;setChunkLength(tcpHeader-&gt;getHeaderLength());</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">// update number of sent sacks</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1db61f436cad720e34506d627b4e1361">snd_sacks</a> += n;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aff166b9e7e6ee791b56a161fc8dd86d3">sndSacksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1db61f436cad720e34506d627b4e1361">snd_sacks</a>);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    EV_INFO &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; SACK(s) added to header:\n&quot;</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> t = 0; t &lt; n; t++) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        EV_INFO &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;. SACK:&quot;</span> &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; option-&gt;getSackItem(t).getStart() &lt;&lt; <span class="stringliteral">&quot;..&quot;</span> &lt;&lt; option-&gt;getSackItem(t).getEnd() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (t == 0) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a>)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot; (D-SACK)&quot;</span>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(option-&gt;getSackItem(t).getEnd(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>)) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot; (received segment filled out a gap)&quot;</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a> = <span class="keyword">true</span>; <span class="comment">// Note: Set snd_dsack to delete first sack from sacks_array</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        EV_INFO &lt;&lt; endl;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// RFC 2883, page 3:</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// &quot;(1) A D-SACK block is only used to report a duplicate contiguous</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// sequence of data received by the receiver in the most recent packet.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// (2) Each duplicate contiguous sequence of data received is reported</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// in at most one D-SACK block.  (I.e., the receiver sends two identical</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// D-SACK blocks in subsequent packets only if the receiver receives two</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// duplicate segments.)//</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">// In case of d-sack: delete first sack (d-sack) and move old sacks by one to the left</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (dsack_inserted)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">sacks_array</a>.pop_front(); <span class="comment">// delete DSACK entry</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// reset flags:</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a> = 0;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a> = 0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">return</span> *tcpHeader;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions()</a>.</p>

</div>
</div>
<a id="aa44320887baf414d8265c95fa11bba60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa44320887baf414d8265c95fa11bba60">&#9670;&nbsp;</a></span>cloneListeningConnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a> * inet::tcp::TcpConnection::cloneListeningConnection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: clone a listening connection. </p>
<p>Used for forking. </p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">auto</span> moduleType = cModuleType::get(<span class="stringliteral">&quot;inet.transportlayer.tcp.TcpConnection&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">int</span> newSocketId = getEnvir()-&gt;getUniqueNumber();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">char</span> submoduleName[24];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    sprintf(submoduleName, <span class="stringliteral">&quot;conn-%d&quot;</span>, newSocketId);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">auto</span> conn = check_and_cast&lt;TcpConnection *&gt;(moduleType-&gt;createScheduleInit(submoduleName, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    conn-&gt;initConnection(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, newSocketId);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    conn-&gt;initClonedConnection(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span> conn;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>.</p>

</div>
</div>
<a id="a3139ca6cfa7eb5d610c9ef391f282f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3139ca6cfa7eb5d610c9ef391f282f1f">&#9670;&nbsp;</a></span>configureStateVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::configureStateVariables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: set snd_mss, rcv_wnd and sack in newly created state variables block. </p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab1e01a8de610d405235f5a646161d856">dupthresh</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;dupthresh&quot;</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">long</span> advertisedWindowPar = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;advertisedWindow&quot;</span>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">ws_support</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;windowScalingSupport&quot;</span>); <span class="comment">// if set, this means that current host supports WS (RFC 1323)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3f5fd4073ff476bb21d6e1d3c7ef676f">ws_manual_scale</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;windowScalingFactor&quot;</span>); <span class="comment">// scaling factor (set manually) to help for Tcp validation</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2d93e09da31c31f2b37b758902de1e66">ecnWillingness</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;ecnWillingness&quot;</span>); <span class="comment">// if set, current host is willing to use ECN</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> ((!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">ws_support</a> &amp;&amp; advertisedWindowPar &gt; <a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a>) || advertisedWindowPar &lt;= 0 || advertisedWindowPar &gt; <a class="code" href="_tcp_connection_8h.html#aae23e1692ce5fee6c56211941ff23f54">TCP_MAX_WIN_SCALED</a>)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Invalid advertisedWindow parameter: %ld&quot;</span>, advertisedWindowPar);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a> = advertisedWindowPar;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a> = advertisedWindowPar;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">ws_support</a> &amp;&amp; advertisedWindowPar &gt; <a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a>) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a> = <a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a>; <span class="comment">// we cannot to guarantee that the other end is also supporting the Window Scale (header option) (RFC 1322)</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a> = <a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a>; <span class="comment">// therefore TCP_MAX_WIN is used as initial value for rcv_wnd and rcv_adv</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">maxRcvBuffer</a> = advertisedWindowPar;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6498b2145c0cfb48d697974321f662a4">delayed_acks_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;delayedAcksEnabled&quot;</span>); <span class="comment">// delayed ACK algorithm (RFC 1122) enabled/disabled</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#abae36bc1eb535ad82586aab38be55407">nagle_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;nagleEnabled&quot;</span>); <span class="comment">// Nagle&#39;s algorithm (RFC 896) enabled/disabled</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa989b9d885f28bc180e2833483decb81">limited_transmit_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;limitedTransmitEnabled&quot;</span>); <span class="comment">// Limited Transmit algorithm (RFC 3042) enabled/disabled</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b2805e7b873917a7bc5409f57a94722">increased_IW_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;increasedIWEnabled&quot;</span>); <span class="comment">// Increased Initial Window (RFC 3390) enabled/disabled</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;mss&quot;</span>); <span class="comment">// Maximum Segment Size (RFC 793)</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a701a3e619d81a47b28c8de4914adb917">ts_support</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;timestampSupport&quot;</span>); <span class="comment">// if set, this means that current host supports TS (RFC 1323)</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">sack_support</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;sackSupport&quot;</span>); <span class="comment">// if set, this means that current host supports SACK (RFC 2018, 2883, 3517)</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">sack_support</a>) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        std::string algorithmName1 = <span class="stringliteral">&quot;TcpReno&quot;</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        std::string algorithmName2 = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;tcpAlgorithmClass&quot;</span>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">if</span> (algorithmName1 != algorithmName2) { <span class="comment">// TODO add additional checks for new SACK supporting algorithms here once they are implemented</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            EV_DEBUG &lt;&lt; <span class="stringliteral">&quot;If you want to use TCP SACK please set tcpAlgorithmClass to TcpReno\n&quot;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            ASSERT(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection()</a>.</p>

</div>
</div>
<a id="a2592b559e4749d06295c427e1d058368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2592b559e4749d06295c427e1d058368">&#9670;&nbsp;</a></span>convertSimtimeToTS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t inet::tcp::TcpConnection::convertSimtimeToTS </td>
          <td>(</td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>simtime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: converts a given simtime to a timestamp (TS). </p>
<div class="fragment"><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;{</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    ASSERT(SimTime::getScaleExp() &lt;= -3);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    uint32_t timestamp = (uint32_t)(simtime.inUnit(SIMTIME_MS));</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">return</span> timestamp;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a87699cc8f9580a8d5e64922e67df4942">inet::tcp::TcpBaseAlg::rttMeasurementCompleteUsingTS()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions()</a>.</p>

</div>
</div>
<a id="a721f2b63af31fd3349d206fae64a20fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a721f2b63af31fd3349d206fae64a20fe">&#9670;&nbsp;</a></span>convertTSToSimtime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t inet::tcp::TcpConnection::convertTSToSimtime </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timestamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: converts a given timestamp (TS) to a simtime. </p>
<div class="fragment"><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;{</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    ASSERT(SimTime::getScaleExp() &lt;= -3);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    simtime_t simtime(timestamp, SIMTIME_MS);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">return</span> simtime;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a87699cc8f9580a8d5e64922e67df4942">inet::tcp::TcpBaseAlg::rttMeasurementCompleteUsingTS()</a>.</p>

</div>
</div>
<a id="a18db3914f2cb5e1f599724fbcb824b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18db3914f2cb5e1f599724fbcb824b05">&#9670;&nbsp;</a></span>eventName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * inet::tcp::TcpConnection::eventName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: returns name of TCP_E_xxx constants. </p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#define CASE(x)    case x: \</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">        s = (char *)#x + 6; break</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">s</a> = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df">TCP_E_OPEN_ACTIVE</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea950c5d5064f7f480184d70bcc8773434">TCP_E_OPEN_PASSIVE</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea1202c3b28f3b6fb66b1a6f5ff301218b">TCP_E_ACCEPT</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea42dc07647bd4d3409908de672c7fc3b3">TCP_E_SEND</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea5dc26c747357fa3709d0c35e7e81a7e5">TCP_E_STATUS</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea821852d71e232c2c690d5f4e84f66cc7">TCP_E_QUEUE_BYTES_LIMIT</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3a8d3b97bb0b99915a43a941f80604f4">TCP_E_RCV_DATA</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa">TCP_E_RCV_SYN</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea010cd4a0a82a1dbc9beb246081ecc88b">TCP_E_RCV_SYN_ACK</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea0385b3f6612c766df9a009506249109f">TCP_E_RCV_FIN_ACK</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaf25e3fe001290d9dc3270102bd1bdcbe">TCP_E_TIMEOUT_2MSL</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea659bff1e5d75352885b205513466ccd1">TCP_E_TIMEOUT_CONN_ESTAB</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaa75de9fd09d1def0d3e0b6ac18f022b6">TCP_E_TIMEOUT_FIN_WAIT_2</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">s</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#undef CASE</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a7d264e9a009c667862516aa6b82faf49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d264e9a009c667862516aa6b82faf49">&#9670;&nbsp;</a></span>getFsmState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::getFsmState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState(); }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="namespaceinet_1_1tcp.html#a214d8e62bc922b8a2bb61dcda81daede">inet::tcp::operator&lt;&lt;()</a>.</p>

</div>
</div>
<a id="ac422487d46d2dacc3ed94fa0702751fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac422487d46d2dacc3ed94fa0702751fb">&#9670;&nbsp;</a></span>getListeningSocketId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::getListeningSocketId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">listeningSocketId</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af209b5ccd11645d1816564b597712672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af209b5ccd11645d1816564b597712672">&#9670;&nbsp;</a></span>getLocalAddr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&amp; inet::tcp::TcpConnection::getLocalAddr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab88f9d9402f1880f539445494e530403"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab88f9d9402f1880f539445494e530403">&#9670;&nbsp;</a></span>getLocalAddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a> inet::tcp::TcpConnection::getLocalAddress </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a686df2fe88381a7c9cf9a8eeddc2ec7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a686df2fe88381a7c9cf9a8eeddc2ec7a">&#9670;&nbsp;</a></span>getLocalPort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::getLocalPort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab04b9670c2ff4b91ff915de2eee5628b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab04b9670c2ff4b91ff915de2eee5628b">&#9670;&nbsp;</a></span>getReceiveQueue() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html">TcpReceiveQueue</a>* inet::tcp::TcpConnection::getReceiveQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac48ba16894a94587859b0bbfb3f36add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac48ba16894a94587859b0bbfb3f36add">&#9670;&nbsp;</a></span>getReceiveQueue() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html">TcpReceiveQueue</a>* inet::tcp::TcpConnection::getReceiveQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="add71f2e3347bdefbd5aee066dd887376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add71f2e3347bdefbd5aee066dd887376">&#9670;&nbsp;</a></span>getRemoteAddr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&amp; inet::tcp::TcpConnection::getRemoteAddr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af4e9de588872ff2e32f4b72f92b26790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e9de588872ff2e32f4b72f92b26790">&#9670;&nbsp;</a></span>getRemoteAddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a> inet::tcp::TcpConnection::getRemoteAddress </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a858aeec76abf6854ca70aa6fb1e7778f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858aeec76abf6854ca70aa6fb1e7778f">&#9670;&nbsp;</a></span>getRemotePort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::getRemotePort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a512b4ba9fb2b016c81fde971c85600b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a512b4ba9fb2b016c81fde971c85600b8">&#9670;&nbsp;</a></span>getRexmitQueue() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html">TcpSackRexmitQueue</a>* inet::tcp::TcpConnection::getRexmitQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ade6387021ac53e8b9ad12a72865560ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6387021ac53e8b9ad12a72865560ab">&#9670;&nbsp;</a></span>getRexmitQueue() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html">TcpSackRexmitQueue</a>* inet::tcp::TcpConnection::getRexmitQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bf84c088151099a830610063f65144a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bf84c088151099a830610063f65144a">&#9670;&nbsp;</a></span>getSendQueue() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html">TcpSendQueue</a>* inet::tcp::TcpConnection::getSendQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="add469419d8eb883b3a7d655085148950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add469419d8eb883b3a7d655085148950">&#9670;&nbsp;</a></span>getSendQueue() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html">TcpSendQueue</a>* inet::tcp::TcpConnection::getSendQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5b229735766bd9041d5a794f04ec588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b229735766bd9041d5a794f04ec588">&#9670;&nbsp;</a></span>getSocketId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::getSocketId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>.</p>

</div>
</div>
<a id="a109be81527af372058453485a4298d13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a109be81527af372058453485a4298d13">&#9670;&nbsp;</a></span>getState() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html">TcpStateVariables</a>* inet::tcp::TcpConnection::getState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a782499aa10f8b3086f02542da75b7057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a782499aa10f8b3086f02542da75b7057">&#9670;&nbsp;</a></span>getState() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html">TcpStateVariables</a>* inet::tcp::TcpConnection::getState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aa1b4e2eb1244c0d807c3fe7bd4a67f8d">inet::tcp::Tcp::handleLowerPacket()</a>, <a class="el" href="namespaceinet_1_1tcp.html#a214d8e62bc922b8a2bb61dcda81daede">inet::tcp::operator&lt;&lt;()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck()</a>.</p>

</div>
</div>
<a id="a94ff49994434ad3b62b56139e0d69b7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ff49994434ad3b62b56139e0d69b7f">&#9670;&nbsp;</a></span>getTcpAlgorithm() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html">TcpAlgorithm</a>* inet::tcp::TcpConnection::getTcpAlgorithm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6dc4f2c22057776204f1195c3ef070bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dc4f2c22057776204f1195c3ef070bc">&#9670;&nbsp;</a></span>getTcpAlgorithm() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html">TcpAlgorithm</a>* inet::tcp::TcpConnection::getTcpAlgorithm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b066f60365c79be25993f90a70d2c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b066f60365c79be25993f90a70d2c3b">&#9670;&nbsp;</a></span>getTcpMain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp.html">Tcp</a>* inet::tcp::TcpConnection::getTcpMain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_dc_tcp.html#ab3ac8b348e6617fad61ba347cbe490e2">inet::tcp::DcTcp::initialize()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_tahoe_reno_family.html#a7bc74d28f18c9a67b67b2a0e11a8597c">inet::tcp::TcpTahoeRenoFamily::initialize()</a>.</p>

</div>
</div>
<a id="a7b7209422a6ff4647d622520ef2762e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b7209422a6ff4647d622520ef2762e8">&#9670;&nbsp;</a></span>getTSecr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t inet::tcp::TcpConnection::getTSecr </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: get TSecr from segments TS header option. </p>
<div class="fragment"><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;{</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> i = 0; i &lt; tcpHeader-&gt;getHeaderOptionArraySize(); i++) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keyword">const</span> TcpOption *option = tcpHeader-&gt;getHeaderOption(i);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">if</span> (option-&gt;getKind() == <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abbfd2f02bffabb60b21194a40ef75e4b">TCPOPTION_TIMESTAMP</a>)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <span class="keywordflow">return</span> check_and_cast&lt;const TcpOptionTimestamp *&gt;(option)-&gt;getEchoedTimestamp();</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>.</p>

</div>
</div>
<a id="a97f166dcdb24cb42e0824417b3a089f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f166dcdb24cb42e0824417b3a089f4">&#9670;&nbsp;</a></span>getTSval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t inet::tcp::TcpConnection::getTSval </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: get TSval from segments TS header option. </p>
<div class="fragment"><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;{</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> i = 0; i &lt; tcpHeader-&gt;getHeaderOptionArraySize(); i++) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keyword">const</span> TcpOption *option = tcpHeader-&gt;getHeaderOption(i);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">if</span> (option-&gt;getKind() == <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abbfd2f02bffabb60b21194a40ef75e4b">TCPOPTION_TIMESTAMP</a>)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            <span class="keywordflow">return</span> check_and_cast&lt;const TcpOptionTimestamp *&gt;(option)-&gt;getSenderTimestamp();</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a664c9361c7066546477350ca08f1d07d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a664c9361c7066546477350ca08f1d07d">&#9670;&nbsp;</a></span>handleMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;{</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;isSelfMessage()) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer</a>(msg))</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">removeConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;model error: TcpConnection allows only self messages&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a69317f3325bcf935665f7c88f776b4de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69317f3325bcf935665f7c88f776b4de">&#9670;&nbsp;</a></span>hasEnoughSpaceForSegmentInReceiveQueue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::hasEnoughSpaceForSegmentInReceiveQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: returns true when receive queue has enough space for store the tcpHeader. </p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// TODO must rewrite it</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//    return (state-&gt;freeRcvBuffer &gt;= tcpHeader-&gt;getPayloadLength()); // enough freeRcvBuffer in rcvQueue for new segment?</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> payloadLength = tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    uint32_t payloadSeq = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    uint32_t firstSeq = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a380a7b467a6e279f76b946f80a9e5d07">getFirstSeqNo</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(payloadSeq, firstSeq)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">long</span> delta = firstSeq - payloadSeq;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        payloadSeq += delta;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        payloadLength -= delta;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(firstSeq, payloadSeq) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(payloadSeq + payloadLength, firstSeq + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">maxRcvBuffer</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="ae23542545db9c2091cd2c533dec08989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae23542545db9c2091cd2c533dec08989">&#9670;&nbsp;</a></span>indicationName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * inet::tcp::TcpConnection::indicationName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: returns name of TCP_I_xxx constants. </p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#define CASE(x)    case x: \</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">        s = (char *)#x + 6; break</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">s</a> = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">switch</span> (code) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaffa1be7ba967dfed00f2a1ecc2630f47">TCP_I_DATA</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aae1486aa9057a2c2388448375ab0d9b50">TCP_I_URGENT_DATA</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa1958c2474a2126a9951293ed0f76dbfc">TCP_I_AVAILABLE</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabebb8b876d14aa2de8ec16a07a64fc0c">TCP_I_ESTABLISHED</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa85246db1cb61179ad34ebd92dd2bef01">TCP_I_PEER_CLOSED</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa59d453e9968e0d5bbe7ed3daffe5da0b">TCP_I_CLOSED</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabb53e95b49db823f33684deac8819842">TCP_I_CONNECTION_REFUSED</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa109dd2103410ba2e7573649fed2300cd">TCP_I_CONNECTION_RESET</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaf19192f797b153d7fcd7b760c469090a">TCP_I_TIMED_OUT</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa20d878b48ef2d6c1bc032d90ba1ac753">TCP_I_STATUS</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa185cf408f70835f6cd64b8908896f7d5">TCP_I_SEND_MSG</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">s</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#undef CASE</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp()</a>.</p>

</div>
</div>
<a id="a19a634fbbac40c82d92c32505d377132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a634fbbac40c82d92c32505d377132">&#9670;&nbsp;</a></span>initClonedConnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::initClonedConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a> *&#160;</td>
          <td class="paramname"><em>listenerConn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;initClonedConnection&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">listeningSocketId</a> = listenerConn-&gt;getSocketId();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// following code to be kept consistent with initConnection()</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *sendQueueClass = listenerConn-&gt;sendQueue-&gt;getClassName();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a> = check_and_cast&lt;TcpSendQueue *&gt;(<a class="code" href="namespaceinet_1_1utils.html#a3e3ef67928a638b7e734578e246ba60b">inet::utils::createOne</a>(sendQueueClass));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a7a35d971a150ba0d7b758e9ff19b4dfe">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *receiveQueueClass = listenerConn-&gt;receiveQueue-&gt;getClassName();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a> = check_and_cast&lt;TcpReceiveQueue *&gt;(<a class="code" href="namespaceinet_1_1utils.html#a3e3ef67928a638b7e734578e246ba60b">inet::utils::createOne</a>(receiveQueueClass));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a8abe59159786a7c49755c49d7d9b4846">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// create SACK retransmit queue</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a> = <span class="keyword">new</span> TcpSackRexmitQueue();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a54aa5ffbc5bfd8546c840b36f1c02599">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *tcpAlgorithmClass = listenerConn-&gt;tcpAlgorithm-&gt;getClassName();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a> = check_and_cast&lt;TcpAlgorithm *&gt;(<a class="code" href="namespaceinet_1_1utils.html#a3e3ef67928a638b7e734578e246ba60b">inet::utils::createOne</a>(tcpAlgorithmClass));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#aaf782f289486e0b60a0e513971632b87">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae45a513394fa38752737ea7e8caea65e">getStateVariables</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">configureStateVariables</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a4c2b3d6a2cb7c47354493c67c144e0cf">initialize</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// put it into LISTEN, with our localAddr/localPort</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad44e8e93bded1311284350f023961454">fork</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> = listenerConn-&gt;localAddr;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> = listenerConn-&gt;localPort;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad00520df766c10bd488edb877824256f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad00520df766c10bd488edb877824256f">&#9670;&nbsp;</a></span>initConnection() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::initConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1tcp_1_1_tcp.html">Tcp</a> *&#160;</td>
          <td class="paramname"><em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socketId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The "normal" constructor. </p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;initConnection&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a> = _mod;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a> = _socketId;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.setName(getName());</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.setState(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// queues and algorithm will be created on active or passive open</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;2MSL&quot;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;CONN-ESTAB&quot;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;FIN-WAIT-2&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;SYN-REXMIT&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>-&gt;setContextPointer(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a559d4b4984ef8f4957dba6d2ee2002dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559d4b4984ef8f4957dba6d2ee2002dc">&#9670;&nbsp;</a></span>initConnection() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::initConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_open_command.html">TcpOpenCommand</a> *&#160;</td>
          <td class="paramname"><em>openCmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: creates send/receive queues and tcpAlgorithm. </p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// create send queue</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a38c072401e7140f11d17b0261de704a8">createSendQueue</a>();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a7a35d971a150ba0d7b758e9ff19b4dfe">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// create receive queue</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#abf35587592ab9d453d578f11aff135c4">createReceiveQueue</a>();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a8abe59159786a7c49755c49d7d9b4846">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// create SACK retransmit queue</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a> = <span class="keyword">new</span> TcpSackRexmitQueue();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a54aa5ffbc5bfd8546c840b36f1c02599">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// create algorithm</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *tcpAlgorithmClass = openCmd-&gt;getTcpAlgorithmClass();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (opp_isempty(tcpAlgorithmClass))</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        tcpAlgorithmClass = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;tcpAlgorithmClass&quot;</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a> = check_and_cast&lt;TcpAlgorithm *&gt;(<a class="code" href="namespaceinet_1_1utils.html#a3e3ef67928a638b7e734578e246ba60b">inet::utils::createOne</a>(tcpAlgorithmClass));</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#aaf782f289486e0b60a0e513971632b87">setConnection</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// create state block</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae45a513394fa38752737ea7e8caea65e">getStateVariables</a>();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">configureStateVariables</a>();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a4c2b3d6a2cb7c47354493c67c144e0cf">initialize</a>();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a>.</p>

</div>
</div>
<a id="a256303f27b17cc11775ea6b34d995c8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a256303f27b17cc11775ea6b34d995c8f">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6da67049d73d31f5cc957232e8c3600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6da67049d73d31f5cc957232e8c3600">&#9670;&nbsp;</a></span>isLost()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::isLost </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seqNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For SACK TCP. </p>
<p>RFC 3517, page 3: "This routine returns whether the given sequence number is considered to be lost. The routine returns true when either DupThresh discontiguous SACKed sequences have arrived above 'SeqNum' or (DupThresh * SMSS) bytes with sequence numbers greater than 'SeqNum' have been SACKed. Otherwise, the routine returns false." </p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// RFC 3517, page 3: &quot;This routine returns whether the given sequence number is</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// considered to be lost.  The routine returns true when either</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// DupThresh discontiguous SACKed sequences have arrived above</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// &#39;SeqNum&#39; or (DupThresh * SMSS) bytes with sequence numbers greater</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// than &#39;SeqNum&#39; have been SACKed.  Otherwise, the routine returns</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// false.&quot;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    ASSERT(<a class="code" href="namespaceinet_1_1tcp.html#a540240a4946cc48d695af1083f88a05b">seqGE</a>(seqNum, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>)); <span class="comment">// HighAck = snd_una</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost</a> = (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#ae184954440450a87d85bd0203686e916">getNumOfDiscontiguousSacks</a>(seqNum) &gt;= <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab1e01a8de610d405235f5a646161d856">dupthresh</a></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                   || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a58ad29e361347c1b9cd73c9d7f0ef66c">getAmountOfSackedBytes</a>(seqNum) &gt;= (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab1e01a8de610d405235f5a646161d856">dupthresh</a> * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">nextSeg()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a10f756bb8ffed7eb3412c399405d942c">setPipe()</a>.</p>

</div>
</div>
<a id="a776e9ca5b96407bb3aa8f29e65087901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776e9ca5b96407bb3aa8f29e65087901">&#9670;&nbsp;</a></span>isSegmentAcceptable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::isSegmentAcceptable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: check if segment is acceptable (all bytes are in receive window) </p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// check that segment entirely falls in receive window</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// RFC 793, page 69:</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// &quot;There are four cases for the acceptability test for an incoming segment:</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">//    Segment Receive  Test</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">//    Length  Window</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">//    ------- -------  -------------------------------------------</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">//       0       0     SEG.SEQ = RCV.NXT</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">//       0      &gt;0     RCV.NXT =&lt; SEG.SEQ &lt; RCV.NXT+RCV.WND</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">//      &gt;0       0     not acceptable</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">//      &gt;0      &gt;0     RCV.NXT =&lt; SEG.SEQ &lt; RCV.NXT+RCV.WND</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">//                  or RCV.NXT =&lt; SEG.SEQ+SEG.LEN-1 &lt; RCV.NXT+RCV.WND&quot;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    uint32_t len = tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    uint32_t seqNo = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    uint32_t ackNo = tcpHeader-&gt;getAckNo();</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    uint32_t rcvWndEnd = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">bool</span> ret;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (len == 0) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a> == 0)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            ret = (seqNo == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">else</span> <span class="comment">// rcv_wnd &gt; 0</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">//            ret = seqLE(state-&gt;rcv_nxt, seqNo) &amp;&amp; seqLess(seqNo, rcvWndEnd);</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            ret = <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>, seqNo) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(seqNo, rcvWndEnd); <span class="comment">// Accept an ACK on end of window</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">// len &gt; 0</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a> == 0)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">else</span> <span class="comment">// rcv_wnd &gt; 0</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            ret = (<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>, seqNo) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(seqNo, rcvWndEnd))</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                || (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>, seqNo + len) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(seqNo + len, rcvWndEnd)); <span class="comment">// Accept an ACK on end of window</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// RFC 793, page 25:</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// &quot;A new acknowledgment (called an &quot;acceptable ack&quot;), is one for which</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// the inequality below holds:</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">//    SND.UNA &lt; SEG.ACK =&lt; SND.NXT&quot;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span> (!ret &amp;&amp; len == 0) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a>)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            ret = (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, ackNo) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(ackNo, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            ret = (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, ackNo) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(ackNo, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)); <span class="comment">// after RTO snd_nxt is reduced therefore we need to use snd_max instead of snd_nxt here</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (!ret)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Not Acceptable segment. seqNo=&quot;</span> &lt;&lt; seqNo &lt;&lt; <span class="stringliteral">&quot; ackNo=&quot;</span> &lt;&lt; ackNo &lt;&lt; <span class="stringliteral">&quot; len=&quot;</span> &lt;&lt; len &lt;&lt; <span class="stringliteral">&quot; rcv_nxt=&quot;</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> &lt;&lt; <span class="stringliteral">&quot; rcv_wnd=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a> &lt;&lt; <span class="stringliteral">&quot; afterRto=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="af77fb1b6498d8690a77d6a7cb4ca7cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af77fb1b6498d8690a77d6a7cb4ca7cc5">&#9670;&nbsp;</a></span>isSendQueueEmpty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::isSendQueueEmpty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: checks if send queue is empty (no data to send). </p>
<div class="fragment"><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;{</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>) == 0;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a7e9461014cb424632888252758ba114a">inet::tcp::TcpBaseAlg::sendData()</a>.</p>

</div>
</div>
<a id="ad9f6b1407d6fb4da74a027d4f4c22aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9f6b1407d6fb4da74a027d4f4c22aad">&#9670;&nbsp;</a></span>isToBeAccepted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool inet::tcp::TcpConnection::isToBeAccepted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: returns true if the connection is not yet accepted by the application. </p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">listeningSocketId</a> != -1; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a218e86e3d8517cfa1f09c432bd3db31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a218e86e3d8517cfa1f09c432bd3db31d">&#9670;&nbsp;</a></span>nextSeg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::nextSeg </td>
          <td>(</td>
          <td class="paramtype">uint32_t &amp;&#160;</td>
          <td class="paramname"><em>seqNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For SACK TCP. </p>
<p>RFC 3517, page 3: "This routine uses the scoreboard data structure maintained by the Update() function to determine what to transmit based on the SACK information that has arrived from the data receiver (and hence been marked in the scoreboard). NextSeg () MUST return the sequence number range of the next segment that is to be transmitted..." Returns true if a valid sequence number (for the next segment) is found and returns false if no segment should be send. </p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// RFC 3517, page 5: &quot;This routine uses the scoreboard data structure maintained by the</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// Update() function to determine what to transmit based on the SACK</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// information that has arrived from the data receiver (and hence</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// been marked in the scoreboard).  NextSeg () MUST return the</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// sequence number range of the next segment that is to be</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// transmitted, per the following rules:&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">getHighestRexmittedSeqNum</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    uint32_t highestSackedSeqNum = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a2c3eaca4f3871d01d9c690cb18cf1340">getHighestSackedSeqNum</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    uint32_t shift = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">bool</span> sacked = <span class="keyword">false</span>; <span class="comment">// required for rexmitQueue-&gt;checkSackBlock()</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">bool</span> rexmitted = <span class="keyword">false</span>; <span class="comment">// required for rexmitQueue-&gt;checkSackBlock()</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    seqNum = 0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a>)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        shift -= <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="namespaceinet_1_1tcp.html#a9646df6c75f2c50877eaf2fcb00767fc">TCP_OPTION_TS_SIZE</a>).get();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// RFC 3517, page 5: &quot;(1) If there exists a smallest unSACKed sequence number &#39;S2&#39; that</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// meets the following three criteria for determining loss, the</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// sequence range of one segment of up to SMSS octets starting</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// with S2 MUST be returned.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// (1.a) S2 is greater than HighRxt.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// (1.b) S2 is less than the highest octet covered by any</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">//       received SACK.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// (1.c) IsLost (S2) returns true.&quot;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Note: state-&gt;highRxt == RFC.HighRxt + 1</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">for</span> (uint32_t s2 = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;         <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(s2, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(s2, highestSackedSeqNum);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;         s2 += shift)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a9d728c2ef24559de13711865253c191c">checkSackBlock</a>(s2, shift, sacked, rexmitted);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (!sacked) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost</a>(s2)) { <span class="comment">// 1.a and 1.b are true, see above &quot;for&quot; statement</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                seqNum = s2;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// !isLost(x) --&gt; !isLost(x + d)</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// RFC 3517, page 5: &quot;(2) If no sequence number &#39;S2&#39; per rule (1) exists but there</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// exists available unsent data and the receiver&#39;s advertised</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// window allows, the sequence range of one segment of up to SMSS</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// octets of previously unsent data starting with sequence number</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// HighData+1 MUST be returned.&quot;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">// check how many unsent bytes we have</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        uint32_t buffered = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        uint32_t maxWindow = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// effectiveWindow: number of bytes we&#39;re allowed to send now</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        uint32_t effectiveWin = maxWindow - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (buffered &gt; 0 &amp;&amp; effectiveWin &gt;= <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            seqNum = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>; <span class="comment">// HighData = snd_max</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// RFC 3517, pages 5 and 6: &quot;(3) If the conditions for rules (1) and (2) fail, but there exists</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// an unSACKed sequence number &#39;S3&#39; that meets the criteria for</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// detecting loss given in steps (1.a) and (1.b) above</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// (specifically excluding step (1.c)) then one segment of up to</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// SMSS octets starting with S3 MAY be returned.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// Note that rule (3) is a sort of retransmission &quot;last resort&quot;.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// It allows for retransmission of sequence numbers even when the</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// sender has less certainty a segment has been lost than as with</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// rule (1).  Retransmitting segments via rule (3) will help</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// sustain TCP&#39;s ACK clock and therefore can potentially help</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// avoid retransmission timeouts.  However, in sending these</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// segments the sender has two copies of the same data considered</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// to be in the network (and also in the Pipe estimate).  When an</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// ACK or SACK arrives covering this retransmitted segment, the</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// sender cannot be sure exactly how much data left the network</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// (one of the two transmissions of the packet or both</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// transmissions of the packet).  Therefore the sender may</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// underestimate Pipe by considering both segments to have left</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// the network when it is possible that only one of the two has.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// We believe that the triggering of rule (3) will be rare and</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// that the implications are likely limited to corner cases</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// relative to the entire recovery algorithm.  Therefore we leave</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// the decision of whether or not to use rule (3) to</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// implementors.&quot;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">for</span> (uint32_t s3 = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;             <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(s3, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(s3, highestSackedSeqNum);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;             s3 += shift)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a9d728c2ef24559de13711865253c191c">checkSackBlock</a>(s3, shift, sacked, rexmitted);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">if</span> (!sacked) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="comment">// 1.a and 1.b are true, see above &quot;for&quot; statement</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                seqNum = s3;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// RFC 3517, page 6: &quot;(4) If the conditions for each of (1), (2), and (3) are not met,</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// then NextSeg () MUST indicate failure, and no segment is</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// returned.&quot;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    seqNum = 0;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac07f0b0d5d9b7e0e3a677e6d458cf98c">sendDataDuringLossRecoveryPhase()</a>.</p>

</div>
</div>
<a id="a9b3c48dbf55f9af32596348733448c5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b3c48dbf55f9af32596348733448c5c">&#9670;&nbsp;</a></span>optionName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * inet::tcp::TcpConnection::optionName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>option</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: returns name of TCPOPTION_xxx constants. </p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;{</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">switch</span> (option) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abf3fa7fa8f31cc254c9c538a51fe5fce">TCPOPTION_END_OF_OPTION_LIST</a>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;EOL&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a6f75ef3f275801e12e682432472c26a9">TCPOPTION_NO_OPERATION</a>:</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;NOP&quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a6c6bdf29d7a49ae3a372fd2f710d9b0b">TCPOPTION_MAXIMUM_SEGMENT_SIZE</a>:</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;MSS&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772adf1e6f8a6d89003f19bac73e8b81efc8">TCPOPTION_WINDOW_SCALE</a>:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;WS&quot;</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a42b781bd85bb27a4d914450d01f27e60">TCPOPTION_SACK_PERMITTED</a>:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;SACK_PERMITTED&quot;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a8a6653346b4cb563cba15af48e1ff40a">TCPOPTION_SACK</a>:</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;SACK&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abbfd2f02bffabb60b21194a40ef75e4b">TCPOPTION_TIMESTAMP</a>:</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;TS&quot;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">printSegmentBrief()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions()</a>.</p>

</div>
</div>
<a id="ad8279e9052ae1d273ace989e9ab659c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8279e9052ae1d273ace989e9ab659c8">&#9670;&nbsp;</a></span>performStateTransition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::performStateTransition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemements the pure TCP state machine. </p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>); <span class="comment">// closed connections should be deleted immediately</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (event == <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>) { <span class="comment">// e.g. discarded segment</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Staying in state: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; (no FSM event)\n&quot;</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// state machine</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// TODO add handling of connection timeout event (KEEP-ALIVE), with transition to CLOSED</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// Note: empty &quot;default:&quot; lines are for gcc&#39;s benefit which would otherwise spit warnings</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">int</span> oldState = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea950c5d5064f7f480184d70bcc8773434">TCP_E_OPEN_PASSIVE</a>:</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df">TCP_E_OPEN_ACTIVE</a>:</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>:</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df">TCP_E_OPEN_ACTIVE</a>:</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea42dc07647bd4d3409908de672c7fc3b3">TCP_E_SEND</a>:</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>:</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa">TCP_E_RCV_SYN</a>:</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>:</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea659bff1e5d75352885b205513466ccd1">TCP_E_TIMEOUT_CONN_ESTAB</a>:</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a> ? <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a> : <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a> ? <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a> : <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>:</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>:</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>:</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea659bff1e5d75352885b205513466ccd1">TCP_E_TIMEOUT_CONN_ESTAB</a>:</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea010cd4a0a82a1dbc9beb246081ecc88b">TCP_E_RCV_SYN_ACK</a>:</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa">TCP_E_RCV_SYN</a>:</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>:</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>:</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>:</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>:</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>:</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>:</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>:</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>:</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>:</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea0385b3f6612c766df9a009506249109f">TCP_E_RCV_FIN_ACK</a>:</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaa75de9fd09d1def0d3e0b6ac18f022b6">TCP_E_TIMEOUT_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>:</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>:</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>:</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaf25e3fe001290d9dc3270102bd1bdcbe">TCP_E_TIMEOUT_2MSL</a>:</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>:</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>:</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    FSM_Goto(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>, <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>:</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (oldState != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Transition: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(oldState) &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot;  (event was: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">eventName</a>(event) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        EV_DEBUG_C(<span class="stringliteral">&quot;testing&quot;</span>) &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(oldState) &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot;  (on &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">eventName</a>(event) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">// cancel timers, etc.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState(), oldState, event);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Staying in state: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; (event was: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">eventName</a>(event) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>.</p>

</div>
</div>
<a id="afcf0d25d019cbe6eed624fa9e6644fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf0d25d019cbe6eed624fa9e6644fc8">&#9670;&nbsp;</a></span>preanalyseAppCommandEvent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::preanalyseAppCommandEvent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>commandCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maps app command codes (msg kind of app command msgs) to TCP_E_xxx event codes. </p>
<div class="fragment"><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;{</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">switch</span> (commandCode) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a7e9bf63012b141c33bf32608de5c5a24">TCP_C_OPEN_ACTIVE</a>:</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df">TCP_E_OPEN_ACTIVE</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a26de7ea87396d67ca943d0bb3580e582">TCP_C_OPEN_PASSIVE</a>:</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea950c5d5064f7f480184d70bcc8773434">TCP_E_OPEN_PASSIVE</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a3e31eeb7896f30c0406b39723f2b1131">TCP_C_ACCEPT</a>:</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea1202c3b28f3b6fb66b1a6f5ff301218b">TCP_E_ACCEPT</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a26e04d9483f45ac8dce5868546533a1a">TCP_C_SEND</a>:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea42dc07647bd4d3409908de672c7fc3b3">TCP_E_SEND</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a20a70ddc8e027eadd2be6b0ea7ad305a">TCP_C_CLOSE</a>:</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5ac71631f7b57d2379af9848c5bd62cdf3">TCP_C_ABORT</a>:</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a151a959cdd47ff9911e0e5179246011c">TCP_C_DESTROY</a>:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a2d62b1f03c437f9061547f99bf30366d">TCP_C_STATUS</a>:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea5dc26c747357fa3709d0c35e7e81a7e5">TCP_E_STATUS</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5ae314e77267ad22558fc37928bc2e90b5">TCP_C_QUEUE_BYTES_LIMIT</a>:</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea821852d71e232c2c690d5f4e84f66cc7">TCP_E_QUEUE_BYTES_LIMIT</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5ae8562081b645b6eb6f115a92ad786b96">TCP_C_READ</a>:</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3233019711645337eea743422eb2c732">TCP_E_READ</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5aec4bfeca3e832ec792bdc9a4c0870dc5">TCP_C_SETOPTION</a>:</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3e08974a4dc6d2b2457250733ad0dc08">TCP_E_SETOPTION</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Unknown message kind in app command&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="ad48d27c4c68b12165dc4c94aad7e2d9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad48d27c4c68b12165dc4c94aad7e2d9d">&#9670;&nbsp;</a></span>printConnBrief()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::printConnBrief </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: prints local/remote addr/port and app gate index/socketId. </p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Connection &quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  on socketId=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  in &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState())</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>.</p>

</div>
</div>
<a id="ae487487c5d3aee8af6dda153cfd62086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae487487c5d3aee8af6dda153cfd62086">&#9670;&nbsp;</a></span>printSegmentBrief()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::printSegmentBrief </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: prints important header fields. </p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    EV_STATICCONTEXT;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpHeader-&gt;getSrcPort() &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpHeader-&gt;getDestPort() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getSynBit())</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        EV_INFO &lt;&lt; (tcpHeader-&gt;getAckBit() ? <span class="stringliteral">&quot;SYN+ACK &quot;</span> : <span class="stringliteral">&quot;SYN &quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getFinBit())</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;FIN(+ACK) &quot;</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit())</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        EV_INFO &lt;&lt; (tcpHeader-&gt;getAckBit() ? <span class="stringliteral">&quot;RST+ACK &quot;</span> : <span class="stringliteral">&quot;RST &quot;</span>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getPshBit())</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;PSH &quot;</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">auto</span> payloadLength = tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (payloadLength &gt; 0 || tcpHeader-&gt;getSynBit()) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; tcpHeader-&gt;getSequenceNo() &lt;&lt; <span class="stringliteral">&quot;..&quot;</span> &lt;&lt; (tcpHeader-&gt;getSequenceNo() + payloadLength) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;(l=&quot;</span> &lt;&lt; payloadLength &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getAckBit())</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;ack &quot;</span> &lt;&lt; tcpHeader-&gt;getAckNo() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;win &quot;</span> &lt;&lt; tcpHeader-&gt;getWindow() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getUrgBit())</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;urg &quot;</span> &lt;&lt; tcpHeader-&gt;getUrgentPointer() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getHeaderLength() &gt; <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>) { <span class="comment">// Header options present?</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;options &quot;</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> i = 0; i &lt; tcpHeader-&gt;getHeaderOptionArraySize(); i++) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keyword">const</span> TcpOption *option = tcpHeader-&gt;getHeaderOption(i);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordtype">short</span> <a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a> = option-&gt;getKind();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            EV_INFO &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b3c48dbf55f9af32596348733448c5c">optionName</a>(<a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a76270b2436749dcdde9c22b4553f6082">segmentArrivalWhileClosed()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="a2b488f6cdc47ab4b57e2e5ee898b8b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b488f6cdc47ab4b57e2e5ee898b8b61">&#9670;&nbsp;</a></span>process_ABORT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_ABORT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">delete</span> tcpCommand;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// The ABORT event will automatically take the connection to the CLOSED</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// state, flush queues etc -- no need to do it here. Also, we don&#39;t need to</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// send notification to the user, they know what&#39;s going on.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Error processing command ABORT: connection not open&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>:</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>:</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="comment">// Send a reset segment:</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">//   &lt;SEQ=SND.NXT&gt;&lt;CTL=RST&gt;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a7a9d893e816312584dc9124d5443c7ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9d893e816312584dc9124d5443c7ff">&#9670;&nbsp;</a></span>process_ACCEPT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_ACCEPT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    TcpAcceptCommand *acceptCommand = check_and_cast&lt;TcpAcceptCommand *&gt;(tcpCommand);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">listeningSocketId</a> = -1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp</a>();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp</a>();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">delete</span> acceptCommand;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="ac9a8e7dbde1f4102cec960e9566af010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a8e7dbde1f4102cec960e9566af010">&#9670;&nbsp;</a></span>process_CLOSE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_CLOSE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">delete</span> tcpCommand;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>:</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">// Nothing to do here</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>:</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">// Delete the TCB and return &quot;error:  closing&quot; responses to any</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="comment">// queued SENDs, or RECEIVEs.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>:</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>:</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">// SYN_RCVD processing (ESTABLISHED and CLOSE_WAIT are similar):</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">// If no SENDs have been issued and there is no pending data to send,</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="comment">// then form a FIN segment and send it, and enter FIN-WAIT-1 state;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// otherwise queue for processing after entering ESTABLISHED state.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>()) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;No outstanding SENDs, sending FIN right away, advancing snd_nxt over the FIN\n&quot;</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a3cc5345bfd2869217e526a1b42a983d1">restartRexmitTimer</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = ++<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="comment">// state transition will automatically take us to FIN_WAIT_1 (or LAST_ACK)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SEND of &quot;</span> &lt;&lt; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>() - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; bytes pending, deferring sending of FIN\n&quot;</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>:</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>:</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">// RFC 793 is not entirely clear on how to handle a duplicate close request.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">// Here we treat it as an error.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Duplicate CLOSE command: connection already closing&quot;</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a6307696102916780d29b5d74ae12930e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6307696102916780d29b5d74ae12930e">&#9670;&nbsp;</a></span>process_DESTROY()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_DESTROY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">delete</span> tcpCommand;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// TODO should we send a RST or not?</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a68dc46455682e7d2ac229f09371342b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68dc46455682e7d2ac229f09371342b5">&#9670;&nbsp;</a></span>process_OPEN_ACTIVE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_OPEN_ACTIVE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    TcpOpenCommand *openCmd = check_and_cast&lt;TcpOpenCommand *&gt;(tcpCommand);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    L3Address <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection</a>(openCmd);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="comment">// store local/remote socket</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> = openCmd-&gt;getLocalAddr();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a> = openCmd-&gt;getRemoteAddr();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> = openCmd-&gt;getLocalPort();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a> = openCmd-&gt;getRemotePort();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>.<a class="code" href="classinet_1_1_l3_address.html#ad9066a0c0be577b31aacb7d72b058795">isUnspecified</a>() || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a> == -1)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: remote address and port must be specified&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> == -1) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aa80bf8e7fb79fd2553dbd0053d1939c9">getEphemeralPort</a>();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Assigned ephemeral port &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;OPEN: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">addSockPair</a>(<span class="keyword">this</span>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="comment">// send initial SYN</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer</a>();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            scheduleAfter(<a class="code" href="_tcp_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: connection already exists&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">delete</span> openCmd;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a975935f14abb62e23aa2dd2a279f4971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a975935f14abb62e23aa2dd2a279f4971">&#9670;&nbsp;</a></span>process_OPEN_PASSIVE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_OPEN_PASSIVE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    TcpOpenCommand *openCmd = check_and_cast&lt;TcpOpenCommand *&gt;(tcpCommand);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    L3Address <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection</a>(openCmd);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">// store local/remote socket</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad44e8e93bded1311284350f023961454">fork</a> = openCmd-&gt;getFork();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> = openCmd-&gt;getLocalAddr();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> = openCmd-&gt;getLocalPort();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> == -1)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command OPEN_PASSIVE: local port must be specified&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Starting to listen on: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">addSockPair</a>(<span class="keyword">this</span>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>, L3Address(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>, -1);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command OPEN_PASSIVE: connection already exists&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">delete</span> openCmd;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a85992dfca295a0ab3240f0ec1650ebd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85992dfca295a0ab3240f0ec1650ebd6">&#9670;&nbsp;</a></span>process_OPTIONS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_OPTIONS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    ASSERT(event == <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3e08974a4dc6d2b2457250733ad0dc08">TCP_E_SETOPTION</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> cmd = <span class="keyword">dynamic_cast&lt;</span>TcpSetTimeToLiveCommand *<span class="keyword">&gt;</span>(tcpCommand))</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">ttl</a> = cmd-&gt;getTtl();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> cmd = <span class="keyword">dynamic_cast&lt;</span>TcpSetTosCommand *<span class="keyword">&gt;</span>(tcpCommand)) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">tos</a> = cmd-&gt;getTos();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> cmd = <span class="keyword">dynamic_cast&lt;</span>TcpSetDscpCommand *<span class="keyword">&gt;</span>(tcpCommand)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">dscp</a> = cmd-&gt;getDscp();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unknown subclass of TcpSetOptionCommand received from app: %s&quot;</span>, tcpCommand-&gt;getClassName());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">delete</span> tcpCommand;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a1e62607e3fbab7f504b3f7dab879bf67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e62607e3fbab7f504b3f7dab879bf67">&#9670;&nbsp;</a></span>process_QUEUE_BYTES_LIMIT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_QUEUE_BYTES_LIMIT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Called process_QUEUE_BYTES_LIMIT on uninitialized TcpConnection!&quot;</span>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a> = tcpCommand-&gt;getUserId(); <span class="comment">// Set queue size limit</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    EV &lt;&lt; <span class="stringliteral">&quot;state-&gt;sendQueueLimit set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">delete</span> tcpCommand;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="ad4b4b186dcd43ec3845c26afb0d9a4b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b4b186dcd43ec3845c26afb0d9a4b7">&#9670;&nbsp;</a></span>process_RCV_SEGMENT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::process_RCV_SEGMENT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process incoming TCP segment. </p>
<p>Returns a specific event code (e.g. TCP_E_RCV_SYN) which will drive the state machine. </p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Seg arrived: &quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">printSegmentBrief</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;TCB: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aabd8ed80ff738d460b3fcf46ac569d32">str</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac3547269704c3b79daf67827bb5eefd8">rcvSeqSignal</a>, tcpHeader-&gt;getSequenceNo());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69f034cb5f674f2554d4d3b59477b7d8">rcvAckSignal</a>, tcpHeader-&gt;getAckNo());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2eacb280f6191279ce691f539f6828b">tcpRcvPayloadBytesSignal</a>, <span class="keywordtype">int</span>(tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get()));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Note: this code is organized exactly as RFC 793, section &quot;3.9 Event</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// Processing&quot;, subsection &quot;SEGMENT ARRIVES&quot;.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> event;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">event</span> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen</a>(tcpSegment, tcpHeader, src, dest);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">event</span> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent</a>(tcpSegment, tcpHeader, src, dest);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// RFC 793 steps &quot;first check sequence number&quot;, &quot;second check the RST bit&quot;, etc</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keyword">event</span> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">delete</span> tcpSegment;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> event;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>.</p>

</div>
</div>
<a id="a4ac9ad945591c08823ca4c196003a1ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ac9ad945591c08823ca4c196003a1ae">&#9670;&nbsp;</a></span>process_READ_REQUEST()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_READ_REQUEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad9f6b1407d6fb4da74a027d4f4c22aad">isToBeAccepted</a>())</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;READ without ACCEPT&quot;</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    Packet *dataMsg;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">while</span> ((dataMsg = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#afd6c47733a16ee555d6b384bd7712aed">extractBytesUpTo</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>)) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        dataMsg-&gt;setKind(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaffa1be7ba967dfed00f2a1ecc2630f47">TCP_I_DATA</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        dataMsg-&gt;addTag&lt;SocketInd&gt;()-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(dataMsg);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="ab7160020102c9f27f6c1e3b1698ee5ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7160020102c9f27f6c1e3b1698ee5ac">&#9670;&nbsp;</a></span>process_SEND()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_SEND </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// FIXME how to support PUSH? One option is to treat each SEND as a unit of data,</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// and set PSH at SEND boundaries</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    Packet *packet = check_and_cast&lt;Packet *&gt;(msg);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command SEND: connection not open&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SEND command turns passive open into active open, sending initial SYN\n&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer</a>();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            scheduleAfter(<a class="code" href="_tcp_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a1305155a666be8b71a2df455a353b140">enqueueAppData</a>(packet); <span class="comment">// queue up for later</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            EV_DETAIL &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes in queue\n&quot;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Queueing up data for sending later.\n&quot;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a1305155a666be8b71a2df455a353b140">enqueueAppData</a>(packet); <span class="comment">// queue up for later</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            EV_DETAIL &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes in queue\n&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>:</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>:</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a1305155a666be8b71a2df455a353b140">enqueueAppData</a>(packet);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            EV_DETAIL &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes in queue, plus &quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                      &lt;&lt; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes unacknowledged\n&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a337d6f4a64a013e7ad5fa24d60961c50">sendCommandInvoked</a>();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>:</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>:</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command SEND: connection closing&quot;</span>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a> &gt; 0) &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>) &gt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a>))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0c8a9f83b111d667670557cabc6d2ce">queueUpdate</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="a13569e009cba1a7f52fdb59c2b85066f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13569e009cba1a7f52fdb59c2b85066f">&#9670;&nbsp;</a></span>process_STATUS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_STATUS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_tcp_command.html">TcpCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">delete</span> tcpCommand; <span class="comment">// but reuse msg for reply</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Error processing command STATUS: connection not open&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    TcpStatusInfo *statusInfo = <span class="keyword">new</span> TcpStatusInfo();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    statusInfo-&gt;setState(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    statusInfo-&gt;setStateName(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    statusInfo-&gt;setLocalAddr(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    statusInfo-&gt;setRemoteAddr(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    statusInfo-&gt;setLocalPort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    statusInfo-&gt;setRemotePort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    statusInfo-&gt;setSnd_mss(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    statusInfo-&gt;setSnd_una(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    statusInfo-&gt;setSnd_nxt(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    statusInfo-&gt;setSnd_max(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    statusInfo-&gt;setSnd_wnd(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    statusInfo-&gt;setSnd_up(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aeac7b3b676b6f9c09ea2d62865faa1e4">snd_up</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    statusInfo-&gt;setSnd_wl1(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa6c008757fabc67fc69a0803084279e5">snd_wl1</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    statusInfo-&gt;setSnd_wl2(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a074ba48b33396e8d42c40d734cca4867">snd_wl2</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    statusInfo-&gt;setIss(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    statusInfo-&gt;setRcv_nxt(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    statusInfo-&gt;setRcv_wnd(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    statusInfo-&gt;setRcv_up(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0bf09e30d4d6dc10f5d58be0c76b787a">rcv_up</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    statusInfo-&gt;setIrs(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac399961a0e6c948ff8ff11cb239bf327">irs</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    statusInfo-&gt;setFin_ack_rcvd(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">fin_ack_rcvd</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    msg-&gt;setControlInfo(statusInfo);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    msg-&gt;setKind(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa20d878b48ef2d6c1bc032d90ba1ac753">TCP_I_STATUS</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(msg);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>.</p>

</div>
</div>
<a id="ad27c319b03d76159b21f347b1eaf9533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad27c319b03d76159b21f347b1eaf9533">&#9670;&nbsp;</a></span>process_TIMEOUT_2MSL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_TIMEOUT_2MSL </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;{</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">// If the time-wait timeout expires on a connection delete the TCB,</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">// enter the CLOSED state and return.</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            <span class="comment">// Nothing to do here. The TIMEOUT_2MSL event will automatically take</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="comment">// the connection to CLOSED. We already notified the user</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            <span class="comment">// (TCP_I_CLOSED) when we entered the TIME_WAIT state from CLOSING,</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="comment">// FIN_WAIT_1 or FIN_WAIT_2.</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="comment">// We should not receive this timeout in this state.</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>,</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="stringliteral">&quot;Internal error: received time-wait (2MSL) timeout in state %s&quot;</span>,</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()));</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    }</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>.</p>

</div>
</div>
<a id="a6f6714ac3137d36f95dc2deaf8ba1c16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6714ac3137d36f95dc2deaf8ba1c16">&#9670;&nbsp;</a></span>process_TIMEOUT_CONN_ESTAB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_TIMEOUT_CONN_ESTAB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;{</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>:</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="comment">// Nothing to do here. TIMEOUT_CONN_ESTAB event will automatically</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <span class="comment">// take the connection to LISTEN or CLOSED, and cancel SYN-REXMIT timer.</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a>) {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                <span class="comment">// notify user if we&#39;re on the active side</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaf19192f797b153d7fcd7b760c469090a">TCP_I_TIMED_OUT</a>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="comment">// We should not receive this timeout in this state.</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Internal error: received CONN_ESTAB timeout in state %s&quot;</span>,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()));</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>.</p>

</div>
</div>
<a id="a8aed4b95f11d1397db07461cd7c997ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aed4b95f11d1397db07461cd7c997ee">&#9670;&nbsp;</a></span>process_TIMEOUT_FIN_WAIT_2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_TIMEOUT_FIN_WAIT_2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;{</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="comment">// Nothing to do here. The TIMEOUT_FIN_WAIT_2 event will automatically take</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <span class="comment">// the connection to CLOSED.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="comment">// We should not receive this timeout in this state.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Internal error: received FIN_WAIT_2 timeout in state %s&quot;</span>,</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()));</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>.</p>

</div>
</div>
<a id="af0930df856c9fb347f5acb3182346e2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0930df856c9fb347f5acb3182346e2f">&#9670;&nbsp;</a></span>process_TIMEOUT_SYN_REXMIT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::process_TIMEOUT_SYN_REXMIT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;{</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">if</span> (++<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> &gt; <a class="code" href="_tcp_connection_8h.html#acd69c7cf1d3622b1d7aa706d7f9b97f9">MAX_SYN_REXMIT_COUNT</a>) {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Retransmission count during connection setup exceeds &quot;</span> &lt;&lt; <a class="code" href="_tcp_connection_8h.html#acd69c7cf1d3622b1d7aa706d7f9b97f9">MAX_SYN_REXMIT_COUNT</a> &lt;&lt; <span class="stringliteral">&quot;, giving up\n&quot;</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="comment">// Note ABORT will take the connection to closed, and cancel CONN-ESTAB timer as well</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Performing retransmission #&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">// resend what&#39;s needed</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>:</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn</a>();</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck</a>();</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Internal error: SYN-REXMIT timer expired while in state %s&quot;</span>,</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()));</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    }</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="comment">// reschedule timer</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">syn_rexmit_timeout</a> *= 2;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">syn_rexmit_timeout</a> &gt; <a class="code" href="_tcp_connection_8h.html#a0b48410b2bd35dbc6509568bfb1842aa">TCP_TIMEOUT_SYN_REXMIT_MAX</a>)</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">syn_rexmit_timeout</a> = <a class="code" href="_tcp_connection_8h.html#a0b48410b2bd35dbc6509568bfb1842aa">TCP_TIMEOUT_SYN_REXMIT_MAX</a>;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    scheduleAfter(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">syn_rexmit_timeout</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>.</p>

</div>
</div>
<a id="a1e61db9d8578ff50bec8d72fe818aa5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e61db9d8578ff50bec8d72fe818aa5f">&#9670;&nbsp;</a></span>processAckInEstabEtc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processAckInEstabEtc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;{</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Processing ACK in a data transfer state\n&quot;</span>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordtype">int</span> payloadLength = tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get();</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">// ECN</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    TcpStateVariables *<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a782499aa10f8b3086f02542da75b7057">getState</a>();</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a>) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getEceBit() == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Received packet with ECE\n&quot;</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afa58384bc31b9c48f48c1a653c1580a1">gotEce</a> = tcpHeader-&gt;getEceBit();</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT then, set SND.UNA &lt;- SEG.ACK.</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="comment">//  Any segments on the retransmission queue which are thereby</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="comment">//  entirely acknowledged are removed.  Users should receive</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">//  positive acknowledgments for buffers which have been SENT and</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">//  fully acknowledged (i.e., SEND buffer should be returned with</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">//  &quot;ok&quot; response).  If the ACK is a duplicate</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">//  (SEG.ACK &lt; SND.UNA), it can be ignored.  If the ACK acks</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">//  something not yet sent (SEG.ACK &gt; SND.NXT) then send an ACK,</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">//  drop the segment, and return.</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT, the send window should be</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">//  updated.  If (SND.WL1 &lt; SEG.SEQ or (SND.WL1 = SEG.SEQ and</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">//  SND.WL2 =&lt; SEG.ACK)), set SND.WND &lt;- SEG.WND, set</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">//  SND.WL1 &lt;- SEG.SEQ, and set SND.WL2 &lt;- SEG.ACK.</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">//  Note that SND.WND is an offset from SND.UNA, that SND.WL1</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">//  records the sequence number of the last segment used to update</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">//  SND.WND, and that SND.WL2 records the acknowledgment number of</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="comment">//  the last segment used to update SND.WND.  The check here</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">//  prevents using old segments to update the window.</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">// Note: should use SND.MAX instead of SND.NXT in above checks</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#a540240a4946cc48d695af1083f88a05b">seqGE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, tcpHeader-&gt;getAckNo())) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="comment">// duplicate ACK? A received TCP segment is a duplicate ACK if all of</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="comment">// the following apply:</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="comment">//    (1) snd_una == ackNo</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="comment">//    (2) segment contains no data</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="comment">//    (3) there&#39;s unacked data (snd_una != snd_max)</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="comment">// Note: ssfnet uses additional constraint &quot;window is the same as last</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="comment">// received (not an update)&quot; -- we don&#39;t do that because window updates</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="comment">// are ignored anyway if neither seqNo nor ackNo has changed.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> == tcpHeader-&gt;getAckNo() &amp;&amp; payloadLength == 0 &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a>++;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">dupAcksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="comment">// we need to update send window even if the ACK is a dupACK, because rcv win</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="comment">// could have been changed if faulty data receiver is not respecting the &quot;do not shrink window&quot; rule</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo</a>(tcpHeader);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae10b0c0c2dbc3e7ba77f5c6fcda74e0d">receivedDuplicateAck</a>();</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <span class="comment">// if doesn&#39;t qualify as duplicate ACK, just ignore it.</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="keywordflow">if</span> (payloadLength == 0) {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> != tcpHeader-&gt;getAckNo())</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Old ACK: ackNo &lt; snd_una\n&quot;</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK looks duplicate but we have currently no unacked data (snd_una == snd_max)\n&quot;</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <span class="comment">// reset counter</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a> = 0;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">dupAcksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a>);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(tcpHeader-&gt;getAckNo(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)) {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="comment">// ack in window.</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        uint32_t old_snd_una = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> = tcpHeader-&gt;getAckNo();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="comment">// after retransmitting a lost segment, we may get an ack well ahead of snd_nxt</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>))</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="comment">// RFC 1323, page 36:</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">// &quot;If SND.UNA &lt; SEG.ACK =&lt; SND.NXT then, set SND.UNA &lt;- SEG.ACK.</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">// Also compute a new estimate of round-trip time.  If Snd.TS.OK</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="comment">// bit is on, use my.TSclock - SEG.TSecr; otherwise use the</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="comment">// elapsed time since the first segment in the retransmission</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="comment">// queue was sent.  Any segments on the retransmission queue</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="comment">// which are thereby entirely acknowledged.&quot;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a>)</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad5411009fe0168685672cebf801292d1">rttMeasurementCompleteUsingTS</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7b7209422a6ff4647d622520ef2762e8">getTSecr</a>(tcpHeader));</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="comment">// Note: If TS is disabled the RTT measurement is completed in TcpBaseAlg::receivedDataAck()</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        uint32_t discardUpToSeq = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="comment">// our FIN acked?</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; tcpHeader-&gt;getAckNo() == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> + 1) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="comment">// set flag that our FIN has been acked</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK acks our FIN\n&quot;</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">fin_ack_rcvd</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            discardUpToSeq--; <span class="comment">// the FIN sequence number is not real data</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="comment">// acked data no longer needed in send queue</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#ac35645b9b8f25a9fd96a54ebcfebee9e">discardUpTo</a>(discardUpToSeq);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="comment">// acked data no longer needed in rexmit queue</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a87778790a2aabc3de1d81a08fb5e035e">discardUpTo</a>(discardUpToSeq);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo</a>(tcpHeader);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="comment">// if segment contains data, wait until data has been forwarded to app before sending ACK,</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">// otherwise we would use an old ACKNo</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">if</span> (payloadLength == 0 &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="comment">// notify</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a9d716ea52ca02eed748706f10b595b58">receivedDataAck</a>(old_snd_una);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            <span class="comment">// in the receivedDataAck we need the old value</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a> = 0;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">dupAcksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a>);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        ASSERT(<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(tcpHeader-&gt;getAckNo(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)); <span class="comment">// from if-ladder</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="comment">// send an ACK, drop the segment, and return.</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ac839f5fc37c9808122c5772036019a85">receivedAckForDataNotYetSent</a>(tcpHeader-&gt;getAckNo());</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a> = 0;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">dupAcksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a>);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// means &quot;drop&quot;</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a97136ad66744c500a7c4f41e12dc27dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97136ad66744c500a7c4f41e12dc27dd">&#9670;&nbsp;</a></span>processAppCommand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processAppCommand </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process commands from the application. </p>
<p>Normally returns true. A return value of false means that the connection structure must be deleted by the caller (TCP). </p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;processAppCommand&quot;</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    take(msg);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief</a>();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// first do actions</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    TcpCommand *tcpCommand = check_and_cast_nullable&lt;TcpCommand *&gt;(msg-&gt;removeControlInfo());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> <span class="keyword">event</span> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afcf0d25d019cbe6eed624fa9e6644fc8">preanalyseAppCommandEvent</a>(msg-&gt;getKind());</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;App command: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">eventName</a>(event) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df">TCP_E_OPEN_ACTIVE</a>:</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea950c5d5064f7f480184d70bcc8773434">TCP_E_OPEN_PASSIVE</a>:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea1202c3b28f3b6fb66b1a6f5ff301218b">TCP_E_ACCEPT</a>:</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7a9d893e816312584dc9124d5443c7ff">process_ACCEPT</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea42dc07647bd4d3409908de672c7fc3b3">TCP_E_SEND</a>:</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>:</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2b488f6cdc47ab4b57e2e5ee898b8b61">process_ABORT</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">TCP_E_DESTROY</a>:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a6307696102916780d29b5d74ae12930e">process_DESTROY</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea5dc26c747357fa3709d0c35e7e81a7e5">TCP_E_STATUS</a>:</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea821852d71e232c2c690d5f4e84f66cc7">TCP_E_QUEUE_BYTES_LIMIT</a>:</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e62607e3fbab7f504b3f7dab879bf67">process_QUEUE_BYTES_LIMIT</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3233019711645337eea743422eb2c732">TCP_E_READ</a>:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3e08974a4dc6d2b2457250733ad0dc08">TCP_E_SETOPTION</a>:</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a85992dfca295a0ab3240f0ec1650ebd6">process_OPTIONS</a>(event, tcpCommand, msg);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;wrong event code&quot;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// then state transitions</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition</a>(event);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a594b698f8aff3e1da0929e03a01161fd">inet::tcp::Tcp::handleUpperCommand()</a>.</p>

</div>
</div>
<a id="a95b7233ca8183973b60c88e1f955993c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95b7233ca8183973b60c88e1f955993c">&#9670;&nbsp;</a></span>processMSSOption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processMSSOption </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_max_segment_size.html">TcpOptionMaxSegmentSize</a> &amp;&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;{</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">if</span> (option.getLength() != 4) {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: MSS option length incorrect\n&quot;</span>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Tcp Header Option MSS received, but in unexpected state\n&quot;</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="comment">// RFC 2581, page 1:</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// &quot;The SMSS is the size of the largest segment that the sender can transmit.</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="comment">// This value can be based on the maximum transmission unit of the network,</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">// the path MTU discovery [MD90] algorithm, RMSS (see next item), or other</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="comment">// factors.  The size does not include the TCP/IP headers and options.&quot;</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">// &quot;The RMSS is the size of the largest segment the receiver is willing to accept.</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">// This is the value specified in the MSS option sent by the receiver during</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="comment">// connection startup.  Or, if the MSS option is not used, 536 bytes [Bra89].</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">// The size does not include the TCP/IP headers and options.&quot;</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// The value of snd_mss (SMSS) is set to the minimum of snd_mss (local parameter) and</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">// the value specified in the MSS option received during connection startup.</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>, (uint32_t)option.getMaxSegmentSize());</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> == 0)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> = 536;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option MSS(=&quot;</span> &lt;&lt; option.getMaxSegmentSize() &lt;&lt; <span class="stringliteral">&quot;) received, SMSS is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions()</a>.</p>

</div>
</div>
<a id="ae287c8e1cff764dfb16a88b6f979a9ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae287c8e1cff764dfb16a88b6f979a9ad">&#9670;&nbsp;</a></span>processRstInSynReceived()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::processRstInSynReceived </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Processing RST in SYN_RCVD\n&quot;</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">// If this connection was initiated with a passive OPEN (i.e.,</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// came from the LISTEN state), then return this connection to</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">// LISTEN state and return.  The user need not be informed.  If</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">// this connection was initiated with an active OPEN (i.e., came</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">// from SYN-SENT state) then the connection was refused, signal</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">// the user &quot;connection refused&quot;.  In either case, all segments</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// on the retransmission queue should be removed.  And in the</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">// active OPEN case, enter the CLOSED state and delete the TCB,</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">// and return.</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#ac35645b9b8f25a9fd96a54ebcfebee9e">discardUpTo</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>()); <span class="comment">// flush send queue</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a87778790a2aabc3de1d81a08fb5e035e">discardUpTo</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#acc159f655c5f3a4c0a42e6dc7f49bcda">getBufferEndSeq</a>()); <span class="comment">// flush rexmit queue</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">active</a>) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="comment">// signal &quot;connection refused&quot;</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabb53e95b49db823f33684deac8819842">TCP_I_CONNECTION_REFUSED</a>);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// on RCV_RST, FSM will go either to LISTEN or to CLOSED, depending on state-&gt;active</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">// FIXME if this was a forked connection, it should rather close than go back to listening (otherwise we&#39;d now have two listening connections with the original one!)</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a3df8bb6e00976c6ebdd69c2f5ece8fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3df8bb6e00976c6ebdd69c2f5ece8fe0">&#9670;&nbsp;</a></span>processSACKOption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processSACKOption </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_sack.html">TcpOptionSack</a> &amp;&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span> (option.getLength() % 8 != 2) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: option length incorrect\n&quot;</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> n = option.getSackItemArraySize();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    ASSERT(option.getLength() == 2 + n * 8);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; SACK(s) received, but sack_enabled is set to false\n&quot;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Tcp Header Option SACK received, but in unexpected state\n&quot;</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (n &gt; 0) { <span class="comment">// sacks present?</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        EV_INFO &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; SACK(s) received:\n&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            Sack tmp;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            tmp.setStart(option.getSackItem(i).getStart());</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            tmp.setEnd(option.getSackItem(i).getEnd());</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            EV_INFO &lt;&lt; (i + 1) &lt;&lt; <span class="stringliteral">&quot;. SACK: &quot;</span> &lt;&lt; tmp.str() &lt;&lt; endl;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="comment">// check for D-SACK</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">if</span> (i == 0 &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(tmp.getEnd(), tcpHeader-&gt;getAckNo())) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">// RFC 2883, page 8:</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                <span class="comment">// &quot;In order for the sender to check that the first (D)SACK block of an</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="comment">// acknowledgement in fact acknowledges duplicate data, the sender</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="comment">// should compare the sequence space in the first SACK block to the</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="comment">// cumulative ACK which is carried IN THE SAME PACKET.  If the SACK</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                <span class="comment">// sequence space is less than this cumulative ACK, it is an indication</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="comment">// that the segment identified by the SACK block has been received more</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                <span class="comment">// than once by the receiver.  An implementation MUST NOT compare the</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="comment">// sequence space in the SACK block to the TCP state variable snd.una</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                <span class="comment">// (which carries the total cumulative ACK), as this may result in the</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="comment">// wrong conclusion if ACK packets are reordered.&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Received D-SACK below cumulative ACK=&quot;</span> &lt;&lt; tcpHeader-&gt;getAckNo()</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; D-SACK: &quot;</span> &lt;&lt; tmp.str() &lt;&lt; endl;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="comment">// Note: RFC 2883 does not specify what should be done in this case.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="comment">// RFC 2883, page 9:</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="comment">// &quot;5. Detection of Duplicate Packets</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="comment">// (...) This document does not specify what action a TCP implementation should</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="comment">// take in these cases. The extension to the SACK option simply enables</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <span class="comment">// the sender to detect each of these cases.(...)&quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0 &amp;&amp; n &gt; 1 &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(tmp.getEnd(), tcpHeader-&gt;getAckNo())) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="comment">// RFC 2883, page 8:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="comment">// &quot;If the sequence space in the first SACK block is greater than the</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="comment">// cumulative ACK, then the sender next compares the sequence space in</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                <span class="comment">// the first SACK block with the sequence space in the second SACK</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="comment">// block, if there is one.  This comparison can determine if the first</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="comment">// SACK block is reporting duplicate data that lies above the cumulative</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="comment">// ACK.&quot;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                Sack tmp2(option.getSackItem(1).getStart(), option.getSackItem(1).getEnd());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">if</span> (tmp2.contains(tmp)) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Received D-SACK above cumulative ACK=&quot;</span> &lt;&lt; tcpHeader-&gt;getAckNo()</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; D-SACK: &quot;</span> &lt;&lt; tmp.str()</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;, SACK: &quot;</span> &lt;&lt; tmp2.str() &lt;&lt; endl;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="comment">// Note: RFC 2883 does not specify what should be done in this case.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="comment">// RFC 2883, page 9:</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <span class="comment">// &quot;5. Detection of Duplicate Packets</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    <span class="comment">// (...) This document does not specify what action a TCP implementation should</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <span class="comment">// take in these cases. The extension to the SACK option simply enables</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    <span class="comment">// the sender to detect each of these cases.(...)&quot;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(tmp.getEnd(), tcpHeader-&gt;getAckNo()) &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(tmp.getEnd(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>))</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#aa8d33ebb463f4c8cfcc824c7c8c3aeee">setSackedBit</a>(tmp.getStart(), tmp.getEnd());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Received SACK below total cumulative ACK snd_una=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaf61d50c3b88381e42a2fa7fd56980b5">rcv_sacks</a> += n; <span class="comment">// total counter, no current number</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a6dcf210a8d13372804d8011739117f97">rcvSacksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaf61d50c3b88381e42a2fa7fd56980b5">rcv_sacks</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// update scoreboard</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a44607c3de01875763befe761a03423ab">sackedBytes_old</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a82acc05161ee0832163008c99475e207">sackedBytes</a>; <span class="comment">// needed for RFC 3042 to check if last dupAck contained new sack information</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a82acc05161ee0832163008c99475e207">sackedBytes</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a34f905e10b376fe2081a06f34fea5ce7">getTotalAmountOfSackedBytes</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a18c00a2d63feb44e9c7d5ae6bf0a2af6">sackedBytesSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a82acc05161ee0832163008c99475e207">sackedBytes</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions()</a>.</p>

</div>
</div>
<a id="a98ad81d8ce1e5dbfd40bd83a34b6d340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98ad81d8ce1e5dbfd40bd83a34b6d340">&#9670;&nbsp;</a></span>processSACKPermittedOption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processSACKPermittedOption </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_sack_permitted.html">TcpOptionSackPermitted</a> &amp;&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;{</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (option.getLength() != 2) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: length incorrect\n&quot;</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>) {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Tcp Header Option SACK_PERMITTED received, but in unexpected state\n&quot;</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae454ba565e4349a82d13897367a32348">rcv_sack_perm</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">sack_support</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad386dec080ca76d4230a18e38802b536">snd_sack_perm</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae454ba565e4349a82d13897367a32348">rcv_sack_perm</a>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option SACK_PERMITTED received, SACK (sack_enabled) is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions()</a>.</p>

</div>
</div>
<a id="a89fb3bba962a1f9b37c4139066fd5851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89fb3bba962a1f9b37c4139066fd5851">&#9670;&nbsp;</a></span>processSegment1stThru8th()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::processSegment1stThru8th </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// Delegates additional processing of ECN to the algorithm</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae860eafb2dc4a15a272ed31807b09043">processEcnInEstablished</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// RFC 793: first check sequence number</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">bool</span> acceptable = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getHeaderLength() &gt; <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>) { <span class="comment">// Header options present? TCP_HEADER_OCTETS = 20</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// PAWS</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a>) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            uint32_t tsval = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97f166dcdb24cb42e0824417b3a089f4">getTSval</a>(tcpHeader);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span> (tsval != 0 &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(tsval, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">ts_recent</a>) &amp;&amp;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                (simTime() - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69d3afa3ef2405fe39bf5d83a0279483">time_last_data_sent</a>) &gt; <a class="code" href="_tcp_connection_8h.html#a6d5e1b9a987d5263ed7885c1e13a5dbf">PAWS_IDLE_TIME_THRESH</a>) <span class="comment">// PAWS_IDLE_TIME_THRESH = 24 days</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;PAWS: Segment is not acceptable, TSval=&quot;</span> &lt;&lt; tsval &lt;&lt; <span class="stringliteral">&quot; in &quot;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                          &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; state received: dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                acceptable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions</a>(tcpHeader);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (acceptable)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        acceptable = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a776e9ca5b96407bb3aa8f29e65087901">isSegmentAcceptable</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> payloadLength = tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!acceptable) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">// If an incoming segment is not acceptable, an acknowledgment</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// should be sent in reply (unless the RST bit is set, if so drop</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// the segment and return):</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">//  &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit()) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RST with unacceptable seqNum: dropping\n&quot;</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (tcpHeader-&gt;getSynBit()) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SYN with unacceptable seqNum in &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; state received (SYN duplicat?)\n&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (payloadLength &gt; 0 &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>((tcpHeader-&gt;getSequenceNo() + payloadLength), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>)) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a> = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a> = tcpHeader-&gt;getSequenceNo() + payloadLength;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SND_D-SACK SET (dupseg rcvd)\n&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Segment seqNum not acceptable, sending ACK with current receive seq\n&quot;</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">// &quot;The receiver SHOULD send an ACK for every valid segment that arrives</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">// containing new data, and each of these &quot;duplicate&quot; ACKs SHOULD bear a</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">// SACK option.&quot;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// The received segment is not &quot;valid&quot; therefore the ACK will not bear a SACK option, if snd_dsack (D-SACK) is not set.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8890d4306e6be47ba796a26fbaa3129d">rcv_naseg</a>++;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0bc96352a49004dc0f7125028939c117">rcvNASegSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8890d4306e6be47ba796a26fbaa3129d">rcv_naseg</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// ECN</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getCwrBit() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Received CWR... Leaving ecnEcho State\n&quot;</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae7f45fa8f832ceedf2d135d66544ecfd">ecnEchoState</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// RFC 793: second check the RST bit,</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit()) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">// Note: if we come from LISTEN, processSegmentInListen() has already handled RST.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="comment">// If this connection was initiated with a passive OPEN (i.e.,</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="comment">// came from the LISTEN state), then return this connection to</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">// LISTEN state and return.  The user need not be informed.  If</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="comment">// this connection was initiated with an active OPEN (i.e., came</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="comment">// from SYN-SENT state) then the connection was refused, signal</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="comment">// the user &quot;connection refused&quot;.  In either case, all segments</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="comment">// on the retransmission queue should be removed.  And in the</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="comment">// active OPEN case, enter the CLOSED state and delete the TCB,</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="comment">// and return.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">processRstInSynReceived</a>(tcpHeader);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>:</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>:</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">// If the RST bit is set then, any outstanding RECEIVEs and SEND</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="comment">// should receive &quot;reset&quot; responses.  All segment queues should be</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="comment">// flushed.  Users should also receive an unsolicited general</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="comment">// &quot;connection reset&quot; signal.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="comment">// Enter the CLOSED state, delete the TCB, and return.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RST: performing connection reset, closing connection\n&quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa109dd2103410ba2e7573649fed2300cd">TCP_I_CONNECTION_RESET</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>; <span class="comment">// this will trigger state transition</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>:</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="comment">// enter the CLOSED state, delete the TCB, and return.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RST: closing connection\n&quot;</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>; <span class="comment">// this will trigger state transition</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                ASSERT(0);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// RFC 793: third check security and precedence</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// This step is ignored.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// RFC 793: fourth, check the SYN bit,</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getSynBit()</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            &amp;&amp; !(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a> &amp;&amp; tcpHeader-&gt;getAckBit())) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// If the SYN is in the window it is an error, send a reset, any</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">// outstanding RECEIVEs and SEND should receive &quot;reset&quot; responses,</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// all segment queues should be flushed, the user should also</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">// receive an unsolicited general &quot;connection reset&quot; signal, enter</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">// the CLOSED state, delete the TCB, and return.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// If the SYN is not in the window this step would not be reached</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// and an ack would have been sent in the first step (sequence</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// number check).</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// Zoltan Bojthe: but accept SYN+ACK in SYN_RCVD state for simultaneous open</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a776e9ca5b96407bb3aa8f29e65087901">isSegmentAcceptable</a>(tcpSegment, tcpHeader)); <span class="comment">// assert SYN is in the window</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SYN is in the window: performing connection reset, closing connection\n&quot;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa109dd2103410ba2e7573649fed2300cd">TCP_I_CONNECTION_RESET</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">TCP_E_RCV_UNEXP_SYN</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// RFC 793: fifth check the ACK field,</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (!tcpHeader-&gt;getAckBit()) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// if the ACK bit is off drop the segment and return</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;ACK not set, dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    uint32_t old_snd_una = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// If SND.UNA =&lt; SEG.ACK =&lt; SND.NXT then enter ESTABLISHED state</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">// and continue processing.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// If the segment acknowledgment is not acceptable, form a</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// reset segment,</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">//  &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// and send it.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, tcpHeader-&gt;getAckNo()) || !<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(tcpHeader-&gt;getAckNo(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>)) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a>(tcpHeader-&gt;getAckNo());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">// notify tcpAlgorithm and app layer</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#aa64ef9fd85c8ff6dd25d746dbf831e1c">established</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad9f6b1407d6fb4da74a027d4f4c22aad">isToBeAccepted</a>())</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp</a>();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp</a>();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// This will trigger transition to ESTABLISHED. Timers and notifying</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// app will be taken care of in stateEntered().</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    uint32_t old_snd_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>; <span class="comment">// later we&#39;ll need to see if snd_nxt changed</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Note: If one of the last data segments is lost while already in LAST-ACK state (e.g. if using TCPEchoApps)</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// TCP must be able to process acceptable acknowledgments, however please note RFC 793, page 73:</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// &quot;LAST-ACK STATE</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">//    The only thing that can arrive in this state is an</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">//    acknowledgment of our FIN.  If our FIN is now acknowledged,</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">//    delete the TCB, enter the CLOSED state, and return.&quot;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a> ||</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a> ||</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a> ||</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">// ESTABLISHED processing:</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT then, set SND.UNA &lt;- SEG.ACK.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">//  Any segments on the retransmission queue which are thereby</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">//  entirely acknowledged are removed.  Users should receive</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">//  positive acknowledgments for buffers which have been SENT and</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">//  fully acknowledged (i.e., SEND buffer should be returned with</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">//  &quot;ok&quot; response).  If the ACK is a duplicate</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">//  (SEG.ACK &lt; SND.UNA), it can be ignored.  If the ACK acks</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">//  something not yet sent (SEG.ACK &gt; SND.NXT) then send an ACK,</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">//  drop the segment, and return.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT, the send window should be</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">//  updated.  If (SND.WL1 &lt; SEG.SEQ or (SND.WL1 = SEG.SEQ and</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">//  SND.WL2 =&lt; SEG.ACK)), set SND.WND &lt;- SEG.WND, set</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">//  SND.WL1 &lt;- SEG.SEQ, and set SND.WL2 &lt;- SEG.ACK.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">//  Note that SND.WND is an offset from SND.UNA, that SND.WL1</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">//  records the sequence number of the last segment used to update</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">//  SND.WND, and that SND.WL2 records the acknowledgment number of</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">//  the last segment used to update SND.WND.  The check here</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">//  prevents using old segments to update the window.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordtype">bool</span> ok = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>; <span class="comment">// if acks something not yet sent, drop it</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">fin_ack_rcvd</a>)) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="comment">// FIN-WAIT-1 STATE</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">//   In addition to the processing for the ESTABLISHED state, if</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">//   our FIN is now acknowledged then enter FIN-WAIT-2 and continue</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">//   processing in that state.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>; <span class="comment">// will trigger transition to FIN-WAIT-2</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">// FIN-WAIT-2 STATE</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">//  In addition to the processing for the ESTABLISHED state, if</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">//  the retransmission queue is empty, the user&#39;s CLOSE can be</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">//  acknowledged (&quot;ok&quot;) but do not delete the TCB.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">// nothing to do here (in our model, used commands don&#39;t need to be</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">// acknowledged)</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// In addition to the processing for the ESTABLISHED state, if</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// the ACK acknowledges our FIN then enter the TIME-WAIT state,</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// otherwise ignore the segment.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">fin_ack_rcvd</a>) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Our FIN acked -- can go to TIME_WAIT now\n&quot;</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>; <span class="comment">// will trigger transition to TIME-WAIT</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            scheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>); <span class="comment">// start timer</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">// The only thing that can arrive in this state is an</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// acknowledgment of our FIN.  If our FIN is now acknowledged,</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">// delete the TCB, enter the CLOSED state, and return.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; tcpHeader-&gt;getAckNo() == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> + 1) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Last ACK arrived\n&quot;</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">TCP_E_RCV_ACK</a>; <span class="comment">// will trigger transition to CLOSED</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="comment">// The only thing that can arrive in this state is a</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="comment">// retransmission of the remote FIN.  Acknowledge it, and restart</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// the 2 MSL timeout.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// And we are staying in the TIME_WAIT state.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck</a>();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        rescheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// RFC 793: sixth, check the URG bit,</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getUrgBit() &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a> ||</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                   <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>))</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">// If the URG bit is set, RCV.UP &lt;- max(RCV.UP,SEG.UP), and signal</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">// the user that the remote side has urgent data if the urgent</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">// pointer (RCV.UP) is in advance of the data consumed.  If the</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">// user has already been signaled (or is still in the &quot;urgent</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// mode&quot;) for this continuous sequence of urgent data, do not</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// signal the user again.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// TODO URG currently not supported</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// RFC 793: seventh, process the segment text,</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    uint32_t old_rcv_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>; <span class="comment">// if rcv_nxt changes, we need to send/schedule an ACK</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a> ||</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">// Once in the ESTABLISHED state, it is possible to deliver segment</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">// text to user RECEIVE buffers.  Text from segments can be moved</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// into buffers until either the buffer is full or the segment is</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">// empty.  If the segment empties and carries an PUSH flag, then</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// the user is informed, when the buffer is returned, that a PUSH</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">// has been received.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">// When the TCP takes responsibility for delivering the data to the</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">// user it must also acknowledge the receipt of the data.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// Once the TCP takes responsibility for the data it advances</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// RCV.NXT over the data accepted, and adjusts RCV.WND as</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="comment">// appropriate to the current buffer availability.  The total of</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">// RCV.NXT and RCV.WND should not be reduced.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">// Please note the window management suggestions in section 3.7.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">// Send an acknowledgment of the form:</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="comment">//   &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">// This acknowledgment should be piggybacked on a segment being</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">// transmitted if possible without incurring undue delay.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (payloadLength &gt; 0) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment">// check for full sized segment</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">if</span> ((uint32_t)payloadLength == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> || (uint32_t)payloadLength + <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength() - <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>).get() == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a89550bcce84f2e8fea39fd7fccfbcf45">full_sized_segment_counter</a>++;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="comment">// check for persist probe</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (payloadLength == 1)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">ack_now</a> = <span class="keyword">true</span>; <span class="comment">// TODO how to check if it is really a persist probe?</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars</a>();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue</a>(tcpSegment, tcpHeader)) { <span class="comment">// enough freeRcvBuffer in rcvQueue for new segment?</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Processing segment text in a data transfer state\n&quot;</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <span class="comment">// insert into receive buffers. If this segment is contiguous with</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="comment">// previously received ones (seqNo == rcv_nxt), rcv_nxt can be increased;</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                <span class="comment">// otherwise it stays the same but the data must be cached nevertheless</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                <span class="comment">// (to avoid &quot;Failure to retain above-sequence data&quot; problem, RFC 2525</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="comment">// section 2.5).</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                uint32_t old_usedRcvBuffer = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1ee55dc20af304777e821e2aad73395b">usedRcvBuffer</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#aa09a3ec420400bcdbdac60ed35f47c6d">insertBytesFromSegment</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, old_snd_una)) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="comment">// notify</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a9d716ea52ca02eed748706f10b595b58">receivedDataAck</a>(old_snd_una);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    <span class="comment">// in the receivedDataAck we need the old value</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a> = 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">dupAcksSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">dupacks</a>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <span class="comment">// out-of-order segment?</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">if</span> (old_rcv_nxt == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8992721ec5ccbd1765cc631428a8cb73">rcv_oooseg</a>++;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aec3b4ea0c2712f557e5a68165b8b082e">rcvOooSegSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8992721ec5ccbd1765cc631428a8cb73">rcv_oooseg</a>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    <span class="comment">// &quot;The receiver SHOULD send an ACK for every valid segment that arrives</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    <span class="comment">// containing new data, and each of these &quot;duplicate&quot; ACKs SHOULD bear a</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    <span class="comment">// SACK option.&quot;</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        <span class="comment">// store start and end sequence numbers of current oooseg in state variables</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a> = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a> = tcpHeader-&gt;getSequenceNo() + payloadLength;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <span class="keywordflow">if</span> (old_usedRcvBuffer == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a33616fbda89adf0349d57da426cafba0">getAmountOfBufferedBytes</a>()) { <span class="comment">// D-SACK</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SND_D-SACK SET (old_rcv_nxt == rcv_nxt duplicated oooseg rcvd)\n&quot;</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        <span class="keywordflow">else</span> { <span class="comment">// SACK</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SND_SACK SET (old_rcv_nxt == rcv_nxt oooseg rcvd)\n&quot;</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a37961d5bbfbf8fb75b90f08787bfc6be">receivedOutOfOrderSegment</a>();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    <span class="comment">// forward data to app</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    <span class="comment">// FIXME observe PSH bit</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    <span class="comment">// FIXME we should implement socket READ command, and pass up only</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    <span class="comment">// as many bytes as requested. rcv_wnd should be decreased</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    <span class="comment">// accordingly!</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad9f6b1407d6fb4da74a027d4f4c22aad">isToBeAccepted</a>())</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp</a>();</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="comment">// if this segment &quot;filled the gap&quot; until the previously arrived segment</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <span class="comment">// that carried a FIN (i.e.rcv_nxt == rcv_fin_seq), we have to advance</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    <span class="comment">// rcv_nxt over the FIN.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fc91f734148ec0bb0647299ebceec75">fin_rcvd</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7494b90535c253ba63d16dd6d0d124bb">rcv_fin_seq</a>) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">ack_now</a> = <span class="keyword">true</span>; <span class="comment">// although not mentioned in [Stevens, W.R.: TCP/IP Illustrated, Volume 2, page 861] seems like we have to set ack_now</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;All segments arrived up to the FIN segment, advancing rcv_nxt over the FIN\n&quot;</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7494b90535c253ba63d16dd6d0d124bb">rcv_fin_seq</a> + 1;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        <span class="comment">// state transitions will be done in the state machine, here we just set</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        <span class="comment">// the proper event code (TCP_E_RCV_FIN or TCP_E_RCV_FIN_ACK)</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                        <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">fin_ack_rcvd</a>) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                    <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea0385b3f6612c766df9a009506249109f">TCP_E_RCV_FIN_ACK</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                    <span class="comment">// start the time-wait timer, turn off the other timers</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                    cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                    scheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                    <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                    <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                <span class="comment">// Start the time-wait timer, turn off the other timers.</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                scheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                <span class="comment">// Restart the 2 MSL time-wait timeout.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                rescheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">else</span> { <span class="comment">// not enough freeRcvBuffer in rcvQueue for new segment</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>++; <span class="comment">// update current number of tcp receive queue drops</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a542b0e99a7d17e907190003038443894">tcpRcvQueueDropsSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <span class="comment">// if the ACK bit is off drop the segment and return</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                EV_WARN &lt;&lt; <span class="stringliteral">&quot;RcvQueueBuffer has run out, dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// RFC 793: eighth, check the FIN bit,</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getFinBit()) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">ack_now</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">// If the FIN bit is set, signal the user &quot;connection closing&quot; and</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">// return any pending RECEIVEs with same message, advance RCV.NXT</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// over the FIN, and send an acknowledgment for the FIN.  Note that</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">// FIN implies PUSH for any segment text not yet delivered to the</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">// user.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">// Note: seems like RFC 793 is not entirely correct here: if the</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// segment is &quot;above sequence&quot; (ie. RCV.NXT &lt; SEG.SEQ), we cannot</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// advance RCV.NXT over the FIN. Instead we remember this sequence</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">// number and do it later.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        uint32_t fin_seq = (uint32_t)tcpHeader-&gt;getSequenceNo() + (uint32_t)payloadLength;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> == fin_seq) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="comment">// advance rcv_nxt over FIN now</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;FIN arrived, advancing rcv_nxt over the FIN\n&quot;</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>++;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="comment">// state transitions will be done in the state machine, here we just set</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="comment">// the proper event code (TCP_E_RCV_FIN or TCP_E_RCV_FIN_ACK)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">TCP_E_RCV_FIN</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">fin_ack_rcvd</a>) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea0385b3f6612c766df9a009506249109f">TCP_E_RCV_FIN_ACK</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        <span class="comment">// start the time-wait timer, turn off the other timers</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        scheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="comment">// Start the time-wait timer, turn off the other timers.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    scheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    <span class="comment">// Restart the 2 MSL time-wait timeout.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    rescheduleAfter(2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">getMsl</a>(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">// we&#39;ll have to do it later (when an arriving segment &quot;fills the gap&quot;)</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;FIN segment above sequence, storing sequence number of FIN\n&quot;</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fc91f734148ec0bb0647299ebceec75">fin_rcvd</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7494b90535c253ba63d16dd6d0d124bb">rcv_fin_seq</a> = fin_seq;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">// TODO do PUSH stuff</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (old_rcv_nxt != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment">// if rcv_nxt changed, either because we received segment text or we</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="comment">// received a FIN that needs to be acked (or both), we need to send or</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">// schedule an ACK.</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a7df4b2a3c971c305dd6ab3f954401077">getQueueLength</a>() != 0) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="comment">// &quot;If sent at all, SACK options SHOULD be included in all ACKs which do</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="comment">// not ACK the highest sequence number in the data receiver&#39;s queue.&quot;</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">start_seqno</a> = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">end_seqno</a> = tcpHeader-&gt;getSequenceNo() + payloadLength;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SND_SACK SET (rcv_nxt changed, but receiveQ is not empty)\n&quot;</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">ack_now</a> = <span class="keyword">true</span>; <span class="comment">// although not mentioned in [Stevens, W.R.: TCP/IP Illustrated, Volume 2, page 861] seems like we have to set ack_now</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">// tcpAlgorithm decides when and how to do ACKs</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#aba883a97661105f6f6d6d77e15758fe9">receiveSeqChanged</a>();</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>) &amp;&amp;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> + 1)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="comment">// if the user issued the CLOSE command a long time ago and we&#39;ve just</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">// managed to send off FIN, we simulate a CLOSE command now (we had to</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="comment">// defer it at that time because we still had data in the send queue.)</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">// This CLOSE will take us into the FIN_WAIT_1 state.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Now we can do the CLOSE which was deferred a while ago\n&quot;</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> + 1 &amp;&amp; old_snd_nxt != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">// if we&#39;re in CLOSE_WAIT and we just got to sent our long-pending FIN,</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">// we simulate a CLOSE command now (we had to defer it at that time because</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="comment">// we still had data in the send queue.) This CLOSE will take us into the</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">// LAST_ACK state.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Now we can do the CLOSE which was deferred a while ago\n&quot;</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">TCP_E_CLOSE</a>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">return</span> event;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>.</p>

</div>
</div>
<a id="a8582acc0ba4d4850f124b4d7aef643c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8582acc0ba4d4850f124b4d7aef643c1">&#9670;&nbsp;</a></span>processSegmentInListen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::processSegmentInListen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Processing segment in LISTEN\n&quot;</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// first check for an RST</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">//   An incoming RST should be ignored.  Return.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit()) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;RST bit set: dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// second check for an ACK</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">//    Any acknowledgment is bad if it arrives on a connection still in</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">//    the LISTEN state.  An acceptable reset segment should be formed</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">//    for any arriving ACK-bearing segment.  The RST should be</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">//    formatted as follows:</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">//      &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">//    Return.</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getAckBit()) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;ACK bit set: dropping segment and sending RST\n&quot;</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a>(tcpHeader-&gt;getAckNo(), destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// third check for a SYN</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getSynBit()) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getFinBit()) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="comment">// Looks like implementations vary on how to react to SYN+FIN.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="comment">// Some treat it as plain SYN (and reply with SYN+ACK), some send RST+ACK.</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="comment">// Let&#39;s just do the former here.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;SYN+FIN received: ignoring FIN\n&quot;</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SYN bit set: filling in foreign socket and sending SYN+ACK\n&quot;</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">// If the listen was not fully specified (i.e., the foreign socket was not</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">// fully specified), then the unspecified fields should be filled in now.</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">// Also, we may need to fork, in order to leave another connection</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">// LISTENing on the port. Note: forking will change our socketId.</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad44e8e93bded1311284350f023961454">fork</a>) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afd54e2ff988fa1dc58b8f25bd082ab86">TcpConnection</a> *conn = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa44320887baf414d8265c95fa11bba60">cloneListeningConnection</a>(); <span class="comment">// &quot;conn&quot; is the clone which will handle the new connection, while &quot;this&quot; stay LISTENing</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aed295470331cb4e1267b2e67ab7f2610">addForkedConnection</a>(<span class="keyword">this</span>, conn, destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Connection forked: new connection got new socketId=&quot;</span> &lt;&lt; conn-&gt;socketId &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                                                                                    <span class="stringliteral">&quot;old connection keeps LISTENing with socketId=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> forkEvent = conn-&gt;processSynInListen(tcpSegment, tcpHeader, srcAddr, destAddr);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            conn-&gt;performStateTransition(forkEvent);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">updateSockPair</a>(<span class="keyword">this</span>, destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen</a>(tcpSegment, tcpHeader, srcAddr, destAddr);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">//  fourth other text or control</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">//   So you are unlikely to get here, but if you do, drop the segment, and return.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    EV_WARN &lt;&lt; <span class="stringliteral">&quot;Unexpected segment: dropping it\n&quot;</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>.</p>

</div>
</div>
<a id="a729b16908c898a0ccf73af5c736f1ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a729b16908c898a0ccf73af5c736f1ee2">&#9670;&nbsp;</a></span>processSegmentInSynSent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::processSegmentInSynSent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;{</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Processing segment in SYN_SENT\n&quot;</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// first check the ACK bit</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">//   If the ACK bit is set</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">//     If SEG.ACK =&lt; ISS, or SEG.ACK &gt; SND.NXT, send a reset (unless</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">//     the RST bit is set, if so drop the segment and return)</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">//       &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">//     and discard the segment.  Return.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">//     If SND.UNA =&lt; SEG.ACK =&lt; SND.NXT then the ACK is acceptable.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getAckBit()) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(tcpHeader-&gt;getAckNo(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>) || <a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(tcpHeader-&gt;getAckNo(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>)) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit())</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK+RST bit set but wrong AckNo, ignored\n&quot;</span>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK bit set but wrong AckNo, sending RST\n&quot;</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a>(tcpHeader-&gt;getAckNo(), destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK bit set, AckNo acceptable\n&quot;</span>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// second check the RST bit</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">//   If the RST bit is set</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">//     If the ACK was acceptable then signal the user &quot;error:</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">//     connection reset&quot;, drop the segment, enter CLOSED state,</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">//     delete TCB, and return.  Otherwise (no ACK) drop the segment</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">//     and return.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit()) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getAckBit()) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RST+ACK: performing connection reset\n&quot;</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa109dd2103410ba2e7573649fed2300cd">TCP_I_CONNECTION_RESET</a>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">TCP_E_RCV_RST</a>;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RST without ACK: dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// third check the security and precedence -- not done</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// fourth check the SYN bit</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">//   This step should be reached only if the ACK is ok, or there is</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">//   no ACK, and it the segment did not contain a RST.</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">//   If the SYN bit is on and the security/compartment and precedence</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//   are acceptable then,</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getSynBit()) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="comment">//   RCV.NXT is set to SEG.SEQ+1, IRS is set to</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="comment">//   SEG.SEQ.  SND.UNA should be advanced to equal SEG.ACK (if there</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="comment">//   is an ACK), and any segments on the retransmission queue which</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">//   are thereby acknowledged should be removed.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> = tcpHeader-&gt;getSequenceNo() + 1;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad78cd9a6e338d5c03499b44727b6829e">rcvAdvSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac399961a0e6c948ff8ff11cb239bf327">irs</a> = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a083fe77c8a6d65b9616180b5bb8b4b9c">init</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getAckBit()) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> = tcpHeader-&gt;getAckNo();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#ac35645b9b8f25a9fd96a54ebcfebee9e">discardUpTo</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a87778790a2aabc3de1d81a08fb5e035e">discardUpTo</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="comment">// although not mentioned in RFC 793, seems like we have to pick up</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="comment">// initial snd_wnd from the segment here.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo</a>(tcpHeader, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="comment">// this also seems to be a good time to learn our local IP address</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// (was probably unspecified at connection open)</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">updateSockPair</a>(<span class="keyword">this</span>, destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">//   If SND.UNA &gt; ISS (our SYN has been ACKed), change the connection</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">//   state to ESTABLISHED, form an ACK segment</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="comment">//     &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="comment">//   and send it.  Data or controls which were queued for</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="comment">//   transmission may be included.  If there are other controls or</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="comment">//   text in the segment then continue processing at the sixth step</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="comment">//   below where the URG bit is checked, otherwise return.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>)) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;SYN+ACK bits set, connection established.\n&quot;</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="comment">// RFC says &quot;continue processing at the sixth step below where</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">// the URG bit is checked&quot;. Those steps deal with: URG, segment text</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">// (and PSH), and FIN.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="comment">// Now: URG and PSH we don&#39;t support yet; in SYN+FIN we ignore FIN;</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="comment">// with segment text we just take it easy and put it in the receiveQueue</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="comment">// -- we&#39;ll forward it to the user when more data arrives.</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keywordflow">if</span> (tcpHeader-&gt;getFinBit())</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SYN+ACK+FIN received: ignoring FIN\n&quot;</span>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpSegment-&gt;getByteLength()) &gt; tcpHeader-&gt;getHeaderLength()) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars</a>();</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue</a>(tcpSegment, tcpHeader)) { <span class="comment">// enough freeRcvBuffer in rcvQueue for new segment?</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#aa09a3ec420400bcdbdac60ed35f47c6d">insertBytesFromSegment</a>(tcpSegment, tcpHeader); <span class="comment">// TODO forward to app, etc.</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                <span class="keywordflow">else</span> { <span class="comment">// not enough freeRcvBuffer in rcvQueue for new segment</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>++; <span class="comment">// update current number of tcp receive queue drops</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a542b0e99a7d17e907190003038443894">tcpRcvQueueDropsSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    EV_WARN &lt;&lt; <span class="stringliteral">&quot;RcvQueueBuffer has run out, dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keywordflow">if</span> (tcpHeader-&gt;getUrgBit() || tcpHeader-&gt;getPshBit())</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Ignoring URG and PSH bits in SYN+ACK\n&quot;</span>; <span class="comment">// TODO</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordflow">if</span> (tcpHeader-&gt;getHeaderLength() &gt; <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>) <span class="comment">// Header options present?</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions</a>(tcpHeader);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="comment">// notify tcpAlgorithm (it has to send ACK of SYN) and app layer</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">ack_now</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#aa64ef9fd85c8ff6dd25d746dbf831e1c">established</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;emit(<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a52f00f65b425f38e977c2478394e0610">Tcp::tcpConnectionAddedSignal</a>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp</a>();</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="comment">// ECN</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a179c4ccdd41290e4afce22dc728c8282">ecnSynSent</a>) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                <span class="keywordflow">if</span> (tcpHeader-&gt;getEceBit() &amp;&amp; !tcpHeader-&gt;getCwrBit()) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    EV &lt;&lt; <span class="stringliteral">&quot;ECN-setup SYN-ACK packet was received... ECN is enabled.\n&quot;</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    EV &lt;&lt; <span class="stringliteral">&quot;non-ECN-setup SYN-ACK packet was received... ECN is disabled.\n&quot;</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a179c4ccdd41290e4afce22dc728c8282">ecnSynSent</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="keywordflow">if</span> (tcpHeader-&gt;getEceBit() &amp;&amp; !tcpHeader-&gt;getCwrBit())</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    EV &lt;&lt; <span class="stringliteral">&quot;ECN-setup SYN-ACK packet was received... ECN is disabled.\n&quot;</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="comment">// This will trigger transition to ESTABLISHED. Timers and notifying</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="comment">// app will be taken care of in stateEntered().</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea010cd4a0a82a1dbc9beb246081ecc88b">TCP_E_RCV_SYN_ACK</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">//   Otherwise enter SYN-RECEIVED, form a SYN,ACK segment</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="comment">//     &lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="comment">//   and send it.  If there are other controls or text in the</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">//   segment, queue them for processing after the ESTABLISHED state</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">//   has been reached, return.</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;SYN bit set: sending SYN+ACK\n&quot;</span>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck</a>();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer</a>();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// Note: code below is similar to processing SYN in LISTEN.</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="comment">// For consistency with that code, we ignore SYN+FIN here</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getFinBit())</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;SYN+FIN received: ignoring FIN\n&quot;</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">// We don&#39;t send text in SYN or SYN+ACK, but accept it. Otherwise</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">// there isn&#39;t much left to do: RST, SYN, ACK, FIN got processed already,</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="comment">// so there&#39;s only URG and PSH left to handle.</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpSegment-&gt;getByteLength()) &gt; tcpHeader-&gt;getHeaderLength()) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars</a>();</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue</a>(tcpSegment, tcpHeader)) { <span class="comment">// enough freeRcvBuffer in rcvQueue for new segment?</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#aa09a3ec420400bcdbdac60ed35f47c6d">insertBytesFromSegment</a>(tcpSegment, tcpHeader); <span class="comment">// TODO forward to app, etc.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">else</span> { <span class="comment">// not enough freeRcvBuffer in rcvQueue for new segment</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>++; <span class="comment">// update current number of tcp receive queue drops</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a542b0e99a7d17e907190003038443894">tcpRcvQueueDropsSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                EV_WARN &lt;&lt; <span class="stringliteral">&quot;RcvQueueBuffer has run out, dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">if</span> (tcpHeader-&gt;getUrgBit() || tcpHeader-&gt;getPshBit())</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Ignoring URG and PSH bits in SYN\n&quot;</span>; <span class="comment">// TODO</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa">TCP_E_RCV_SYN</a>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// fifth, if neither of the SYN or RST bits is set then drop the</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">// segment and return.</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>.</p>

</div>
</div>
<a id="a5de94d23a73961fbca3b3530b296732d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5de94d23a73961fbca3b3530b296732d">&#9670;&nbsp;</a></span>processSynInListen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> inet::tcp::TcpConnection::processSynInListen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;{</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">//  Set RCV.NXT to SEG.SEQ+1, IRS is set to SEG.SEQ and any other</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">//  control or text should be queued for processing later.  ISS</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">//  should be selected and a SYN segment sent of the form:</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">//    &lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">//  SND.NXT is set to ISS+1 and SND.UNA to ISS.  The connection</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//  state should be changed to SYN-RECEIVED.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> = tcpHeader-&gt;getSequenceNo() + 1;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad78cd9a6e338d5c03499b44727b6829e">rcvAdvSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac399961a0e6c948ff8ff11cb239bf327">irs</a> = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a083fe77c8a6d65b9616180b5bb8b4b9c">init</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>); <span class="comment">// FIXME may init twice...</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum</a>();</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// although not mentioned in RFC 793, seems like we have to pick up</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// initial snd_wnd from the segment here.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo</a>(tcpHeader, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getHeaderLength() &gt; <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>) <span class="comment">// Header options present?</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions</a>(tcpHeader);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">ack_now</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// ECN</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getEceBit() == <span class="keyword">true</span> &amp;&amp; tcpHeader-&gt;getCwrBit() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a63f81359bde6fbd0cca323cfa056ff79">endPointIsWillingECN</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        EV &lt;&lt; <span class="stringliteral">&quot;ECN-setup SYN packet received\n&quot;</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck</a>();</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer</a>();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>-&gt;isScheduled())</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        scheduleAfter(<a class="code" href="_tcp_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Note that any other incoming control or data (combined with SYN)</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// will be processed in the SYN-RECEIVED state, but processing of SYN</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// and ACK should not be repeated.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">// We don&#39;t send text in SYN or SYN+ACK, but accept it. Otherwise</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// there isn&#39;t much left to do: RST, SYN, ACK, FIN got processed already,</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// so there&#39;s only URG and PSH left to handle.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpSegment-&gt;getByteLength()) &gt; tcpHeader-&gt;getHeaderLength()) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars</a>();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue</a>(tcpSegment, tcpHeader)) { <span class="comment">// enough freeRcvBuffer in rcvQueue for new segment?</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#aa09a3ec420400bcdbdac60ed35f47c6d">insertBytesFromSegment</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">else</span> { <span class="comment">// not enough freeRcvBuffer in rcvQueue for new segment</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>++; <span class="comment">// update current number of tcp receive queue drops</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a542b0e99a7d17e907190003038443894">tcpRcvQueueDropsSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">tcpRcvQueueDrops</a>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot;RcvQueueBuffer has run out, dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getUrgBit() || tcpHeader-&gt;getPshBit())</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Ignoring URG and PSH bits in SYN\n&quot;</span>; <span class="comment">// TODO</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa">TCP_E_RCV_SYN</a>; <span class="comment">// this will take us to SYN_RCVD</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>.</p>

</div>
</div>
<a id="a62437fe059a142794609ed08cde88375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62437fe059a142794609ed08cde88375">&#9670;&nbsp;</a></span>processTCPSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processTCPSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process incoming TCP segment. </p>
<p>Normally returns true. A return value of false means that the connection structure must be deleted by the caller (TCP). </p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;processTCPSegment&quot;</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    take(tcpSegment);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief</a>();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>.<a class="code" href="classinet_1_1_l3_address.html#ad9066a0c0be577b31aacb7d72b058795">isUnspecified</a>()) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a> == segDestAddr);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> == tcpHeader-&gt;getDestPort());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>.<a class="code" href="classinet_1_1_l3_address.html#ad9066a0c0be577b31aacb7d72b058795">isUnspecified</a>()) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a> == segSrcAddr);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a> == tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae57488043d7b7533872cac4a73ba5907">tryFastRoute</a>(tcpHeader))</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// first do actions</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> <span class="keyword">event</span> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT</a>(tcpSegment, tcpHeader, segSrcAddr, segDestAddr);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// then state transitions</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition</a>(event);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aa1b4e2eb1244c0d807c3fe7bd4a67f8d">inet::tcp::Tcp::handleLowerPacket()</a>.</p>

</div>
</div>
<a id="aa41b2cd9b54a275b28246d319ba690d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41b2cd9b54a275b28246d319ba690d7">&#9670;&nbsp;</a></span>processTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processTimer </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process self-messages (timers). </p>
<p>Normally returns true. A return value of false means that the connection structure must be deleted by the caller (TCP). </p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief</a>();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    EV_DETAIL &lt;&lt; msg-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; timer expired\n&quot;</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// first do actions</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a> event;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (msg == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaf25e3fe001290d9dc3270102bd1bdcbe">TCP_E_TIMEOUT_2MSL</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad27c319b03d76159b21f347b1eaf9533">process_TIMEOUT_2MSL</a>();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea659bff1e5d75352885b205513466ccd1">TCP_E_TIMEOUT_CONN_ESTAB</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB</a>();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaa75de9fd09d1def0d3e0b6ac18f022b6">TCP_E_TIMEOUT_FIN_WAIT_2</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a8aed4b95f11d1397db07461cd7c997ee">process_TIMEOUT_FIN_WAIT_2</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT</a>(event);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keyword">event</span> = <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">TCP_E_IGNORE</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a5594138f315ab12573fac280ec05ed4e">processTimer</a>(msg, event);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// then state transitions</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition</a>(event);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a664c9361c7066546477350ca08f1d07d">handleMessage()</a>.</p>

</div>
</div>
<a id="a34be7e48b4ab7e1c189665d61b1e9e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34be7e48b4ab7e1c189665d61b1e9e47">&#9670;&nbsp;</a></span>processTSOption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processTSOption </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_timestamp.html">TcpOptionTimestamp</a> &amp;&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;{</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span> (option.getLength() != 10) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: length incorrect\n&quot;</span>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> ((!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>) ||</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a> &amp;&amp;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;         <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>))</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Tcp Header Option TS received, but in unexpected state\n&quot;</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a>) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a54573456795943feec64ebac35be9122">rcv_initial_ts</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a701a3e619d81a47b28c8de4914adb917">ts_support</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab964376b0e8842da819d5d93e9de6583">snd_initial_ts</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a54573456795943feec64ebac35be9122">rcv_initial_ts</a>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option TS(TSval=&quot;</span> &lt;&lt; option.getSenderTimestamp() &lt;&lt; <span class="stringliteral">&quot;, TSecr=&quot;</span> &lt;&lt; option.getEchoedTimestamp() &lt;&lt; <span class="stringliteral">&quot;) received, TS (ts_enabled) is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option TS(TSval=&quot;</span> &lt;&lt; option.getSenderTimestamp() &lt;&lt; <span class="stringliteral">&quot;, TSecr=&quot;</span> &lt;&lt; option.getEchoedTimestamp() &lt;&lt; <span class="stringliteral">&quot;) received\n&quot;</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// RFC 1323, page 35:</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">// &quot;Check whether the segment contains a Timestamps option and bit</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">// Snd.TS.OK is on.  If so:</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="comment">//   If SEG.TSval &lt; TS.Recent, then test whether connection has</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="comment">//   been idle less than 24 days; if both are true, then the</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">//   segment is not acceptable; follow steps below for an</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">//   unacceptable segment.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">//   If SEG.SEQ is equal to Last.ACK.sent, then save SEG.[TSval] in</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">//   variable TS.Recent.&quot;</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a>) {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(option.getSenderTimestamp(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">ts_recent</a>)) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="keywordflow">if</span> ((simTime() - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69d3afa3ef2405fe39bf5d83a0279483">time_last_data_sent</a>) &gt; <a class="code" href="_tcp_connection_8h.html#a6d5e1b9a987d5263ed7885c1e13a5dbf">PAWS_IDLE_TIME_THRESH</a>) { <span class="comment">// PAWS_IDLE_TIME_THRESH = 24 days</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;PAWS: Segment is not acceptable, TSval=&quot;</span> &lt;&lt; option.getSenderTimestamp() &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; state received: dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(tcpHeader-&gt;getSequenceNo(), <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1719493572e3440d52107199f0578459">last_ack_sent</a>)) { <span class="comment">// Note: test is modified according to the latest proposal of the tcplw@cray.com list (Braden 1993/04/26)</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">ts_recent</a> = option.getSenderTimestamp();</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Updating ts_recent from segment: new ts_recent=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">ts_recent</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions()</a>.</p>

</div>
</div>
<a id="a93c7bc93c84a410a40ceefee26e61196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c7bc93c84a410a40ceefee26e61196">&#9670;&nbsp;</a></span>processWSOption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::processWSOption </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1tcp_1_1_tcp_option_window_scale.html">TcpOptionWindowScale</a> &amp;&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;{</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (option.getLength() != 3) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: length incorrect\n&quot;</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>) {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Tcp Header Option WS received, but in unexpected state\n&quot;</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5f06b20358ab5338c8af2490541dc724">rcv_ws</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">ws_support</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#abeff78d75750335417e9e82a0e14fab9">snd_ws</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5f06b20358ab5338c8af2490541dc724">rcv_ws</a>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8bfd8f820c13ba78df3883241171d369">snd_wnd_scale</a> = option.getWindowScale();</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option WS(=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8bfd8f820c13ba78df3883241171d369">snd_wnd_scale</a> &lt;&lt; <span class="stringliteral">&quot;) received, WS (ws_enabled) is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8bfd8f820c13ba78df3883241171d369">snd_wnd_scale</a> &gt; 14) { <span class="comment">// RFC 1323, page 11: &quot;the shift count must be limited to 14&quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Tcp Header Option WS received but shift count value is exceeding 14\n&quot;</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8bfd8f820c13ba78df3883241171d369">snd_wnd_scale</a> = 14;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">readHeaderOptions()</a>.</p>

</div>
</div>
<a id="a4b550d07dd3ddf8fcd0294dbfe9ffb55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b550d07dd3ddf8fcd0294dbfe9ffb55">&#9670;&nbsp;</a></span>readHeaderOptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::readHeaderOptions </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: readHeaderOptions (Currently only EOL, NOP, MSS, WS, SACK_PERMITTED, SACK and TS are implemented) </p>
<div class="fragment"><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option(s) received:\n&quot;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> i = 0; i &lt; tcpHeader-&gt;getHeaderOptionArraySize(); i++) {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keyword">const</span> TcpOption *option = tcpHeader-&gt;getHeaderOption(i);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordtype">short</span> <a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a> = option-&gt;getKind();</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keywordtype">short</span> length = option-&gt;getLength();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Option type &quot;</span> &lt;&lt; <a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b3c48dbf55f9af32596348733448c5c">optionName</a>(<a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a>) &lt;&lt; <span class="stringliteral">&quot;), length &quot;</span> &lt;&lt; length &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a>) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abf3fa7fa8f31cc254c9c538a51fe5fce">TCPOPTION_END_OF_OPTION_LIST</a>: <span class="comment">// EOL=0</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a6f75ef3f275801e12e682432472c26a9">TCPOPTION_NO_OPERATION</a>: <span class="comment">// NOP=1</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                <span class="keywordflow">if</span> (length != 1) {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: option length incorrect\n&quot;</span>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    ok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a6c6bdf29d7a49ae3a372fd2f710d9b0b">TCPOPTION_MAXIMUM_SEGMENT_SIZE</a>: <span class="comment">// MSS=2</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                ok = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a95b7233ca8183973b60c88e1f955993c">processMSSOption</a>(tcpHeader, *check_and_cast&lt;const TcpOptionMaxSegmentSize *&gt;(option));</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772adf1e6f8a6d89003f19bac73e8b81efc8">TCPOPTION_WINDOW_SCALE</a>: <span class="comment">// WS=3</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                ok = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c7bc93c84a410a40ceefee26e61196">processWSOption</a>(tcpHeader, *check_and_cast&lt;const TcpOptionWindowScale *&gt;(option));</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a42b781bd85bb27a4d914450d01f27e60">TCPOPTION_SACK_PERMITTED</a>: <span class="comment">// SACK_PERMITTED=4</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                ok = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a98ad81d8ce1e5dbfd40bd83a34b6d340">processSACKPermittedOption</a>(tcpHeader, *check_and_cast&lt;const TcpOptionSackPermitted *&gt;(option));</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a8a6653346b4cb563cba15af48e1ff40a">TCPOPTION_SACK</a>: <span class="comment">// SACK=5</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                ok = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption</a>(tcpHeader, *check_and_cast&lt;const TcpOptionSack *&gt;(option));</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abbfd2f02bffabb60b21194a40ef75e4b">TCPOPTION_TIMESTAMP</a>: <span class="comment">// TS=8</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                ok = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a34be7e48b4ab7e1c189665d61b1e9e47">processTSOption</a>(tcpHeader, *check_and_cast&lt;const TcpOptionTimestamp *&gt;(option));</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="comment">// TODO add new TCPOptions here once they are implemented</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <span class="comment">// TODO delegate to TcpAlgorithm as well -- it may want to recognized additional options</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Unsupported Tcp option kind &quot;</span> &lt;&lt; <a class="code" href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        (void)ok; <span class="comment">// unused</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="a69d92cf8b5ea339a828b34b33fc102a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d92cf8b5ea339a828b34b33fc102a3">&#9670;&nbsp;</a></span>retransmitData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::retransmitData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: retransmit all from snd_una to snd_max. </p>
<div class="fragment"><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;{</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">// rfc-3168, page 20:</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// ECN-capable TCP implementations MUST NOT set either ECT codepoint</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">// (ECT(0) or ECT(1)) in the IP header for retransmitted data packets</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a>)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab8a10a273ecf8245f1dd9fdf6d32bec6">rexmit</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// retransmit everything from snd_una</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    uint32_t bytesToSend = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// FIN (without user data) needs to be resent</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">if</span> (bytesToSend == 0 &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>()) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>();</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;No outstanding DATA, resending FIN, advancing snd_nxt over the FIN\n&quot;</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin</a>();</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = ++<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    ASSERT(bytesToSend != 0);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">// TODO - avoid to send more than allowed - check cwnd and rwnd before retransmitting data!</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">while</span> (bytesToSend &gt; 0) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        uint32_t bytes = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(bytesToSend, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        bytes = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(bytes, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>));</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        uint32_t sentBytes = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(bytes);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="comment">// Do not send packets after the FIN.</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="comment">// fixes bug that occurs in examples/inet/bulktransfer at event #64043  T=13.861159213744</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> + 1)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        ASSERT(bytesToSend &gt;= sentBytes);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        bytesToSend -= sentBytes;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad965cbba967109e9cae36a41ec46e2cc">segmentRetransmitted</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a>)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab8a10a273ecf8245f1dd9fdf6d32bec6">rexmit</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#ae24ba59481726ae1a1f8095e8827a933">inet::tcp::DumbTcp::processTimer()</a>.</p>

</div>
</div>
<a id="a93c2dec9ae82329e76fa37c0bf6ea730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c2dec9ae82329e76fa37c0bf6ea730">&#9670;&nbsp;</a></span>retransmitOneSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::retransmitOneSegment </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>called_at_rto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: retransmit one segment from snd_una. </p>
<div class="fragment"><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;{</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// rfc-3168, page 20:</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// ECN-capable TCP implementations MUST NOT set either ECT codepoint</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// (ECT(0) or ECT(1)) in the IP header for retransmitted data packets</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a>)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab8a10a273ecf8245f1dd9fdf6d32bec6">rexmit</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    uint32_t old_snd_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// retransmit one segment at snd_una, and set snd_nxt accordingly (if not called at RTO)</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// When FIN sent the snd_max - snd_nxt larger than bytes available in queue</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    uint32_t bytes = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(<a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>),</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>));</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// FIN (without user data) needs to be resent</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (bytes == 0 &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>()) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">getBufferEndSeq</a>();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;No outstanding DATA, resending FIN, advancing snd_nxt over the FIN\n&quot;</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin</a>();</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad965cbba967109e9cae36a41ec46e2cc">segmentRetransmitted</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> + 1);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = ++<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        ASSERT(bytes != 0);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(bytes);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad965cbba967109e9cae36a41ec46e2cc">segmentRetransmitted</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">if</span> (!called_at_rto) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(old_snd_nxt, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>))</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = old_snd_nxt;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// notify</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="comment">// RFC 3517, page 7: &quot;(3) Retransmit the first data segment presumed dropped -- the segment</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="comment">// starting with sequence number HighACK + 1.  To prevent repeated</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="comment">// retransmission of the same data, set HighRxt to the highest</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="comment">// sequence number in the retransmitted segment.&quot;</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">getHighestRexmittedSeqNum</a>();</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a>)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab8a10a273ecf8245f1dd9fdf6d32bec6">rexmit</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_no_congestion_control.html#a6ca3ac5e608890ee7db49ce43ecc7151">inet::tcp::TcpNoCongestionControl::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_new_reno.html#a916479f2e29e5c82e445be8df80ca8e5">inet::tcp::TcpNewReno::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_reno.html#ab39ea09946a36c19863df21de5ae4d90">inet::tcp::TcpReno::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_tahoe.html#ab1a3634d3dd4dab57033b66f6f30c274">inet::tcp::TcpTahoe::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_westwood.html#a0fbe32b26f2b9025461957c03f88d531">inet::tcp::TcpWestwood::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_vegas.html#ad50709a4b6a09d6c0ba55cdfe56abe2e">inet::tcp::TcpVegas::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_new_reno.html#acba41bec364e407e4ef19573a68ecf91">inet::tcp::TcpNewReno::receivedDataAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_vegas.html#acba422a674c37292b9bfa0e6d97e82c1">inet::tcp::TcpVegas::receivedDataAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_new_reno.html#a038b3c89b3aaeba16d5d94f9ece9b0d7">inet::tcp::TcpNewReno::receivedDuplicateAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_reno.html#a10c49fdf579139304be902761a0baff4">inet::tcp::TcpReno::receivedDuplicateAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_tahoe.html#a6649c5bca8f060d2f672e413385998eb">inet::tcp::TcpTahoe::receivedDuplicateAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_westwood.html#ac622658e1b52c4f0e3656e5123061c2f">inet::tcp::TcpWestwood::receivedDuplicateAck()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_vegas.html#a833292b3780019267a62f7102ff2dbd6">inet::tcp::TcpVegas::receivedDuplicateAck()</a>.</p>

</div>
</div>
<a id="a76270b2436749dcdde9c22b4553f6082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76270b2436749dcdde9c22b4553f6082">&#9670;&nbsp;</a></span>segmentArrivalWhileClosed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::segmentArrivalWhileClosed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method gets invoked from TCP when a segment arrives which doesn't belong to an existing connection. </p>
<p>TCP creates a temporary connection object so that it can call this method, then immediately deletes it. </p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Seg arrived: &quot;</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">printSegmentBrief</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// This segment doesn&#39;t belong to any connection, so this object</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// must be a temp object created solely for the purpose of calling us</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> == <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Segment doesn&#39;t belong to any existing connection\n&quot;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// RFC 793:</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// all data in the incoming segment is discarded.  An incoming</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// segment containing a RST is discarded.  An incoming segment not</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// containing a RST causes a RST to be sent in response.  The</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// acknowledgment and sequence field values are selected to make the</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// reset sequence acceptable to the TCP that sent the offending</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// segment.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// If the ACK bit is off, sequence number zero is used,</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">//    &lt;SEQ=0&gt;&lt;ACK=SEG.SEQ+SEG.LEN&gt;&lt;CTL=RST,ACK&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// If the ACK bit is on,</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//    &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// ...</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//    SEG.LEN = the number of octets occupied by the data in the segment</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">//              (counting SYN and FIN)</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getRstBit()) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RST bit set: dropping segment\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (!tcpHeader-&gt;getAckBit()) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK bit not set: sending RST+ACK\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        uint32_t ackNo = tcpHeader-&gt;getSequenceNo() + tcpSegment-&gt;getByteLength() - <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()).get() + tcpHeader-&gt;getSynFinLen();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">sendRstAck</a>(0, ackNo, destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;ACK bit set: sending RST\n&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a>(tcpHeader-&gt;getAckNo(), destAddr, srcAddr, tcpHeader-&gt;getDestPort(), tcpHeader-&gt;getSrcPort());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a741bf838feb4b009c6e0da096815b21d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741bf838feb4b009c6e0da096815b21d">&#9670;&nbsp;</a></span>selectInitialSeqNum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::selectInitialSeqNum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: generates ISS and initializes corresponding state variables. </p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// set the initial send sequence number</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a> = (<span class="keywordtype">unsigned</span> long)fmod(SIMTIME_DBL(simTime()) * 250000.0, 1.0 + (double)(<span class="keywordtype">unsigned</span>)0xffffffffUL) &amp; 0xffffffffUL;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a16c5a6f366d0ada79820b386eca8faad">init</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a> + 1); <span class="comment">// + 1 is for SYN</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#ae2373d8dfefb03ae8f314b87ed79a81a">init</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a> + 1); <span class="comment">// + 1 is for SYN</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="ac16044dfebbb178c5941ab62380b8601"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac16044dfebbb178c5941ab62380b8601">&#9670;&nbsp;</a></span>sendAck()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendAck </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send ACK. </p>
<div class="fragment"><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;{</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    tcpHeader-&gt;setAckBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    tcpHeader-&gt;setSequenceNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    tcpHeader-&gt;setAckNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    tcpHeader-&gt;setWindow(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd</a>());</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// rfc-3168, pages 19-20:</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">// When TCP receives a CE data packet at the destination end-system, the</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// TCP data receiver sets the ECN-Echo flag in the TCP header of the</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// subsequent ACK packet.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// ...</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">// After a TCP receiver sends an ACK packet with the ECN-Echo bit set,</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// that TCP receiver continues to set the ECN-Echo flag in all the ACK</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// packets it sends (whether they acknowledge CE data packets or non-CE</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// data packets) until it receives a CWR packet (a packet with the CWR</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// flag set).  After the receipt of the CWR packet, acknowledgments for</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// subsequent non-CE data packets do not have the ECN-Echo flag set.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    TcpStateVariables *<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a782499aa10f8b3086f02542da75b7057">getState</a>();</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a>) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a0b544cc8ab57b7d381371b0d1cc671f4">shouldMarkAck</a>()) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            tcpHeader-&gt;setEceBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;In ecnEcho state... send ACK with ECE bit set\n&quot;</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// write header options</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions</a>(tcpHeader);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    Packet *fp = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;TcpAck&quot;</span>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// rfc-3168 page 20: pure ack packets must be sent with not-ECT codepoint</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a271132eb5c66ef013822b45a27985f58">sndAck</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(fp, tcpHeader);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a271132eb5c66ef013822b45a27985f58">sndAck</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// notify</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_no_congestion_control.html#a1781d6406347ba4ccba72a9ce254c374">inet::tcp::TcpNoCongestionControl::established()</a>, <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#a5912db08ae7e25154e8692c5e3740c40">inet::tcp::DumbTcp::established()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#ae5930c4a285c2002be1e21a3c48279db">inet::tcp::TcpBaseAlg::established()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a3b7478d0b5d0667781842f6db2d4f1d3">inet::tcp::TcpBaseAlg::processDelayedAckTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#a1adcafe3c78ea8c2e0de84f5825c5e61">inet::tcp::DumbTcp::receivedAckForDataNotYetSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a43171b0fb2785d56b9023c7762fd7876">inet::tcp::TcpBaseAlg::receivedAckForDataNotYetSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#a48040438393883c3ac3269545705f371">inet::tcp::DumbTcp::receivedOutOfOrderSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#aefb3433bab6210cf6b443e692ff3d280">inet::tcp::TcpBaseAlg::receivedOutOfOrderSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#ae342639398c2f496a68b7cba5af3b3b6">inet::tcp::DumbTcp::receiveSeqChanged()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a17261f406f13d6e0c77f9a2f42bd42de">inet::tcp::TcpBaseAlg::receiveSeqChanged()</a>.</p>

</div>
</div>
<a id="adb71143849cc54f0d0dabdc196dc7213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb71143849cc54f0d0dabdc196dc7213">&#9670;&nbsp;</a></span>sendAvailableDataToApp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendAvailableDataToApp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends data or data notification to application. </p>
<div class="fragment"><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;{</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a33616fbda89adf0349d57da426cafba0">getAmountOfBufferedBytes</a>()) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#a5d8c17132e7da6f6f02e3c187e397a77">useDataNotification</a>) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keyword">auto</span> indication = <span class="keyword">new</span> Indication(<span class="stringliteral">&quot;Data Notification&quot;</span>, <a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa96c866226144944ee5f16f087af3a4a1">TCP_I_DATA_NOTIFICATION</a>); <span class="comment">// TODO currently we never send TCP_I_URGENT_DATA</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            TcpCommand *cmd = <span class="keyword">new</span> TcpCommand();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            indication-&gt;addTag&lt;SocketInd&gt;()-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            indication-&gt;setControlInfo(cmd);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(indication);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">while</span> (<span class="keyword">auto</span> msg = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#afd6c47733a16ee555d6b384bd7712aed">extractBytesUpTo</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>)) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                msg-&gt;setKind(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaffa1be7ba967dfed00f2a1ecc2630f47">TCP_I_DATA</a>); <span class="comment">// TODO currently we never send TCP_I_URGENT_DATA</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                msg-&gt;addTag&lt;SocketInd&gt;()-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(msg);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7a9d893e816312584dc9124d5443c7ff">process_ACCEPT()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a6d6c500012de26b9f25cd1d339a77d50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6c500012de26b9f25cd1d339a77d50">&#9670;&nbsp;</a></span>sendAvailableIndicationToApp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendAvailableIndicationToApp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends TCP_I_AVAILABLE indication with <a class="el" href="classinet_1_1_tcp_available_info.html" title="Class generated from inet/transportlayer/contract/tcp/TcpCommand.msg:161 by opp_msgtool.">TcpAvailableInfo</a> to application. </p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Notifying app: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa1958c2474a2126a9951293ed0f76dbfc">TCP_I_AVAILABLE</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">auto</span> indication = <span class="keyword">new</span> Indication(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa1958c2474a2126a9951293ed0f76dbfc">TCP_I_AVAILABLE</a>), <a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa1958c2474a2126a9951293ed0f76dbfc">TCP_I_AVAILABLE</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    TcpAvailableInfo *ind = <span class="keyword">new</span> TcpAvailableInfo();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    ind-&gt;setNewSocketId(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    ind-&gt;setLocalAddr(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    ind-&gt;setRemoteAddr(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    ind-&gt;setLocalPort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    ind-&gt;setRemotePort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    indication-&gt;addTag&lt;SocketInd&gt;()-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">listeningSocketId</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    indication-&gt;setControlInfo(ind);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(indication);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a2d63bfdd2c222e3898a922e1cd35c117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d63bfdd2c222e3898a922e1cd35c117">&#9670;&nbsp;</a></span>sendData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::sendData </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>congestionWindow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: Send data from sendQueue, at most congestionWindow. </p>
<div class="fragment"><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;{</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// we&#39;ll start sending from snd_max, if not after RTO</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a>)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    uint32_t old_highRxt = 0;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        old_highRxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">getHighestRexmittedSeqNum</a>();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// check how many bytes we have</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    uint32_t buffered = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">if</span> (buffered == 0)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// maxWindow is minimum of snd_wnd and congestionWindow (snd_cwnd)</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    uint32_t maxWindow = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a>, congestionWindow);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">// effectiveWindow: number of bytes we&#39;re allowed to send now</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    int64_t effectiveWin = (int64_t)maxWindow - (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span> (effectiveWin &lt;= 0) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Effective window is zero (advertised window &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, congestion window &quot;</span> &lt;&lt; congestionWindow &lt;&lt; <span class="stringliteral">&quot;), cannot send.\n&quot;</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    uint32_t bytesToSend = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(buffered, (uint32_t)effectiveWin);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// make a temporary tcp header for detecting tcp options length (copied from &#39;TcpConnection::sendSegment(uint32_t bytes)&#39; )</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tmpTcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    tmpTcpHeader-&gt;setAckBit(<span class="keyword">true</span>); <span class="comment">// needed for TS option, otherwise TSecr will be set to 0</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions</a>(tmpTcpHeader);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> options_len = <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tmpTcpHeader-&gt;getHeaderLength() - <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>).get();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    ASSERT(options_len &lt; state-&gt;snd_mss);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    uint32_t effectiveMss = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> - options_len;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    uint32_t old_snd_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// start sending &#39;bytesToSend&#39; bytes</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;May send &quot;</span> &lt;&lt; bytesToSend &lt;&lt; <span class="stringliteral">&quot; bytes (effectiveWindow &quot;</span> &lt;&lt; effectiveWin &lt;&lt; <span class="stringliteral">&quot;, in buffer &quot;</span> &lt;&lt; buffered &lt;&lt; <span class="stringliteral">&quot; bytes)\n&quot;</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// send whole segments</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">while</span> (bytesToSend &gt;= effectiveMss) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        uint32_t sentBytes = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(effectiveMss);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        ASSERT(bytesToSend &gt;= sentBytes);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        bytesToSend -= sentBytes;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">if</span> (bytesToSend &gt; 0) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">// Nagle&#39;s algorithm: when a TCP connection has outstanding data that has not</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">// yet been acknowledged, small segments cannot be sent until the outstanding</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// data is acknowledged.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordtype">bool</span> unacknowledgedData = (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a> != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordtype">bool</span> containsFin = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> + bytesToSend) == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <a class="code" href="_changes-20051129_8txt.html#a974896d9568f55fd56da7b21422ba4df">if</a> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#abae36bc1eb535ad82586aab38be55407">nagle_enabled</a> &amp;&amp; unacknowledgedData &amp;&amp; !containsFin)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot;Cannot send (last) segment due to Nagle, not enough data for a full segment\n&quot;</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(bytesToSend);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span> (old_snd_nxt == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no data sent</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">// notify (once is enough)</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a07ea8b8ecb22845b4e7d8954e7fab82a">lossRecovery</a> &amp;&amp; old_highRxt != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a>) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">// Note: Restart of REXMIT timer on retransmission is not part of RFC 2581, however optional in RFC 3517 if sent during recovery.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Retransmission sent during recovery, restarting REXMIT timer.\n&quot;</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a3cc5345bfd2869217e526a1b42a983d1">restartRexmitTimer</a>();</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">else</span> <span class="comment">// don&#39;t measure RTT for retransmitted packets</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae82e69467fe1056d434778c37fcb149d">dataSent</a>(old_snd_nxt);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#a5912db08ae7e25154e8692c5e3740c40">inet::tcp::DumbTcp::established()</a>, <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#af25d111ac5ddfa0d2d79712c6bc3c482">inet::tcp::DumbTcp::receivedDataAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_dumb_tcp.html#abeb15e53d4d4bba73d2328d10087c065">inet::tcp::DumbTcp::sendCommandInvoked()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_no_congestion_control.html#a9590dde8899c347507f6ad39f9aa31bc">inet::tcp::TcpNoCongestionControl::sendData()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a7e9461014cb424632888252758ba114a">inet::tcp::TcpBaseAlg::sendData()</a>.</p>

</div>
</div>
<a id="ac07f0b0d5d9b7e0e3a677e6d458cf98c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac07f0b0d5d9b7e0e3a677e6d458cf98c">&#9670;&nbsp;</a></span>sendDataDuringLossRecoveryPhase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendDataDuringLossRecoveryPhase </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>congestionWindow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send data during Loss Recovery phase (if SACK is enabled). </p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;{</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a07ea8b8ecb22845b4e7d8954e7fab82a">lossRecovery</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// RFC 3517 pages 7 and 8: &quot;(5) In order to take advantage of potential additional available</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// cwnd, proceed to step (C) below.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// (...)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// (C) If cwnd - pipe &gt;= 1 SMSS the sender SHOULD transmit one or more</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// segments as follows:</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// (...)</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// (C.5) If cwnd - pipe &gt;= 1 SMSS, return to (C.1)&quot;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">while</span> (((<span class="keywordtype">int</span>)congestionWindow - (<span class="keywordtype">int</span>)<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a>) &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>) { <span class="comment">// Note: Typecast needed to avoid prohibited transmissions</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">// RFC 3517 pages 7 and 8: &quot;(C.1) The scoreboard MUST be queried via NextSeg () for the</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">// sequence number range of the next segment to transmit (if any),</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// and the given segment sent.  If NextSeg () returns failure (no</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">// data to send) return without sending anything (i.e., terminate</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">// steps C.1 -- C.5).&quot;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        uint32_t seqNum;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">nextSeg</a>(seqNum)) <span class="comment">// if nextSeg() returns false (=failure): terminate steps C.1 -- C.5</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        uint32_t sentBytes = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase</a>(seqNum);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// RFC 3517 page 8: &quot;(C.4) The estimate of the amount of data outstanding in the</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">// network must be updated by incrementing pipe by the number of</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">// octets transmitted in (C.1).&quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a> += sentBytes;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_dc_tcp.html#a516faa96e43e4eba49a59d9be7343821">inet::tcp::DcTcp::receivedDataAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_reno.html#a4313b7777b967f944719f5b10aa814ec">inet::tcp::TcpReno::receivedDataAck()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_reno.html#a10c49fdf579139304be902761a0baff4">inet::tcp::TcpReno::receivedDuplicateAck()</a>.</p>

</div>
</div>
<a id="a7441e1e51cc3a6df1edaf9e1447f1dbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7441e1e51cc3a6df1edaf9e1447f1dbd">&#9670;&nbsp;</a></span>sendEstabIndicationToApp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendEstabIndicationToApp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends TCP_I_ESTABLISHED indication with <a class="el" href="classinet_1_1_tcp_connect_info.html" title="Class generated from inet/transportlayer/contract/tcp/TcpCommand.msg:176 by opp_msgtool.">TcpConnectInfo</a> to application. </p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Notifying app: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabebb8b876d14aa2de8ec16a07a64fc0c">TCP_I_ESTABLISHED</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">auto</span> indication = <span class="keyword">new</span> Indication(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabebb8b876d14aa2de8ec16a07a64fc0c">TCP_I_ESTABLISHED</a>), <a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabebb8b876d14aa2de8ec16a07a64fc0c">TCP_I_ESTABLISHED</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    TcpConnectInfo *ind = <span class="keyword">new</span> TcpConnectInfo();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    ind-&gt;setLocalAddr(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    ind-&gt;setRemoteAddr(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    ind-&gt;setLocalPort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    ind-&gt;setRemotePort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    indication-&gt;addTag&lt;SocketInd&gt;()-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    indication-&gt;setControlInfo(ind);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(indication);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7a9d893e816312584dc9124d5443c7ff">process_ACCEPT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>.</p>

</div>
</div>
<a id="ab2c6979d1519488109b9a8fc029081a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c6979d1519488109b9a8fc029081a2">&#9670;&nbsp;</a></span>sendFin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendFin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends FIN. </p>
<div class="fragment"><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// Note: ACK bit *must* be set for both FIN and FIN+ACK. What makes</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// the difference for FIN+ACK is that its ackNo acks the remote Tcp&#39;s FIN.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    tcpHeader-&gt;setFinBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    tcpHeader-&gt;setAckBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    tcpHeader-&gt;setAckNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    tcpHeader-&gt;setSequenceNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    tcpHeader-&gt;setWindow(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd</a>());</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    Packet *fp = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;FIN&quot;</span>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(fp, tcpHeader);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">// notify</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>.</p>

</div>
</div>
<a id="a2969ad9d4633f46f1193733a2adc211a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2969ad9d4633f46f1193733a2adc211a">&#9670;&nbsp;</a></span>sendIndicationToApp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendIndicationToApp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends status indication (TCP_I_xxx) to application. </p>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Notifying app: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a>(code) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keyword">auto</span> indication = <span class="keyword">new</span> Indication(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">indicationName</a>(code), code);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    TcpCommand *ind = <span class="keyword">new</span> TcpCommand();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    ind-&gt;setUserId(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    indication-&gt;addTag&lt;SocketInd&gt;()-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">setSocketId</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    indication-&gt;setControlInfo(ind);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp</a>(indication);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">processRstInSynReceived()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae9c251d96c91f8ac882ea64ea0e6a1d7">signalConnectionTimeout()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>.</p>

</div>
</div>
<a id="ac98e6eb26dabef91260e4ea36e70ccbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac98e6eb26dabef91260e4ea36e70ccbd">&#9670;&nbsp;</a></span>sendOneNewSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendOneNewSegment </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fullSegmentsOnly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>congestionWindow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send one new segment from snd_max if allowed (RFC 3042). </p>
<div class="fragment"><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;{</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa989b9d885f28bc180e2833483decb81">limited_transmit_enabled</a>);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">// RFC 3042, page 3:</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">// &quot;When a TCP sender has previously unsent data queued for transmission</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">// it SHOULD use the Limited Transmit algorithm, which calls for a TCP</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// sender to transmit new data upon the arrival of the first two</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// consecutive duplicate ACKs when the following conditions are</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">// satisfied:</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">//  * The receiver&#39;s advertised window allows the transmission of the</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">//  segment.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="comment">//  * The amount of outstanding data would remain less than or equal</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="comment">//  to the congestion window plus 2 segments.  In other words, the</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">//  sender can only send two segments beyond the congestion window</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">//  (cwnd).</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="comment">// The congestion window (cwnd) MUST NOT be changed when these new</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="comment">// segments are transmitted.  Assuming that these new segments and the</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="comment">// corresponding ACKs are not dropped, this procedure allows the sender</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">// to infer loss using the standard Fast Retransmit threshold of three</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// duplicate ACKs [RFC2581].  This is more robust to reordered packets</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">// than if an old packet were retransmitted on the first or second</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="comment">// duplicate ACK.</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// Note: If the connection is using selective acknowledgments [RFC2018],</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">// the data sender MUST NOT send new segments in response to duplicate</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// ACKs that contain no new SACK information, as a misbehaving receiver</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// can generate such ACKs to trigger inappropriate transmission of data</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="comment">// segments.  See [SCWA99] for a discussion of attacks by misbehaving</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="comment">// receivers.&quot;</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a44607c3de01875763befe761a03423ab">sackedBytes_old</a> != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a82acc05161ee0832163008c99475e207">sackedBytes</a>)) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="comment">// check how many bytes we have</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        uint32_t buffered = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keywordflow">if</span> (buffered &gt;= <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> || (!fullSegmentsOnly &amp;&amp; buffered &gt; 0)) {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            uint32_t outstandingData = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="comment">// check conditions from RFC 3042</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keywordflow">if</span> (outstandingData + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> &lt;= <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a> &amp;&amp;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                outstandingData + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> &lt;= congestionWindow + 2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                <span class="comment">// RFC 3042, page 3: &quot;(...)the sender can only send two segments beyond the congestion window (cwnd).&quot;</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                uint32_t effectiveWin = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a>, congestionWindow) - outstandingData + 2 * <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                <span class="comment">// bytes: number of bytes we&#39;re allowed to send now</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                uint32_t bytes = <a class="code" href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">std::min</a>(effectiveWin, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                <span class="keywordflow">if</span> (bytes &gt;= <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> || (!fullSegmentsOnly &amp;&amp; bytes &gt; 0)) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                    uint32_t old_snd_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                    <span class="comment">// we&#39;ll start sending from snd_max</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Limited Transmit algorithm enabled. Sending one new segment.\n&quot;</span>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    uint32_t sentBytes = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(bytes);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>))</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    <span class="comment">// reset snd_nxt if needed</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a>)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = old_snd_nxt + sentBytes;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                    <span class="comment">// notify</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae82e69467fe1056d434778c37fcb149d">dataSent</a>(old_snd_nxt);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a1e126b4d3699f8c67f80395d51d57d10">inet::tcp::TcpBaseAlg::receivedDuplicateAck()</a>.</p>

</div>
</div>
<a id="a53293619e77207f0f2efb029da9ea37c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53293619e77207f0f2efb029da9ea37c">&#9670;&nbsp;</a></span>sendProbe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::sendProbe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends 1 bytes as "probe", called by the "persist" mechanism. </p>
<div class="fragment"><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;{</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// we&#39;ll start sending from snd_max</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// check we have 1 byte to send</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>) == 0) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Cannot send probe because send buffer is empty\n&quot;</span>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    uint32_t old_snd_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending 1 byte as probe, with seq=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(1);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">// remember highest seq sent (snd_nxt may be set back on retransmission,</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// but we&#39;ll need snd_max to check validity of ACKs -- they must ack</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">// something we really sent)</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// notify</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae82e69467fe1056d434778c37fcb149d">dataSent</a>(old_snd_nxt);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#af0cf5f64a1e7705c0f086c7d7cdfad2d">inet::tcp::TcpBaseAlg::processPersistTimer()</a>.</p>

</div>
</div>
<a id="a0164100bb7b0722aafb91edadc87b903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0164100bb7b0722aafb91edadc87b903">&#9670;&nbsp;</a></span>sendRst() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendRst </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>srcPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>destPort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends RST; does not use connection state. </p>
<div class="fragment"><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;{</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    tcpHeader-&gt;setSrcPort(srcPort);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    tcpHeader-&gt;setDestPort(destPort);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    tcpHeader-&gt;setRstBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    tcpHeader-&gt;setSequenceNo(seq);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    tcpHeader-&gt;setCrcMode(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aaba0cc129b1179a7ecd6ad5b2b5a12ca">crcMode</a>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    tcpHeader-&gt;setCrc(0);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    Packet *fp = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;RST&quot;</span>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(fp, tcpHeader, src, dest);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9e2c7e2c00d063a782808ab9f3bbccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e2c7e2c00d063a782808ab9f3bbccf">&#9670;&nbsp;</a></span>sendRst() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendRst </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seqNo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends RST. </p>
<div class="fragment"><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;{</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst</a>(seqNo, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2b488f6cdc47ab4b57e2e5ee898b8b61">process_ABORT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a76270b2436749dcdde9c22b4553f6082">segmentArrivalWhileClosed()</a>.</p>

</div>
</div>
<a id="a247e7362ec8ea0956d44f5c97aeffa24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a247e7362ec8ea0956d44f5c97aeffa24">&#9670;&nbsp;</a></span>sendRstAck()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendRstAck </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>srcPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>destPort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends RST+ACK; does not use connection state. </p>
<div class="fragment"><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;{</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    tcpHeader-&gt;setSrcPort(srcPort);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    tcpHeader-&gt;setDestPort(destPort);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    tcpHeader-&gt;setRstBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    tcpHeader-&gt;setAckBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    tcpHeader-&gt;setSequenceNo(seq);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    tcpHeader-&gt;setAckNo(ack);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    tcpHeader-&gt;setCrcMode(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aaba0cc129b1179a7ecd6ad5b2b5a12ca">crcMode</a>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    tcpHeader-&gt;setCrc(0);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    Packet *fp = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;RST+ACK&quot;</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(fp, tcpHeader, src, dest);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// notify</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a76270b2436749dcdde9c22b4553f6082">segmentArrivalWhileClosed()</a>.</p>

</div>
</div>
<a id="a1ed176ad4551f8571d4fc13cb9480eda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed176ad4551f8571d4fc13cb9480eda">&#9670;&nbsp;</a></span>sendSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t inet::tcp::TcpConnection::sendSegment </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends one segment of 'bytes' bytes from snd_nxt, and advances snd_nxt. </p>
<p><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117" title="Utility: Send data from sendQueue, at most congestionWindow.">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c" title="Utility: sends 1 bytes as &quot;probe&quot;, called by the &quot;persist&quot; mechanism.">sendProbe()</a> and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3" title="Utility: retransmit all from snd_una to snd_max.">retransmitData()</a> internally all rely on this one. Returns the number of bytes sent. </p>
<div class="fragment"><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;{</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// FIXME check it: where is the right place for the next code (sacked/rexmitted)</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a>) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="comment">// check rexmitQ and try to forward snd_nxt before sending new data</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        uint32_t forward = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a0684f23ea5e00081f9bdbf1b944f291f">checkRexmitQueueForSackedOrRexmittedSegments</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span> (forward &gt; 0) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;sendSegment(&quot;</span> &lt;&lt; bytes &lt;&lt; <span class="stringliteral">&quot;) forwarded &quot;</span> &lt;&lt; forward &lt;&lt; <span class="stringliteral">&quot; bytes of snd_nxt from &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> += forward;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            EV_DETAIL &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a5f9c870db993a6094293e39b9a5756e2">detailedInfo</a>();</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    uint32_t buffered = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (bytes &gt; buffered) <span class="comment">// last segment?</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        bytes = buffered;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// if header options will be added, this could reduce the number of data bytes allowed for this segment,</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// because following condition must to be respected:</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="comment">//     bytes + options_len &lt;= snd_mss</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tmpTcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    tmpTcpHeader-&gt;setAckBit(<span class="keyword">true</span>); <span class="comment">// needed for TS option, otherwise TSecr will be set to 0</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions</a>(tmpTcpHeader);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> options_len = <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tmpTcpHeader-&gt;getHeaderLength() - <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>).get();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    ASSERT(options_len &lt; state-&gt;snd_mss);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (bytes + options_len &gt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        bytes = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> - options_len;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    uint32_t sentBytes = bytes;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// send one segment of &#39;bytes&#39; bytes from snd_nxt, and advance snd_nxt</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    Packet *tcpSegment = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#ab5dd93208f2f4f76b6454ef6b6a37f0c">createSegmentWithBytes</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, bytes);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    tcpHeader-&gt;setSequenceNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    ASSERT(tcpHeader != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// Remember old_snd_next to store in SACK rexmit queue.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    uint32_t old_snd_nxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    tcpHeader-&gt;setAckNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    tcpHeader-&gt;setAckBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    tcpHeader-&gt;setWindow(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd</a>());</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// ECN</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afa81cfbf0d827dcd5ca342d503faebf3">sndCwr</a>) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        tcpHeader-&gt;setCwrBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;set CWR bit\n&quot;</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afa81cfbf0d827dcd5ca342d503faebf3">sndCwr</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">// TODO when to set PSH bit?</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// TODO set URG bit if needed</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    ASSERT(bytes == tcpSegment-&gt;getByteLength());</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> += bytes;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">// check if afterRto bit can be reset</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a> &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a540240a4946cc48d695af1083f88a05b">seqGE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>))</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">afterRto</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a>) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Setting FIN on segment\n&quot;</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        tcpHeader-&gt;setFinBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a> + 1;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// if sack_enabled copy region of tcpHeader to rexmitQueue</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#aa032073527a29157ae853670c5131bc5">enqueueSentData</a>(old_snd_nxt, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// add header options and update header length (from tcpseg_temp)</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> i = 0; i &lt; tmpTcpHeader-&gt;getHeaderOptionArraySize(); i++)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        tcpHeader-&gt;appendHeaderOption(tmpTcpHeader-&gt;getHeaderOption(i)-&gt;dup());</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    tcpHeader-&gt;setHeaderLength(<a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a> + tcpHeader-&gt;getHeaderOptionArrayLength());</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    tcpHeader-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getHeaderLength()));</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    ASSERT(tcpHeader-&gt;getHeaderLength() == tmpTcpHeader-&gt;getHeaderLength());</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// let application fill queue again, if there is space</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">const</span> uint32_t alreadyQueued = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">getBytesAvailable</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">sendQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_send_queue.html#a461031ff2d9e90352ad181ddcc2ad5ab">getBufferStartSeq</a>());</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keyword">const</span> uint32_t abated = (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a> &gt; alreadyQueued) ? <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a> - alreadyQueued : 0;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="_changes-20051129_8txt.html#a974896d9568f55fd56da7b21422ba4df">if</a> ((<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">sendQueueLimit</a> &gt; 0) &amp;&amp; !<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0c8a9f83b111d667670557cabc6d2ce">queueUpdate</a> &amp;&amp; (abated &gt;= <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>)) { <span class="comment">// request more data if space &gt;= 1 MSS</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="comment">// Tell upper layer readiness to accept more data</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa185cf408f70835f6cd64b8908896f7d5">TCP_I_SEND_MSG</a>, abated);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0c8a9f83b111d667670557cabc6d2ce">queueUpdate</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// remember highest seq sent (snd_nxt may be set back on retransmission,</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// but we&#39;ll need snd_max to check validity of ACKs -- they must ack</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="comment">// something we really sent)</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>))</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">return</span> sentBytes;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">sendOneNewSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">sendProbe()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase()</a>.</p>

</div>
</div>
<a id="acc4b52c9e9becab1674bdbf2e7b4164e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc4b52c9e9becab1674bdbf2e7b4164e">&#9670;&nbsp;</a></span>sendSegmentDuringLossRecoveryPhase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t inet::tcp::TcpConnection::sendSegmentDuringLossRecoveryPhase </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seqNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send segment during Loss Recovery phase (if SACK is enabled). </p>
<p>Returns the number of bytes sent. </p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a07ea8b8ecb22845b4e7d8954e7fab82a">lossRecovery</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// start sending from seqNum</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = seqNum;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    uint32_t old_highRxt = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">getHighestRexmittedSeqNum</a>();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// no need to check cwnd and rwnd - has already be done before</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// no need to check nagle - sending mss bytes</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    uint32_t sentBytes = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    uint32_t sentSeqNum = seqNum + sentBytes;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">send_fin</a> &amp;&amp; sentSeqNum == <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">snd_fin_seq</a>)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        sentSeqNum = sentSeqNum + 1;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    ASSERT(<a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a>, sentSeqNum));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// RFC 3517 page 8: &quot;(C.2) If any of the data octets sent in (C.1) are below HighData,</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// HighRxt MUST be set to the highest sequence number of the</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// retransmitted segment.&quot;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(seqNum, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)) { <span class="comment">// HighData = snd_max</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">getHighestRexmittedSeqNum</a>();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// RFC 3517 page 8: &quot;(C.3) If any of the data octets sent in (C.1) are above HighData,</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// HighData must be updated to reflect the transmission of</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// previously unsent data.&quot;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">seqGreater</a>(sentSeqNum, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>)) <span class="comment">// HighData = snd_max</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = sentSeqNum;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">unackedSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// RFC 3517, page 9: &quot;6   Managing the RTO Timer</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// The standard TCP RTO estimator is defined in [RFC2988].  Due to the</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// fact that the SACK algorithm in this document can have an impact on</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// the behavior of the estimator, implementers may wish to consider how</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// the timer is managed.  [RFC2988] calls for the RTO timer to be</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// re-armed each time an ACK arrives that advances the cumulative ACK</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// point.  Because the algorithm presented in this document can keep the</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// ACK clock going through a fairly significant loss event,</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// (comparatively longer than the algorithm described in [RFC2581]), on</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// some networks the loss event could last longer than the RTO.  In this</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// case the RTO timer would expire prematurely and a segment that need</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// not be retransmitted would be resent.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// Therefore we give implementers the latitude to use the standard</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// [RFC2988] style RTO management or, optionally, a more careful variant</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// that re-arms the RTO timer on each retransmission that is sent during</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// recovery MAY be used.  This provides a more conservative timer than</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// specified in [RFC2988], and so may not always be an attractive</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// alternative.  However, in some cases it may prevent needless</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// retransmissions, go-back-N transmission and further reduction of the</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// congestion window.&quot;</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (old_highRxt != <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a>) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">// Note: Restart of REXMIT timer on retransmission is not part of RFC 2581, however optional in RFC 3517 if sent during recovery.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Retransmission sent during recovery, restarting REXMIT timer.\n&quot;</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a3cc5345bfd2869217e526a1b42a983d1">restartRexmitTimer</a>();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">else</span> <span class="comment">// don&#39;t measure RTT for retransmitted packets</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae82e69467fe1056d434778c37fcb149d">dataSent</a>(seqNum); <span class="comment">// seqNum = old_snd_nxt</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> sentBytes;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac07f0b0d5d9b7e0e3a677e6d458cf98c">sendDataDuringLossRecoveryPhase()</a>.</p>

</div>
</div>
<a id="a1322918e1985b3e30c63a82c62834b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1322918e1985b3e30c63a82c62834b4c">&#9670;&nbsp;</a></span>sendSyn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendSyn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send SYN. </p>
<div class="fragment"><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;{</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>.<a class="code" href="classinet_1_1_l3_address.html#ad9066a0c0be577b31aacb7d72b058795">isUnspecified</a>() || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a> == -1)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: foreign socket unspecified&quot;</span>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a> == -1)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>, <span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: local port unspecified&quot;</span>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// create segment</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    tcpHeader-&gt;setSequenceNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    tcpHeader-&gt;setSynBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd</a>();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    tcpHeader-&gt;setWindow(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a> + 1;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// ECN</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2d93e09da31c31f2b37b758902de1e66">ecnWillingness</a>) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        tcpHeader-&gt;setEceBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        tcpHeader-&gt;setCwrBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a179c4ccdd41290e4afce22dc728c8282">ecnSynSent</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        EV &lt;&lt; <span class="stringliteral">&quot;ECN-setup SYN packet sent\n&quot;</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// rfc 3168 page 16:</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">// A host that is not willing to use ECN on a TCP connection SHOULD</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="comment">// clear both the ECE and CWR flags in all non-ECN-setup SYN and/or</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="comment">// SYN-ACK packets that it sends to indicate this unwillingness.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        tcpHeader-&gt;setEceBit(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        tcpHeader-&gt;setCwrBit(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a179c4ccdd41290e4afce22dc728c8282">ecnSynSent</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">//        EV &lt;&lt; &quot;non-ECN-setup SYN packet sent\n&quot;;</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// write header options</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions</a>(tcpHeader);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    Packet *fp = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;SYN&quot;</span>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(fp, tcpHeader);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>.</p>

</div>
</div>
<a id="a69abf2064bebb5deaf8169d034cfca86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69abf2064bebb5deaf8169d034cfca86">&#9670;&nbsp;</a></span>sendSynAck()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendSynAck </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send SYN+ACK. </p>
<div class="fragment"><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// create segment</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tcpHeader = makeShared&lt;TcpHeader&gt;();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    tcpHeader-&gt;setSequenceNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    tcpHeader-&gt;setAckNo(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    tcpHeader-&gt;setSynBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    tcpHeader-&gt;setAckBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    tcpHeader-&gt;setWindow(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">snd_nxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">iss</a> + 1;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// ECN</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2d93e09da31c31f2b37b758902de1e66">ecnWillingness</a>) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        tcpHeader-&gt;setEceBit(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        tcpHeader-&gt;setCwrBit(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        EV &lt;&lt; <span class="stringliteral">&quot;ECN-setup SYN-ACK packet sent\n&quot;</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        tcpHeader-&gt;setEceBit(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        tcpHeader-&gt;setCwrBit(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a63f81359bde6fbd0cca323cfa056ff79">endPointIsWillingECN</a>)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            EV &lt;&lt; <span class="stringliteral">&quot;non-ECN-setup SYN-ACK packet sent\n&quot;</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2d93e09da31c31f2b37b758902de1e66">ecnWillingness</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a63f81359bde6fbd0cca323cfa056ff79">endPointIsWillingECN</a>) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        EV &lt;&lt; <span class="stringliteral">&quot;both end-points are willing to use ECN... ECN is enabled\n&quot;</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">// TODO not sure if we have to.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;           <span class="comment">// rfc-3168, page 16:</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;           <span class="comment">// A host that is not willing to use ECN on a TCP connection SHOULD</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;           <span class="comment">// clear both the ECE and CWR flags in all non-ECN-setup SYN and/or</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;           <span class="comment">// SYN-ACK packets that it sends to indicate this unwillingness.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a63f81359bde6fbd0cca323cfa056ff79">endPointIsWillingECN</a>)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            EV &lt;&lt; <span class="stringliteral">&quot;ECN is disabled\n&quot;</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// write header options</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions</a>(tcpHeader);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    Packet *fp = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;SYN+ACK&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// send it</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP</a>(fp, tcpHeader);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// notify</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">ackSent</a>();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="ab77b0cf9754e394332dd36cc610e3bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab77b0cf9754e394332dd36cc610e3bfc">&#9670;&nbsp;</a></span>sendToApp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendToApp </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: sends packet to application. </p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#ac890fc1aa704a0a82bed0424353c35f8">sendFromConn</a>(msg, <span class="stringliteral">&quot;appOut&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp()</a>.</p>

</div>
</div>
<a id="aef5d6ef72325ff4100c61f54aa718083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef5d6ef72325ff4100c61f54aa718083">&#9670;&nbsp;</a></span>sendToIP() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendToIP </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: send IP packet. </p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    EV_STATICCONTEXT;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending: &quot;</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">printSegmentBrief</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    IL3AddressType *addressType = dest.getAddressType();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    ASSERT(tcpHeader-&gt;getChunkLength() == tcpHeader-&gt;getHeaderLength());</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    tcpSegment-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a>&gt;()-&gt;setProtocol(addressType-&gt;getNetworkProtocol());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">ttl</a> != -1 &amp;&amp; tcpSegment-&gt;findTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a>&gt;() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        tcpSegment-&gt;addTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a>&gt;()-&gt;setHopLimit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">ttl</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">dscp</a> != -1 &amp;&amp; tcpSegment-&gt;findTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a080c497238ecf4e48b128a09ae2a6e7c">DscpReq</a>&gt;() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        tcpSegment-&gt;addTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a080c497238ecf4e48b128a09ae2a6e7c">DscpReq</a>&gt;()-&gt;setDifferentiatedServicesCodePoint(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">dscp</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">tos</a> != -1 &amp;&amp; tcpSegment-&gt;findTag&lt;TosReq&gt;() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        tcpSegment-&gt;addTag&lt;TosReq&gt;()-&gt;setTos(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">tos</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keyword">auto</span> addresses = tcpSegment-&gt;addTagIfAbsent&lt;L3AddressReq&gt;();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    addresses-&gt;setSrcAddress(src);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    addresses-&gt;setDestAddress(dest);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="namespaceinet.html#a76bc5c89148708a4d99dba04bd76f6ca">insertTransportProtocolHeader</a>(tcpSegment, <a class="code" href="classinet_1_1_protocol.html#ac274a953c505bbf6835122da65358a57">Protocol::tcp</a>, tcpHeader);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#ac890fc1aa704a0a82bed0424353c35f8">sendFromConn</a>(tcpSegment, <span class="stringliteral">&quot;ipOut&quot;</span>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a149bc4c48129dc7b91263b0171189a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a149bc4c48129dc7b91263b0171189a64">&#9670;&nbsp;</a></span>sendToIP() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::sendToIP </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>tcpSegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: adds control info to segment and sends it to IP. </p>
<div class="fragment"><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;{</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// record seq (only if we do send data) and ackno</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (tcpSegment-&gt;getByteLength() &gt; <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(tcpHeader-&gt;getChunkLength()).get())</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a1f4034777ecaed134ee827b75c30a3aa">sndNxtSignal</a>, tcpHeader-&gt;getSequenceNo());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac8999bc036241c07295cea07f6b069c2">sndAckSignal</a>, tcpHeader-&gt;getAckNo());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// final touches on the segment before sending</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    tcpHeader-&gt;setSrcPort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">localPort</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    tcpHeader-&gt;setDestPort(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">remotePort</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    ASSERT(tcpHeader-&gt;getHeaderLength() &gt;= <a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    ASSERT(tcpHeader-&gt;getHeaderLength() &lt;= <a class="code" href="namespaceinet_1_1tcp.html#a6b9b8721038abecf3e397a2743bace39">TCP_MAX_HEADER_LENGTH</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    ASSERT(tcpHeader-&gt;getChunkLength() == tcpHeader-&gt;getHeaderLength());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending: &quot;</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">printSegmentBrief</a>(tcpSegment, tcpHeader);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// TODO reuse next function for sending</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    IL3AddressType *addressType = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>.<a class="code" href="classinet_1_1_l3_address.html#a30dd435542f45ebc9bb7c75344545e49">getAddressType</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    tcpSegment-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a>&gt;()-&gt;setProtocol(addressType-&gt;getNetworkProtocol());</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">ttl</a> != -1 &amp;&amp; tcpSegment-&gt;findTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a>&gt;() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        tcpSegment-&gt;addTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a>&gt;()-&gt;setHopLimit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">ttl</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">dscp</a> != -1 &amp;&amp; tcpSegment-&gt;findTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a080c497238ecf4e48b128a09ae2a6e7c">DscpReq</a>&gt;() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        tcpSegment-&gt;addTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a080c497238ecf4e48b128a09ae2a6e7c">DscpReq</a>&gt;()-&gt;setDifferentiatedServicesCodePoint(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">dscp</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">tos</a> != -1 &amp;&amp; tcpSegment-&gt;findTag&lt;TosReq&gt;() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        tcpSegment-&gt;addTag&lt;TosReq&gt;()-&gt;setTos(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">tos</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">auto</span> addresses = tcpSegment-&gt;addTagIfAbsent&lt;L3AddressReq&gt;();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    addresses-&gt;setSrcAddress(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">localAddr</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    addresses-&gt;setDestAddress(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">remoteAddr</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// ECN:</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// We decided to use ECT(1) to indicate ECN capable transport.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// rfc-3168, page 6:</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Routers treat the ECT(0) and ECT(1) codepoints</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// as equivalent.  Senders are free to use either the ECT(0) or the</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// ECT(1) codepoint to indicate ECT.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// rfc-3168, page 20:</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// For the current generation of TCP congestion control algorithms, pure</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// acknowledgement packets (e.g., packets that do not contain any</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// accompanying data) MUST be sent with the not-ECT codepoint.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// rfc-3168, page 20:</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// ECN-capable TCP implementations MUST NOT set either ECT codepoint</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// (ECT(0) or ECT(1)) in the IP header for retransmitted data packets</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    tcpSegment-&gt;addTagIfAbsent&lt;EcnReq&gt;()-&gt;setExplicitCongestionNotification((<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">ect</a> &amp;&amp; !<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a271132eb5c66ef013822b45a27985f58">sndAck</a> &amp;&amp; !<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab8a10a273ecf8245f1dd9fdf6d32bec6">rexmit</a>) ? <a class="code" href="namespaceinet.html#ac8175ca68b0984f2ed7c1362f8c6955da92d48e3b12bc59fb1903c1b060dd18c2">IP_ECN_ECT_1</a> : <a class="code" href="namespaceinet.html#ac8175ca68b0984f2ed7c1362f8c6955daf4ecd7b6e34e6330e2ffa75ca3462a1c">IP_ECN_NOT_ECT</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    tcpHeader-&gt;setCrc(0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    tcpHeader-&gt;setCrcMode(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#aaba0cc129b1179a7ecd6ad5b2b5a12ca">crcMode</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="namespaceinet.html#a76bc5c89148708a4d99dba04bd76f6ca">insertTransportProtocolHeader</a>(tcpSegment, <a class="code" href="classinet_1_1_protocol.html#ac274a953c505bbf6835122da65358a57">Protocol::tcp</a>, tcpHeader);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">tcpMain</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp.html#ac890fc1aa704a0a82bed0424353c35f8">sendFromConn</a>(tcpSegment, <span class="stringliteral">&quot;ipOut&quot;</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0164100bb7b0722aafb91edadc87b903">sendRst()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">sendRstAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck()</a>.</p>

</div>
</div>
<a id="a10f756bb8ffed7eb3412c399405d942c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10f756bb8ffed7eb3412c399405d942c">&#9670;&nbsp;</a></span>setPipe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::setPipe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For SACK TCP. </p>
<p>RFC 3517, page 3: "This routine traverses the sequence
space from HighACK to HighData and MUST set the "pipe" variable to an estimate of the number of octets that are currently in transit between the TCP sender and the TCP receiver." </p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// RFC 3517, pages 1 and 2: &quot;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// &quot;HighACK&quot; is the sequence number of the highest byte of data that</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// has been cumulatively ACKed at a given point.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// &quot;HighData&quot; is the highest sequence number transmitted at a given</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// point.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// &quot;HighRxt&quot; is the highest sequence number which has been</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// retransmitted during the current loss recovery phase.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// &quot;Pipe&quot; is a sender&#39;s estimate of the number of bytes outstanding</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// in the network.  This is used during recovery for limiting the</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// sender&#39;s sending rate.  The pipe variable allows TCP to use a</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// fundamentally different congestion control than specified in</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// [RFC2581].  The algorithm is often referred to as the &quot;pipe</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// algorithm&quot;.&quot;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// HighAck = snd_una</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// HighData = snd_max</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">getHighestRexmittedSeqNum</a>();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a> = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    uint32_t length = 0; <span class="comment">// required for rexmitQueue-&gt;checkSackBlock()</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">bool</span> sacked; <span class="comment">// required for rexmitQueue-&gt;checkSackBlock()</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">bool</span> rexmitted; <span class="comment">// required for rexmitQueue-&gt;checkSackBlock()</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// RFC 3517, page 3: &quot;This routine traverses the sequence space from HighACK to HighData</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// and MUST set the &quot;pipe&quot; variable to an estimate of the number of</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// octets that are currently in transit between the TCP sender and</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// the TCP receiver.  After initializing pipe to zero the following</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// steps are taken for each octet &#39;S1&#39; in the sequence space between</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// HighACK and HighData that has not been SACKed:&quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span> (uint32_t s1 = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">snd_una</a>; <a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(s1, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">snd_max</a>); s1 += length) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">rexmitQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a9d728c2ef24559de13711865253c191c">checkSackBlock</a>(s1, length, sacked, rexmitted);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (!sacked) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">// RFC 3517, page 3: &quot;(a) If IsLost (S1) returns false:</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">//     Pipe is incremented by 1 octet.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">//     The effect of this condition is that pipe is incremented for</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">//     packets that have not been SACKed and have not been determined</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">//     to have been lost (i.e., those segments that are still assumed</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">//     to be in the network).&quot;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost</a>(s1) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a> += length;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">// RFC 3517, pages 3 and 4: &quot;(b) If S1 &lt;= HighRxt:</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="comment">//     Pipe is incremented by 1 octet.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">//     The effect of this condition is that pipe is incremented for</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="comment">//     the retransmission of the octet.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">//  Note that octets retransmitted without being considered lost are</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment">//  counted twice by the above mechanism.&quot;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(s1, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">highRxt</a>))</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a> += length;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa0f29c42a316c329683196e9d7ace718">pipeSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">pipe</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_dc_tcp.html#a516faa96e43e4eba49a59d9be7343821">inet::tcp::DcTcp::receivedDataAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_reno.html#a4313b7777b967f944719f5b10aa814ec">inet::tcp::TcpReno::receivedDataAck()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_reno.html#a10c49fdf579139304be902761a0baff4">inet::tcp::TcpReno::receivedDuplicateAck()</a>.</p>

</div>
</div>
<a id="a0416c97da1b894d6199f133509e8ada3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0416c97da1b894d6199f133509e8ada3">&#9670;&nbsp;</a></span>setSocketId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::setSocketId </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newSocketId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{ ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a> == -1); <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">socketId</a> = newSocketId; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp()</a>.</p>

</div>
</div>
<a id="ae9c251d96c91f8ac882ea64ea0e6a1d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9c251d96c91f8ac882ea64ea0e6a1d7">&#9670;&nbsp;</a></span>signalConnectionTimeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::signalConnectionTimeout </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: signal to user that connection timed out. </p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaf19192f797b153d7fcd7b760c469090a">TCP_I_TIMED_OUT</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a1ff5c2c9d5fa9cc0139e05e6c4b87c18">inet::tcp::TcpBaseAlg::processRexmitTimer()</a>.</p>

</div>
</div>
<a id="ac60a7ea5cb157c0bb34372eca11b40c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac60a7ea5cb157c0bb34372eca11b40c2">&#9670;&nbsp;</a></span>startSynRexmitTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::startSynRexmitTimer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: start SYN-REXMIT timer. </p>
<div class="fragment"><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;{</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> = 0;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">syn_rexmit_timeout</a> = <a class="code" href="_tcp_connection_8h.html#a89ce38305130a5021e21134602a88f79">TCP_TIMEOUT_SYN_REXMIT</a>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    rescheduleAfter(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">syn_rexmit_timeout</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="a759a1d53d5b30d2a1f5f14bb76bf55a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a759a1d53d5b30d2a1f5f14bb76bf55a4">&#9670;&nbsp;</a></span>stateEntered()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::stateEntered </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>oldState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">TcpEventCode</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform cleanup necessary when entering a new state, e.g. </p>
<p>cancelling timers </p>
<div class="fragment"><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// cancel timers</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>:</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">// we&#39;ll never get back to INIT</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>:</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="comment">// we may get back to LISTEN from SYN_RCVD</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>:</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>:</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>:</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="comment">// we&#39;re in ESTABLISHED, these timers are no longer needed</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keyword">delete</span> cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="keyword">delete</span> cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="comment">// TCP_I_ESTAB notification moved inside event processing</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>:</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>:</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>:</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>:</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>:</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a> == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa85246db1cb61179ad34ebd92dd2bef01">TCP_I_PEER_CLOSED</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="comment">// whether connection setup succeeded (ESTABLISHED) or not (others),</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="comment">// cancel these timers</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>:</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa59d453e9968e0d5bbe7ed3daffe5da0b">TCP_I_CLOSED</a>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>:</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="keywordflow">if</span> (oldState != <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a> &amp;&amp; event != <a class="code" href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">TCP_E_ABORT</a>)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp</a>(<a class="code" href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa59d453e9968e0d5bbe7ed3daffe5da0b">TCP_I_CLOSED</a>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">// all timers need to be cancelled</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">the2MSLTimer</a>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">connEstabTimer</a>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">finWait2Timer</a>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                cancelEvent(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">synRexmitTimer</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">tcpAlgorithm</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_algorithm.html#a1c522a4f856714ffaaaef933c731b149">connectionClosed</a>();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition()</a>.</p>

</div>
</div>
<a id="a3f713d3c35004f40eef567f610f83127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f713d3c35004f40eef567f610f83127">&#9670;&nbsp;</a></span>stateName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * inet::tcp::TcpConnection::stateName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: returns name of TCP_S_xxx constants. </p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#define CASE(x)    case x: \</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">        s = (char *)#x + 6; break</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">s</a> = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">TCP_S_CLOSED</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">TCP_S_LAST_ACK</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">TCP_S_CLOSING</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">TCP_S_TIME_WAIT</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">s</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#undef CASE</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="namespaceinet_1_1tcp.html#a214d8e62bc922b8a2bb61dcda81daede">inet::tcp::operator&lt;&lt;()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad27c319b03d76159b21f347b1eaf9533">process_TIMEOUT_2MSL()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8aed4b95f11d1397db07461cd7c997ee">process_TIMEOUT_FIN_WAIT_2()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a34be7e48b4ab7e1c189665d61b1e9e47">processTSOption()</a>.</p>

</div>
</div>
<a id="ae57488043d7b7533872cac4a73ba5907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae57488043d7b7533872cac4a73ba5907">&#9670;&nbsp;</a></span>tryFastRoute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::tcp::TcpConnection::tryFastRoute </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shortcut to process most common case as fast as possible. </p>
<p>Returns false if segment requires normal (slow) route. </p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// fast route processing not yet implemented</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>.</p>

</div>
</div>
<a id="a5dce56cbb130a9eff691579cb479fdd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dce56cbb130a9eff691579cb479fdd7">&#9670;&nbsp;</a></span>updateRcvQueueVars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::updateRcvQueueVars </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: update receiver queue related variables and statistics - called before setting rcv_wnd. </p>
<div class="fragment"><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;{</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="comment">// update receive queue related state variables</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fbf27a7d9162dae1b3b94e034a1afbd">freeRcvBuffer</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#ad1b600d74eb698cc02c43e1ef192f0b9">getAmountOfFreeBytes</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">maxRcvBuffer</a>);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1ee55dc20af304777e821e2aad73395b">usedRcvBuffer</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">maxRcvBuffer</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fbf27a7d9162dae1b3b94e034a1afbd">freeRcvBuffer</a>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">// update receive queue related statistics</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a97c136fdf02b4cdaa010d86105aac3f9">tcpRcvQueueBytesSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1ee55dc20af304777e821e2aad73395b">usedRcvBuffer</a>);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">//    tcpEV &lt;&lt; &quot;receiveQ: receiveQLength=&quot; &lt;&lt; receiveQueue-&gt;getQueueLength() &lt;&lt; &quot; maxRcvBuffer=&quot; &lt;&lt; state-&gt;maxRcvBuffer &lt;&lt; &quot; usedRcvBuffer=&quot; &lt;&lt; state-&gt;usedRcvBuffer &lt;&lt; &quot; freeRcvBuffer=&quot; &lt;&lt; state-&gt;freeRcvBuffer &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd()</a>.</p>

</div>
</div>
<a id="a9b36439caaec220aebab659e5c6ff4d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b36439caaec220aebab659e5c6ff4d8">&#9670;&nbsp;</a></span>updateRcvWnd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short inet::tcp::TcpConnection::updateRcvWnd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: update receive window (rcv_wnd), and calculate scaled value if window scaling enabled. </p>
<p>Returns the (scaled) receive window size. </p>
<div class="fragment"><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;{</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    uint32_t win = 0;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">// update receive queue related state variables and statistics</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars</a>();</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    win = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fbf27a7d9162dae1b3b94e034a1afbd">freeRcvBuffer</a>;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// Following lines are based on [Stevens, W.R.: TCP/IP Illustrated, Volume 2, chapter 26.7, pages 878-879]:</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// Don&#39;t advertise less than one full-sized segment to avoid SWS</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordflow">if</span> (win &lt; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">maxRcvBuffer</a> / 4) &amp;&amp; win &lt; state-&gt;snd_mss)</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        win = 0;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">// Do not shrink window</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">// (rcv_adv minus rcv_nxt) is the amount of space still available to the sender that was previously advertised</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">if</span> (win &lt; state-&gt;rcv_adv - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        win = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// Observe upper limit for advertised window on this connection</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keyword">const</span> uint32_t maxWin = (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a>) ? (<a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a>) : <a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a>; <span class="comment">// TCP_MAX_WIN = 65535 (16 bit)</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (win &gt; maxWin)</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        win = maxWin; <span class="comment">// Note: The window size is limited to a 16 bit value in the TCP header if WINDOW SCALE option (RFC 1323) is not used</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// Note: The order of the &quot;Do not shrink window&quot; and &quot;Observe upper limit&quot; parts has been changed to the order used in FreeBSD Release 7.1</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="comment">// update rcv_adv if needed</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">if</span> (win &gt; 0 &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a540240a4946cc48d695af1083f88a05b">seqGE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> + win, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a>)) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a> + win;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ad78cd9a6e338d5c03499b44727b6829e">rcvAdvSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">rcv_adv</a>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a> = win;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a7c980dc89305fbe03d5450934859d1f4">rcvWndSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="comment">// scale rcv_wnd:</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    uint32_t scaled_rcv_wnd = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">rcv_wnd</a>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a>) {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        ASSERT(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a> &lt;= 14); <span class="comment">// RFC 1323, page 11: &quot;the shift count must be limited to 14&quot;</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        scaled_rcv_wnd = scaled_rcv_wnd &gt;&gt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    ASSERT(scaled_rcv_wnd == (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)scaled_rcv_wnd);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160; </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)scaled_rcv_wnd;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck()</a>.</p>

</div>
</div>
<a id="af6a60e79915ff54a4a91715cb6318593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6a60e79915ff54a4a91715cb6318593">&#9670;&nbsp;</a></span>updateWndInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::tcp::TcpConnection::updateWndInfo </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doAlways</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: update window information (snd_wnd, snd_wl1, snd_wl2) </p>
<div class="fragment"><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;{</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    uint32_t true_window = tcpHeader-&gt;getWindow();</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">// RFC 1323, page 10:</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">// &quot;The window field (SEG.WND) in the header of every incoming</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">// segment, with the exception of SYN segments, is left-shifted</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">// by Snd.Wind.Scale bits before updating SND.WND:</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">//    SND.WND = SEG.WND &lt;&lt; Snd.Wind.Scale&quot;</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> &amp;&amp; !tcpHeader-&gt;getSynBit())</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        true_window = tcpHeader-&gt;getWindow() &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8bfd8f820c13ba78df3883241171d369">snd_wnd_scale</a>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// Following lines are based on [Stevens, W.R.: TCP/IP Illustrated, Volume 2, page 982]:</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">if</span> (doAlways || (tcpHeader-&gt;getAckBit()</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                     &amp;&amp; (<a class="code" href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">seqLess</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa6c008757fabc67fc69a0803084279e5">snd_wl1</a>, tcpHeader-&gt;getSequenceNo()) ||</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                         (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa6c008757fabc67fc69a0803084279e5">snd_wl1</a> == tcpHeader-&gt;getSequenceNo() &amp;&amp; <a class="code" href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">seqLE</a>(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a074ba48b33396e8d42c40d734cca4867">snd_wl2</a>, tcpHeader-&gt;getAckNo())) ||</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                         (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a074ba48b33396e8d42c40d734cca4867">snd_wl2</a> == tcpHeader-&gt;getAckNo() &amp;&amp; true_window &gt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a>))))</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <span class="comment">// send window should be updated</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a> = true_window;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Updating send window from segment: new wnd=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa6c008757fabc67fc69a0803084279e5">snd_wl1</a> = tcpHeader-&gt;getSequenceNo();</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a074ba48b33396e8d42c40d734cca4867">snd_wl2</a> = tcpHeader-&gt;getAckNo();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        emit(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a0def5a11ed40d33fa6821c79cc1b2533">sndWndSignal</a>, <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">snd_wnd</a>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="a88a1f002d9ffdc83267c750151631bda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a1f002d9ffdc83267c750151631bda">&#9670;&nbsp;</a></span>writeHeaderOptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> inet::tcp::TcpConnection::writeHeaderOptions </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; <a class="el" href="classinet_1_1tcp_1_1_tcp_header.html">TcpHeader</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpHeader</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility: writeHeaderOptions (Currently only EOL, NOP, MSS, WS, SACK_PERMITTED, SACK and TS are implemented) </p>
<div class="fragment"><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;{</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">// SYN flag set and connetion in INIT or LISTEN state (or after synRexmit timeout)</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getSynBit() &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">TCP_S_LISTEN</a></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                || ((<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a>)</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                    &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> &gt; 0)))</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">// MSS header option</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> &gt; 0) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            TcpOptionMaxSegmentSize *option = <span class="keyword">new</span> TcpOptionMaxSegmentSize();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            option-&gt;setMaxSegmentSize(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a>);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            tcpHeader-&gt;appendHeaderOption(option);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option MSS(=&quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">snd_mss</a> &lt;&lt; <span class="stringliteral">&quot;) sent\n&quot;</span>;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="comment">// WS header option</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">ws_support</a> &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5f06b20358ab5338c8af2490541dc724">rcv_ws</a> || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                                    || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> &gt; 0))))</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="comment">// 1 padding byte</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="comment">// Update WS variables</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3f5fd4073ff476bb21d6e1d3c7ef676f">ws_manual_scale</a> &gt; -1) {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3f5fd4073ff476bb21d6e1d3c7ef676f">ws_manual_scale</a>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <a class="code" href="namespaceinet.html#a3de731dd41ee41b66d326c7a7e851ce3">ulong</a> scaled_rcv_wnd = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">receiveQueue</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a380a7b467a6e279f76b946f80a9e5d07">getFirstSeqNo</a>() + <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">maxRcvBuffer</a> - <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">rcv_nxt</a>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a> = 0;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="keywordflow">while</span> (scaled_rcv_wnd &gt; <a class="code" href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a> &lt; 14) { <span class="comment">// RFC 1323, page 11: &quot;the shift count must be limited to 14&quot;</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                    scaled_rcv_wnd = scaled_rcv_wnd &gt;&gt; 1;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                    <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a>++;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            TcpOptionWindowScale *option = <span class="keyword">new</span> TcpOptionWindowScale();</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            option-&gt;setWindowScale(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">rcv_wnd_scale</a>); <span class="comment">// rcv_wnd_scale is also set in scaleRcvWnd()</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#abeff78d75750335417e9e82a0e14fab9">snd_ws</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">ws_support</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#abeff78d75750335417e9e82a0e14fab9">snd_ws</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5f06b20358ab5338c8af2490541dc724">rcv_ws</a>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option WS(=&quot;</span> &lt;&lt; option-&gt;getWindowScale() &lt;&lt; <span class="stringliteral">&quot;) sent, WS (ws_enabled) is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">ws_enabled</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            tcpHeader-&gt;appendHeaderOption(option);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="comment">// SACK_PERMITTED header option</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">sack_support</a> &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae454ba565e4349a82d13897367a32348">rcv_sack_perm</a> || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                                             || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> &gt; 0))))</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a701a3e619d81a47b28c8de4914adb917">ts_support</a>) { <span class="comment">// if TS is supported by host, do not add NOPs to this segment</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                <span class="comment">// 2 padding bytes</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionSackPermitted());</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="comment">// Update SACK variables</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad386dec080ca76d4230a18e38802b536">snd_sack_perm</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">sack_support</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad386dec080ca76d4230a18e38802b536">snd_sack_perm</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae454ba565e4349a82d13897367a32348">rcv_sack_perm</a>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option SACK_PERMITTED sent, SACK (sack_enabled) is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="comment">// TS header option</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a701a3e619d81a47b28c8de4914adb917">ts_support</a> &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a54573456795943feec64ebac35be9122">rcv_initial_ts</a> || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">TCP_S_INIT</a></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                                            || (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">syn_rexmit_count</a> &gt; 0))))</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">sack_support</a>) { <span class="comment">// if SACK is supported by host, do not add NOPs to this segment</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                <span class="comment">// 2 padding bytes</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            TcpOptionTimestamp *option = <span class="keyword">new</span> TcpOptionTimestamp();</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="comment">// Update TS variables</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="comment">// RFC 1323, page 13: &quot;The Timestamp Value field (TSval) contains the current value of the timestamp clock of the Tcp sending the option.&quot;</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            option-&gt;setSenderTimestamp(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2592b559e4749d06295c427e1d058368">convertSimtimeToTS</a>(simTime()));</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="comment">// RFC 1323, page 16: &quot;(3) When a TSopt is sent, its TSecr field is set to the current TS.Recent value.&quot;</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            <span class="comment">// RFC 1323, page 13:</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="comment">// &quot;The Timestamp Echo Reply field (TSecr) is only valid if the ACK</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="comment">// bit is set in the Tcp header; if it is valid, it echos a times-</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <span class="comment">// tamp value that was sent by the remote Tcp in the TSval field</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="comment">// of a Timestamps option.  When TSecr is not valid, its value</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="comment">// must be zero.&quot;</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            option-&gt;setEchoedTimestamp(tcpHeader-&gt;getAckBit() ? <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">ts_recent</a> : 0);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab964376b0e8842da819d5d93e9de6583">snd_initial_ts</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a> = <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a701a3e619d81a47b28c8de4914adb917">ts_support</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab964376b0e8842da819d5d93e9de6583">snd_initial_ts</a> &amp;&amp; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a54573456795943feec64ebac35be9122">rcv_initial_ts</a>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option TS(TSval=&quot;</span> &lt;&lt; option-&gt;getSenderTimestamp() &lt;&lt; <span class="stringliteral">&quot;, TSecr=&quot;</span> &lt;&lt; option-&gt;getEchoedTimestamp() &lt;&lt; <span class="stringliteral">&quot;) sent, TS (ts_enabled) is set to &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            tcpHeader-&gt;appendHeaderOption(option);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="comment">// TODO add new TCPOptions here once they are implemented</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">TCP_S_SYN_SENT</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">TCP_S_SYN_RCVD</a></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;             || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">TCP_S_ESTABLISHED</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">TCP_S_FIN_WAIT_1</a></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;             || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">TCP_S_FIN_WAIT_2</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">fsm</a>.getState() == <a class="code" href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">TCP_S_CLOSE_WAIT</a>) <span class="comment">// connetion is not in INIT or LISTEN state</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="comment">// TS header option</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">ts_enabled</a>) { <span class="comment">// Is TS enabled?</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <span class="keywordflow">if</span> (!(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a>))) { <span class="comment">// if SACK is enabled and SACKs need to be added, do not add NOPs to this segment</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                <span class="comment">// 2 padding bytes</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                tcpHeader-&gt;appendHeaderOption(<span class="keyword">new</span> TcpOptionNop()); <span class="comment">// NOP</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            TcpOptionTimestamp *option = <span class="keyword">new</span> TcpOptionTimestamp();</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <span class="comment">// Update TS variables</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            <span class="comment">// RFC 1323, page 13: &quot;The Timestamp Value field (TSval) contains the current value of the timestamp clock of the Tcp sending the option.&quot;</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            option-&gt;setSenderTimestamp(<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#a2592b559e4749d06295c427e1d058368">convertSimtimeToTS</a>(simTime()));</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="comment">// RFC 1323, page 16: &quot;(3) When a TSopt is sent, its TSecr field is set to the current TS.Recent value.&quot;</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="comment">// RFC 1323, page 13:</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="comment">// &quot;The Timestamp Echo Reply field (TSecr) is only valid if the ACK</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="comment">// bit is set in the Tcp header; if it is valid, it echos a times-</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <span class="comment">// tamp value that was sent by the remote Tcp in the TSval field</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <span class="comment">// of a Timestamps option.  When TSecr is not valid, its value</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment">// must be zero.&quot;</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            option-&gt;setEchoedTimestamp(tcpHeader-&gt;getAckBit() ? <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">ts_recent</a> : 0);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Tcp Header Option TS(TSval=&quot;</span> &lt;&lt; option-&gt;getSenderTimestamp() &lt;&lt; <span class="stringliteral">&quot;, TSecr=&quot;</span> &lt;&lt; option-&gt;getEchoedTimestamp() &lt;&lt; <span class="stringliteral">&quot;) sent\n&quot;</span>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            tcpHeader-&gt;appendHeaderOption(option);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="comment">// SACK header option</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="comment">// RFC 2018, page 4:</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="comment">// &quot;If sent at all, SACK options SHOULD be included in all ACKs which do</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="comment">// not ACK the highest sequence number in the data receiver&#39;s queue.  In</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="comment">// this situation the network has lost or mis-ordered data, such that</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="comment">// the receiver holds non-contiguous data in its queue.  RFC 1122,</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="comment">// Section 4.2.2.21, discusses the reasons for the receiver to send ACKs</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <span class="comment">// in response to additional segments received in this state.  The</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="comment">// receiver SHOULD send an ACK for every valid segment that arrives</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="comment">// containing new data, and each of these &quot;duplicate&quot; ACKs SHOULD bear a</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="comment">// SACK option.&quot;</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">sack_enabled</a> &amp;&amp; (<a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">snd_sack</a> || <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">state</a>-&gt;<a class="code" href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">snd_dsack</a>)) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <a class="code" href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">addSacks</a>(tcpHeader);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="comment">// TODO add new TCPOptions here once they are implemented</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="comment">// TODO delegate to TcpAlgorithm as well -- it may want to append additional options</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (tcpHeader-&gt;getHeaderOptionArraySize() != 0) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a> options_len = tcpHeader-&gt;getHeaderOptionArrayLength();</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">if</span> (options_len &lt;= <a class="code" href="namespaceinet_1_1tcp.html#a8fa2795781fd0df1ea479f2e72d3642d">TCP_OPTIONS_MAX_SIZE</a>) { <span class="comment">// Options length allowed? - maximum: 40 Bytes</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            tcpHeader-&gt;setHeaderLength(<a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a> + options_len);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            tcpHeader-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a> + options_len));</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            tcpHeader-&gt;dropHeaderOptions(); <span class="comment">// drop all options</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            tcpHeader-&gt;setHeaderLength(<a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            tcpHeader-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">TCP_MIN_HEADER_LENGTH</a>);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            EV_ERROR &lt;&lt; <span class="stringliteral">&quot;ERROR: Options length exceeded! Segment will be sent without options&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">return</span> *tcpHeader;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac7c09509eed5568d9ca764207707c20d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c09509eed5568d9ca764207707c20d">&#9670;&nbsp;</a></span>connEstabTimer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* inet::tcp::TcpConnection::connEstabTimer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="ae756c38799f1d6fdb05f536dd924a3c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae756c38799f1d6fdb05f536dd924a3c0">&#9670;&nbsp;</a></span>dscp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short inet::tcp::TcpConnection::dscp = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a85992dfca295a0ab3240f0ec1650ebd6">process_OPTIONS()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="aa7f76b4e941cbbe2ef203bf27a8173a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7f76b4e941cbbe2ef203bf27a8173a2">&#9670;&nbsp;</a></span>dupAcksSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::dupAcksSignal = registerSignal(&quot;dupAcks&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="afaf1fe106e54ec80d28d242823e55ce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaf1fe106e54ec80d28d242823e55ce7">&#9670;&nbsp;</a></span>finWait2Timer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* inet::tcp::TcpConnection::finWait2Timer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="aa3ef478c5f1fb691510da2b4b6a47cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3ef478c5f1fb691510da2b4b6a47cd9">&#9670;&nbsp;</a></span>fsm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cFSM inet::tcp::TcpConnection::fsm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2b488f6cdc47ab4b57e2e5ee898b8b61">process_ABORT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad27c319b03d76159b21f347b1eaf9533">process_TIMEOUT_2MSL()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8aed4b95f11d1397db07461cd7c997ee">process_TIMEOUT_FIN_WAIT_2()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a95b7233ca8183973b60c88e1f955993c">processMSSOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a98ad81d8ce1e5dbfd40bd83a34b6d340">processSACKPermittedOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a34be7e48b4ab7e1c189665d61b1e9e47">processTSOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c7bc93c84a410a40ceefee26e61196">processWSOption()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions()</a>.</p>

</div>
</div>
<a id="a48ce9072da1e00dd840db1ddd1322534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48ce9072da1e00dd840db1ddd1322534">&#9670;&nbsp;</a></span>listeningSocketId</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::listeningSocketId = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7a9d893e816312584dc9124d5443c7ff">process_ACCEPT()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>.</p>

</div>
</div>
<a id="af0709b8c1e83b2b343bfb76ac5adb1df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0709b8c1e83b2b343bfb76ac5adb1df">&#9670;&nbsp;</a></span>localAddr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a> inet::tcp::TcpConnection::localAddr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">inet::tcp::Tcp::addSockPair()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">inet::tcp::Tcp::removeConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">inet::tcp::Tcp::updateSockPair()</a>.</p>

</div>
</div>
<a id="aad4561cfa55aeae815b09a98e464dc79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad4561cfa55aeae815b09a98e464dc79">&#9670;&nbsp;</a></span>localPort</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::localPort = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">inet::tcp::Tcp::addSockPair()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">inet::tcp::Tcp::removeConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">inet::tcp::Tcp::updateSockPair()</a>.</p>

</div>
</div>
<a id="aa0f29c42a316c329683196e9d7ace718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0f29c42a316c329683196e9d7ace718">&#9670;&nbsp;</a></span>pipeSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::pipeSignal = registerSignal(&quot;pipe&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a10f756bb8ffed7eb3412c399405d942c">setPipe()</a>.</p>

</div>
</div>
<a id="a69f034cb5f674f2554d4d3b59477b7d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f034cb5f674f2554d4d3b59477b7d8">&#9670;&nbsp;</a></span>rcvAckSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvAckSignal = registerSignal(&quot;rcvAck&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>.</p>

</div>
</div>
<a id="ad78cd9a6e338d5c03499b44727b6829e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78cd9a6e338d5c03499b44727b6829e">&#9670;&nbsp;</a></span>rcvAdvSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvAdvSignal = registerSignal(&quot;rcvAdv&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd()</a>.</p>

</div>
</div>
<a id="a0bc96352a49004dc0f7125028939c117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bc96352a49004dc0f7125028939c117">&#9670;&nbsp;</a></span>rcvNASegSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvNASegSignal = registerSignal(&quot;rcvNASeg&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="aec3b4ea0c2712f557e5a68165b8b082e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3b4ea0c2712f557e5a68165b8b082e">&#9670;&nbsp;</a></span>rcvOooSegSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvOooSegSignal = registerSignal(&quot;rcvOooSeg&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>.</p>

</div>
</div>
<a id="a6dcf210a8d13372804d8011739117f97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dcf210a8d13372804d8011739117f97">&#9670;&nbsp;</a></span>rcvSacksSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvSacksSignal = registerSignal(&quot;rcvSacks&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption()</a>.</p>

</div>
</div>
<a id="ac3547269704c3b79daf67827bb5eefd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3547269704c3b79daf67827bb5eefd8">&#9670;&nbsp;</a></span>rcvSeqSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvSeqSignal = registerSignal(&quot;rcvSeq&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>.</p>

</div>
</div>
<a id="a7c980dc89305fbe03d5450934859d1f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c980dc89305fbe03d5450934859d1f4">&#9670;&nbsp;</a></span>rcvWndSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::rcvWndSignal = registerSignal(&quot;rcvWnd&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd()</a>.</p>

</div>
</div>
<a id="aa817b5fce2fa957353f76dc00bb59060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa817b5fce2fa957353f76dc00bb59060">&#9670;&nbsp;</a></span>receiveQueue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_receive_queue.html">TcpReceiveQueue</a>* inet::tcp::TcpConnection::receiveQueue = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">addSacks()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="a7166c0d1e3090b61c90b179c82f60730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7166c0d1e3090b61c90b179c82f60730">&#9670;&nbsp;</a></span>remoteAddr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_l3_address.html">L3Address</a> inet::tcp::TcpConnection::remoteAddr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">inet::tcp::Tcp::addSockPair()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">inet::tcp::Tcp::removeConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">inet::tcp::Tcp::updateSockPair()</a>.</p>

</div>
</div>
<a id="ad76dc793cff441a2e7b3c206c8389dea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76dc793cff441a2e7b3c206c8389dea">&#9670;&nbsp;</a></span>remotePort</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::remotePort = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">inet::tcp::Tcp::addSockPair()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a62437fe059a142794609ed08cde88375">processTCPSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">inet::tcp::Tcp::removeConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">sendRst()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">inet::tcp::Tcp::updateSockPair()</a>.</p>

</div>
</div>
<a id="a37e2a54894d305fb793ce1c5fa00ed70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e2a54894d305fb793ce1c5fa00ed70">&#9670;&nbsp;</a></span>rexmitQueue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html">TcpSackRexmitQueue</a>* inet::tcp::TcpConnection::rexmitQueue = nullptr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">nextSeg()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_base_alg.html#a1ff5c2c9d5fa9cc0139e05e6c4b87c18">inet::tcp::TcpBaseAlg::processRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">processRstInSynReceived()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a10f756bb8ffed7eb3412c399405d942c">setPipe()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="a18c00a2d63feb44e9c7d5ae6bf0a2af6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18c00a2d63feb44e9c7d5ae6bf0a2af6">&#9670;&nbsp;</a></span>sackedBytesSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::sackedBytesSignal = registerSignal(&quot;sackedBytes&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption()</a>.</p>

</div>
</div>
<a id="af5a106f1b332763f61f14022eeb80ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a106f1b332763f61f14022eeb80ed8">&#9670;&nbsp;</a></span>sendQueue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_send_queue.html">TcpSendQueue</a>* inet::tcp::TcpConnection::sendQueue = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af77fb1b6498d8690a77d6a7cb4ca7cc5">isSendQueueEmpty()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">nextSeg()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">processRstInSynReceived()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">sendOneNewSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">sendProbe()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="ac8999bc036241c07295cea07f6b069c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8999bc036241c07295cea07f6b069c2">&#9670;&nbsp;</a></span>sndAckSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::sndAckSignal = registerSignal(&quot;sndAck&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="a1f4034777ecaed134ee827b75c30a3aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4034777ecaed134ee827b75c30a3aa">&#9670;&nbsp;</a></span>sndNxtSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::sndNxtSignal = registerSignal(&quot;sndNxt&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="aff166b9e7e6ee791b56a161fc8dd86d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff166b9e7e6ee791b56a161fc8dd86d3">&#9670;&nbsp;</a></span>sndSacksSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::sndSacksSignal = registerSignal(&quot;sndSacks&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">addSacks()</a>.</p>

</div>
</div>
<a id="a0def5a11ed40d33fa6821c79cc1b2533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0def5a11ed40d33fa6821c79cc1b2533">&#9670;&nbsp;</a></span>sndWndSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::sndWndSignal = registerSignal(&quot;sndWnd&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo()</a>.</p>

</div>
</div>
<a id="a97ba97acbd81b0f689af1978c5bd02c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97ba97acbd81b0f689af1978c5bd02c1">&#9670;&nbsp;</a></span>socketId</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::socketId = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp.html#aed295470331cb4e1267b2e67ab7f2610">inet::tcp::Tcp::addForkedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="namespaceinet_1_1tcp.html#a214d8e62bc922b8a2bb61dcda81daede">inet::tcp::operator&lt;&lt;()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">printConnBrief()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">inet::tcp::Tcp::removeConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">sendAvailableIndicationToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">sendEstabIndicationToApp()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">sendIndicationToApp()</a>.</p>

</div>
</div>
<a id="ab0055a12446dba0c431b0fd1b46a2a72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0055a12446dba0c431b0fd1b46a2a72">&#9670;&nbsp;</a></span>state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_state_variables.html">TcpStateVariables</a>* inet::tcp::TcpConnection::state = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">addSacks()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">configureStateVariables()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">hasEnoughSpaceForSegmentInReceiveQueue()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">isLost()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a776e9ca5b96407bb3aa8f29e65087901">isSegmentAcceptable()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af77fb1b6498d8690a77d6a7cb4ca7cc5">isSendQueueEmpty()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">nextSeg()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2b488f6cdc47ab4b57e2e5ee898b8b61">process_ABORT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e62607e3fbab7f504b3f7dab879bf67">process_QUEUE_BYTES_LIMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">process_READ_REQUEST()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">process_STATUS()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a95b7233ca8183973b60c88e1f955993c">processMSSOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">processRstInSynReceived()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">processSACKOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a98ad81d8ce1e5dbfd40bd83a34b6d340">processSACKPermittedOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a34be7e48b4ab7e1c189665d61b1e9e47">processTSOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c7bc93c84a410a40ceefee26e61196">processWSOption()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a76270b2436749dcdde9c22b4553f6082">segmentArrivalWhileClosed()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">selectInitialSeqNum()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac07f0b0d5d9b7e0e3a677e6d458cf98c">sendDataDuringLossRecoveryPhase()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">sendOneNewSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">sendProbe()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">sendSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a10f756bb8ffed7eb3412c399405d942c">setPipe()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">stateName()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">updateRcvWnd()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">updateWndInfo()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">writeHeaderOptions()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="ab29c1ca6f5d0e6bd292dc0e482cda96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab29c1ca6f5d0e6bd292dc0e482cda96b">&#9670;&nbsp;</a></span>stateSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::stateSignal = registerSignal(&quot;state&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae726cf09a498dcd0b25a8f57f6aa3d99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae726cf09a498dcd0b25a8f57f6aa3d99">&#9670;&nbsp;</a></span>synRexmitTimer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* inet::tcp::TcpConnection::synRexmitTimer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">startSynRexmitTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="aaae281a0487887d96eb74249ad0fdeb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaae281a0487887d96eb74249ad0fdeb9">&#9670;&nbsp;</a></span>tcpAlgorithm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp_algorithm.html">TcpAlgorithm</a>* inet::tcp::TcpConnection::tcpAlgorithm = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a19a634fbbac40c82d92c32505d377132">initClonedConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">sendAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">sendFin()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">sendOneNewSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">sendProbe()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">sendRstAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">sendSynAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="a5e2b660adffd4b9119385c39871371ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e2b660adffd4b9119385c39871371ea">&#9670;&nbsp;</a></span>tcpConnectionAddedSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::tcpConnectionAddedSignal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2c501d49303a5912f9d792ddabd2ddfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c501d49303a5912f9d792ddabd2ddfb">&#9670;&nbsp;</a></span>tcpMain</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1tcp_1_1_tcp.html">Tcp</a>* inet::tcp::TcpConnection::tcpMain = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa44320887baf414d8265c95fa11bba60">cloneListeningConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">configureStateVariables()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a664c9361c7066546477350ca08f1d07d">handleMessage()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">performStateTransition()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#afcf0d25d019cbe6eed624fa9e6644fc8">preanalyseAppCommandEvent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">process_OPEN_ACTIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">process_OPEN_PASSIVE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">process_SEND()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad27c319b03d76159b21f347b1eaf9533">process_TIMEOUT_2MSL()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8aed4b95f11d1397db07461cd7c997ee">process_TIMEOUT_FIN_WAIT_2()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a97136ad66744c500a7c4f41e12dc27dd">processAppCommand()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">processSegmentInListen()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">sendAvailableDataToApp()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a0164100bb7b0722aafb91edadc87b903">sendRst()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">sendRstAck()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">sendSyn()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">sendToApp()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="ab2eacb280f6191279ce691f539f6828b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2eacb280f6191279ce691f539f6828b">&#9670;&nbsp;</a></span>tcpRcvPayloadBytesSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::tcpRcvPayloadBytesSignal = registerSignal(&quot;tcpRcvPayloadBytes&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">process_RCV_SEGMENT()</a>.</p>

</div>
</div>
<a id="a97c136fdf02b4cdaa010d86105aac3f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97c136fdf02b4cdaa010d86105aac3f9">&#9670;&nbsp;</a></span>tcpRcvQueueBytesSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::tcpRcvQueueBytesSignal = registerSignal(&quot;tcpRcvQueueBytes&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">updateRcvQueueVars()</a>.</p>

</div>
</div>
<a id="a542b0e99a7d17e907190003038443894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a542b0e99a7d17e907190003038443894">&#9670;&nbsp;</a></span>tcpRcvQueueDropsSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::tcpRcvQueueDropsSignal = registerSignal(&quot;tcpRcvQueueDrops&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">processSegmentInSynSent()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">processSynInListen()</a>.</p>

</div>
</div>
<a id="a9427c96c47960d86c30f2addbee224c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9427c96c47960d86c30f2addbee224c0">&#9670;&nbsp;</a></span>the2MSLTimer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* inet::tcp::TcpConnection::the2MSLTimer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ad00520df766c10bd488edb877824256f">initConnection()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">processSegment1stThru8th()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">processTimer()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">stateEntered()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a456bd2fe74982d05486d3d0008d72f2b">~TcpConnection()</a>.</p>

</div>
</div>
<a id="a740f9d67c4d45e9037f2b12b392568c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a740f9d67c4d45e9037f2b12b392568c4">&#9670;&nbsp;</a></span>tos</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short inet::tcp::TcpConnection::tos = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a85992dfca295a0ab3240f0ec1650ebd6">process_OPTIONS()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="a5ecf5464de1b085c557ac7d2d15220d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ecf5464de1b085c557ac7d2d15220d6">&#9670;&nbsp;</a></span>ttl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int inet::tcp::TcpConnection::ttl = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="namespaceinet_1_1tcp.html#a214d8e62bc922b8a2bb61dcda81daede">inet::tcp::operator&lt;&lt;()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a85992dfca295a0ab3240f0ec1650ebd6">process_OPTIONS()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">sendToIP()</a>.</p>

</div>
</div>
<a id="a0b59c4b6eca46a2a341d73178ade5934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b59c4b6eca46a2a341d73178ade5934">&#9670;&nbsp;</a></span>unackedSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::tcp::TcpConnection::unackedSignal = registerSignal(&quot;unacked&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">process_CLOSE()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">processAckInEstabEtc()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a69d92cf8b5ea339a828b34b33fc102a3">retransmitData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a93c2dec9ae82329e76fa37c0bf6ea730">retransmitOneSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a2d63bfdd2c222e3898a922e1cd35c117">sendData()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#ac98e6eb26dabef91260e4ea36e70ccbd">sendOneNewSegment()</a>, <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#a53293619e77207f0f2efb029da9ea37c">sendProbe()</a>, and <a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">sendSegmentDuringLossRecoveryPhase()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_tcp_connection_8h.html">TcpConnection.h</a></li>
<li><a class="el" href="_tcp_connection_base_8cc.html">TcpConnectionBase.cc</a></li>
<li><a class="el" href="_tcp_connection_event_proc_8cc.html">TcpConnectionEventProc.cc</a></li>
<li><a class="el" href="_tcp_connection_rcv_segment_8cc.html">TcpConnectionRcvSegment.cc</a></li>
<li><a class="el" href="_tcp_connection_sack_util_8cc.html">TcpConnectionSackUtil.cc</a></li>
<li><a class="el" href="_tcp_connection_util_8cc.html">TcpConnectionUtil.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aaf19192f797b153d7fcd7b760c469090a"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaf19192f797b153d7fcd7b760c469090a">inet::TCP_I_TIMED_OUT</a></div><div class="ttdeci">@ TCP_I_TIMED_OUT</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:133</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_afaf1fe106e54ec80d28d242823e55ce7"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#afaf1fe106e54ec80d28d242823e55ce7">inet::tcp::TcpConnection::finWait2Timer</a></div><div class="ttdeci">cMessage * finWait2Timer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:384</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a8aed4b95f11d1397db07461cd7c997ee"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a8aed4b95f11d1397db07461cd7c997ee">inet::tcp::TcpConnection::process_TIMEOUT_FIN_WAIT_2</a></div><div class="ttdeci">virtual void process_TIMEOUT_FIN_WAIT_2()</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1317</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a3f5fd4073ff476bb21d6e1d3c7ef676f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3f5fd4073ff476bb21d6e1d3c7ef676f">inet::tcp::TcpStateVariables::ws_manual_scale</a></div><div class="ttdeci">int ws_manual_scale</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:199</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aabd8ed80ff738d460b3fcf46ac569d32"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aabd8ed80ff738d460b3fcf46ac569d32">inet::tcp::TcpStateVariables::str</a></div><div class="ttdeci">virtual std::string str() const override</div><div class="ttdef"><b>Definition:</b> TcpConnectionBase.cc:144</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a97f166dcdb24cb42e0824417b3a089f4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a97f166dcdb24cb42e0824417b3a089f4">inet::tcp::TcpConnection::getTSval</a></div><div class="ttdeci">virtual uint32_t getTSval(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader) const</div><div class="ttdoc">Utility: get TSval from segments TS header option.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1404</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ab2eacb280f6191279ce691f539f6828b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ab2eacb280f6191279ce691f539f6828b">inet::tcp::TcpConnection::tcpRcvPayloadBytesSignal</a></div><div class="ttdeci">static simsignal_t tcpRcvPayloadBytesSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:334</div></div>
<div class="ttc" id="anamespaceinet_html_a3de731dd41ee41b66d326c7a7e851ce3"><div class="ttname"><a href="namespaceinet.html#a3de731dd41ee41b66d326c7a7e851ce3">inet::ulong</a></div><div class="ttdeci">unsigned long ulong</div><div class="ttdef"><b>Definition:</b> INETDefs.h:56</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a6dcf210a8d13372804d8011739117f97"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a6dcf210a8d13372804d8011739117f97">inet::tcp::TcpConnection::rcvSacksSignal</a></div><div class="ttdeci">static simsignal_t rcvSacksSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:328</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa41b2cd9b54a275b28246d319ba690d7"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa41b2cd9b54a275b28246d319ba690d7">inet::tcp::TcpConnection::processTimer</a></div><div class="ttdeci">virtual bool processTimer(cMessage *msg)</div><div class="ttdoc">Process self-messages (timers).</div><div class="ttdef"><b>Definition:</b> TcpConnectionBase.cc:249</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea3e08974a4dc6d2b2457250733ad0dc08"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3e08974a4dc6d2b2457250733ad0dc08">inet::tcp::TCP_E_SETOPTION</a></div><div class="ttdeci">@ TCP_E_SETOPTION</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:80</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a37961d5bbfbf8fb75b90f08787bfc6be"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a37961d5bbfbf8fb75b90f08787bfc6be">inet::tcp::TcpAlgorithm::receivedOutOfOrderSegment</a></div><div class="ttdeci">virtual void receivedOutOfOrderSegment()=0</div><div class="ttdoc">Called after receiving data which are in the window, but not at its left edge (seq !...</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a89fb3bba962a1f9b37c4139066fd5851"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a89fb3bba962a1f9b37c4139066fd5851">inet::tcp::TcpConnection::processSegment1stThru8th</a></div><div class="ttdeci">virtual TcpEventCode processSegment1stThru8th(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:125</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_a512458671be6d68703cc89178b0b35f0"><div class="ttname"><a href="_tcp_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a></div><div class="ttdeci">#define TCP_TIMEOUT_CONN_ESTAB</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:104</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea659bff1e5d75352885b205513466ccd1"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea659bff1e5d75352885b205513466ccd1">inet::tcp::TCP_E_TIMEOUT_CONN_ESTAB</a></div><div class="ttdeci">@ TCP_E_TIMEOUT_CONN_ESTAB</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:95</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ae82e69467fe1056d434778c37fcb149d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae82e69467fe1056d434778c37fcb149d">inet::tcp::TcpAlgorithm::dataSent</a></div><div class="ttdeci">virtual void dataSent(uint32_t fromseq)=0</div><div class="ttdoc">Called after we sent data.</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5ae314e77267ad22558fc37928bc2e90b5"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5ae314e77267ad22558fc37928bc2e90b5">inet::TCP_C_QUEUE_BYTES_LIMIT</a></div><div class="ttdeci">@ TCP_C_QUEUE_BYTES_LIMIT</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:89</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a89550bcce84f2e8fea39fd7fccfbcf45"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a89550bcce84f2e8fea39fd7fccfbcf45">inet::tcp::TcpStateVariables::full_sized_segment_counter</a></div><div class="ttdeci">uint32_t full_sized_segment_counter</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:184</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_aed295470331cb4e1267b2e67ab7f2610"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#aed295470331cb4e1267b2e67ab7f2610">inet::tcp::Tcp::addForkedConnection</a></div><div class="ttdeci">virtual void addForkedConnection(TcpConnection *conn, TcpConnection *newConn, L3Address localAddr, L3Address remoteAddr, int localPort, int remotePort)</div><div class="ttdoc">Update conn's socket pair, and register newConn (which'll keep LISTENing).</div><div class="ttdef"><b>Definition:</b> Tcp.cc:295</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ab0055a12446dba0c431b0fd1b46a2a72"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ab0055a12446dba0c431b0fd1b46a2a72">inet::tcp::TcpConnection::state</a></div><div class="ttdeci">TcpStateVariables * state</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:364</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5aec4bfeca3e832ec792bdc9a4c0870dc5"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5aec4bfeca3e832ec792bdc9a4c0870dc5">inet::TCP_C_SETOPTION</a></div><div class="ttdeci">@ TCP_C_SETOPTION</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:92</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a6f6714ac3137d36f95dc2deaf8ba1c16"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a6f6714ac3137d36f95dc2deaf8ba1c16">inet::tcp::TcpConnection::process_TIMEOUT_CONN_ESTAB</a></div><div class="ttdeci">virtual void process_TIMEOUT_CONN_ESTAB()</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1275</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_aa8d33ebb463f4c8cfcc824c7c8c3aeee"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#aa8d33ebb463f4c8cfcc824c7c8c3aeee">inet::tcp::TcpSackRexmitQueue::setSackedBit</a></div><div class="ttdeci">virtual void setSackedBit(uint32_t fromSeqNum, uint32_t toSeqNum)</div><div class="ttdoc">Called when data sender received selective acknowledgments.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:177</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad8279e9052ae1d273ace989e9ab659c8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad8279e9052ae1d273ace989e9ab659c8">inet::tcp::TcpConnection::performStateTransition</a></div><div class="ttdeci">virtual bool performStateTransition(const TcpEventCode &amp;event)</div><div class="ttdoc">Implemements the pure TCP state machine.</div><div class="ttdef"><b>Definition:</b> TcpConnectionBase.cc:414</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a72ce7064a43596a206b1737e8fcffeaf"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a72ce7064a43596a206b1737e8fcffeaf">inet::tcp::TcpStateVariables::fin_ack_rcvd</a></div><div class="ttdeci">bool fin_ack_rcvd</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:171</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a6b9b8721038abecf3e397a2743bace39"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a6b9b8721038abecf3e397a2743bace39">inet::tcp::TCP_MAX_HEADER_LENGTH</a></div><div class="ttdeci">const B TCP_MAX_HEADER_LENGTH</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:64</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_aa64ef9fd85c8ff6dd25d746dbf831e1c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#aa64ef9fd85c8ff6dd25d746dbf831e1c">inet::tcp::TcpAlgorithm::established</a></div><div class="ttdeci">virtual void established(bool active)=0</div><div class="ttdoc">Called when the connection is going to ESTABLISHED from SYN_SENT or SYN_RCVD.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a0def5a11ed40d33fa6821c79cc1b2533"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a0def5a11ed40d33fa6821c79cc1b2533">inet::tcp::TcpConnection::sndWndSignal</a></div><div class="ttdeci">static simsignal_t sndWndSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:317</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac60a7ea5cb157c0bb34372eca11b40c2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac60a7ea5cb157c0bb34372eca11b40c2">inet::tcp::TcpConnection::startSynRexmitTimer</a></div><div class="ttdeci">virtual void startSynRexmitTimer()</div><div class="ttdoc">Utility: start SYN-REXMIT timer.</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1332</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad9f6b1407d6fb4da74a027d4f4c22aad"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad9f6b1407d6fb4da74a027d4f4c22aad">inet::tcp::TcpConnection::isToBeAccepted</a></div><div class="ttdeci">virtual bool isToBeAccepted() const</div><div class="ttdoc">Utility: returns true if the connection is not yet accepted by the application.</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:489</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a6307696102916780d29b5d74ae12930e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a6307696102916780d29b5d74ae12930e">inet::tcp::TcpConnection::process_DESTROY</a></div><div class="ttdeci">virtual void process_DESTROY(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:276</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa59d453e9968e0d5bbe7ed3daffe5da0b"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa59d453e9968e0d5bbe7ed3daffe5da0b">inet::TCP_I_CLOSED</a></div><div class="ttdeci">@ TCP_I_CLOSED</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:130</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac6da67049d73d31f5cc957232e8c3600"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac6da67049d73d31f5cc957232e8c3600">inet::tcp::TcpConnection::isLost</a></div><div class="ttdeci">virtual bool isLost(uint32_t seqNum)</div><div class="ttdoc">For SACK TCP.</div><div class="ttdef"><b>Definition:</b> TcpConnectionSackUtil.cc:123</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a8890d4306e6be47ba796a26fbaa3129d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8890d4306e6be47ba796a26fbaa3129d">inet::tcp::TcpStateVariables::rcv_naseg</a></div><div class="ttdeci">uint32_t rcv_naseg</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:240</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea010cd4a0a82a1dbc9beb246081ecc88b"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea010cd4a0a82a1dbc9beb246081ecc88b">inet::tcp::TCP_E_RCV_SYN_ACK</a></div><div class="ttdeci">@ TCP_E_RCV_SYN_ACK</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:86</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_a0b48410b2bd35dbc6509568bfb1842aa"><div class="ttname"><a href="_tcp_connection_8h.html#a0b48410b2bd35dbc6509568bfb1842aa">TCP_TIMEOUT_SYN_REXMIT_MAX</a></div><div class="ttdeci">#define TCP_TIMEOUT_SYN_REXMIT_MAX</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:107</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa8c2448573eb3e4c89ac289595e12598"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa8c2448573eb3e4c89ac289595e12598">inet::tcp::TcpConnection::addSacks</a></div><div class="ttdeci">virtual TcpHeader addSacks(const Ptr&lt; TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Utility: adds SACKs to segments header options field.</div><div class="ttdef"><b>Definition:</b> TcpConnectionSackUtil.cc:430</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a776e9ca5b96407bb3aa8f29e65087901"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a776e9ca5b96407bb3aa8f29e65087901">inet::tcp::TcpConnection::isSegmentAcceptable</a></div><div class="ttdeci">virtual bool isSegmentAcceptable(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader) const</div><div class="ttdoc">Utility: check if segment is acceptable (all bytes are in receive window)</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:486</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea0385b3f6612c766df9a009506249109f"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea0385b3f6612c766df9a009506249109f">inet::tcp::TCP_E_RCV_FIN_ACK</a></div><div class="ttdeci">@ TCP_E_RCV_FIN_ACK</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:88</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a4c2b3d6a2cb7c47354493c67c144e0cf"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a4c2b3d6a2cb7c47354493c67c144e0cf">inet::tcp::TcpAlgorithm::initialize</a></div><div class="ttdeci">virtual void initialize()</div><div class="ttdoc">Should be redefined to initialize the object: create timers, etc.</div><div class="ttdef"><b>Definition:</b> TcpAlgorithm.h:70</div></div>
<div class="ttc" id="anamespaceinet_html_ac8175ca68b0984f2ed7c1362f8c6955daf4ecd7b6e34e6330e2ffa75ca3462a1c"><div class="ttname"><a href="namespaceinet.html#ac8175ca68b0984f2ed7c1362f8c6955daf4ecd7b6e34e6330e2ffa75ca3462a1c">inet::IP_ECN_NOT_ECT</a></div><div class="ttdeci">@ IP_ECN_NOT_ECT</div><div class="ttdef"><b>Definition:</b> EcnTag_m.h:59</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_a461031ff2d9e90352ad181ddcc2ad5ab"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#a461031ff2d9e90352ad181ddcc2ad5ab">inet::tcp::TcpSendQueue::getBufferStartSeq</a></div><div class="ttdeci">virtual uint32_t getBufferStartSeq() const</div><div class="ttdoc">Returns the sequence number of the first byte stored in the buffer.</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:47</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a5f9c870db993a6094293e39b9a5756e2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a5f9c870db993a6094293e39b9a5756e2">inet::tcp::TcpSackRexmitQueue::detailedInfo</a></div><div class="ttdeci">virtual std::string detailedInfo() const</div><div class="ttdoc">Prints the current rexmitQueue status for debug purposes.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:40</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aa989b9d885f28bc180e2833483decb81"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa989b9d885f28bc180e2833483decb81">inet::tcp::TcpStateVariables::limited_transmit_enabled</a></div><div class="ttdeci">bool limited_transmit_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:181</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a782499aa10f8b3086f02542da75b7057"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a782499aa10f8b3086f02542da75b7057">inet::tcp::TcpConnection::getState</a></div><div class="ttdeci">const TcpStateVariables * getState() const</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:613</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_ab5dd93208f2f4f76b6454ef6b6a37f0c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#ab5dd93208f2f4f76b6454ef6b6a37f0c">inet::tcp::TcpSendQueue::createSegmentWithBytes</a></div><div class="ttdeci">virtual Packet * createSegmentWithBytes(uint32_t fromSeq, uint32_t numBytes)</div><div class="ttdoc">Called when the TCP wants to send or retransmit data, it constructs a TCP segment which contains the ...</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:62</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a080c497238ecf4e48b128a09ae2a6e7c"><div class="ttname"><a href="_i_udp-gates_8txt.html#a080c497238ecf4e48b128a09ae2a6e7c">DscpReq</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down DscpReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_a26da52f8b2bd74d1af60431e3bc4621c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#a26da52f8b2bd74d1af60431e3bc4621c">inet::tcp::Tcp::updateSockPair</a></div><div class="ttdeci">virtual void updateSockPair(TcpConnection *conn, L3Address localAddr, L3Address remoteAddr, int localPort, int remotePort)</div><div class="ttdoc">To be called from TcpConnection when socket pair (key for TcpConnMap) changes (e.g.</div><div class="ttdef"><b>Definition:</b> Tcp.cc:333</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac16044dfebbb178c5941ab62380b8601"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac16044dfebbb178c5941ab62380b8601">inet::tcp::TcpConnection::sendAck</a></div><div class="ttdeci">virtual void sendAck()</div><div class="ttdoc">Utility: send ACK.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:679</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ae10b0c0c2dbc3e7ba77f5c6fcda74e0d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae10b0c0c2dbc3e7ba77f5c6fcda74e0d">inet::tcp::TcpAlgorithm::receivedDuplicateAck</a></div><div class="ttdeci">virtual void receivedDuplicateAck()=0</div><div class="ttdoc">Called after we received a duplicate ACK (that is: ackNo == snd_una, no data in segment,...</div></div>
<div class="ttc" id="aclassinet_1_1_protocol_html_ac274a953c505bbf6835122da65358a57"><div class="ttname"><a href="classinet_1_1_protocol.html#ac274a953c505bbf6835122da65358a57">inet::Protocol::tcp</a></div><div class="ttdeci">static const Protocol tcp</div><div class="ttdef"><b>Definition:</b> Protocol.h:112</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aabebb8b876d14aa2de8ec16a07a64fc0c"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabebb8b876d14aa2de8ec16a07a64fc0c">inet::TCP_I_ESTABLISHED</a></div><div class="ttdeci">@ TCP_I_ESTABLISHED</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:128</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a7eb95b359f06b1ff3cf47288ed6fa28b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7eb95b359f06b1ff3cf47288ed6fa28b">inet::tcp::TcpStateVariables::start_seqno</a></div><div class="ttdeci">uint32_t start_seqno</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:219</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a5530cca4250bca0af7fbe79712dd03d8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5530cca4250bca0af7fbe79712dd03d8">inet::tcp::TcpStateVariables::ts_recent</a></div><div class="ttdeci">uint32_t ts_recent</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:210</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a34be7e48b4ab7e1c189665d61b1e9e47"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a34be7e48b4ab7e1c189665d61b1e9e47">inet::tcp::TcpConnection::processTSOption</a></div><div class="ttdeci">virtual bool processTSOption(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, const TcpOptionTimestamp &amp;option)</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1174</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a0416c97da1b894d6199f133509e8ada3"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a0416c97da1b894d6199f133509e8ada3">inet::tcp::TcpConnection::setSocketId</a></div><div class="ttdeci">void setSocketId(int newSocketId)</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:339</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a5594138f315ab12573fac280ec05ed4e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a5594138f315ab12573fac280ec05ed4e">inet::tcp::TcpAlgorithm::processTimer</a></div><div class="ttdeci">virtual void processTimer(cMessage *timer, TcpEventCode &amp;event)=0</div><div class="ttdoc">Place to process timers specific to this TcpAlgorithm class.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ab964376b0e8842da819d5d93e9de6583"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab964376b0e8842da819d5d93e9de6583">inet::tcp::TcpStateVariables::snd_initial_ts</a></div><div class="ttdeci">bool snd_initial_ts</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:208</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a04ee56c7b417ea59a1fd3856beeb284e"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a04ee56c7b417ea59a1fd3856beeb284e">inet::tcp::TCP_OPTION_HEAD_SIZE</a></div><div class="ttdeci">const B TCP_OPTION_HEAD_SIZE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:67</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a69f034cb5f674f2554d4d3b59477b7d8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a69f034cb5f674f2554d4d3b59477b7d8">inet::tcp::TcpConnection::rcvAckSignal</a></div><div class="ttdeci">static simsignal_t rcvAckSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:323</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa9e2c7e2c00d063a782808ab9f3bbccf"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa9e2c7e2c00d063a782808ab9f3bbccf">inet::tcp::TcpConnection::sendRst</a></div><div class="ttdeci">virtual void sendRst(uint32_t seqNo)</div><div class="ttdoc">Utility: sends RST.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:632</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ad5411009fe0168685672cebf801292d1"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad5411009fe0168685672cebf801292d1">inet::tcp::TcpAlgorithm::rttMeasurementCompleteUsingTS</a></div><div class="ttdeci">virtual void rttMeasurementCompleteUsingTS(uint32_t echoedTS)=0</div><div class="ttdoc">Converting uint32_t echoedTS to simtime_t and calling rttMeasurementComplete() to update state vars w...</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa85246db1cb61179ad34ebd92dd2bef01"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa85246db1cb61179ad34ebd92dd2bef01">inet::TCP_I_PEER_CLOSED</a></div><div class="ttdeci">@ TCP_I_PEER_CLOSED</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:129</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a2b488f6cdc47ab4b57e2e5ee898b8b61"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a2b488f6cdc47ab4b57e2e5ee898b8b61">inet::tcp::TcpConnection::process_ABORT</a></div><div class="ttdeci">virtual void process_ABORT(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:247</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a18146352d563b0d92be9659f9f4b857b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a18146352d563b0d92be9659f9f4b857b">inet::tcp::TcpStateVariables::ws_support</a></div><div class="ttdeci">bool ws_support</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:197</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a73af1cd2c10f505af1e9e9bd762b3476"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a73af1cd2c10f505af1e9e9bd762b3476">inet::tcp::TcpStateVariables::snd_dsack</a></div><div class="ttdeci">bool snd_dsack</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:222</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a5f06b20358ab5338c8af2490541dc724"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a5f06b20358ab5338c8af2490541dc724">inet::tcp::TcpStateVariables::rcv_ws</a></div><div class="ttdeci">bool rcv_ws</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:201</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a3d0933262abc7132bb14c2856e3b1c80"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a3d0933262abc7132bb14c2856e3b1c80">inet::tcp::TcpStateVariables::rcv_wnd</a></div><div class="ttdeci">uint32_t rcv_wnd</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:158</div></div>
<div class="ttc" id="anamespaceinet_1_1sctp_html_a58955dacfac2b3f8a497c845473af3c2"><div class="ttname"><a href="namespaceinet_1_1sctp.html#a58955dacfac2b3f8a497c845473af3c2">inet::sctp::min</a></div><div class="ttdeci">double min(const double a, const double b)</div><div class="ttdoc">Returns the minimum of a and b.</div><div class="ttdef"><b>Definition:</b> SctpAssociation.h:261</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a0fbf27a7d9162dae1b3b94e034a1afbd"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fbf27a7d9162dae1b3b94e034a1afbd">inet::tcp::TcpStateVariables::freeRcvBuffer</a></div><div class="ttdeci">uint32_t freeRcvBuffer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:245</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ae210d49b6a35e60b8e31fb3bf41f5014"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae210d49b6a35e60b8e31fb3bf41f5014">inet::tcp::TcpStateVariables::dupacks</a></div><div class="ttdeci">uint32_t dupacks</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:236</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_a3aa50e2b4cb4448423fbb3d5186d904d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#a3aa50e2b4cb4448423fbb3d5186d904d">inet::tcp::Tcp::removeConnection</a></div><div class="ttdeci">virtual void removeConnection(TcpConnection *conn)</div><div class="ttdef"><b>Definition:</b> Tcp.cc:198</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa44320887baf414d8265c95fa11bba60"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa44320887baf414d8265c95fa11bba60">inet::tcp::TcpConnection::cloneListeningConnection</a></div><div class="ttdeci">virtual TcpConnection * cloneListeningConnection()</div><div class="ttdoc">Utility: clone a listening connection.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:234</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_afd54e2ff988fa1dc58b8f25bd082ab86"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#afd54e2ff988fa1dc58b8f25bd082ab86">inet::tcp::TcpConnection::TcpConnection</a></div><div class="ttdeci">TcpConnection()</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:582</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a82acc05161ee0832163008c99475e207"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a82acc05161ee0832163008c99475e207">inet::tcp::TcpStateVariables::sackedBytes</a></div><div class="ttdeci">uint32_t sackedBytes</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:227</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aaf61d50c3b88381e42a2fa7fd56980b5"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaf61d50c3b88381e42a2fa7fd56980b5">inet::tcp::TcpStateVariables::rcv_sacks</a></div><div class="ttdeci">uint32_t rcv_sacks</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:238</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa817b5fce2fa957353f76dc00bb59060"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa817b5fce2fa957353f76dc00bb59060">inet::tcp::TcpConnection::receiveQueue</a></div><div class="ttdeci">TcpReceiveQueue * receiveQueue</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:369</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a1c522a4f856714ffaaaef933c731b149"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a1c522a4f856714ffaaaef933c731b149">inet::tcp::TcpAlgorithm::connectionClosed</a></div><div class="ttdeci">virtual void connectionClosed()=0</div><div class="ttdoc">Called when the connection closes, it should cancel all running timers.</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa1958c2474a2126a9951293ed0f76dbfc"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa1958c2474a2126a9951293ed0f76dbfc">inet::TCP_I_AVAILABLE</a></div><div class="ttdeci">@ TCP_I_AVAILABLE</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:127</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ab77b0cf9754e394332dd36cc610e3bfc"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ab77b0cf9754e394332dd36cc610e3bfc">inet::tcp::TcpConnection::sendToApp</a></div><div class="ttdeci">virtual void sendToApp(cMessage *msg)</div><div class="ttdoc">Utility: sends packet to application.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:382</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a4ac9ad945591c08823ca4c196003a1ae"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a4ac9ad945591c08823ca4c196003a1ae">inet::tcp::TcpConnection::process_READ_REQUEST</a></div><div class="ttdeci">virtual void process_READ_REQUEST(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:159</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea161bbf5e847d77c5eec03e1f32790f4d">inet::tcp::TCP_E_IGNORE</a></div><div class="ttdeci">@ TCP_E_IGNORE</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:66</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_aaba0cc129b1179a7ecd6ad5b2b5a12ca"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#aaba0cc129b1179a7ecd6ad5b2b5a12ca">inet::tcp::Tcp::crcMode</a></div><div class="ttdeci">CrcMode crcMode</div><div class="ttdef"><b>Definition:</b> Tcp.h:135</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_acc4b52c9e9becab1674bdbf2e7b4164e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#acc4b52c9e9becab1674bdbf2e7b4164e">inet::tcp::TcpConnection::sendSegmentDuringLossRecoveryPhase</a></div><div class="ttdeci">virtual uint32_t sendSegmentDuringLossRecoveryPhase(uint32_t seqNum)</div><div class="ttdoc">Utility: send segment during Loss Recovery phase (if SACK is enabled).</div><div class="ttdef"><b>Definition:</b> TcpConnectionSackUtil.cc:360</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a0323ac93ca7b779d82d9fb23cd4c8681"><div class="ttname"><a href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down DispatchProtocolReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_afd6c47733a16ee555d6b384bd7712aed"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#afd6c47733a16ee555d6b384bd7712aed">inet::tcp::TcpReceiveQueue::extractBytesUpTo</a></div><div class="ttdeci">virtual Packet * extractBytesUpTo(uint32_t seq)</div><div class="ttdoc">Should create a packet to be passed up to the app, up to (but NOT including) the given sequence no (u...</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:80</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a7c980dc89305fbe03d5450934859d1f4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a7c980dc89305fbe03d5450934859d1f4">inet::tcp::TcpConnection::rcvWndSignal</a></div><div class="ttdeci">static simsignal_t rcvWndSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:318</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aaae281a0487887d96eb74249ad0fdeb9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aaae281a0487887d96eb74249ad0fdeb9">inet::tcp::TcpConnection::tcpAlgorithm</a></div><div class="ttdeci">TcpAlgorithm * tcpAlgorithm</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:378</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aaab66e3a27082da1bacda4d93b866b38"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaab66e3a27082da1bacda4d93b866b38">inet::tcp::TcpStateVariables::sack_support</a></div><div class="ttdeci">bool sack_support</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:215</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_abf35587592ab9d453d578f11aff135c4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#abf35587592ab9d453d578f11aff135c4">inet::tcp::Tcp::createReceiveQueue</a></div><div class="ttdeci">virtual TcpReceiveQueue * createReceiveQueue()</div><div class="ttdoc">To be called from TcpConnection: create a new receive queue.</div><div class="ttdef"><b>Definition:</b> Tcp.cc:363</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a68dc46455682e7d2ac229f09371342b5"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a68dc46455682e7d2ac229f09371342b5">inet::tcp::TcpConnection::process_OPEN_ACTIVE</a></div><div class="ttdeci">virtual void process_OPEN_ACTIVE(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:26</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a3e31eeb7896f30c0406b39723f2b1131"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a3e31eeb7896f30c0406b39723f2b1131">inet::TCP_C_ACCEPT</a></div><div class="ttdeci">@ TCP_C_ACCEPT</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:84</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772a42b781bd85bb27a4d914450d01f27e60"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a42b781bd85bb27a4d914450d01f27e60">inet::tcp::TCPOPTION_SACK_PERMITTED</a></div><div class="ttdeci">@ TCPOPTION_SACK_PERMITTED</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:119</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_af5a106f1b332763f61f14022eeb80ed8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#af5a106f1b332763f61f14022eeb80ed8">inet::tcp::TcpConnection::sendQueue</a></div><div class="ttdeci">TcpSendQueue * sendQueue</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:367</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a2969ad9d4633f46f1193733a2adc211a"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a2969ad9d4633f46f1193733a2adc211a">inet::tcp::TcpConnection::sendIndicationToApp</a></div><div class="ttdeci">virtual void sendIndicationToApp(int code, const int id=0)</div><div class="ttdoc">Utility: sends status indication (TCP_I_xxx) to application.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:341</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ae57488043d7b7533872cac4a73ba5907"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ae57488043d7b7533872cac4a73ba5907">inet::tcp::TcpConnection::tryFastRoute</a></div><div class="ttdeci">virtual bool tryFastRoute(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Shortcut to process most common case as fast as possible.</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:22</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ac399961a0e6c948ff8ff11cb239bf327"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac399961a0e6c948ff8ff11cb239bf327">inet::tcp::TcpStateVariables::irs</a></div><div class="ttdeci">uint32_t irs</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:160</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a7166c0d1e3090b61c90b179c82f60730"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a7166c0d1e3090b61c90b179c82f60730">inet::tcp::TcpConnection::remoteAddr</a></div><div class="ttdeci">L3Address remoteAddr</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:347</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea108c5272848f6e6e7518826eab7c1eaf">inet::tcp::TCP_E_RCV_ACK</a></div><div class="ttdeci">@ TCP_E_RCV_ACK</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:84</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a1ed176ad4551f8571d4fc13cb9480eda"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a1ed176ad4551f8571d4fc13cb9480eda">inet::tcp::TcpConnection::sendSegment</a></div><div class="ttdeci">virtual uint32_t sendSegment(uint32_t bytes)</div><div class="ttdoc">Utility: sends one segment of 'bytes' bytes from snd_nxt, and advances snd_nxt.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:744</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90aa7ec9c1b9af8a9e5d8c2d64987a4cbf4">inet::tcp::TCP_S_INIT</a></div><div class="ttdeci">@ TCP_S_INIT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:47</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a975935f14abb62e23aa2dd2a279f4971"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a975935f14abb62e23aa2dd2a279f4971">inet::tcp::TcpConnection::process_OPEN_PASSIVE</a></div><div class="ttdeci">virtual void process_OPEN_PASSIVE(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:70</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac8999bc036241c07295cea07f6b069c2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac8999bc036241c07295cea07f6b069c2">inet::tcp::TcpConnection::sndAckSignal</a></div><div class="ttdeci">static simsignal_t sndAckSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:321</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_ac488a0cd4068c146be104df90aed028d"><div class="ttname"><a href="namespaceinet_1_1tcp.html#ac488a0cd4068c146be104df90aed028d">inet::tcp::seqLess</a></div><div class="ttdeci">bool seqLess(uint32_t a, uint32_t b)</div><div class="ttdef"><b>Definition:</b> TcpHeader.h:21</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa109dd2103410ba2e7573649fed2300cd"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa109dd2103410ba2e7573649fed2300cd">inet::TCP_I_CONNECTION_RESET</a></div><div class="ttdeci">@ TCP_I_CONNECTION_RESET</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:132</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a54aa5ffbc5bfd8546c840b36f1c02599"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a54aa5ffbc5bfd8546c840b36f1c02599">inet::tcp::TcpSackRexmitQueue::setConnection</a></div><div class="ttdeci">virtual void setConnection(TcpConnection *_conn)</div><div class="ttdoc">Set the connection that owns this queue.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.h:51</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a4b0abf3befa02b97a51db7cfda1eef94"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b0abf3befa02b97a51db7cfda1eef94">inet::tcp::TcpStateVariables::ws_enabled</a></div><div class="ttdeci">bool ws_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:198</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ae7f45fa8f832ceedf2d135d66544ecfd"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae7f45fa8f832ceedf2d135d66544ecfd">inet::tcp::TcpStateVariables::ecnEchoState</a></div><div class="ttdeci">bool ecnEchoState</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:249</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a5dce56cbb130a9eff691579cb479fdd7"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a5dce56cbb130a9eff691579cb479fdd7">inet::tcp::TcpConnection::updateRcvQueueVars</a></div><div class="ttdeci">virtual void updateRcvQueueVars()</div><div class="ttdoc">Utility: update receiver queue related variables and statistics - called before setting rcv_wnd.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1426</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a18c00a2d63feb44e9c7d5ae6bf0a2af6"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a18c00a2d63feb44e9c7d5ae6bf0a2af6">inet::tcp::TcpConnection::sackedBytesSignal</a></div><div class="ttdeci">static simsignal_t sackedBytesSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:331</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa96c866226144944ee5f16f087af3a4a1"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa96c866226144944ee5f16f087af3a4a1">inet::TCP_I_DATA_NOTIFICATION</a></div><div class="ttdeci">@ TCP_I_DATA_NOTIFICATION</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:136</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a790b38dc70ae02013f180e7e9f8460e8"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a790b38dc70ae02013f180e7e9f8460e8">inet::tcp::seqLE</a></div><div class="ttdeci">bool seqLE(uint32_t a, uint32_t b)</div><div class="ttdef"><b>Definition:</b> TcpHeader.h:22</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33beaf25e3fe001290d9dc3270102bd1bdcbe"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaf25e3fe001290d9dc3270102bd1bdcbe">inet::tcp::TCP_E_TIMEOUT_2MSL</a></div><div class="ttdeci">@ TCP_E_TIMEOUT_2MSL</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:94</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aae1486aa9057a2c2388448375ab0d9b50"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aae1486aa9057a2c2388448375ab0d9b50">inet::TCP_I_URGENT_DATA</a></div><div class="ttdeci">@ TCP_I_URGENT_DATA</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:126</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a1033c78477cb2a19ba4b8520c2d08541">inet::tcp::TCP_S_FIN_WAIT_1</a></div><div class="ttdeci">@ TCP_S_FIN_WAIT_1</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:55</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_a083fe77c8a6d65b9616180b5bb8b4b9c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a083fe77c8a6d65b9616180b5bb8b4b9c">inet::tcp::TcpReceiveQueue::init</a></div><div class="ttdeci">virtual void init(uint32_t startSeq)</div><div class="ttdoc">Set initial receive sequence number.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:25</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ab1e01a8de610d405235f5a646161d856"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab1e01a8de610d405235f5a646161d856">inet::tcp::TcpStateVariables::dupthresh</a></div><div class="ttdeci">uint32_t dupthresh</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:261</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad78cd9a6e338d5c03499b44727b6829e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad78cd9a6e338d5c03499b44727b6829e">inet::tcp::TcpConnection::rcvAdvSignal</a></div><div class="ttdeci">static simsignal_t rcvAdvSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:319</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea16176061824289ff50bdca3649378afc">inet::tcp::TCP_E_DESTROY</a></div><div class="ttdeci">@ TCP_E_DESTROY</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:76</div></div>
<div class="ttc" id="anamespaceinet_1_1utils_html_a3e3ef67928a638b7e734578e246ba60b"><div class="ttname"><a href="namespaceinet_1_1utils.html#a3e3ef67928a638b7e734578e246ba60b">inet::utils::createOne</a></div><div class="ttdeci">cObject * createOne(const char *className, const char *defaultNamespace)</div><div class="ttdoc">Like cObjectFactory::createOne(), except it starts searching for the class in the given namespace.</div><div class="ttdef"><b>Definition:</b> INETUtils.cc:147</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a9b3c48dbf55f9af32596348733448c5c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a9b3c48dbf55f9af32596348733448c5c">inet::tcp::TcpConnection::optionName</a></div><div class="ttdeci">static const char * optionName(int option)</div><div class="ttdoc">Utility: returns name of TCPOPTION_xxx constants.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:118</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a559d4b4984ef8f4957dba6d2ee2002dc"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a559d4b4984ef8f4957dba6d2ee2002dc">inet::tcp::TcpConnection::initConnection</a></div><div class="ttdeci">virtual void initConnection(TcpOpenCommand *openCmd)</div><div class="ttdoc">Utility: creates send/receive queues and tcpAlgorithm.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:407</div></div>
<div class="ttc" id="aclassinet_1_1_l3_address_html_ad9066a0c0be577b31aacb7d72b058795"><div class="ttname"><a href="classinet_1_1_l3_address.html#ad9066a0c0be577b31aacb7d72b058795">inet::L3Address::isUnspecified</a></div><div class="ttdeci">bool isUnspecified() const</div><div class="ttdef"><b>Definition:</b> L3Address.cc:138</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a0684f23ea5e00081f9bdbf1b944f291f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a0684f23ea5e00081f9bdbf1b944f291f">inet::tcp::TcpSackRexmitQueue::checkRexmitQueueForSackedOrRexmittedSegments</a></div><div class="ttdeci">virtual uint32_t checkRexmitQueueForSackedOrRexmittedSegments(uint32_t fromSeq) const</div><div class="ttdoc">Checks rexmit queue for sacked of rexmitted segments and returns a certain offset (contiguous sacked ...</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:266</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a44607c3de01875763befe761a03423ab"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a44607c3de01875763befe761a03423ab">inet::tcp::TcpStateVariables::sackedBytes_old</a></div><div class="ttdeci">uint32_t sackedBytes_old</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:228</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a12c68f79586cd1b78c71c284e9d356c3"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a12c68f79586cd1b78c71c284e9d356c3">inet::tcp::TcpStateVariables::send_fin</a></div><div class="ttdeci">bool send_fin</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:173</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a0e312f091c2ff5522870d44b212f94a0"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0e312f091c2ff5522870d44b212f94a0">inet::tcp::TcpStateVariables::snd_wnd</a></div><div class="ttdeci">uint32_t snd_wnd</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:150</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_aae23e1692ce5fee6c56211941ff23f54"><div class="ttname"><a href="_tcp_connection_8h.html#aae23e1692ce5fee6c56211941ff23f54">TCP_MAX_WIN_SCALED</a></div><div class="ttdeci">#define TCP_MAX_WIN_SCALED</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:112</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_a6150a738cf14a725f283b0ccb505570b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#a6150a738cf14a725f283b0ccb505570b">inet::tcp::TcpSendQueue::getBytesAvailable</a></div><div class="ttdeci">virtual uint32_t getBytesAvailable(uint32_t fromSeq) const</div><div class="ttdoc">Utility function: returns how many bytes are available in the queue, from (and including) the given s...</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:57</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_af0e8f6a7dfafe6ce82fa53ad7c50512e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#af0e8f6a7dfafe6ce82fa53ad7c50512e">inet::tcp::TcpStateVariables::ts_enabled</a></div><div class="ttdeci">bool ts_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:207</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_aaf782f289486e0b60a0e513971632b87"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#aaf782f289486e0b60a0e513971632b87">inet::tcp::TcpAlgorithm::setConnection</a></div><div class="ttdeci">void setConnection(TcpConnection *_conn)</div><div class="ttdoc">Assign this object to a TcpConnection.</div><div class="ttdef"><b>Definition:</b> TcpAlgorithm.h:52</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a48ce9072da1e00dd840db1ddd1322534"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a48ce9072da1e00dd840db1ddd1322534">inet::tcp::TcpConnection::listeningSocketId</a></div><div class="ttdeci">int listeningSocketId</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:341</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a26e04d9483f45ac8dce5868546533a1a"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a26e04d9483f45ac8dce5868546533a1a">inet::TCP_C_SEND</a></div><div class="ttdeci">@ TCP_C_SEND</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:85</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_a7a35d971a150ba0d7b758e9ff19b4dfe"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#a7a35d971a150ba0d7b758e9ff19b4dfe">inet::tcp::TcpSendQueue::setConnection</a></div><div class="ttdeci">virtual void setConnection(TcpConnection *_conn)</div><div class="ttdoc">Set the connection that owns this queue.</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.h:48</div></div>
<div class="ttc" id="a_tcp_connection_util_8cc_html_a60cc06bef97da802b8522d258ac4fe89"><div class="ttname"><a href="_tcp_connection_util_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a></div><div class="ttdeci">#define CASE(x)</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a1e61db9d8578ff50bec8d72fe818aa5f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a1e61db9d8578ff50bec8d72fe818aa5f">inet::tcp::TcpConnection::processAckInEstabEtc</a></div><div class="ttdeci">virtual bool processAckInEstabEtc(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1127</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea662961b5391511e34cc8d7754a83e7cf">inet::tcp::TCP_E_RCV_UNEXP_SYN</a></div><div class="ttdeci">@ TCP_E_RCV_UNEXP_SYN</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:91</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a2e15e4191c23dc50127cbdda91bc567b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e15e4191c23dc50127cbdda91bc567b">inet::tcp::TcpStateVariables::end_seqno</a></div><div class="ttdeci">uint32_t end_seqno</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:220</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_afcf0d25d019cbe6eed624fa9e6644fc8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#afcf0d25d019cbe6eed624fa9e6644fc8">inet::tcp::TcpConnection::preanalyseAppCommandEvent</a></div><div class="ttdeci">virtual TcpEventCode preanalyseAppCommandEvent(int commandCode)</div><div class="ttdoc">Maps app command codes (msg kind of app command msgs) to TCP_E_xxx event codes.</div><div class="ttdef"><b>Definition:</b> TcpConnectionBase.cc:373</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_a1305155a666be8b71a2df455a353b140"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#a1305155a666be8b71a2df455a353b140">inet::tcp::TcpSendQueue::enqueueAppData</a></div><div class="ttdeci">virtual void enqueueAppData(Packet *msg)</div><div class="ttdoc">Called on SEND app command, it inserts in the queue the data the user wants to send.</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:38</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_abeff78d75750335417e9e82a0e14fab9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#abeff78d75750335417e9e82a0e14fab9">inet::tcp::TcpStateVariables::snd_ws</a></div><div class="ttdeci">bool snd_ws</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:200</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_aa032073527a29157ae853670c5131bc5"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#aa032073527a29157ae853670c5131bc5">inet::tcp::TcpSackRexmitQueue::enqueueSentData</a></div><div class="ttdeci">virtual void enqueueSentData(uint32_t fromSeqNum, uint32_t toSeqNum)</div><div class="ttdoc">Inserts sent data to the rexmit queue.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:78</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_ad2b50ef2e9dba9f55f1b909e0b628b91"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#ad2b50ef2e9dba9f55f1b909e0b628b91">inet::tcp::TcpReceiveQueue::getLE</a></div><div class="ttdeci">virtual uint32_t getLE(uint32_t fromSeqNum)</div><div class="ttdoc">Returns left edge of enqueued region.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:130</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_ac35645b9b8f25a9fd96a54ebcfebee9e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#ac35645b9b8f25a9fd96a54ebcfebee9e">inet::tcp::TcpSendQueue::discardUpTo</a></div><div class="ttdeci">virtual void discardUpTo(uint32_t seqNum)</div><div class="ttdoc">Tells the queue that bytes up to (but NOT including) seqNum have been transmitted and ACKed,...</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:75</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad4b4b186dcd43ec3845c26afb0d9a4b7"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad4b4b186dcd43ec3845c26afb0d9a4b7">inet::tcp::TcpConnection::process_RCV_SEGMENT</a></div><div class="ttdeci">virtual TcpEventCode process_RCV_SEGMENT(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, L3Address src, L3Address dest)</div><div class="ttdoc">Process incoming TCP segment.</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:78</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa0f29c42a316c329683196e9d7ace718"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa0f29c42a316c329683196e9d7ace718">inet::tcp::TcpConnection::pipeSignal</a></div><div class="ttdeci">static simsignal_t pipeSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:326</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a07ea8b8ecb22845b4e7d8954e7fab82a"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a07ea8b8ecb22845b4e7d8954e7fab82a">inet::tcp::TcpStateVariables::lossRecovery</a></div><div class="ttdeci">bool lossRecovery</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:229</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a074ba48b33396e8d42c40d734cca4867"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a074ba48b33396e8d42c40d734cca4867">inet::tcp::TcpStateVariables::snd_wl2</a></div><div class="ttdeci">uint32_t snd_wl2</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:153</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea400699fb3d46b4c6d6891bdb301448df">inet::tcp::TCP_E_OPEN_ACTIVE</a></div><div class="ttdeci">@ TCP_E_OPEN_ACTIVE</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:70</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a13569e009cba1a7f52fdb59c2b85066f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a13569e009cba1a7f52fdb59c2b85066f">inet::tcp::TcpConnection::process_STATUS</a></div><div class="ttdeci">virtual void process_STATUS(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:283</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a1719493572e3440d52107199f0578459"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1719493572e3440d52107199f0578459">inet::tcp::TcpStateVariables::last_ack_sent</a></div><div class="ttdeci">uint32_t last_ack_sent</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:211</div></div>
<div class="ttc" id="anamespaceinet_1_1units_1_1values_html_a108df471d310062a178144ec45653798"><div class="ttname"><a href="namespaceinet_1_1units_1_1values.html#a108df471d310062a178144ec45653798">inet::units::values::s</a></div><div class="ttdeci">value&lt; double, units::s &gt; s</div><div class="ttdef"><b>Definition:</b> Units.h:1235</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a8fa2795781fd0df1ea479f2e72d3642d"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a8fa2795781fd0df1ea479f2e72d3642d">inet::tcp::TCP_OPTIONS_MAX_SIZE</a></div><div class="ttdeci">const B TCP_OPTIONS_MAX_SIZE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:66</div></div>
<div class="ttc" id="anamespaceinet_1_1units_1_1units_html_af52f6a778cd03659324d02848f8aaa33"><div class="ttname"><a href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">inet::units::units::B</a></div><div class="ttdeci">intscale&lt; b, 1, 8 &gt; B</div><div class="ttdef"><b>Definition:</b> Units.h:1168</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ab7160020102c9f27f6c1e3b1698ee5ac"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ab7160020102c9f27f6c1e3b1698ee5ac">inet::tcp::TcpConnection::process_SEND</a></div><div class="ttdeci">virtual void process_SEND(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:112</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a8e6958c27f26128766e80b5794708c95"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8e6958c27f26128766e80b5794708c95">inet::tcp::TcpStateVariables::sacks_array</a></div><div class="ttdeci">SackList sacks_array</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:223</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_a16c5a6f366d0ada79820b386eca8faad"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#a16c5a6f366d0ada79820b386eca8faad">inet::tcp::TcpSendQueue::init</a></div><div class="ttdeci">virtual void init(uint32_t startSeq)</div><div class="ttdoc">Initialize the object.</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:24</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_abae36bc1eb535ad82586aab38be55407"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#abae36bc1eb535ad82586aab38be55407">inet::tcp::TcpStateVariables::nagle_enabled</a></div><div class="ttdeci">bool nagle_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:179</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ae756c38799f1d6fdb05f536dd924a3c0"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ae756c38799f1d6fdb05f536dd924a3c0">inet::tcp::TcpConnection::dscp</a></div><div class="ttdeci">short dscp</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:354</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ad1292ff172208a4aaacc2475f0a24ca6"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad1292ff172208a4aaacc2475f0a24ca6">inet::tcp::TcpAlgorithm::ackSent</a></div><div class="ttdeci">virtual void ackSent()=0</div><div class="ttdoc">Called after we sent an ACK.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a7b7209422a6ff4647d622520ef2762e8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a7b7209422a6ff4647d622520ef2762e8">inet::tcp::TcpConnection::getTSecr</a></div><div class="ttdeci">virtual uint32_t getTSecr(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader) const</div><div class="ttdoc">Utility: get TSecr from segments TS header option.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1415</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772adf1e6f8a6d89003f19bac73e8b81efc8"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772adf1e6f8a6d89003f19bac73e8b81efc8">inet::tcp::TCPOPTION_WINDOW_SCALE</a></div><div class="ttdeci">@ TCPOPTION_WINDOW_SCALE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:118</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a2d62b1f03c437f9061547f99bf30366d"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a2d62b1f03c437f9061547f99bf30366d">inet::TCP_C_STATUS</a></div><div class="ttdeci">@ TCP_C_STATUS</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:88</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a740f9d67c4d45e9037f2b12b392568c4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a740f9d67c4d45e9037f2b12b392568c4">inet::tcp::TcpConnection::tos</a></div><div class="ttdeci">short tos</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:355</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7770b83bee7d2c5edf7b76ba1f3353cc">inet::tcp::TCP_S_LISTEN</a></div><div class="ttdeci">@ TCP_S_LISTEN</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:49</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea94283817362a7228cd3c2436ef56e1fa">inet::tcp::TCP_E_RCV_SYN</a></div><div class="ttdeci">@ TCP_E_RCV_SYN</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:85</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_a4e186216aa94206fd4b1458f5bbf385f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a4e186216aa94206fd4b1458f5bbf385f">inet::tcp::TcpReceiveQueue::getRE</a></div><div class="ttdeci">virtual uint32_t getRE(uint32_t toSeqNum)</div><div class="ttdoc">Returns right edge of enqueued region.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:142</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a271132eb5c66ef013822b45a27985f58"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a271132eb5c66ef013822b45a27985f58">inet::tcp::TcpStateVariables::sndAck</a></div><div class="ttdeci">bool sndAck</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:257</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_a5d8c17132e7da6f6f02e3c187e397a77"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#a5d8c17132e7da6f6f02e3c187e397a77">inet::tcp::Tcp::useDataNotification</a></div><div class="ttdeci">bool useDataNotification</div><div class="ttdef"><b>Definition:</b> Tcp.h:134</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a3cc5345bfd2869217e526a1b42a983d1"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a3cc5345bfd2869217e526a1b42a983d1">inet::tcp::TcpAlgorithm::restartRexmitTimer</a></div><div class="ttdeci">virtual void restartRexmitTimer()=0</div><div class="ttdoc">Restart REXMIT timer.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a2c501d49303a5912f9d792ddabd2ddfb"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a2c501d49303a5912f9d792ddabd2ddfb">inet::tcp::TcpConnection::tcpMain</a></div><div class="ttdeci">Tcp * tcpMain</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:358</div></div>
<div class="ttc" id="a_changes-20051129_8txt_html_a974896d9568f55fd56da7b21422ba4df"><div class="ttname"><a href="_changes-20051129_8txt.html#a974896d9568f55fd56da7b21422ba4df">if</a></div><div class="ttdeci">if(cwndVector) cwndVector -&gt; record(state-&gt;snd_cwnd)</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aad4561cfa55aeae815b09a98e464dc79"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aad4561cfa55aeae815b09a98e464dc79">inet::tcp::TcpConnection::localPort</a></div><div class="ttdeci">int localPort</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:349</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a69d3afa3ef2405fe39bf5d83a0279483"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69d3afa3ef2405fe39bf5d83a0279483">inet::tcp::TcpStateVariables::time_last_data_sent</a></div><div class="ttdeci">simtime_t time_last_data_sent</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:212</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a741bf838feb4b009c6e0da096815b21d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a741bf838feb4b009c6e0da096815b21d">inet::tcp::TcpConnection::selectInitialSeqNum</a></div><div class="ttdeci">virtual void selectInitialSeqNum()</div><div class="ttdoc">Utility: generates ISS and initializes corresponding state variables.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:475</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a7441e1e51cc3a6df1edaf9e1447f1dbd"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a7441e1e51cc3a6df1edaf9e1447f1dbd">inet::tcp::TcpConnection::sendEstabIndicationToApp</a></div><div class="ttdeci">virtual void sendEstabIndicationToApp()</div><div class="ttdoc">Utility: sends TCP_I_ESTABLISHED indication with TcpConnectInfo to application.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:368</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac7c09509eed5568d9ca764207707c20d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac7c09509eed5568d9ca764207707c20d">inet::tcp::TcpConnection::connEstabTimer</a></div><div class="ttdeci">cMessage * connEstabTimer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:383</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a041d14e32c38571e64119937a81bff32">inet::tcp::TCP_S_CLOSED</a></div><div class="ttdeci">@ TCP_S_CLOSED</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:48</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_a38c072401e7140f11d17b0261de704a8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#a38c072401e7140f11d17b0261de704a8">inet::tcp::Tcp::createSendQueue</a></div><div class="ttdeci">virtual TcpSendQueue * createSendQueue()</div><div class="ttdoc">To be called from TcpConnection: create a new send queue.</div><div class="ttdef"><b>Definition:</b> Tcp.cc:358</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad941749bff06b05017bd85bf072f699c">inet::tcp::TCP_S_ESTABLISHED</a></div><div class="ttdeci">@ TCP_S_ESTABLISHED</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:52</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_aa09a3ec420400bcdbdac60ed35f47c6d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#aa09a3ec420400bcdbdac60ed35f47c6d">inet::tcp::TcpReceiveQueue::insertBytesFromSegment</a></div><div class="ttdeci">virtual uint32_t insertBytesFromSegment(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Called when a TCP segment arrives, it should extract the payload from the segment and store it in the...</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:44</div></div>
<div class="ttc" id="anamespaceinet_html_a76bc5c89148708a4d99dba04bd76f6ca"><div class="ttname"><a href="namespaceinet.html#a76bc5c89148708a4d99dba04bd76f6ca">inet::insertTransportProtocolHeader</a></div><div class="ttdeci">void insertTransportProtocolHeader(Packet *packet, const Protocol &amp;protocol, const Ptr&lt; TransportHeaderBase &gt; &amp;header)</div><div class="ttdef"><b>Definition:</b> L4Tools.cc:77</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a4a39ca573f2bd6706d8d7540768f4071">inet::tcp::TCP_S_SYN_RCVD</a></div><div class="ttdeci">@ TCP_S_SYN_RCVD</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:51</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_af4f0f313342b12d8fba57f08234b53a3"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#af4f0f313342b12d8fba57f08234b53a3">inet::tcp::TcpStateVariables::snd_fin_seq</a></div><div class="ttdeci">uint32_t snd_fin_seq</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:174</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a959c0a408e03ad813d41b9e0e47d7268"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a959c0a408e03ad813d41b9e0e47d7268">inet::tcp::TcpStateVariables::tcpRcvQueueDrops</a></div><div class="ttdeci">uint32_t tcpRcvQueueDrops</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:246</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5ae8562081b645b6eb6f115a92ad786b96"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5ae8562081b645b6eb6f115a92ad786b96">inet::TCP_C_READ</a></div><div class="ttdeci">@ TCP_C_READ</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:90</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a97baf7787238d2dd281d18269006b451"><div class="ttname"><a href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a></div><div class="ttdeci">removed HopLimitReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:11</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a542b0e99a7d17e907190003038443894"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a542b0e99a7d17e907190003038443894">inet::tcp::TcpConnection::tcpRcvQueueDropsSignal</a></div><div class="ttdeci">static simsignal_t tcpRcvQueueDropsSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:333</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a149bc4c48129dc7b91263b0171189a64"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a149bc4c48129dc7b91263b0171189a64">inet::tcp::TcpConnection::sendToIP</a></div><div class="ttdeci">virtual void sendToIP(Packet *tcpSegment, const Ptr&lt; TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Utility: adds control info to segment and sends it to IP.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:246</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a1db61f436cad720e34506d627b4e1361"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1db61f436cad720e34506d627b4e1361">inet::tcp::TcpStateVariables::snd_sacks</a></div><div class="ttdeci">uint32_t snd_sacks</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:237</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ac0e65a9e0ad46097670d0c61c3300a2d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0e65a9e0ad46097670d0c61c3300a2d">inet::tcp::TcpStateVariables::ect</a></div><div class="ttdeci">bool ect</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:253</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a69abf2064bebb5deaf8169d034cfca86"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a69abf2064bebb5deaf8169d034cfca86">inet::tcp::TcpConnection::sendSynAck</a></div><div class="ttdeci">virtual void sendSynAck()</div><div class="ttdoc">Utility: send SYN+ACK.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:581</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ae2f4845c3ab5854f70adbcb428215617"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae2f4845c3ab5854f70adbcb428215617">inet::tcp::TcpStateVariables::afterRto</a></div><div class="ttdeci">bool afterRto</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:194</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea42dc07647bd4d3409908de672c7fc3b3"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea42dc07647bd4d3409908de672c7fc3b3">inet::tcp::TCP_E_SEND</a></div><div class="ttdeci">@ TCP_E_SEND</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:73</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a3139ca6cfa7eb5d610c9ef391f282f1f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a3139ca6cfa7eb5d610c9ef391f282f1f">inet::tcp::TcpConnection::configureStateVariables</a></div><div class="ttdeci">virtual void configureStateVariables()</div><div class="ttdoc">Utility: set snd_mss, rcv_wnd and sack in newly created state variables block.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:436</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_acd69c7cf1d3622b1d7aa706d7f9b97f9"><div class="ttname"><a href="_tcp_connection_8h.html#acd69c7cf1d3622b1d7aa706d7f9b97f9">MAX_SYN_REXMIT_COUNT</a></div><div class="ttdeci">#define MAX_SYN_REXMIT_COUNT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:110</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a87778790a2aabc3de1d81a08fb5e035e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a87778790a2aabc3de1d81a08fb5e035e">inet::tcp::TcpSackRexmitQueue::discardUpTo</a></div><div class="ttdeci">virtual void discardUpTo(uint32_t seqNum)</div><div class="ttdoc">Tells the queue that bytes up to (but NOT including) seqNum have been transmitted and ACKed,...</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:56</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a540240a4946cc48d695af1083f88a05b"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a540240a4946cc48d695af1083f88a05b">inet::tcp::seqGE</a></div><div class="ttdeci">bool seqGE(uint32_t a, uint32_t b)</div><div class="ttdef"><b>Definition:</b> TcpHeader.h:24</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a85992dfca295a0ab3240f0ec1650ebd6"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a85992dfca295a0ab3240f0ec1650ebd6">inet::tcp::TcpConnection::process_OPTIONS</a></div><div class="ttdeci">virtual void process_OPTIONS(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:172</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_a89ce38305130a5021e21134602a88f79"><div class="ttname"><a href="_tcp_connection_8h.html#a89ce38305130a5021e21134602a88f79">TCP_TIMEOUT_SYN_REXMIT</a></div><div class="ttdeci">#define TCP_TIMEOUT_SYN_REXMIT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:106</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a93c7bc93c84a410a40ceefee26e61196"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a93c7bc93c84a410a40ceefee26e61196">inet::tcp::TcpConnection::processWSOption</a></div><div class="ttdeci">virtual bool processWSOption(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, const TcpOptionWindowScale &amp;option)</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1149</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac3547269704c3b79daf67827bb5eefd8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac3547269704c3b79daf67827bb5eefd8">inet::tcp::TcpConnection::rcvSeqSignal</a></div><div class="ttdeci">static simsignal_t rcvSeqSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:322</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea5dc26c747357fa3709d0c35e7e81a7e5"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea5dc26c747357fa3709d0c35e7e81a7e5">inet::tcp::TCP_E_STATUS</a></div><div class="ttdeci">@ TCP_E_STATUS</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:77</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a26de7ea87396d67ca943d0bb3580e582"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a26de7ea87396d67ca943d0bb3580e582">inet::TCP_C_OPEN_PASSIVE</a></div><div class="ttdeci">@ TCP_C_OPEN_PASSIVE</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:83</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a97ba97acbd81b0f689af1978c5bd02c1"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a97ba97acbd81b0f689af1978c5bd02c1">inet::tcp::TcpConnection::socketId</a></div><div class="ttdeci">int socketId</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:337</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_a8abe59159786a7c49755c49d7d9b4846"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a8abe59159786a7c49755c49d7d9b4846">inet::tcp::TcpReceiveQueue::setConnection</a></div><div class="ttdeci">virtual void setConnection(TcpConnection *_conn)</div><div class="ttdoc">Set the connection that owns this queue.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.h:67</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a2e702b41235a601e1eda4c08ae62e119"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2e702b41235a601e1eda4c08ae62e119">inet::tcp::TcpStateVariables::snd_nxt</a></div><div class="ttdeci">uint32_t snd_nxt</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:148</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a99e1c6ee1d15fe6cb33922f270852e80">inet::tcp::TCP_S_CLOSE_WAIT</a></div><div class="ttdeci">@ TCP_S_CLOSE_WAIT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:53</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ab2fbd6659f73a5aee8db09e1706cb3ee"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab2fbd6659f73a5aee8db09e1706cb3ee">inet::tcp::TcpStateVariables::sack_enabled</a></div><div class="ttdeci">bool sack_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:216</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a701a3e619d81a47b28c8de4914adb917"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a701a3e619d81a47b28c8de4914adb917">inet::tcp::TcpStateVariables::ts_support</a></div><div class="ttdeci">bool ts_support</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:206</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a58ad29e361347c1b9cd73c9d7f0ef66c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a58ad29e361347c1b9cd73c9d7f0ef66c">inet::tcp::TcpSackRexmitQueue::getAmountOfSackedBytes</a></div><div class="ttdeci">virtual uint32_t getAmountOfSackedBytes(uint32_t seqNum) const</div><div class="ttdoc">Returns amount of sacked bytes above seqNum.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:314</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a7d1206eb2d24f6c1e1a15dcf4ef36da0">inet::tcp::TCP_S_TIME_WAIT</a></div><div class="ttdeci">@ TCP_S_TIME_WAIT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:58</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aa6c008757fabc67fc69a0803084279e5"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa6c008757fabc67fc69a0803084279e5">inet::tcp::TcpStateVariables::snd_wl1</a></div><div class="ttdeci">uint32_t snd_wl1</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:152</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_a6d5e1b9a987d5263ed7885c1e13a5dbf"><div class="ttname"><a href="_tcp_connection_8h.html#a6d5e1b9a987d5263ed7885c1e13a5dbf">PAWS_IDLE_TIME_THRESH</a></div><div class="ttdeci">#define PAWS_IDLE_TIME_THRESH</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:114</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad48d27c4c68b12165dc4c94aad7e2d9d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad48d27c4c68b12165dc4c94aad7e2d9d">inet::tcp::TcpConnection::printConnBrief</a></div><div class="ttdeci">virtual void printConnBrief() const</div><div class="ttdoc">Utility: prints local/remote addr/port and app gate index/socketId.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:147</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a179c4ccdd41290e4afce22dc728c8282"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a179c4ccdd41290e4afce22dc728c8282">inet::tcp::TcpStateVariables::ecnSynSent</a></div><div class="ttdeci">bool ecnSynSent</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:255</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_acc159f655c5f3a4c0a42e6dc7f49bcda"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#acc159f655c5f3a4c0a42e6dc7f49bcda">inet::tcp::TcpSackRexmitQueue::getBufferEndSeq</a></div><div class="ttdeci">virtual uint32_t getBufferEndSeq() const</div><div class="ttdoc">Returns the sequence number of the last byte stored in the buffer plus one.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.h:82</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_ac0872ac4b4d00d37240648a8ef16a196"><div class="ttname"><a href="_i_udp-gates_8txt.html#ac0872ac4b4d00d37240648a8ef16a196">kind</a></div><div class="ttdeci">removed DscpReq kind</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:12</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a0b59c4b6eca46a2a341d73178ade5934"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a0b59c4b6eca46a2a341d73178ade5934">inet::tcp::TcpConnection::unackedSignal</a></div><div class="ttdeci">static simsignal_t unackedSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:324</div></div>
<div class="ttc" id="a_tcp_connection_8h_html_a45fb301bd71c5637907f72760c563002"><div class="ttname"><a href="_tcp_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a></div><div class="ttdeci">#define TCP_MAX_WIN</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:111</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a0bc96352a49004dc0f7125028939c117"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a0bc96352a49004dc0f7125028939c117">inet::tcp::TcpConnection::rcvNASegSignal</a></div><div class="ttdeci">static simsignal_t rcvNASegSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:330</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a6f0d12e23dbd07d45b9fcf597d1517a6"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6f0d12e23dbd07d45b9fcf597d1517a6">inet::tcp::TcpStateVariables::maxRcvBuffer</a></div><div class="ttdeci">uint32_t maxRcvBuffer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:243</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a8992721ec5ccbd1765cc631428a8cb73"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8992721ec5ccbd1765cc631428a8cb73">inet::tcp::TcpStateVariables::rcv_oooseg</a></div><div class="ttdeci">uint32_t rcv_oooseg</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:239</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad76dc793cff441a2e7b3c206c8389dea"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad76dc793cff441a2e7b3c206c8389dea">inet::tcp::TcpConnection::remotePort</a></div><div class="ttdeci">int remotePort</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:350</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aa8856cddc7e239b9eb93bbb42326d3b1"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aa8856cddc7e239b9eb93bbb42326d3b1">inet::tcp::TcpStateVariables::syn_rexmit_timeout</a></div><div class="ttdeci">simtime_t syn_rexmit_timeout</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:166</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_ae9c6e08735ee777f9cf7afeaefd5ff3f"><div class="ttname"><a href="namespaceinet_1_1tcp.html#ae9c6e08735ee777f9cf7afeaefd5ff3f">inet::tcp::TCP_OPTION_SACK_ENTRY_SIZE</a></div><div class="ttdeci">const B TCP_OPTION_SACK_ENTRY_SIZE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:69</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a2c3eaca4f3871d01d9c690cb18cf1340"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a2c3eaca4f3871d01d9c690cb18cf1340">inet::tcp::TcpSackRexmitQueue::getHighestSackedSeqNum</a></div><div class="ttdeci">virtual uint32_t getHighestSackedSeqNum() const</div><div class="ttdoc">Returns the highest sequence number sacked by data receiver.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:246</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a337d6f4a64a013e7ad5fa24d60961c50"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a337d6f4a64a013e7ad5fa24d60961c50">inet::tcp::TcpAlgorithm::sendCommandInvoked</a></div><div class="ttdeci">virtual void sendCommandInvoked()=0</div><div class="ttdoc">Called after user sent TCP_C_SEND command to us.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_a7df4b2a3c971c305dd6ab3f954401077"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a7df4b2a3c971c305dd6ab3f954401077">inet::tcp::TcpReceiveQueue::getQueueLength</a></div><div class="ttdeci">virtual uint32_t getQueueLength()</div><div class="ttdoc">Returns the number of blocks currently buffered in queue.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:120</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a20a70ddc8e027eadd2be6b0ea7ad305a"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a20a70ddc8e027eadd2be6b0ea7ad305a">inet::TCP_C_CLOSE</a></div><div class="ttdeci">@ TCP_C_CLOSE</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:86</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772a6c6bdf29d7a49ae3a372fd2f710d9b0b"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a6c6bdf29d7a49ae3a372fd2f710d9b0b">inet::tcp::TCPOPTION_MAXIMUM_SEGMENT_SIZE</a></div><div class="ttdeci">@ TCPOPTION_MAXIMUM_SEGMENT_SIZE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:117</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a9b36439caaec220aebab659e5c6ff4d8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a9b36439caaec220aebab659e5c6ff4d8">inet::tcp::TcpConnection::updateRcvWnd</a></div><div class="ttdeci">virtual unsigned short updateRcvWnd()</div><div class="ttdoc">Utility: update receive window (rcv_wnd), and calculate scaled value if window scaling enabled.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1438</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a18db3914f2cb5e1f599724fbcb824b05"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a18db3914f2cb5e1f599724fbcb824b05">inet::tcp::TcpConnection::eventName</a></div><div class="ttdeci">static const char * eventName(int event)</div><div class="ttdoc">Utility: returns name of TCP_E_xxx constants.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:65</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a69b2b2a5aa4759a17c70f73d9b932054"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a69b2b2a5aa4759a17c70f73d9b932054">inet::tcp::TcpStateVariables::highRxt</a></div><div class="ttdeci">uint32_t highRxt</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:224</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ae23542545db9c2091cd2c533dec08989"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ae23542545db9c2091cd2c533dec08989">inet::tcp::TcpConnection::indicationName</a></div><div class="ttdeci">static const char * indicationName(int code)</div><div class="ttdoc">Utility: returns name of TCP_I_xxx constants.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:96</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a218e86e3d8517cfa1f09c432bd3db31d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a218e86e3d8517cfa1f09c432bd3db31d">inet::tcp::TcpConnection::nextSeg</a></div><div class="ttdeci">virtual bool nextSeg(uint32_t &amp;seqNum)</div><div class="ttdoc">For SACK TCP.</div><div class="ttdef"><b>Definition:</b> TcpConnectionSackUtil.cc:208</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa7f76b4e941cbbe2ef203bf27a8173a2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa7f76b4e941cbbe2ef203bf27a8173a2">inet::tcp::TcpConnection::dupAcksSignal</a></div><div class="ttdeci">static simsignal_t dupAcksSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:325</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_a380a7b467a6e279f76b946f80a9e5d07"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a380a7b467a6e279f76b946f80a9e5d07">inet::tcp::TcpReceiveQueue::getFirstSeqNo</a></div><div class="ttdeci">virtual uint32_t getFirstSeqNo()</div><div class="ttdoc">Returns the minimum of first byte seq.no.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:154</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772abbfd2f02bffabb60b21194a40ef75e4b"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abbfd2f02bffabb60b21194a40ef75e4b">inet::tcp::TCPOPTION_TIMESTAMP</a></div><div class="ttdeci">@ TCPOPTION_TIMESTAMP</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:121</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5ac71631f7b57d2379af9848c5bd62cdf3"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5ac71631f7b57d2379af9848c5bd62cdf3">inet::TCP_C_ABORT</a></div><div class="ttdeci">@ TCP_C_ABORT</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:87</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ad965cbba967109e9cae36a41ec46e2cc"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ad965cbba967109e9cae36a41ec46e2cc">inet::tcp::TcpAlgorithm::segmentRetransmitted</a></div><div class="ttdeci">virtual void segmentRetransmitted(uint32_t fromseq, uint32_t toseq)=0</div><div class="ttdoc">Called after we retransmitted segment.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a6bf163d0940921709cdfabc3cc7ba9e7"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a6bf163d0940921709cdfabc3cc7ba9e7">inet::tcp::TcpSackRexmitQueue::getHighestRexmittedSeqNum</a></div><div class="ttdeci">virtual uint32_t getHighestRexmittedSeqNum() const</div><div class="ttdoc">Returns the highest sequence number rexmitted by data sender.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:256</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ae74c4b3aabca7e3af4379563e0a73d78"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae74c4b3aabca7e3af4379563e0a73d78">inet::tcp::TcpStateVariables::snd_mss</a></div><div class="ttdeci">uint32_t snd_mss</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:142</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a151a959cdd47ff9911e0e5179246011c"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a151a959cdd47ff9911e0e5179246011c">inet::TCP_C_DESTROY</a></div><div class="ttdeci">@ TCP_C_DESTROY</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:91</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ac839f5fc37c9808122c5772036019a85"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ac839f5fc37c9808122c5772036019a85">inet::tcp::TcpAlgorithm::receivedAckForDataNotYetSent</a></div><div class="ttdeci">virtual void receivedAckForDataNotYetSent(uint32_t seq)=0</div><div class="ttdoc">Called after we received an ACK for data not yet sent.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ad44e8e93bded1311284350f023961454"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad44e8e93bded1311284350f023961454">inet::tcp::TcpStateVariables::fork</a></div><div class="ttdeci">bool fork</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:140</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_send_queue_html_a285e0827e6548b8cfb3c34bb50eda74f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_send_queue.html#a285e0827e6548b8cfb3c34bb50eda74f">inet::tcp::TcpSendQueue::getBufferEndSeq</a></div><div class="ttdeci">virtual uint32_t getBufferEndSeq() const</div><div class="ttdoc">Returns the sequence number of the last byte stored in the buffer plus one.</div><div class="ttdef"><b>Definition:</b> TcpSendQueue.cc:52</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a5ecf5464de1b085c557ac7d2d15220d6"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a5ecf5464de1b085c557ac7d2d15220d6">inet::tcp::TcpConnection::ttl</a></div><div class="ttdeci">int ttl</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:353</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ae487487c5d3aee8af6dda153cfd62086"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ae487487c5d3aee8af6dda153cfd62086">inet::tcp::TcpConnection::printSegmentBrief</a></div><div class="ttdeci">static void printSegmentBrief(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Utility: prints important header fields.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:156</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a3df8bb6e00976c6ebdd69c2f5ece8fe0"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a3df8bb6e00976c6ebdd69c2f5ece8fe0">inet::tcp::TcpConnection::processSACKOption</a></div><div class="ttdeci">virtual bool processSACKOption(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, const TcpOptionSack &amp;option)</div><div class="ttdef"><b>Definition:</b> TcpConnectionSackUtil.cc:29</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ac9a8e7dbde1f4102cec960e9566af010"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ac9a8e7dbde1f4102cec960e9566af010">inet::tcp::TcpConnection::process_CLOSE</a></div><div class="ttdeci">virtual void process_CLOSE(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:190</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a4b550d07dd3ddf8fcd0294dbfe9ffb55"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a4b550d07dd3ddf8fcd0294dbfe9ffb55">inet::tcp::TcpConnection::readHeaderOptions</a></div><div class="ttdeci">virtual void readHeaderOptions(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Utility: readHeaderOptions (Currently only EOL, NOP, MSS, WS, SACK_PERMITTED, SACK and TS are impleme...</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1062</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ae287c8e1cff764dfb16a88b6f979a9ad"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ae287c8e1cff764dfb16a88b6f979a9ad">inet::tcp::TcpConnection::processRstInSynReceived</a></div><div class="ttdeci">virtual TcpEventCode processRstInSynReceived(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1096</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a9d716ea52ca02eed748706f10b595b58"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a9d716ea52ca02eed748706f10b595b58">inet::tcp::TcpAlgorithm::receivedDataAck</a></div><div class="ttdeci">virtual void receivedDataAck(uint32_t firstSeqAcked)=0</div><div class="ttdoc">Called after we received an ACK which acked some data (that is, we could advance snd_una).</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aa3ef478c5f1fb691510da2b4b6a47cd9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aa3ef478c5f1fb691510da2b4b6a47cd9">inet::tcp::TcpConnection::fsm</a></div><div class="ttdeci">cFSM fsm</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:361</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_ae2373d8dfefb03ae8f314b87ed79a81a"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#ae2373d8dfefb03ae8f314b87ed79a81a">inet::tcp::TcpSackRexmitQueue::init</a></div><div class="ttdeci">virtual void init(uint32_t seqNum)</div><div class="ttdoc">Initialize the object.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:26</div></div>
<div class="ttc" id="a_self_doc_8h_html_a8e54030c665b5254da268db865fccdfc"><div class="ttname"><a href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a></div><div class="ttdeci">#define Enter_Method(...)</div><div class="ttdef"><b>Definition:</b> SelfDoc.h:71</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ac0c8a9f83b111d667670557cabc6d2ce"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac0c8a9f83b111d667670557cabc6d2ce">inet::tcp::TcpStateVariables::queueUpdate</a></div><div class="ttdeci">bool queueUpdate</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:233</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ae860eafb2dc4a15a272ed31807b09043"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae860eafb2dc4a15a272ed31807b09043">inet::tcp::TcpAlgorithm::processEcnInEstablished</a></div><div class="ttdeci">virtual void processEcnInEstablished()=0</div><div class="ttdoc">Called before processing segment in established state.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a4b2805e7b873917a7bc5409f57a94722"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a4b2805e7b873917a7bc5409f57a94722">inet::tcp::TcpStateVariables::increased_IW_enabled</a></div><div class="ttdeci">bool increased_IW_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:182</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a46f6755d44254353ba6645e81d41bb5f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a46f6755d44254353ba6645e81d41bb5f">inet::tcp::TcpStateVariables::syn_rexmit_count</a></div><div class="ttdeci">int syn_rexmit_count</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:165</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a0fc91f734148ec0bb0647299ebceec75"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0fc91f734148ec0bb0647299ebceec75">inet::tcp::TcpStateVariables::fin_rcvd</a></div><div class="ttdeci">bool fin_rcvd</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:176</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a5de94d23a73961fbca3b3530b296732d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a5de94d23a73961fbca3b3530b296732d">inet::tcp::TcpConnection::processSynInListen</a></div><div class="ttdeci">virtual TcpEventCode processSynInListen(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, L3Address srcAddr, L3Address destAddr)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:799</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_ac890fc1aa704a0a82bed0424353c35f8"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#ac890fc1aa704a0a82bed0424353c35f8">inet::tcp::Tcp::sendFromConn</a></div><div class="ttdeci">virtual void sendFromConn(cMessage *msg, const char *gatename, int gateindex=-1)</div><div class="ttdef"><b>Definition:</b> Tcp.cc:118</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_afd648cdcdb403ab7099fc5fbad5c36ab"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#afd648cdcdb403ab7099fc5fbad5c36ab">inet::tcp::TcpStateVariables::rcv_wnd_scale</a></div><div class="ttdeci">uint rcv_wnd_scale</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:202</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ab2c6979d1519488109b9a8fc029081a2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ab2c6979d1519488109b9a8fc029081a2">inet::tcp::TcpConnection::sendFin</a></div><div class="ttdeci">virtual void sendFin()</div><div class="ttdoc">Utility: sends FIN.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:724</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_ad1b600d74eb698cc02c43e1ef192f0b9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#ad1b600d74eb698cc02c43e1ef192f0b9">inet::tcp::TcpReceiveQueue::getAmountOfFreeBytes</a></div><div class="ttdeci">virtual uint32_t getAmountOfFreeBytes(uint32_t maxRcvBuffer)</div><div class="ttdoc">Returns the number of bytes currently free (=available) in queue.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:113</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_a52f00f65b425f38e977c2478394e0610"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#a52f00f65b425f38e977c2478394e0610">inet::tcp::Tcp::tcpConnectionAddedSignal</a></div><div class="ttdeci">static simsignal_t tcpConnectionAddedSignal</div><div class="ttdef"><b>Definition:</b> Tcp.h:87</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aff166b9e7e6ee791b56a161fc8dd86d3"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aff166b9e7e6ee791b56a161fc8dd86d3">inet::tcp::TcpConnection::sndSacksSignal</a></div><div class="ttdeci">static simsignal_t sndSacksSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:327</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ae726cf09a498dcd0b25a8f57f6aa3d99"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ae726cf09a498dcd0b25a8f57f6aa3d99">inet::tcp::TcpConnection::synRexmitTimer</a></div><div class="ttdeci">cMessage * synRexmitTimer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:385</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a729b16908c898a0ccf73af5c736f1ee2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a729b16908c898a0ccf73af5c736f1ee2">inet::tcp::TcpConnection::processSegmentInSynSent</a></div><div class="ttdeci">virtual TcpEventCode processSegmentInSynSent(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, L3Address src, L3Address dest)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:872</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_afa81cfbf0d827dcd5ca342d503faebf3"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#afa81cfbf0d827dcd5ca342d503faebf3">inet::tcp::TcpStateVariables::sndCwr</a></div><div class="ttdeci">bool sndCwr</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:250</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a9646df6c75f2c50877eaf2fcb00767fc"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a9646df6c75f2c50877eaf2fcb00767fc">inet::tcp::TCP_OPTION_TS_SIZE</a></div><div class="ttdeci">const B TCP_OPTION_TS_SIZE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:70</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a162449c72e930dab66d9f385ed648f27"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a162449c72e930dab66d9f385ed648f27">inet::tcp::TcpStateVariables::sendQueueLimit</a></div><div class="ttdeci">uint32_t sendQueueLimit</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:232</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33be"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33be">inet::tcp::TcpEventCode</a></div><div class="ttdeci">TcpEventCode</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:65</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a6d6c500012de26b9f25cd1d339a77d50"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a6d6c500012de26b9f25cd1d339a77d50">inet::tcp::TcpConnection::sendAvailableIndicationToApp</a></div><div class="ttdeci">virtual void sendAvailableIndicationToApp()</div><div class="ttdoc">Utility: sends TCP_I_AVAILABLE indication with TcpAvailableInfo to application.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:352</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a9d728c2ef24559de13711865253c191c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a9d728c2ef24559de13711865253c191c">inet::tcp::TcpSackRexmitQueue::checkSackBlock</a></div><div class="ttdeci">virtual void checkSackBlock(uint32_t seqNum, uint32_t &amp;length, bool &amp;sacked, bool &amp;rexmitted) const</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:362</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea682d0f84075ac44c034ec192839f0567">inet::tcp::TCP_E_ABORT</a></div><div class="ttdeci">@ TCP_E_ABORT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:75</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_aec3b4ea0c2712f557e5a68165b8b082e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#aec3b4ea0c2712f557e5a68165b8b082e">inet::tcp::TcpConnection::rcvOooSegSignal</a></div><div class="ttdeci">static simsignal_t rcvOooSegSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:329</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_ad27c319b03d76159b21f347b1eaf9533"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#ad27c319b03d76159b21f347b1eaf9533">inet::tcp::TcpConnection::process_TIMEOUT_2MSL</a></div><div class="ttdeci">virtual void process_TIMEOUT_2MSL()</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1295</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_af0930df856c9fb347f5acb3182346e2f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#af0930df856c9fb347f5acb3182346e2f">inet::tcp::TcpConnection::process_TIMEOUT_SYN_REXMIT</a></div><div class="ttdeci">virtual void process_TIMEOUT_SYN_REXMIT(TcpEventCode &amp;event)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:1339</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a8582acc0ba4d4850f124b4d7aef643c1"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a8582acc0ba4d4850f124b4d7aef643c1">inet::tcp::TcpConnection::processSegmentInListen</a></div><div class="ttdeci">virtual TcpEventCode processSegmentInListen(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, L3Address src, L3Address dest)</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:724</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea1202c3b28f3b6fb66b1a6f5ff301218b"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea1202c3b28f3b6fb66b1a6f5ff301218b">inet::tcp::TCP_E_ACCEPT</a></div><div class="ttdeci">@ TCP_E_ACCEPT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:72</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_a34f905e10b376fe2081a06f34fea5ce7"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#a34f905e10b376fe2081a06f34fea5ce7">inet::tcp::TcpSackRexmitQueue::getTotalAmountOfSackedBytes</a></div><div class="ttdeci">virtual uint32_t getTotalAmountOfSackedBytes() const</div><div class="ttdoc">Returns total amount of sacked bytes.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:302</div></div>
<div class="ttc" id="aclassinet_1_1_l3_address_html_a30dd435542f45ebc9bb7c75344545e49"><div class="ttname"><a href="classinet_1_1_l3_address.html#a30dd435542f45ebc9bb7c75344545e49">inet::L3Address::getAddressType</a></div><div class="ttdeci">IL3AddressType * getAddressType() const</div><div class="ttdef"><b>Definition:</b> L3Address.cc:59</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a247e7362ec8ea0956d44f5c97aeffa24"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a247e7362ec8ea0956d44f5c97aeffa24">inet::tcp::TcpConnection::sendRstAck</a></div><div class="ttdeci">virtual void sendRstAck(uint32_t seq, uint32_t ack, L3Address src, L3Address dest, int srcPort, int destPort)</div><div class="ttdoc">Utility: sends RST+ACK; does not use connection state.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:655</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772abf3fa7fa8f31cc254c9c538a51fe5fce"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772abf3fa7fa8f31cc254c9c538a51fe5fce">inet::tcp::TCPOPTION_END_OF_OPTION_LIST</a></div><div class="ttdeci">@ TCPOPTION_END_OF_OPTION_LIST</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:115</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ad386dec080ca76d4230a18e38802b536"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ad386dec080ca76d4230a18e38802b536">inet::tcp::TcpStateVariables::snd_sack_perm</a></div><div class="ttdeci">bool snd_sack_perm</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:217</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a97c136fdf02b4cdaa010d86105aac3f9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a97c136fdf02b4cdaa010d86105aac3f9">inet::tcp::TcpConnection::tcpRcvQueueBytesSignal</a></div><div class="ttdeci">static simsignal_t tcpRcvQueueBytesSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:332</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a91750ba2c074c8dc66b970558ac0734f"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a91750ba2c074c8dc66b970558ac0734f">inet::tcp::TcpStateVariables::rcv_nxt</a></div><div class="ttdeci">uint32_t rcv_nxt</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:157</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ae454ba565e4349a82d13897367a32348"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ae454ba565e4349a82d13897367a32348">inet::tcp::TcpStateVariables::rcv_sack_perm</a></div><div class="ttdeci">bool rcv_sack_perm</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:218</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a318f534d7d7044e612b0f05dfee41a4e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a318f534d7d7044e612b0f05dfee41a4e">inet::tcp::TcpStateVariables::ack_now</a></div><div class="ttdeci">bool ack_now</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:185</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea514e4e5901373a106638c1749c4a1320">inet::tcp::TCP_E_CLOSE</a></div><div class="ttdeci">@ TCP_E_CLOSE</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:74</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a9ad273577effccc29c74a5197a30f59d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9ad273577effccc29c74a5197a30f59d">inet::tcp::TcpStateVariables::rcv_adv</a></div><div class="ttdeci">uint32_t rcv_adv</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:161</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea908ee3369c13b26d0fa679e0893fdf60">inet::tcp::TCP_E_RCV_FIN</a></div><div class="ttdeci">@ TCP_E_RCV_FIN</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:87</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_aba883a97661105f6f6d6d77e15758fe9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#aba883a97661105f6f6d6d77e15758fe9">inet::tcp::TcpAlgorithm::receiveSeqChanged</a></div><div class="ttdeci">virtual void receiveSeqChanged()=0</div><div class="ttdoc">Called after rcv_nxt got advanced, either because we received in-sequence data (&quot;text&quot; in RFC 793 lin...</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea3233019711645337eea743422eb2c732"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3233019711645337eea743422eb2c732">inet::tcp::TCP_E_READ</a></div><div class="ttdeci">@ TCP_E_READ</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:79</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772a8a6653346b4cb563cba15af48e1ff40a"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a8a6653346b4cb563cba15af48e1ff40a">inet::tcp::TCPOPTION_SACK</a></div><div class="ttdeci">@ TCPOPTION_SACK</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:120</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a2592b559e4749d06295c427e1d058368"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a2592b559e4749d06295c427e1d058368">inet::tcp::TcpConnection::convertSimtimeToTS</a></div><div class="ttdeci">static uint32_t convertSimtimeToTS(simtime_t simtime)</div><div class="ttdoc">Utility: converts a given simtime to a timestamp (TS).</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1589</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a8bfd8f820c13ba78df3883241171d369"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a8bfd8f820c13ba78df3883241171d369">inet::tcp::TcpStateVariables::snd_wnd_scale</a></div><div class="ttdeci">uint snd_wnd_scale</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:203</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a0377e85d038d3eb2336cf60a4a961f4a">inet::tcp::TCP_S_LAST_ACK</a></div><div class="ttdeci">@ TCP_S_LAST_ACK</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:54</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a54573456795943feec64ebac35be9122"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a54573456795943feec64ebac35be9122">inet::tcp::TcpStateVariables::rcv_initial_ts</a></div><div class="ttdeci">bool rcv_initial_ts</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:209</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa20d878b48ef2d6c1bc032d90ba1ac753"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa20d878b48ef2d6c1bc032d90ba1ac753">inet::TCP_I_STATUS</a></div><div class="ttdeci">@ TCP_I_STATUS</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:134</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a2d93e09da31c31f2b37b758902de1e66"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a2d93e09da31c31f2b37b758902de1e66">inet::tcp::TcpStateVariables::ecnWillingness</a></div><div class="ttdeci">bool ecnWillingness</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:256</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a69317f3325bcf935665f7c88f776b4de"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a69317f3325bcf935665f7c88f776b4de">inet::tcp::TcpConnection::hasEnoughSpaceForSegmentInReceiveQueue</a></div><div class="ttdeci">virtual bool hasEnoughSpaceForSegmentInReceiveQueue(Packet *tcpSegment, const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Utility: returns true when receive queue has enough space for store the tcpHeader.</div><div class="ttdef"><b>Definition:</b> TcpConnectionRcvSegment.cc:109</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_afa58384bc31b9c48f48c1a653c1580a1"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#afa58384bc31b9c48f48c1a653c1580a1">inet::tcp::TcpStateVariables::gotEce</a></div><div class="ttdeci">bool gotEce</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:251</div></div>
<div class="ttc" id="anamespaceinet_html_a9ad30be62e792f35add531d609e18d1f"><div class="ttname"><a href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">inet::uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> INETDefs.h:55</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea3a8d3b97bb0b99915a43a941f80604f4"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea3a8d3b97bb0b99915a43a941f80604f4">inet::tcp::TCP_E_RCV_DATA</a></div><div class="ttdeci">@ TCP_E_RCV_DATA</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:83</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a95b7233ca8183973b60c88e1f955993c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a95b7233ca8183973b60c88e1f955993c">inet::tcp::TcpConnection::processMSSOption</a></div><div class="ttdeci">virtual bool processMSSOption(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, const TcpOptionMaxSegmentSize &amp;option)</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1114</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33beaa75de9fd09d1def0d3e0b6ac18f022b6"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33beaa75de9fd09d1def0d3e0b6ac18f022b6">inet::tcp::TCP_E_TIMEOUT_FIN_WAIT_2</a></div><div class="ttdeci">@ TCP_E_TIMEOUT_FIN_WAIT_2</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:96</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aaffa1be7ba967dfed00f2a1ecc2630f47"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aaffa1be7ba967dfed00f2a1ecc2630f47">inet::TCP_I_DATA</a></div><div class="ttdeci">@ TCP_I_DATA</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:125</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a1e62607e3fbab7f504b3f7dab879bf67"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a1e62607e3fbab7f504b3f7dab879bf67">inet::tcp::TcpConnection::process_QUEUE_BYTES_LIMIT</a></div><div class="ttdeci">virtual void process_QUEUE_BYTES_LIMIT(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:320</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a7a9d893e816312584dc9124d5443c7ff"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a7a9d893e816312584dc9124d5443c7ff">inet::tcp::TcpConnection::process_ACCEPT</a></div><div class="ttdeci">virtual void process_ACCEPT(TcpEventCode &amp;event, TcpCommand *tcpCommand, cMessage *msg)</div><div class="ttdef"><b>Definition:</b> TcpConnectionEventProc.cc:102</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a1f4034777ecaed134ee827b75c30a3aa"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a1f4034777ecaed134ee827b75c30a3aa">inet::tcp::TcpConnection::sndNxtSignal</a></div><div class="ttdeci">static simsignal_t sndNxtSignal</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:320</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_receive_queue_html_a33616fbda89adf0349d57da426cafba0"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_receive_queue.html#a33616fbda89adf0349d57da426cafba0">inet::tcp::TcpReceiveQueue::getAmountOfBufferedBytes</a></div><div class="ttdeci">virtual uint32_t getAmountOfBufferedBytes()</div><div class="ttdoc">Returns the number of bytes (out-of-order-segments) currently buffered in queue.</div><div class="ttdef"><b>Definition:</b> TcpReceiveQueue.cc:103</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a54c3832df2b9cbee3f8496761ef90892">inet::tcp::TCP_S_CLOSING</a></div><div class="ttdeci">@ TCP_S_CLOSING</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:57</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea821852d71e232c2c690d5f4e84f66cc7"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea821852d71e232c2c690d5f4e84f66cc7">inet::tcp::TCP_E_QUEUE_BYTES_LIMIT</a></div><div class="ttdeci">@ TCP_E_QUEUE_BYTES_LIMIT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:78</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ac163abb43e0e8766058386b35caf02c3"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ac163abb43e0e8766058386b35caf02c3">inet::tcp::TcpStateVariables::snd_una</a></div><div class="ttdeci">uint32_t snd_una</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:147</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a9e4919e1e33b26ff813c075500cde40d"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a9e4919e1e33b26ff813c075500cde40d">inet::tcp::TcpStateVariables::active</a></div><div class="ttdeci">bool active</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:139</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a9427c96c47960d86c30f2addbee224c0"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a9427c96c47960d86c30f2addbee224c0">inet::tcp::TcpConnection::the2MSLTimer</a></div><div class="ttdeci">cMessage * the2MSLTimer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:382</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90a9bb991a408e4e309ac29197675b7e293">inet::tcp::TCP_S_SYN_SENT</a></div><div class="ttdeci">@ TCP_S_SYN_SENT</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:50</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aaad86607f56deaf3104a2c84b28ddb3b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aaad86607f56deaf3104a2c84b28ddb3b">inet::tcp::TcpStateVariables::snd_sack</a></div><div class="ttdeci">bool snd_sack</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:221</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a0bf09e30d4d6dc10f5d58be0c76b787a"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0bf09e30d4d6dc10f5d58be0c76b787a">inet::tcp::TcpStateVariables::rcv_up</a></div><div class="ttdeci">uint32_t rcv_up</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:159</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a63f81359bde6fbd0cca323cfa056ff79"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a63f81359bde6fbd0cca323cfa056ff79">inet::tcp::TcpStateVariables::endPointIsWillingECN</a></div><div class="ttdeci">bool endPointIsWillingECN</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:254</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a3f713d3c35004f40eef567f610f83127"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a3f713d3c35004f40eef567f610f83127">inet::tcp::TcpConnection::stateName</a></div><div class="ttdeci">static const char * stateName(int state)</div><div class="ttdoc">Utility: returns name of TCP_S_xxx constants.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:42</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a98ad81d8ce1e5dbfd40bd83a34b6d340"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a98ad81d8ce1e5dbfd40bd83a34b6d340">inet::tcp::TcpConnection::processSACKPermittedOption</a></div><div class="ttdeci">virtual bool processSACKPermittedOption(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, const TcpOptionSackPermitted &amp;option)</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1222</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a1ee55dc20af304777e821e2aad73395b"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a1ee55dc20af304777e821e2aad73395b">inet::tcp::TcpStateVariables::usedRcvBuffer</a></div><div class="ttdeci">uint32_t usedRcvBuffer</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:244</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_a0b544cc8ab57b7d381371b0d1cc671f4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#a0b544cc8ab57b7d381371b0d1cc671f4">inet::tcp::TcpAlgorithm::shouldMarkAck</a></div><div class="ttdeci">virtual bool shouldMarkAck()=0</div><div class="ttdoc">Called before sending ACK.</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a37e2a54894d305fb793ce1c5fa00ed70"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a37e2a54894d305fb793ce1c5fa00ed70">inet::tcp::TcpConnection::rexmitQueue</a></div><div class="ttdeci">TcpSackRexmitQueue * rexmitQueue</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:373</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_af0709b8c1e83b2b343bfb76ac5adb1df"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#af0709b8c1e83b2b343bfb76ac5adb1df">inet::tcp::TcpConnection::localAddr</a></div><div class="ttdeci">L3Address localAddr</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:345</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a7494b90535c253ba63d16dd6d0d124bb"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a7494b90535c253ba63d16dd6d0d124bb">inet::tcp::TcpStateVariables::rcv_fin_seq</a></div><div class="ttdeci">uint32_t rcv_fin_seq</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:177</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a394722524509d5d21099d92591144a33"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a394722524509d5d21099d92591144a33">inet::tcp::TCP_MIN_HEADER_LENGTH</a></div><div class="ttdeci">const B TCP_MIN_HEADER_LENGTH</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:63</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aa185cf408f70835f6cd64b8908896f7d5"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aa185cf408f70835f6cd64b8908896f7d5">inet::TCP_I_SEND_MSG</a></div><div class="ttdeci">@ TCP_I_SEND_MSG</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:135</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a17785afe28ff4c5d721e172d7cfcd766"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a17785afe28ff4c5d721e172d7cfcd766">inet::tcp::TcpStateVariables::pipe</a></div><div class="ttdeci">uint32_t pipe</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:225</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_adb71143849cc54f0d0dabdc196dc7213"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#adb71143849cc54f0d0dabdc196dc7213">inet::tcp::TcpConnection::sendAvailableDataToApp</a></div><div class="ttdeci">virtual void sendAvailableDataToApp()</div><div class="ttdoc">Utility: sends data or data notification to application.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:387</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_aef06677c8426a5171aa0fa5b88f8a97c"><div class="ttname"><a href="namespaceinet_1_1tcp.html#aef06677c8426a5171aa0fa5b88f8a97c">inet::tcp::seqGreater</a></div><div class="ttdeci">bool seqGreater(uint32_t a, uint32_t b)</div><div class="ttdef"><b>Definition:</b> TcpHeader.h:23</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a876457e27b60f07de2105e66bc506772a6f75ef3f275801e12e682432472c26a9"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a876457e27b60f07de2105e66bc506772a6f75ef3f275801e12e682432472c26a9">inet::tcp::TCPOPTION_NO_OPERATION</a></div><div class="ttdeci">@ TCPOPTION_NO_OPERATION</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:116</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a88a1f002d9ffdc83267c750151631bda"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a88a1f002d9ffdc83267c750151631bda">inet::tcp::TcpConnection::writeHeaderOptions</a></div><div class="ttdeci">virtual TcpHeader writeHeaderOptions(const Ptr&lt; TcpHeader &gt; &amp;tcpHeader)</div><div class="ttdoc">Utility: writeHeaderOptions (Currently only EOL, NOP, MSS, WS, SACK_PERMITTED, SACK and TS are implem...</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1240</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a93a9cc36b133cd8131fdb307e3e55d1e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a93a9cc36b133cd8131fdb307e3e55d1e">inet::tcp::TcpStateVariables::iss</a></div><div class="ttdeci">uint32_t iss</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:154</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a759a1d53d5b30d2a1f5f14bb76bf55a4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a759a1d53d5b30d2a1f5f14bb76bf55a4">inet::tcp::TcpConnection::stateEntered</a></div><div class="ttdeci">virtual void stateEntered(int state, int oldState, TcpEventCode event)</div><div class="ttdoc">Perform cleanup necessary when entering a new state, e.g.</div><div class="ttdef"><b>Definition:</b> TcpConnectionBase.cc:692</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_aeac7b3b676b6f9c09ea2d62865faa1e4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#aeac7b3b676b6f9c09ea2d62865faa1e4">inet::tcp::TcpStateVariables::snd_up</a></div><div class="ttdeci">uint32_t snd_up</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:151</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_aa80bf8e7fb79fd2553dbd0053d1939c9"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#aa80bf8e7fb79fd2553dbd0053d1939c9">inet::tcp::Tcp::getEphemeralPort</a></div><div class="ttdeci">virtual ushort getEphemeralPort()</div><div class="ttdoc">To be called from TcpConnection: reserves an ephemeral port for the connection.</div><div class="ttdef"><b>Definition:</b> Tcp.cc:274</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_a1322918e1985b3e30c63a82c62834b4c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#a1322918e1985b3e30c63a82c62834b4c">inet::tcp::TcpConnection::sendSyn</a></div><div class="ttdeci">virtual void sendSyn()</div><div class="ttdoc">Utility: send SYN.</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:538</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_algorithm_html_ae45a513394fa38752737ea7e8caea65e"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_algorithm.html#ae45a513394fa38752737ea7e8caea65e">inet::tcp::TcpAlgorithm::getStateVariables</a></div><div class="ttdeci">TcpStateVariables * getStateVariables()</div><div class="ttdoc">Creates and returns the TCP state variables.</div><div class="ttdef"><b>Definition:</b> TcpAlgorithm.h:57</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bead15e53bbf4b2e8a16e2182c800d4486a">inet::tcp::TCP_E_RCV_RST</a></div><div class="ttdeci">@ TCP_E_RCV_RST</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:89</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a35c1cb3c5353627c533a2abf890e0f90ad97519c5051122134decdc6576b1f451">inet::tcp::TCP_S_FIN_WAIT_2</a></div><div class="ttdeci">@ TCP_S_FIN_WAIT_2</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:56</div></div>
<div class="ttc" id="anamespaceinet_html_ac8175ca68b0984f2ed7c1362f8c6955da92d48e3b12bc59fb1903c1b060dd18c2"><div class="ttname"><a href="namespaceinet.html#ac8175ca68b0984f2ed7c1362f8c6955da92d48e3b12bc59fb1903c1b060dd18c2">inet::IP_ECN_ECT_1</a></div><div class="ttdeci">@ IP_ECN_ECT_1</div><div class="ttdef"><b>Definition:</b> EcnTag_m.h:60</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_a0d364684b9e1a5431c5376e48a81e88c"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#a0d364684b9e1a5431c5376e48a81e88c">inet::tcp::Tcp::getMsl</a></div><div class="ttdeci">int getMsl()</div><div class="ttdef"><b>Definition:</b> Tcp.h:198</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_sack_rexmit_queue_html_ae184954440450a87d85bd0203686e916"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_sack_rexmit_queue.html#ae184954440450a87d85bd0203686e916">inet::tcp::TcpSackRexmitQueue::getNumOfDiscontiguousSacks</a></div><div class="ttdeci">virtual uint32_t getNumOfDiscontiguousSacks(uint32_t seqNum) const</div><div class="ttdoc">Returns the number of discontiguous sacked regions (SACKed sequences) above seqNum.</div><div class="ttdef"><b>Definition:</b> TcpSackRexmitQueue.cc:335</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_connection_html_af6a60e79915ff54a4a91715cb6318593"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_connection.html#af6a60e79915ff54a4a91715cb6318593">inet::tcp::TcpConnection::updateWndInfo</a></div><div class="ttdeci">virtual void updateWndInfo(const Ptr&lt; const TcpHeader &gt; &amp;tcpHeader, bool doAlways=false)</div><div class="ttdoc">Utility: update window information (snd_wnd, snd_wl1, snd_wl2)</div><div class="ttdef"><b>Definition:</b> TcpConnectionUtil.cc:1486</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a5968e29470e4155db503982ded1d33bea950c5d5064f7f480184d70bcc8773434"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a5968e29470e4155db503982ded1d33bea950c5d5064f7f480184d70bcc8773434">inet::tcp::TCP_E_OPEN_PASSIVE</a></div><div class="ttdeci">@ TCP_E_OPEN_PASSIVE</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:71</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a0661140e945cf90dc88160caff33b217"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a0661140e945cf90dc88160caff33b217">inet::tcp::TcpStateVariables::snd_max</a></div><div class="ttdeci">uint32_t snd_max</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:149</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_ab8a10a273ecf8245f1dd9fdf6d32bec6"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#ab8a10a273ecf8245f1dd9fdf6d32bec6">inet::tcp::TcpStateVariables::rexmit</a></div><div class="ttdeci">bool rexmit</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:258</div></div>
<div class="ttc" id="anamespaceinet_1_1tcp_html_a44d1be9a5e80c9a4d00b6aa721d3e040"><div class="ttname"><a href="namespaceinet_1_1tcp.html#a44d1be9a5e80c9a4d00b6aa721d3e040">inet::tcp::TCP_OPTION_SACK_MIN_SIZE</a></div><div class="ttdeci">const B TCP_OPTION_SACK_MIN_SIZE</div><div class="ttdef"><b>Definition:</b> TcpHeader_m.h:68</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_html_aeae495db5f1d8d158c70fd2b341574d2"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp.html#aeae495db5f1d8d158c70fd2b341574d2">inet::tcp::Tcp::addSockPair</a></div><div class="ttdeci">virtual void addSockPair(TcpConnection *conn, L3Address localAddr, L3Address remoteAddr, int localPort, int remotePort)</div><div class="ttdoc">To be called from TcpConnection when a new connection gets created, during processing of OPEN_ACTIVE ...</div><div class="ttdef"><b>Definition:</b> Tcp.cc:304</div></div>
<div class="ttc" id="anamespaceinet_html_a2a9e726bf850a4d002289e59f67c725aabb53e95b49db823f33684deac8819842"><div class="ttname"><a href="namespaceinet.html#a2a9e726bf850a4d002289e59f67c725aabb53e95b49db823f33684deac8819842">inet::TCP_I_CONNECTION_REFUSED</a></div><div class="ttdeci">@ TCP_I_CONNECTION_REFUSED</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:131</div></div>
<div class="ttc" id="anamespaceinet_html_a05e2e48834f511a2902c8b8a2aec41b5a7e9bf63012b141c33bf32608de5c5a24"><div class="ttname"><a href="namespaceinet.html#a05e2e48834f511a2902c8b8a2aec41b5a7e9bf63012b141c33bf32608de5c5a24">inet::TCP_C_OPEN_ACTIVE</a></div><div class="ttdeci">@ TCP_C_OPEN_ACTIVE</div><div class="ttdef"><b>Definition:</b> TcpCommand_m.h:82</div></div>
<div class="ttc" id="aclassinet_1_1tcp_1_1_tcp_state_variables_html_a6498b2145c0cfb48d697974321f662a4"><div class="ttname"><a href="classinet_1_1tcp_1_1_tcp_state_variables.html#a6498b2145c0cfb48d697974321f662a4">inet::tcp::TcpStateVariables::delayed_acks_enabled</a></div><div class="ttdeci">bool delayed_acks_enabled</div><div class="ttdef"><b>Definition:</b> TcpConnection.h:180</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceinet.html">inet</a></li><li class="navelem"><a class="el" href="namespaceinet_1_1tcp.html">tcp</a></li><li class="navelem"><a class="el" href="classinet_1_1tcp_1_1_tcp_connection.html">TcpConnection</a></li>
    <li class="footer">Generated on Sun Apr 10 2022 21:00:44 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
