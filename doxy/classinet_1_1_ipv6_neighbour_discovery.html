<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>INET Framework for OMNeT++/OMNEST: inet::Ipv6NeighbourDiscovery Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="opp.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classinet_1_1_ipv6_neighbour_discovery.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classinet_1_1_ipv6_neighbour_discovery-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inet::Ipv6NeighbourDiscovery Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements RFC 2461 Neighbor Discovery for <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a>.  
 <a href="classinet_1_1_ipv6_neighbour_discovery.html#details">More...</a></p>

<p><code>#include &lt;Ipv6NeighbourDiscovery.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for inet::Ipv6NeighbourDiscovery:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classinet_1_1_ipv6_neighbour_discovery.png" usemap="#inet::Ipv6NeighbourDiscovery_map" alt=""/>
  <map id="inet::Ipv6NeighbourDiscovery_map" name="inet::Ipv6NeighbourDiscovery_map">
<area href="classinet_1_1_lifecycle_unsupported.html" alt="inet::LifecycleUnsupported" shape="rect" coords="189,56,368,80"/>
<area href="classinet_1_1_i_lifecycle.html" title="Interface to be implemented by modules that want to support failure/recovery, shutdown/restart,..." alt="inet::ILifecycle" shape="rect" coords="189,0,368,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_adv_if_entry.html">AdvIfEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_dad_entry.html">DadEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_rd_entry.html">RdEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a3fbd67788781a9d929cfbbd293be7716"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classinet_1_1_packet.html">Packet</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a3fbd67788781a9d929cfbbd293be7716">MsgPtrVector</a></td></tr>
<tr class="separator:a3fbd67788781a9d929cfbbd293be7716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f6e782255b8c0e61fa1c474d13cb27"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_key.html">Ipv6NeighbourCache::Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a></td></tr>
<tr class="separator:a72f6e782255b8c0e61fa1c474d13cb27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42f495d6268186cb5616025bbe52901c"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html">Ipv6NeighbourCache::Neighbour</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a></td></tr>
<tr class="separator:a42f495d6268186cb5616025bbe52901c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac731b180d5b32fcbedfaf4fb99795a7a"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classinet_1_1_ipv6_neighbour_cache_1_1_default_router_list.html">Ipv6NeighbourCache::DefaultRouterList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac731b180d5b32fcbedfaf4fb99795a7a">DefaultRouterList</a></td></tr>
<tr class="separator:ac731b180d5b32fcbedfaf4fb99795a7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae9301f0bc879176acb7be6bcb3b88032"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae9301f0bc879176acb7be6bcb3b88032">Ipv6NeighbourDiscovery</a> ()</td></tr>
<tr class="separator:ae9301f0bc879176acb7be6bcb3b88032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fbdf352f9ee7ae5559dafc5d95f6153"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1fbdf352f9ee7ae5559dafc5d95f6153">~Ipv6NeighbourDiscovery</a> ()</td></tr>
<tr class="separator:a1fbdf352f9ee7ae5559dafc5d95f6153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac94a0f1736ad699faa4f2207a0b1b4a8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classinet_1_1_mac_address.html">MacAddress</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac94a0f1736ad699faa4f2207a0b1b4a8">resolveNeighbour</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;nextHop, int interfaceId)</td></tr>
<tr class="memdesc:ac94a0f1736ad699faa4f2207a0b1b4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public method, to be invoked from the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module to determine link-layer address and the output interface of the next hop.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#ac94a0f1736ad699faa4f2207a0b1b4a8">More...</a><br /></td></tr>
<tr class="separator:ac94a0f1736ad699faa4f2207a0b1b4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af637e15ac37dec83545e2e79bf4fca98"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af637e15ac37dec83545e2e79bf4fca98">reachabilityConfirmed</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;neighbour, int interfaceId)</td></tr>
<tr class="memdesc:af637e15ac37dec83545e2e79bf4fca98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public method, it can be invoked from the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module or any other module to let Neighbour Discovery know that the reachability of the given neighbor has just been confirmed (e.g.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#af637e15ac37dec83545e2e79bf4fca98">More...</a><br /></td></tr>
<tr class="separator:af637e15ac37dec83545e2e79bf4fca98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classinet_1_1_lifecycle_unsupported"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classinet_1_1_lifecycle_unsupported')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classinet_1_1_lifecycle_unsupported.html">inet::LifecycleUnsupported</a></td></tr>
<tr class="memitem:a3edd8099c4db84a405a93aaeadf543f2 inherit pub_methods_classinet_1_1_lifecycle_unsupported"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_lifecycle_unsupported.html#a3edd8099c4db84a405a93aaeadf543f2">handleOperationStage</a> (<a class="el" href="classinet_1_1_lifecycle_operation.html">LifecycleOperation</a> *operation, <a class="el" href="classinet_1_1_i_done_callback.html">IDoneCallback</a> *doneCallback) override</td></tr>
<tr class="memdesc:a3edd8099c4db84a405a93aaeadf543f2 inherit pub_methods_classinet_1_1_lifecycle_unsupported"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform one stage of a lifecycle operation.  <a href="classinet_1_1_lifecycle_unsupported.html#a3edd8099c4db84a405a93aaeadf543f2">More...</a><br /></td></tr>
<tr class="separator:a3edd8099c4db84a405a93aaeadf543f2 inherit pub_methods_classinet_1_1_lifecycle_unsupported"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classinet_1_1_i_lifecycle"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classinet_1_1_i_lifecycle')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classinet_1_1_i_lifecycle.html">inet::ILifecycle</a></td></tr>
<tr class="memitem:a42ada991baf0d85f6c3b4adcf2b0e87b inherit pub_methods_classinet_1_1_i_lifecycle"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_i_lifecycle.html#a42ada991baf0d85f6c3b4adcf2b0e87b">~ILifecycle</a> ()</td></tr>
<tr class="separator:a42ada991baf0d85f6c3b4adcf2b0e87b inherit pub_methods_classinet_1_1_i_lifecycle"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:ae227a389fec9f2515d4ce65cf5b62828"><td class="memItemLeft" align="right" valign="top">typedef std::set&lt; cMessage * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae227a389fec9f2515d4ce65cf5b62828">RaTimerList</a></td></tr>
<tr class="separator:ae227a389fec9f2515d4ce65cf5b62828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3bf14aa09cfc17052f2649f097a198f"><td class="memItemLeft" align="right" valign="top">typedef std::set&lt; <a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_dad_entry.html">DadEntry</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af3bf14aa09cfc17052f2649f097a198f">DadList</a></td></tr>
<tr class="separator:af3bf14aa09cfc17052f2649f097a198f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de1796c8bccf6250c13f80500af4fc8"><td class="memItemLeft" align="right" valign="top">typedef std::set&lt; <a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_rd_entry.html">RdEntry</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1de1796c8bccf6250c13f80500af4fc8">RdList</a></td></tr>
<tr class="separator:a1de1796c8bccf6250c13f80500af4fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a133a74558097ce3e1f58ee85350af2ee"><td class="memItemLeft" align="right" valign="top">typedef std::set&lt; <a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_adv_if_entry.html">AdvIfEntry</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a133a74558097ce3e1f58ee85350af2ee">AdvIfList</a></td></tr>
<tr class="separator:a133a74558097ce3e1f58ee85350af2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae321b56ae012d739e84651811d247a84"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae321b56ae012d739e84651811d247a84">numInitStages</a> () const override</td></tr>
<tr class="separator:ae321b56ae012d739e84651811d247a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16a7053ca26034297580c0568ef48a4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize</a> (int stage) override</td></tr>
<tr class="separator:ad16a7053ca26034297580c0568ef48a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60cb60d89f39802b186fa30cab992954"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage</a> (cMessage *msg) override</td></tr>
<tr class="separator:a60cb60d89f39802b186fa30cab992954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae11d641202039eb04a11cf497508cc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_icmpv6_header.html">Icmpv6Header</a> *msg)</td></tr>
<tr class="separator:a4ae11d641202039eb04a11cf497508cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a270fa069d853e08ad5ccdd1c1330f839"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a270fa069d853e08ad5ccdd1c1330f839">finish</a> () override</td></tr>
<tr class="separator:a270fa069d853e08ad5ccdd1c1330f839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae17f560536bd339bfccddc2623a9a60"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet)</td></tr>
<tr class="separator:aae17f560536bd339bfccddc2623a9a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69afa04d7f16597917a932346cd2dff7"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_adv_if_entry.html">Ipv6NeighbourDiscovery::AdvIfEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a69afa04d7f16597917a932346cd2dff7">fetchAdvIfEntry</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a69afa04d7f16597917a932346cd2dff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac781673fa35d079fc0569013a1543b72"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_rd_entry.html">Ipv6NeighbourDiscovery::RdEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac781673fa35d079fc0569013a1543b72">fetchRdEntry</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:ac781673fa35d079fc0569013a1543b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58403829a82d8e16c1088f1a7d974e8a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a58403829a82d8e16c1088f1a7d974e8a">determineNextHop</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;destAddr, int &amp;outIfID)</td></tr>
<tr class="memdesc:a58403829a82d8e16c1088f1a7d974e8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function accepts the datagram's destination address and attempts to determine the destination's next hop address and interface ID by: (1) looking up the destination cache, (2)looking up the routing table, or (3) selecting a default router.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a58403829a82d8e16c1088f1a7d974e8a">More...</a><br /></td></tr>
<tr class="separator:a58403829a82d8e16c1088f1a7d974e8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed4e9d56a44c338ea001e9211569588"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#afed4e9d56a44c338ea001e9211569588">initiateNeighbourUnreachabilityDetection</a> (<a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *neighbour)</td></tr>
<tr class="separator:afed4e9d56a44c338ea001e9211569588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a974038ffaaefc3afe370f22e7deb4abb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a974038ffaaefc3afe370f22e7deb4abb">processNudTimeout</a> (cMessage *timeoutMsg)</td></tr>
<tr class="separator:a974038ffaaefc3afe370f22e7deb4abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4354002e9435d6c52390575b79a26d0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad4354002e9435d6c52390575b79a26d0">selectDefaultRouter</a> (int &amp;outIfID)</td></tr>
<tr class="separator:ad4354002e9435d6c52390575b79a26d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0952be7b9362cd542d795cd2d8af858e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0952be7b9362cd542d795cd2d8af858e">timeoutPrefixEntry</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;destPrefix, int prefixLength)</td></tr>
<tr class="memdesc:a0952be7b9362cd542d795cd2d8af858e"><td class="mdescLeft">&#160;</td><td class="mdescRight">RFC 2461: Section 6.3.5 Whenever the invalidation timer expires for a Prefix List entry, that entry is discarded.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a0952be7b9362cd542d795cd2d8af858e">More...</a><br /></td></tr>
<tr class="separator:a0952be7b9362cd542d795cd2d8af858e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5d2ce626c1d5ebe787101eacfc97df"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0b5d2ce626c1d5ebe787101eacfc97df">timeoutDefaultRouter</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;addr, int interfaceID)</td></tr>
<tr class="memdesc:a0b5d2ce626c1d5ebe787101eacfc97df"><td class="mdescLeft">&#160;</td><td class="mdescRight">RFC 2461: Section 6.3.5 Whenever the Lifetime of an entry in the Default Router List expires, that entry is discarded.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a0b5d2ce626c1d5ebe787101eacfc97df">More...</a><br /></td></tr>
<tr class="separator:a0b5d2ce626c1d5ebe787101eacfc97df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95ab88a9f54400a96e69c7197692d325"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a95ab88a9f54400a96e69c7197692d325">initiateAddressResolution</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dgSrcAddr, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce)</td></tr>
<tr class="memdesc:a95ab88a9f54400a96e69c7197692d325"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method attempts to resolve the given neighbour's link-layer address.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a95ab88a9f54400a96e69c7197692d325">More...</a><br /></td></tr>
<tr class="separator:a95ab88a9f54400a96e69c7197692d325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31d32a84a4bb0111c3f4216ba8c73bbc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">processArTimeout</a> (cMessage *arTimeoutMsg)</td></tr>
<tr class="memdesc:a31d32a84a4bb0111c3f4216ba8c73bbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resends a NS packet to the address intended for address resolution.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">More...</a><br /></td></tr>
<tr class="separator:a31d32a84a4bb0111c3f4216ba8c73bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0fcf592fe394c5614522491abd845f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">dropQueuedPacketsAwaitingAr</a> (<a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce)</td></tr>
<tr class="memdesc:a4e0fcf592fe394c5614522491abd845f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drops specific queued packets for a specific NCE AR-timeout.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">More...</a><br /></td></tr>
<tr class="separator:a4e0fcf592fe394c5614522491abd845f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa719d2a80f993cd2091cdcb9e1e2ded8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">sendPacketToIpv6Module</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *msg, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;destAddr, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;srcAddr, int interfaceId)</td></tr>
<tr class="memdesc:aa719d2a80f993cd2091cdcb9e1e2ded8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create control info and assigns it to a msg.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">More...</a><br /></td></tr>
<tr class="separator:aa719d2a80f993cd2091cdcb9e1e2ded8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68d77f1a5ed7ed3daf4e44d25e7c57d6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a68d77f1a5ed7ed3daf4e44d25e7c57d6">sendQueuedPacketsToIpv6Module</a> (<a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce)</td></tr>
<tr class="memdesc:a68d77f1a5ed7ed3daf4e44d25e7c57d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send off any queued packets within the Neighbour Discovery module awaiting address resolution.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a68d77f1a5ed7ed3daf4e44d25e7c57d6">More...</a><br /></td></tr>
<tr class="separator:a68d77f1a5ed7ed3daf4e44d25e7c57d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed7ee5ee69631757e9439e54a7e7e980"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">initiateDad</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;tentativeAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:aed7ee5ee69631757e9439e54a7e7e980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiating DAD means to send off a Neighbour Solicitation with its target address set as this node's tentative link-local address.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">More...</a><br /></td></tr>
<tr class="separator:aed7ee5ee69631757e9439e54a7e7e980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49ef5934320202c550ee03b2bea178b0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">processDadTimeout</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a49ef5934320202c550ee03b2bea178b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a scheduled DAD NS packet.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">More...</a><br /></td></tr>
<tr class="separator:a49ef5934320202c550ee03b2bea178b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49804b7936addaf44c498b28c2757fa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac49804b7936addaf44c498b28c2757fa">makeTentativeAddressPermanent</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;tentativeAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:ac49804b7936addaf44c498b28c2757fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Permanently assign the given address for the given interface entry.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#ac49804b7936addaf44c498b28c2757fa">More...</a><br /></td></tr>
<tr class="separator:ac49804b7936addaf44c498b28c2757fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0b078c7b87d8f58ad6e43de5c37089"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">assignLinkLocalAddress</a> (cMessage *timerMsg)</td></tr>
<tr class="memdesc:a1e0b078c7b87d8f58ad6e43de5c37089"><td class="mdescLeft">&#160;</td><td class="mdescRight">as it is not possbile to explicitly define RFC 2462.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">More...</a><br /></td></tr>
<tr class="separator:a1e0b078c7b87d8f58ad6e43de5c37089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0074c0980ba136204e92b58293c0768b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0074c0980ba136204e92b58293c0768b">createAndSendRsPacket</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a0074c0980ba136204e92b58293c0768b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada0656767ed0fc44353b64524b681c3e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ada0656767ed0fc44353b64524b681c3e">initiateRouterDiscovery</a> (cMessage *msg)</td></tr>
<tr class="separator:ada0656767ed0fc44353b64524b681c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af725a09fc820f4212c28e9a057e3f1eb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af725a09fc820f4212c28e9a057e3f1eb">cancelRouterDiscovery</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:af725a09fc820f4212c28e9a057e3f1eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">RFC 2461: Section 6.3.7 4th paragraph Once the host sends a Router Solicitation, and receives a valid Router Advertisement with a non-zero Router Lifetime, the host MUST desist from sending additional solicitations on that interface,.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#af725a09fc820f4212c28e9a057e3f1eb">More...</a><br /></td></tr>
<tr class="separator:af725a09fc820f4212c28e9a057e3f1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ee162e2bb2ddeb05382151def252fa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad7ee162e2bb2ddeb05382151def252fa">processRdTimeout</a> (cMessage *msg)</td></tr>
<tr class="separator:ad7ee162e2bb2ddeb05382151def252fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6545a821734516cb41b46ea3018768e6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a6545a821734516cb41b46ea3018768e6">processRsPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_router_solicitation.html">Ipv6RouterSolicitation</a> *rs)</td></tr>
<tr class="separator:a6545a821734516cb41b46ea3018768e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e577327ead9f3ba0c9165c6086f94b"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aa5e577327ead9f3ba0c9165c6086f94b">validateRsPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_router_solicitation.html">Ipv6RouterSolicitation</a> *rs)</td></tr>
<tr class="separator:aa5e577327ead9f3ba0c9165c6086f94b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f8917e02b416330fd8fc446f548735"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">createAndSendRaPacket</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;destAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a69f8917e02b416330fd8fc446f548735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ab43456af51d304c3079313d0c834d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *ra)</td></tr>
<tr class="separator:ad0ab43456af51d304c3079313d0c834d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f59bd32ca1ae82ee472c9aaf1250b5f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *ra)</td></tr>
<tr class="separator:a5f59bd32ca1ae82ee472c9aaf1250b5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e81888790f212685a2a3a483481dee"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a53e81888790f212685a2a3a483481dee">processRaPrefixInfo</a> (const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *ra, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a53e81888790f212685a2a3a483481dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41970533db31303c76cd7929c9cbb87c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a41970533db31303c76cd7929c9cbb87c">processRaPrefixInfoForAddrAutoConf</a> (const <a class="el" href="classinet_1_1_ipv6_nd_prefix_information.html">Ipv6NdPrefixInformation</a> &amp;prefixInfo, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a41970533db31303c76cd7929c9cbb87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd8d8f8fb25e14520eebf1ffd3e8638"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1bd8d8f8fb25e14520eebf1ffd3e8638">createRaTimer</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:a1bd8d8f8fb25e14520eebf1ffd3e8638"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a timer for the given interface entry that sends periodic Router Advertisements.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#a1bd8d8f8fb25e14520eebf1ffd3e8638">More...</a><br /></td></tr>
<tr class="separator:a1bd8d8f8fb25e14520eebf1ffd3e8638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7743dc27c4a5b6aa7bcb4ba295cdfac"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af7743dc27c4a5b6aa7bcb4ba295cdfac">resetRaTimer</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:af7743dc27c4a5b6aa7bcb4ba295cdfac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the given interface entry's Router Advertisement timer.  <a href="classinet_1_1_ipv6_neighbour_discovery.html#af7743dc27c4a5b6aa7bcb4ba295cdfac">More...</a><br /></td></tr>
<tr class="separator:af7743dc27c4a5b6aa7bcb4ba295cdfac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a5eeceb530ef5ec54f5116e95b51b83"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0a5eeceb530ef5ec54f5116e95b51b83">sendPeriodicRa</a> (cMessage *msg)</td></tr>
<tr class="separator:a0a5eeceb530ef5ec54f5116e95b51b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66149131978353b4c56809f18035cfa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae66149131978353b4c56809f18035cfa">sendSolicitedRa</a> (cMessage *msg)</td></tr>
<tr class="separator:ae66149131978353b4c56809f18035cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f776f294e2d817343427ccef1479f1a"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a3f776f294e2d817343427ccef1479f1a">validateRaPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *ra)</td></tr>
<tr class="separator:a3f776f294e2d817343427ccef1479f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c5a1874ba2a53bc3b1f6f12f7960595"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;nsTargetAddr, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dgDestAddr, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dgSrcAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a5c5a1874ba2a53bc3b1f6f12f7960595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a3fdd591f0f9afdd924d561c0e71cb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">processNsPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *<a class="el" href="namespaceinet_1_1units_1_1values.html#ae1cce124d42b1c11aa9d13e9ed7d113f">ns</a>)</td></tr>
<tr class="separator:a77a3fdd591f0f9afdd924d561c0e71cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909f55a15fe0bdf6de9dd34664b1ab27"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a909f55a15fe0bdf6de9dd34664b1ab27">validateNsPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *<a class="el" href="namespaceinet_1_1units_1_1values.html#ae1cce124d42b1c11aa9d13e9ed7d113f">ns</a>)</td></tr>
<tr class="separator:a909f55a15fe0bdf6de9dd34664b1ab27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9a227416f64d7dd9c80182a0d9c07f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4f9a227416f64d7dd9c80182a0d9c07f">processNsForTentativeAddress</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *<a class="el" href="namespaceinet_1_1units_1_1values.html#ae1cce124d42b1c11aa9d13e9ed7d113f">ns</a>)</td></tr>
<tr class="separator:a4f9a227416f64d7dd9c80182a0d9c07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f4663f98d7ead079225599d98ff0e9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac9f4663f98d7ead079225599d98ff0e9">processNsForNonTentativeAddress</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *<a class="el" href="namespaceinet_1_1units_1_1values.html#ae1cce124d42b1c11aa9d13e9ed7d113f">ns</a>, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:ac9f4663f98d7ead079225599d98ff0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af705b92b216d89adb9ecd0509c46c322"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af705b92b216d89adb9ecd0509c46c322">processNsWithSpecifiedSrcAddr</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *<a class="el" href="namespaceinet_1_1units_1_1values.html#ae1cce124d42b1c11aa9d13e9ed7d113f">ns</a>, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:af705b92b216d89adb9ecd0509c46c322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f48d8c4cac324ccebd842b32c9e0465"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">sendSolicitedNa</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *<a class="el" href="namespaceinet_1_1units_1_1values.html#ae1cce124d42b1c11aa9d13e9ed7d113f">ns</a>, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a8f48d8c4cac324ccebd842b32c9e0465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad69ece6c0328a87c63564034d620af19"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad69ece6c0328a87c63564034d620af19">sendUnsolicitedNa</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:ad69ece6c0328a87c63564034d620af19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f72c7b83a0bc8a33a2ddbcb31f4754d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *na)</td></tr>
<tr class="separator:a1f72c7b83a0bc8a33a2ddbcb31f4754d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17981233c1189689062894b35f19cf7a"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a17981233c1189689062894b35f19cf7a">validateNaPacket</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *na)</td></tr>
<tr class="separator:a17981233c1189689062894b35f19cf7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac7db21bc55a5ea3575d4298a34238d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8ac7db21bc55a5ea3575d4298a34238d">processNaForIncompleteNceState</a> (const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *na, <a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html">Ipv6NeighbourCache::Neighbour</a> *nce)</td></tr>
<tr class="separator:a8ac7db21bc55a5ea3575d4298a34238d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5a196dc851cd900c43606a87aa4214a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ab5a196dc851cd900c43606a87aa4214a">processNaForOtherNceStates</a> (const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *na, <a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html">Ipv6NeighbourCache::Neighbour</a> *nce)</td></tr>
<tr class="separator:ab5a196dc851cd900c43606a87aa4214a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf2eea6ee985b14d983b48962834ebdb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#abf2eea6ee985b14d983b48962834ebdb">createAndSendRedirectPacket</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:abf2eea6ee985b14d983b48962834ebdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba863f826a94e3cda5fe0530674f368c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aba863f826a94e3cda5fe0530674f368c">processRedirectPacket</a> (const <a class="el" href="classinet_1_1_ipv6_redirect.html">Ipv6Redirect</a> *redirect)</td></tr>
<tr class="separator:aba863f826a94e3cda5fe0530674f368c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ae56cb9501320961fdbecaa7091196f4e"><td class="memItemLeft" align="right" valign="top">cQueue&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae56cb9501320961fdbecaa7091196f4e">pendingQueue</a></td></tr>
<tr class="separator:ae56cb9501320961fdbecaa7091196f4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e12213fbe33b3cb3a838d9148a5d843"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_i_interface_table.html">IInterfaceTable</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a></td></tr>
<tr class="separator:a8e12213fbe33b3cb3a838d9148a5d843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab81ba417b96f24a632816551b750116c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_ipv6_routing_table.html">Ipv6RoutingTable</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a></td></tr>
<tr class="separator:ab81ba417b96f24a632816551b750116c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec34bce8a900f4950b15314399343ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_icmpv6.html">Icmpv6</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a9ec34bce8a900f4950b15314399343ab">icmpv6</a></td></tr>
<tr class="separator:a9ec34bce8a900f4950b15314399343ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96e74cfc876460fc5a5b9c452f6f1cb1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceinet.html#a8e064ca696c868d4b453ed29a327c268">CrcMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a> = <a class="el" href="namespaceinet.html#a8e064ca696c868d4b453ed29a327c268ac976c93f96267266fbe43cfd40f02bed">CRC_MODE_UNDEFINED</a></td></tr>
<tr class="separator:a96e74cfc876460fc5a5b9c452f6f1cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e41e16cf0b9351675924c57b1e92e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_ipv6_neighbour_cache.html">Ipv6NeighbourCache</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a></td></tr>
<tr class="separator:aa4e41e16cf0b9351675924c57b1e92e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c68a3688014e46919973b9658f76ad8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae227a389fec9f2515d4ce65cf5b62828">RaTimerList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a7c68a3688014e46919973b9658f76ad8">raTimerList</a></td></tr>
<tr class="separator:a7c68a3688014e46919973b9658f76ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed93f574978b74ed1468f72415cb9bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af3bf14aa09cfc17052f2649f097a198f">DadList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aeed93f574978b74ed1468f72415cb9bc">dadList</a></td></tr>
<tr class="separator:aeed93f574978b74ed1468f72415cb9bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e95b51db717607155679e42a61baa7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1de1796c8bccf6250c13f80500af4fc8">RdList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">rdList</a></td></tr>
<tr class="separator:a3e95b51db717607155679e42a61baa7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7698ec16351dd133fc0f6b1511bdadd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a133a74558097ce3e1f58ee85350af2ee">AdvIfList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae7698ec16351dd133fc0f6b1511bdadd">advIfList</a></td></tr>
<tr class="separator:ae7698ec16351dd133fc0f6b1511bdadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a053e86d782629b4bca3b8efb826c158e"><td class="memItemLeft" align="right" valign="top">static simsignal_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a053e86d782629b4bca3b8efb826c158e">startDadSignal</a> = registerSignal(&quot;startDad&quot;)</td></tr>
<tr class="separator:a053e86d782629b4bca3b8efb826c158e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements RFC 2461 Neighbor Discovery for <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a>. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a133a74558097ce3e1f58ee85350af2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a133a74558097ce3e1f58ee85350af2ee">&#9670;&nbsp;</a></span>AdvIfList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::set&lt;<a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_adv_if_entry.html">AdvIfEntry</a> *&gt; <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a133a74558097ce3e1f58ee85350af2ee">inet::Ipv6NeighbourDiscovery::AdvIfList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af3bf14aa09cfc17052f2649f097a198f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3bf14aa09cfc17052f2649f097a198f">&#9670;&nbsp;</a></span>DadList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::set&lt;<a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_dad_entry.html">DadEntry</a> *&gt; <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af3bf14aa09cfc17052f2649f097a198f">inet::Ipv6NeighbourDiscovery::DadList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac731b180d5b32fcbedfaf4fb99795a7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac731b180d5b32fcbedfaf4fb99795a7a">&#9670;&nbsp;</a></span>DefaultRouterList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classinet_1_1_ipv6_neighbour_cache_1_1_default_router_list.html">Ipv6NeighbourCache::DefaultRouterList</a> <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac731b180d5b32fcbedfaf4fb99795a7a">inet::Ipv6NeighbourDiscovery::DefaultRouterList</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a72f6e782255b8c0e61fa1c474d13cb27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f6e782255b8c0e61fa1c474d13cb27">&#9670;&nbsp;</a></span>Key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_key.html">Ipv6NeighbourCache::Key</a> <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">inet::Ipv6NeighbourDiscovery::Key</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3fbd67788781a9d929cfbbd293be7716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fbd67788781a9d929cfbbd293be7716">&#9670;&nbsp;</a></span>MsgPtrVector</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classinet_1_1_packet.html">Packet</a> *&gt; <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a3fbd67788781a9d929cfbbd293be7716">inet::Ipv6NeighbourDiscovery::MsgPtrVector</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a42f495d6268186cb5616025bbe52901c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42f495d6268186cb5616025bbe52901c">&#9670;&nbsp;</a></span>Neighbour</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html">Ipv6NeighbourCache::Neighbour</a> <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">inet::Ipv6NeighbourDiscovery::Neighbour</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae227a389fec9f2515d4ce65cf5b62828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae227a389fec9f2515d4ce65cf5b62828">&#9670;&nbsp;</a></span>RaTimerList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::set&lt;cMessage *&gt; <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae227a389fec9f2515d4ce65cf5b62828">inet::Ipv6NeighbourDiscovery::RaTimerList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1de1796c8bccf6250c13f80500af4fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1de1796c8bccf6250c13f80500af4fc8">&#9670;&nbsp;</a></span>RdList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::set&lt;<a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_rd_entry.html">RdEntry</a> *&gt; <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1de1796c8bccf6250c13f80500af4fc8">inet::Ipv6NeighbourDiscovery::RdList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae9301f0bc879176acb7be6bcb3b88032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9301f0bc879176acb7be6bcb3b88032">&#9670;&nbsp;</a></span>Ipv6NeighbourDiscovery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">inet::Ipv6NeighbourDiscovery::Ipv6NeighbourDiscovery </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>(*<span class="keyword">this</span>)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fbdf352f9ee7ae5559dafc5d95f6153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fbdf352f9ee7ae5559dafc5d95f6153">&#9670;&nbsp;</a></span>~Ipv6NeighbourDiscovery()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inet::Ipv6NeighbourDiscovery::~Ipv6NeighbourDiscovery </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// FIXME delete the following data structures, cancelAndDelete timers in them etc.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// Deleting the data structures my become unnecessary if the lists store the</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// structs themselves and not pointers.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//    RaTimerList raTimerList;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a7c68a3688014e46919973b9658f76ad8">raTimerList</a>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        cancelAndDelete(elem);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">delete</span> elem;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//    DadList dadList;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aeed93f574978b74ed1468f72415cb9bc">dadList</a>) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        cancelAndDelete((elem)-&gt;timeoutMsg);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keyword">delete</span> elem;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//    RdList rdList;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">rdList</a>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        cancelAndDelete((elem)-&gt;timeoutMsg);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keyword">delete</span> elem;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//    AdvIfList advIfList;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae7698ec16351dd133fc0f6b1511bdadd">advIfList</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        cancelAndDelete((elem)-&gt;raTimeoutMsg);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keyword">delete</span> elem;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1e0b078c7b87d8f58ad6e43de5c37089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e0b078c7b87d8f58ad6e43de5c37089">&#9670;&nbsp;</a></span>assignLinkLocalAddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::assignLinkLocalAddress </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>timerMsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>as it is not possbile to explicitly define RFC 2462. </p>
<p>ND is the next best place to do this.</p>
<p>RFC 2462-<a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> Stateless Address Autoconfiguration: Section 1 The autoconfiguration process specified in this document applies only to hosts and not routers. Since host autoconfiguration uses information advertised by routers, routers will need to be configured by some other means. However, it is expected that routers will generate link-local addresses using the mechanism described in this document. In addition, routers are expected to successfully pass the Duplicate Address Detection procedure described in this document on all addresses prior to assigning them to an interface. </p>
<div class="fragment"><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;{</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// Node has booted up. Start assigning a link-local address for each</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">// interface in this node.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getNumInterfaces(); i++) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterface(i);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="comment">// Skip the loopback interface.</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">if</span> (ie-&gt;isLoopback())</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        Ipv6Address linkLocalAddr = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getLinkLocalAddress();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">if</span> (linkLocalAddr.isUnspecified()) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="comment">// if no link local address exists for this interface, we assign one to it.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;No link local address exists. Forming one&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            linkLocalAddr = Ipv6Address().formLinkLocalAddress(ie-&gt;getInterfaceToken());</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;assignAddress(linkLocalAddr, <span class="keyword">true</span>, SIMTIME_ZERO, SIMTIME_ZERO);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="comment">// Before we can use this address, we MUST initiate DAD first.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;isTentativeAddress(linkLocalAddr)) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getDupAddrDetectTransmits() &gt; 0)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">initiateDad</a>(linkLocalAddr, ie);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ac49804b7936addaf44c498b28c2757fa">makeTentativeAddressPermanent</a>(linkLocalAddr, ie);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keyword">delete</span> timerMsg;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="af725a09fc820f4212c28e9a057e3f1eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af725a09fc820f4212c28e9a057e3f1eb">&#9670;&nbsp;</a></span>cancelRouterDiscovery()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::cancelRouterDiscovery </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RFC 2461: Section 6.3.7 4th paragraph Once the host sends a Router Solicitation, and receives a valid Router Advertisement with a non-zero Router Lifetime, the host MUST desist from sending additional solicitations on that interface,. </p>
<p>Cancel Router Discovery on the Interface where a RA was received with the given Interface Entry. </p>
<div class="fragment"><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;{</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// Next we retrieve the rdEntry with the Interface Entry.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    RdEntry *rdEntry = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ac781673fa35d079fc0569013a1543b72">fetchRdEntry</a>(ie);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">if</span> (rdEntry != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;rdEntry is not nullptr, RD cancelled!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        cancelAndDelete(rdEntry-&gt;timeoutMsg);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">rdList</a>.erase(rdEntry);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keyword">delete</span> rdEntry;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;rdEntry is nullptr, not cancelling RD!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket()</a>.</p>

</div>
</div>
<a id="a5c5a1874ba2a53bc3b1f6f12f7960595"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c5a1874ba2a53bc3b1f6f12f7960595">&#9670;&nbsp;</a></span>createAndSendNsPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::createAndSendNsPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>nsTargetAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dgDestAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dgSrcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;{</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;createAndSendNsPacket&quot;</span>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    MacAddress myMacAddr = ie-&gt;getMacAddress();</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160; </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="comment">// Construct a Neighbour Solicitation message</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a> = makeShared&lt;Ipv6NeighbourSolicitation&gt;();</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="comment">// Neighbour Solicitation Specific Information</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;setTargetAddress(nsTargetAddr);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="comment">/*If the solicitation is being sent to a solicited-node multicast</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">       address, the sender MUST include its link-layer address (if it has</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">       one) as a Source Link-Layer Address option.*/</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordflow">if</span> (dgDestAddr.matches(Ipv6Address(<span class="stringliteral">&quot;FF02::1:FF00:0&quot;</span>), 104) &amp;&amp; <span class="comment">// FIXME what&#39;s this? make constant...</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        !dgSrcAddr.isUnspecified())</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keyword">auto</span> sla = <span class="keyword">new</span> Ipv6NdSourceLinkLayerAddress();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        sla-&gt;setLinkLayerAddress(myMacAddr);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getOptionsForUpdate().appendOption(sla);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;addChunkLength(<a class="code" href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;NSpacket&quot;</span>);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <a class="code" href="classinet_1_1_icmpv6.html#ac142d92cd12e9ebf7b63304205678f86">Icmpv6::insertCrc</a>(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a>, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>, packet);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    packet-&gt;insertAtFront(<a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">sendPacketToIpv6Module</a>(packet, dgDestAddr, dgSrcAddr, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a95ab88a9f54400a96e69c7197692d325">initiateAddressResolution()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">initiateDad()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">processArTimeout()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">processDadTimeout()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a974038ffaaefc3afe370f22e7deb4abb">processNudTimeout()</a>.</p>

</div>
</div>
<a id="a69f8917e02b416330fd8fc446f548735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f8917e02b416330fd8fc446f548735">&#9670;&nbsp;</a></span>createAndSendRaPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::createAndSendRaPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Create and send RA invoked!\n&quot;</span>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// Must use link-local addr. See: RFC2461 Section 6.1.2</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    Ipv6Address sourceAddr = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getLinkLocalAddress();</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// This operation includes all options, regardless whether it is solicited or unsolicited.</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvSendAdvertisements()) { <span class="comment">// if this is an advertising interface</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="comment">// Construct a Router Advertisment message</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keyword">auto</span> ra = makeShared&lt;Ipv6RouterAdvertisement&gt;();</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="comment">// RFC 2461: Section 6.2.3 Router Advertisment Message Content</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="comment">/*A router sends periodic as well as solicited Router Advertisements out</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">           its advertising interfaces.  Outgoing Router Advertisements are filled</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">           with the following values consistent with the message format given in</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">           Section 4.2:*/</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">// - In the Router Lifetime field: the interface&#39;s configured AdvDefaultLifetime.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        ra-&gt;setRouterLifetime(SIMTIME_DBL(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvDefaultLifetime()));</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="comment">// - In the M and O flags: the interface&#39;s configured AdvManagedFlag and</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="comment">// AdvOtherConfigFlag, respectively.  See [ADDRCONF].</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        ra-&gt;setManagedAddrConfFlag(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvManagedFlag());</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        ra-&gt;setOtherStatefulConfFlag(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvOtherConfigFlag());</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="comment">// Configuring the HomeAgentFlag (H-bit) (RFC 3775): Zarrar 25.02.07</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isHomeAgent())</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            ra-&gt;setHomeAgentFlag(<span class="keyword">true</span>); <span class="comment">// Set H-bit if the router is a HA</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            ra-&gt;setHomeAgentFlag(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvHomeAgentFlag()); <span class="comment">// else unset it, which is default</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">// - In the Cur Hop Limit field: the interface&#39;s configured CurHopLimit.</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        ra-&gt;setCurHopLimit(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvCurHopLimit());</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="comment">// - In the Reachable Time field: the interface&#39;s configured AdvReachableTime.</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        ra-&gt;setReachableTime(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvReachableTime());</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">// - In the Retrans Timer field: the interface&#39;s configured AdvRetransTimer.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        ra-&gt;setRetransTimer(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvRetransTimer());</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">// - In the options:</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">/*o Source Link-Layer Address option: link-layer address of the sending</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">            interface.  (Assumption: We always send this)*/</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keyword">auto</span> sla = <span class="keyword">new</span> Ipv6NdSourceLinkLayerAddress();</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        sla-&gt;setLinkLayerAddress(ie-&gt;getMacAddress());</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        ra-&gt;getOptionsForUpdate().appendOption(sla);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        ra-&gt;addChunkLength(<a class="code" href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="comment">// set MTU option</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keyword">auto</span> mtu = <span class="keyword">new</span> Ipv6NdMtu();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        mtu-&gt;setMtu(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvLinkMtu());</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        ra-&gt;getOptionsForUpdate().appendOption(mtu);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        ra-&gt;addChunkLength(<a class="code" href="namespaceinet.html#a06e5a464a4fc1eb79ca999d8df5a85fb">IPv6ND_MTU_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="comment">// Add all Advertising Prefixes to the RA</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordtype">int</span> numAdvPrefixes = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getNumAdvPrefixes();</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Number of Adv Prefixes: &quot;</span> &lt;&lt; numAdvPrefixes &lt;&lt; endl;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numAdvPrefixes; i++) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            Ipv6InterfaceData::AdvPrefix advPrefix = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvPrefix(i);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <span class="keyword">auto</span> prefixInfo = <span class="keyword">new</span> Ipv6NdPrefixInformation();</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="preprocessor">#ifndef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            prefixInfo-&gt;setPrefix(advPrefix.prefix);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;\n+=+=+=+= Appendign Prefix Info Option to RA +=+=+=+=\n&quot;</span>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Prefix Value: &quot;</span> &lt;&lt; advPrefix.prefix &lt;&lt; endl;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Prefix Length: &quot;</span> &lt;&lt; advPrefix.prefixLength &lt;&lt; endl;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;L-Flag: &quot;</span> &lt;&lt; advPrefix.advOnLinkFlag &lt;&lt; endl;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;A-Flag: &quot;</span> &lt;&lt; advPrefix.advAutonomousFlag &lt;&lt; endl;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;R-Flag: &quot;</span> &lt;&lt; advPrefix.advRtrAddr &lt;&lt; endl;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Global Address from Prefix: &quot;</span> &lt;&lt; advPrefix.rtrAddress &lt;&lt; endl;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isHomeAgent() &amp;&amp; advPrefix.advRtrAddr == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                prefixInfo-&gt;setPrefix(advPrefix.rtrAddress); <span class="comment">// add the global-scope address of the HA&#39;s interface in the prefix option list of the RA message.</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                prefixInfo-&gt;setPrefix(advPrefix.prefix); <span class="comment">// adds the prefix only of the router&#39;s interface in the prefix option list of the RA message.</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            prefixInfo-&gt;setPrefixLength(advPrefix.prefixLength);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="comment">// - In the &quot;on-link&quot; flag: the entry&#39;s AdvOnLinkFlag.</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            prefixInfo-&gt;setOnlinkFlag(advPrefix.advOnLinkFlag);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="comment">// - In the Valid Lifetime field: the entry&#39;s AdvValidLifetime.</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            prefixInfo-&gt;setValidLifetime(SIMTIME_DBL(advPrefix.advValidLifetime));</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="comment">// - In the &quot;Autonomous address configuration&quot; flag: the entry&#39;s</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="comment">// AdvAutonomousFlag.</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            prefixInfo-&gt;setAutoAddressConfFlag(advPrefix.advAutonomousFlag);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isHomeAgent())</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                prefixInfo-&gt;setRouterAddressFlag(<span class="keyword">true</span>); <span class="comment">// set the R-bit if the node is a HA</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="comment">// - In the Valid Lifetime field: the entry&#39;s AdvValidLifetime.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            prefixInfo-&gt;setValidLifetime(SIMTIME_DBL(advPrefix.advValidLifetime));</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="comment">// - In the Preferred Lifetime field: the entry&#39;s AdvPreferredLifetime.</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            prefixInfo-&gt;setPreferredLifetime(SIMTIME_DBL(advPrefix.advPreferredLifetime));</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <span class="comment">// Now we pop the prefix info into the RA.</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            ra-&gt;getOptionsForUpdate().appendOption(prefixInfo);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            ra-&gt;addChunkLength(<a class="code" href="namespaceinet.html#a0d17392bf005b0d3c27fb759dbd23e48">IPv6ND_PREFIX_INFORMATION_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;RApacket&quot;</span>);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <a class="code" href="classinet_1_1_icmpv6.html#ac142d92cd12e9ebf7b63304205678f86">Icmpv6::insertCrc</a>(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a>, ra, packet);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        packet-&gt;insertAtFront(ra);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">sendPacketToIpv6Module</a>(packet, destAddr, sourceAddr, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0a5eeceb530ef5ec54f5116e95b51b83">sendPeriodicRa()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae66149131978353b4c56809f18035cfa">sendSolicitedRa()</a>.</p>

</div>
</div>
<a id="abf2eea6ee985b14d983b48962834ebdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf2eea6ee985b14d983b48962834ebdb">&#9670;&nbsp;</a></span>createAndSendRedirectPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::createAndSendRedirectPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;{</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="comment">// Construct a Redirect message</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keyword">auto</span> redirect = makeShared&lt;Ipv6Redirect&gt;(); <span class="comment">// TODO &quot;redirectMsg&quot;);</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    <span class="comment">// FIXME incomplete code</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="comment">// Redirect Message Specific Information</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    redirect-&gt;setTargetAddress();</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    redirect-&gt;setDestinationAddress();</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="comment">// Possible Option</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    redirect-&gt;setTargetLinkLayerAddress();</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    redirect-&gt;addByteLength(<a class="code" href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0074c0980ba136204e92b58293c0768b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0074c0980ba136204e92b58293c0768b">&#9670;&nbsp;</a></span>createAndSendRsPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::createAndSendRsPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;{</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    ASSERT(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvSendAdvertisements() == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// RFC 2461: Section 6.3.7 Sending Router Solicitations</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">// A host sends Router Solicitations to the All-Routers multicast address. The</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// IP source address is set to either one of the interface&#39;s unicast addresses</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// or the unspecified address.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    Ipv6Address myIPv6Address = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getPreferredAddress();</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (myIPv6Address.isUnspecified())</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        myIPv6Address = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getLinkLocalAddress(); <span class="comment">// so we use the link local address instead</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;isTentativeAddress(myIPv6Address))</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        myIPv6Address = <a class="code" href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">Ipv6Address::UNSPECIFIED_ADDRESS</a>; <span class="comment">// set my Ipv6 address to unspecified.</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    Ipv6Address destAddr = <a class="code" href="classinet_1_1_ipv6_address.html#a19baf4e67b98c19b998a7808bbe2c7b4">Ipv6Address::ALL_ROUTERS_2</a>; <span class="comment">// all_routers multicast</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keyword">auto</span> rs = makeShared&lt;Ipv6RouterSolicitation&gt;();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// The Source Link-Layer Address option SHOULD be set to the host&#39;s link-layer</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// address, if the IP source address is not the unspecified address.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (!myIPv6Address.isUnspecified()) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keyword">auto</span> sla = <span class="keyword">new</span> Ipv6NdSourceLinkLayerAddress();</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        sla-&gt;setLinkLayerAddress(ie-&gt;getMacAddress());</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        rs-&gt;getOptionsForUpdate().insertUniqueOption(sla);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        rs-&gt;setChunkLength(<a class="code" href="namespaceinet.html#aaffaaf4c7fe91d1ccf6b620881927195">ICMPv6_HEADER_BYTES</a> + <a class="code" href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// Construct a Router Solicitation message</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;RSpacket&quot;</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <a class="code" href="classinet_1_1_icmpv6.html#ac142d92cd12e9ebf7b63304205678f86">Icmpv6::insertCrc</a>(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a>, rs, packet);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    packet-&gt;insertAtFront(rs);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">sendPacketToIpv6Module</a>(packet, destAddr, myIPv6Address, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ada0656767ed0fc44353b64524b681c3e">initiateRouterDiscovery()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad7ee162e2bb2ddeb05382151def252fa">processRdTimeout()</a>.</p>

</div>
</div>
<a id="a1bd8d8f8fb25e14520eebf1ffd3e8638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd8d8f8fb25e14520eebf1ffd3e8638">&#9670;&nbsp;</a></span>createRaTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::createRaTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a timer for the given interface entry that sends periodic Router Advertisements. </p>
<div class="fragment"><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;{</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;sendPeriodicRA&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a810fd09c143fca097e7f2569c9f9b89c">MK_SEND_PERIODIC_RTRADV</a>);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    msg-&gt;setContextPointer(ie);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    AdvIfEntry *advIfEntry = <span class="keyword">new</span> AdvIfEntry();</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    advIfEntry-&gt;interfaceId = ie-&gt;getInterfaceId();</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    advIfEntry-&gt;numRASent = 0;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="comment">// 20.9.07 - CB</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">/*if ( rt6-&gt;isRouter() )</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">       {</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">        ie-&gt;ipv6()-&gt;setMinRtrAdvInterval(Ipv6NeighbourDiscovery::getMinRAInterval()); //should be 0.07 for MIPv6 Support</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">        ie-&gt;ipv6()-&gt;setMaxRtrAdvInterval(Ipv6NeighbourDiscovery::getMaxRAInterval()); //should be 0.03 for MIPv6 Support</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">       }*/</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">// update 23.10.07 - CB</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160; </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">if</span> (canServeWirelessNodes(ie)) {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;This Interface is connected to a WLAN AP, hence using MIPv6 Default Values&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        simtime_t minRAInterval = par(<span class="stringliteral">&quot;minIntervalBetweenRAs&quot;</span>); <span class="comment">// reading from the omnetpp.ini (ZY 23.07.09)</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        simtime_t maxRAInterval = par(<span class="stringliteral">&quot;maxIntervalBetweenRAs&quot;</span>); <span class="comment">// reading from the omnetpp.ini (ZY 23.07.09</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setMinRtrAdvInterval(minRAInterval);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setMaxRtrAdvInterval(maxRAInterval);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;This Interface is not connected to a WLAN AP, hence using default values&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">//        interval = uniform( ie-&gt;ipv6()-&gt;minRtrAdvInterval(), ie-&gt;ipv6()-&gt;maxRtrAdvInterval() );</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">//        EV&lt;&lt;&quot;\nThe random calculated RA_ND interval is: &quot;&lt;&lt; interval&lt;&lt;&quot; seconds\n&quot;;</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="comment">// end CB</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    simtime_t interval = uniform(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMinRtrAdvInterval(), ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMaxRtrAdvInterval());</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    advIfEntry-&gt;raTimeoutMsg = msg;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    simtime_t nextScheduledTime = simTime() + interval;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    advIfEntry-&gt;nextScheduledRATime = nextScheduledTime;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae7698ec16351dd133fc0f6b1511bdadd">advIfList</a>.insert(advIfEntry);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Interval: &quot;</span> &lt;&lt; interval &lt;&lt; endl;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Next scheduled time: &quot;</span> &lt;&lt; nextScheduledTime &lt;&lt; endl;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">// now we schedule the msg for whatever time that was derived</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    scheduleAfter(interval, msg);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize()</a>.</p>

</div>
</div>
<a id="a58403829a82d8e16c1088f1a7d974e8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58403829a82d8e16c1088f1a7d974e8a">&#9670;&nbsp;</a></span>determineNextHop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> inet::Ipv6NeighbourDiscovery::determineNextHop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>outIfID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function accepts the datagram's destination address and attempts to determine the destination's next hop address and interface ID by: (1) looking up the destination cache, (2)looking up the routing table, or (3) selecting a default router. </p>
<p>It then updates the destination cache. If no default router can be selected than we assume the destination address to be onlink and simply return any available interface. </p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    Ipv6Address nextHopAddr;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    simtime_t expiryTime;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// RFC 2461 Section 5.2</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// Next-hop determination for a given unicast destination operates as follows.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// The sender performs a longest prefix match against the Prefix List to</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// determine whether the packet&#39;s destination is on- or off-link.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Find out if supplied dest addr is on-link or off-link.\n&quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keyword">const</span> Ipv6Route *route = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;doLongestPrefixMatch(destAddr);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (route != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        expiryTime = route-&gt;getExpiryTime();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        outIfID = route-&gt;getInterface() ? route-&gt;getInterface()-&gt;getInterfaceId() : -1;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// If the destination is on-link, the next-hop address is the same as the</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// packet&#39;s destination address.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> (route-&gt;getNextHop().isUnspecified()) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Dest is on-link, next-hop addr is same as dest addr.\n&quot;</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            nextHopAddr = destAddr;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;A next-hop address was found with the route, dest is off-link\n&quot;</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Assume next-hop address as the selected default router.\n&quot;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            nextHopAddr = route-&gt;getNextHop();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">// Otherwise, the sender selects a router from the Default Router List</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">// (following the rules described in Section 6.3.6).</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;No routes were found, Dest addr is off-link.\n&quot;</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        nextHopAddr = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ad4354002e9435d6c52390575b79a26d0">selectDefaultRouter</a>(outIfID);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        expiryTime = 0;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">if</span> (outIfID == -1)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;No Default Routers were found.&quot;</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Default router found.\n&quot;</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">/*the results of next-hop determination computations are saved in the Destination</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">       Cache (which also contains updates learned from Redirect messages).*/</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;updateDestCache(destAddr, nextHopAddr, outIfID, expiryTime);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> nextHopAddr;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>.</p>

</div>
</div>
<a id="a4e0fcf592fe394c5614522491abd845f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e0fcf592fe394c5614522491abd845f">&#9670;&nbsp;</a></span>dropQueuedPacketsAwaitingAr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::dropQueuedPacketsAwaitingAr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *&#160;</td>
          <td class="paramname"><em>nce</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drops specific queued packets for a specific NCE AR-timeout. </p>
<p>TODO Not implemented yet! </p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// RFC 2461: Section 7.2.2</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">/*If no Neighbor Advertisement is received after MAX_MULTICAST_SOLICIT</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">       solicitations, address resolution has failed. The sender MUST return ICMP</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">       destination unreachable indications with code 3 (Address Unreachable) for</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">       each packet queued awaiting address resolution.*/</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3fbd67788781a9d929cfbbd293be7716">MsgPtrVector</a>&amp; pendingPackets = nce-&gt;pendingPackets;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Pending Packets empty:&quot;</span> &lt;&lt; pendingPackets.empty() &lt;&lt; endl;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">while</span> (!pendingPackets.empty()) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keyword">auto</span> i = pendingPackets.begin();</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        Packet *msg = (*i);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="comment">// Assume msg is the packet itself. I need the datagram&#39;s source addr.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// The datagram&#39;s src addr will be the destination of the unreachable msg.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending ICMP unreachable destination.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        pendingPackets.erase(i);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae56cb9501320961fdbecaa7091196f4e">pendingQueue</a>.remove(msg);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a9ec34bce8a900f4950b15314399343ab">icmpv6</a>-&gt;sendErrorMessage(msg, <a class="code" href="namespaceinet.html#a38ad526702853fea4e883830f4279782ad2fe6e5a03c33df578a94e98d1258a0b">ICMPv6_DESTINATION_UNREACHABLE</a>, <a class="code" href="namespaceinet.html#ac63b650107e16ca12e43cff1e0577fbbab5608159f0aa1ba32c8174774d8884fc">ADDRESS_UNREACHABLE</a>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// RFC 2461: Section 7.3.3</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">/*If address resolution fails, the entry SHOULD be deleted, so that subsequent</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">       traffic to that neighbor invokes the next-hop determination procedure again.*/</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Removing neighbour cache entry&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#aa9b1ce87953f709ff8f15a1330360e51">remove</a>(nceKey-&gt;address, nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">processArTimeout()</a>.</p>

</div>
</div>
<a id="a69afa04d7f16597917a932346cd2dff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69afa04d7f16597917a932346cd2dff7">&#9670;&nbsp;</a></span>fetchAdvIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_adv_if_entry.html">Ipv6NeighbourDiscovery::AdvIfEntry</a> * inet::Ipv6NeighbourDiscovery::fetchAdvIfEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> advIfEntry : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae7698ec16351dd133fc0f6b1511bdadd">advIfList</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (advIfEntry-&gt;interfaceId == ie-&gt;getInterfaceId()) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">return</span> advIfEntry;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a6545a821734516cb41b46ea3018768e6">processRsPacket()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0a5eeceb530ef5ec54f5116e95b51b83">sendPeriodicRa()</a>.</p>

</div>
</div>
<a id="ac781673fa35d079fc0569013a1543b72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac781673fa35d079fc0569013a1543b72">&#9670;&nbsp;</a></span>fetchRdEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structinet_1_1_ipv6_neighbour_discovery_1_1_rd_entry.html">Ipv6NeighbourDiscovery::RdEntry</a> * inet::Ipv6NeighbourDiscovery::fetchRdEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> rdEntry : <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">rdList</a>) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (rdEntry-&gt;interfaceId == ie-&gt;getInterfaceId()) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">return</span> rdEntry;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af725a09fc820f4212c28e9a057e3f1eb">cancelRouterDiscovery()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad7ee162e2bb2ddeb05382151def252fa">processRdTimeout()</a>.</p>

</div>
</div>
<a id="a270fa069d853e08ad5ccdd1c1330f839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a270fa069d853e08ad5ccdd1c1330f839">&#9670;&nbsp;</a></span>finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::finish </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a60cb60d89f39802b186fa30cab992954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60cb60d89f39802b186fa30cab992954">&#9670;&nbsp;</a></span>handleMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;isSelfMessage()) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        EV_TRACE &lt;&lt; <span class="stringliteral">&quot;Self message received!\n&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a810fd09c143fca097e7f2569c9f9b89c">MK_SEND_PERIODIC_RTRADV</a>) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending periodic RA\n&quot;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a0a5eeceb530ef5ec54f5116e95b51b83">sendPeriodicRa</a>(msg);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#ab76c2fe672ed307b0a91f9efa35a7548">MK_SEND_SOL_RTRADV</a>) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending solicited RA\n&quot;</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae66149131978353b4c56809f18035cfa">sendSolicitedRa</a>(msg);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#aed4b9313083f229d6a498c6c337f931e">MK_ASSIGN_LINKLOCAL_ADDRESS</a>) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Assigning Link Local Address\n&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">assignLinkLocalAddress</a>(msg);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a81f972006a357c3ddda2dfcfd7469015">MK_DAD_TIMEOUT</a>) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;DAD Timeout message received\n&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">processDadTimeout</a>(msg);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a9f894036bf61bbc51aa7a8560db5a30e">MK_RD_TIMEOUT</a>) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Router Discovery message received\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ad7ee162e2bb2ddeb05382151def252fa">processRdTimeout</a>(msg);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#aadba1232289c7af8c42ae503b367f409">MK_INITIATE_RTRDIS</a>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;initiate router discovery.\n&quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ada0656767ed0fc44353b64524b681c3e">initiateRouterDiscovery</a>(msg);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a817ccecd04135b6f9307b110598e476e">MK_NUD_TIMEOUT</a>) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;NUD Timeout message received\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a974038ffaaefc3afe370f22e7deb4abb">processNudTimeout</a>(msg);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a3599ccb8ab8108c0d27c47561d6f93e3">MK_AR_TIMEOUT</a>) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Address Resolution Timeout message received\n&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">processArTimeout</a>(msg);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unrecognized Timer&quot;</span>); <span class="comment">// stops sim w/ error msg.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> packet = <span class="keyword">dynamic_cast&lt;</span>Packet *<span class="keyword">&gt;</span>(msg)) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">auto</span> <a class="code" href="_i_udp-gates_8txt.html#a6803ba0bf881b22819a1193768cc5367">protocol</a> = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a>&gt;()-&gt;getProtocol();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_i_udp-gates_8txt.html#a6803ba0bf881b22819a1193768cc5367">protocol</a> == &amp;<a class="code" href="classinet_1_1_protocol.html#a325be61ec7aa7b45c11ac87f5ac7258a">Protocol::icmpv6</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// This information will serve as input parameters to various processors.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ndMsg = packet-&gt;peekAtFront&lt;Icmpv6Header&gt;();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage</a>(packet, ndMsg.get()); <span class="comment">// KLUDGE remove get()</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">else</span> { <span class="comment">// not ND message</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram</a>(packet);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unknown message type received.\n&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad16a7053ca26034297580c0568ef48a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16a7053ca26034297580c0568ef48a4">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    cSimpleModule::initialize(stage);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (stage == <a class="code" href="namespaceinet.html#a6be747ab6f195055e109f27f8462e52e">INITSTAGE_LOCAL</a>) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *crcModeString = par(<span class="stringliteral">&quot;crcMode&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a> = <a class="code" href="namespaceinet.html#a16b0faa236f48c833c525c317934bb28">parseCrcMode</a>(crcModeString, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage == <a class="code" href="namespaceinet.html#a94d913e59c662fec2a321c6507315bad">INITSTAGE_NETWORK_LAYER_PROTOCOLS</a>) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        cModule *node = <a class="code" href="namespaceinet.html#acd0d847a7b6e0f156094fbdd101a00a6">findContainingNode</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        NodeStatus *nodeStatus = node ? check_and_cast_nullable&lt;NodeStatus *&gt;(node-&gt;getSubmodule(<span class="stringliteral">&quot;status&quot;</span>)) : nullptr;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">bool</span> isOperational = (!nodeStatus) || nodeStatus-&gt;getState() == <a class="code" href="classinet_1_1_node_status.html#a3623ef63233aec9ad2838030e3ce5bd3ab88e3292de0cb8bfb808d31864d404bc">NodeStatus::UP</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span> (!isOperational)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;This module doesn&#39;t support starting in node DOWN state&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;interfaceTableModule&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;routingTableModule&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a9ec34bce8a900f4950b15314399343ab">icmpv6</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;icmpv6Module&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isMobileNode())</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            mipv6.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;xmipv6Module&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae56cb9501320961fdbecaa7091196f4e">pendingQueue</a>.setName(<span class="stringliteral">&quot;pendingQueue&quot;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//         MIPv6Enabled = par(&quot;MIPv6Support&quot;); // (Zarrar 14.07.07)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">/*if(rt6-&gt;isRouter()) // 12.9.07 - CB</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">           {</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">            minRAInterval = par(&quot;minIntervalBetweenRAs&quot;); // from the omnetpp.ini file (Zarrar 15.07.07)</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">            maxRAInterval = par(&quot;maxIntervalBetweenRAs&quot;); // from the omnetpp.ini file (Zarrar 15.07.07)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">            //WATCH (MIPv6Enabled);    // (Zarrar 14.07.07)</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">            WATCH(minRAInterval);    // (Zarrar 15.07.07)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">            WATCH(maxRAInterval);    // (Zarrar 15.07.07)</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">           }*/</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getNumInterfaces(); i++) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterface(i);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvSendAdvertisements() &amp;&amp; !(ie-&gt;isLoopback())) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a1bd8d8f8fb25e14520eebf1ffd3e8638">createRaTimer</a>(ie);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// This simulates random node bootup time. Link local address assignment</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// takes place during this time.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;assignLinkLocalAddr&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#aed4b9313083f229d6a498c6c337f931e">MK_ASSIGN_LINKLOCAL_ADDRESS</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// We want routers to boot up faster!</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isRouter())</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            scheduleAfter(uniform(0, 0.3), msg); <span class="comment">// Random Router bootup time</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            scheduleAfter(uniform(0.4, 1), msg); <span class="comment">// Random Host bootup time</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a95ab88a9f54400a96e69c7197692d325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95ab88a9f54400a96e69c7197692d325">&#9670;&nbsp;</a></span>initiateAddressResolution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::initiateAddressResolution </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dgSrcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *&#160;</td>
          <td class="paramname"><em>nce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method attempts to resolve the given neighbour's link-layer address. </p>
<p>The source address of the packet prompting address resolution is also given in order to decide the source address of the NS to be sent. nceKey stores 2 pieces of information (Neighbour address and Interface ID) which is needed for addr resolution and access to the corresponding nce. </p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    Ipv6Address neighbourAddr = nceKey-&gt;address;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordtype">int</span> ifID = nceKey-&gt;interfaceID;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// RFC2461: Section 7.2.2</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// When a node has a unicast packet to send to a neighbor, but does not</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// know the neighbor&#39;s link-layer address, it performs address</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// resolution.  For multicast-capable interfaces this entails creating a</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// Neighbor Cache entry in the INCOMPLETE state(already created if not done yet)</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// WEI-If entry already exists, we still have to ensure that its state is INCOMPLETE.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025">Ipv6NeighbourCache::INCOMPLETE</a>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">// and transmitting a Neighbor Solicitation message targeted at the</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// neighbor.  The solicitation is sent to the solicited-node multicast</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// address &quot;corresponding to&quot;(or &quot;derived from&quot;) the target address.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// (in this case, the target address is the address we are trying to resolve)</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Preparing to send NS to solicited-node multicast group\n&quot;</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;on the next hop interface\n&quot;</span>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    Ipv6Address nsDestAddr = neighbourAddr.formSolicitedNodeMulticastAddress(); <span class="comment">// for NS datagram</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    Ipv6Address nsTargetAddr = neighbourAddr; <span class="comment">// for the field within the NS</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    Ipv6Address nsSrcAddr;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">/*If the source address of the packet prompting the solicitation is the</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">       same as one of the addresses assigned to the outgoing interface,*/</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;hasAddress(dgSrcAddr))</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">/*that address SHOULD be placed in the IP Source Address of the outgoing</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">           solicitation.*/</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        nsSrcAddr = dgSrcAddr;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">/*Otherwise, any one of the addresses assigned to the interface</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">           should be used.*/</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        nsSrcAddr = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getPreferredAddress();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    ASSERT(ifID != -1);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// Sending NS on specified interface.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket</a>(nsTargetAddr, nsDestAddr, nsSrcAddr, ie);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    nce-&gt;numOfARNSSent = 1;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    nce-&gt;nsSrcAddr = nsSrcAddr;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">/*While awaiting a response, the sender SHOULD retransmit Neighbor Solicitation</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">       messages approximately every RetransTimer milliseconds, even in the absence</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">       of additional traffic to the neighbor. Retransmissions MUST be rate-limited</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">       to at most one solicitation per neighbor every RetransTimer milliseconds.*/</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;arTimeout&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a3599ccb8ab8108c0d27c47561d6f93e3">MK_AR_TIMEOUT</a>); <span class="comment">// AR msg timer</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    nce-&gt;arTimer = msg;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    msg-&gt;setContextPointer(nce);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getRetransTimer(), msg);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>.</p>

</div>
</div>
<a id="aed7ee5ee69631757e9439e54a7e7e980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed7ee5ee69631757e9439e54a7e7e980">&#9670;&nbsp;</a></span>initiateDad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::initiateDad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>tentativeAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initiating DAD means to send off a Neighbour Solicitation with its target address set as this node's tentative link-local address. </p>
<div class="fragment"><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;{</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;initiateDad&quot;</span>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;----------INITIATING DUPLICATE ADDRESS DISCOVERY----------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setDadInProgress(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    DadEntry *dadEntry = <span class="keyword">new</span> DadEntry();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    dadEntry-&gt;interfaceId = ie-&gt;getInterfaceId();</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    dadEntry-&gt;address = tentativeAddr;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    dadEntry-&gt;numNSSent = 0;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aeed93f574978b74ed1468f72415cb9bc">dadList</a>.insert(dadEntry);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">       RFC2462: Section 5.4.2</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">       To check an address, a node sends DupAddrDetectTransmits Neighbor</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">       Solicitations, each separated by RetransTimer milliseconds. The</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">       solicitation&#39;s Target Address is set to the address being checked,</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">       the IP source is set to the unspecified address and the IP</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">       destination is set to the solicited-node multicast address of the</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">       target address.*/</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    Ipv6Address destAddr = tentativeAddr.formSolicitedNodeMulticastAddress();</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// Send a NS</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket</a>(tentativeAddr, destAddr,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <a class="code" href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">Ipv6Address::UNSPECIFIED_ADDRESS</a>, ie);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    dadEntry-&gt;numNSSent++;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;dadTimeout&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a81f972006a357c3ddda2dfcfd7469015">MK_DAD_TIMEOUT</a>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    msg-&gt;setContextPointer(dadEntry);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">#ifndef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getRetransTimer(), msg);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// update: added uniform(0, IPv6_MAX_RTR_SOLICITATION_DELAY) to account for joining the solicited-node multicast</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// group which is delay up to one 1 second (RFC 4862, 5.4.2) - 16.01.08, CB</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getRetransTimer() + uniform(0, <a class="code" href="_ipv6_interface_data_8h.html#a062efe990ca0b6b9de4742526b251a73">IPv6_MAX_RTR_SOLICITATION_DELAY</a>), msg);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    emit(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a053e86d782629b4bca3b8efb826c158e">startDadSignal</a>, 1);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">assignLinkLocalAddress()</a>.</p>

</div>
</div>
<a id="afed4e9d56a44c338ea001e9211569588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed4e9d56a44c338ea001e9211569588">&#9670;&nbsp;</a></span>initiateNeighbourUnreachabilityDetection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::initiateNeighbourUnreachabilityDetection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *&#160;</td>
          <td class="paramname"><em>neighbour</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    ASSERT(nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    ASSERT(nce-&gt;nudTimeoutEvent == <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Initiating Neighbour Unreachability Detection&quot;</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Setting NCE state to DELAY.\n&quot;</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">/*The first time a node sends a packet to a neighbor whose entry is</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">       STALE, the sender changes the state to DELAY*/</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a379487af3fd63c982388189ccb914f4b">Ipv6NeighbourCache::DELAY</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">/*and sets a timer to expire in DELAY_FIRST_PROBE_TIME seconds.*/</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;NUDTimeout&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a817ccecd04135b6f9307b110598e476e">MK_NUD_TIMEOUT</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    msg-&gt;setContextPointer(nce);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    nce-&gt;nudTimeoutEvent = msg;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getDelayFirstProbeTime(), msg);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac94a0f1736ad699faa4f2207a0b1b4a8">resolveNeighbour()</a>.</p>

</div>
</div>
<a id="ada0656767ed0fc44353b64524b681c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada0656767ed0fc44353b64524b681c3e">&#9670;&nbsp;</a></span>initiateRouterDiscovery()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::initiateRouterDiscovery </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;{</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Initiating Router Discovery&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    NetworkInterface *ie = (NetworkInterface *)msg-&gt;getContextPointer();</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// RFC2461: Section 6.3.7</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">/*When an interface becomes enabled, a host may be unwilling to wait for the</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">       next unsolicited Router Advertisement to locate default routers or learn</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">       prefixes.  To obtain Router Advertisements quickly, a host SHOULD transmit up</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">       to MAX_RTR_SOLICITATIONS Router Solicitation messages each separated by at</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">       least RTR_SOLICITATION_INTERVAL seconds.(FIXMETherefore this should be invoked</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">       at the beginning of the simulation-WEI)*/</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    RdEntry *rdEntry = <span class="keyword">new</span> RdEntry();</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    rdEntry-&gt;interfaceId = ie-&gt;getInterfaceId();</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    rdEntry-&gt;numRSSent = 0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a0074c0980ba136204e92b58293c0768b">createAndSendRsPacket</a>(ie);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    rdEntry-&gt;numRSSent++;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// Create and schedule a message for retransmission to this module</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    cMessage *rdTimeoutMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;processRDTimeout&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#a9f894036bf61bbc51aa7a8560db5a30e">MK_RD_TIMEOUT</a>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    rdTimeoutMsg-&gt;setContextPointer(ie);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    rdEntry-&gt;timeoutMsg = rdTimeoutMsg;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">rdList</a>.insert(rdEntry);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">/*Before a host sends an initial solicitation, it SHOULD delay the</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">       transmission for a random amount of time between 0 and</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">       MAX_RTR_SOLICITATION_DELAY.  This serves to alleviate congestion when</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">       many hosts start up on a link at the same time, such as might happen</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">       after recovery from a power failure.  If a host has already performed</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">       a random delay since the interface became (re)enabled (e.g., as part</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">       of Duplicate Address Detection [ADDRCONF]) there is no need to delay</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">       again before sending the first Router Solicitation message.*/</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">//    simtime_t rndInterval = uniform(0, ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRtrSolicitationDelay());</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getRtrSolicitationInterval(), rdTimeoutMsg);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="ac49804b7936addaf44c498b28c2757fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49804b7936addaf44c498b28c2757fa">&#9670;&nbsp;</a></span>makeTentativeAddressPermanent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::makeTentativeAddressPermanent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>tentativeAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Permanently assign the given address for the given interface entry. </p>
<p>To be called after successful DAD. </p>
<div class="fragment"><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;{</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;permanentlyAssign(tentativeAddr);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setDadInProgress(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// update 28.09.07 - CB</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// after the link-local address was verified to be unique</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">// we can assign the address and initiate the MIPv6 protocol</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// in case there are any pending entries in the list</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keyword">auto</span> it = dadGlobalList.find(ie);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (it != dadGlobalList.end()) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        DadGlobalEntry&amp; entry = it-&gt;second;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;assignAddress(entry.addr, <span class="keyword">false</span>, simTime() + entry.validLifetime,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                simTime() + entry.preferredLifetime, entry.hFlag);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="comment">// moved from processRAPrefixInfoForAddrAutoConf()</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="comment">// we can remove the old CoA now</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">if</span> (!entry.CoA.isUnspecified())</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;removeAddress(entry.CoA);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="comment">// set addresses on this interface to tentative=false</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getNumAddresses(); i++) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="comment">// TODO improve this code so that only addresses are permanently assigned</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment">// which are formed based on the new prefix from the RA</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            Ipv6Address addr = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAddress(i);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;permanentlyAssign(addr);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="comment">// if we have MIPv6 protocols on this node we will eventually have to</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">// call some appropriate methods</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isMobileNode()) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">if</span> (entry.hFlag == <span class="keyword">false</span>) <span class="comment">// if we are not in the home network, send BUs</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                mipv6-&gt;initiateMipv6Protocol(ie, tentativeAddr);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">               else if ( entry.returnedHome ) // if we are again in the home network</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">               {</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">                ASSERT(entry.CoA.isUnspecified() == false);</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">                mipv6-&gt;returningHome(entry.CoA, ie); // initiate the returning home procedure</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">               }*/</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        dadGlobalList.erase(it-&gt;first);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">// an optimization to make sure that the access router on the link gets our L2 address</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">//    sendUnsolicitedNA(ie);</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// =================================Start: Zarrar Yousaf 08.07.07 ===============================================</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">/* == Calling the routine to assign global scope adddresses to the the routers only. At present during the simulation initialization, the Ipv6FlatNetworkConfigurator assigns a 64 bit prefix to the routers but for xMIPv6 operation, we need full 128bit global scope address, only for routers. The call to  autoConfRouterGlobalScopeAddress() will autoconfigure the full 128 bit global scope address, which will be used by the MN in its BU message destination address, especially for home registeration.</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isRouter() &amp;&amp; !(ie-&gt;isLoopback())) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getNumAdvPrefixes(); i++) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            Ipv6Address globalAddress = ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;autoConfRouterGlobalScopeAddress(i);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;assignAddress(globalAddress, <span class="keyword">false</span>, 0, 0);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">//            ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;deduceAdvPrefix(); //commented out but the above two statements can be replaced with this single statement. But i am using the above two statements for clarity reasons.</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// ==================================End: Zarrar Yousaf 08.07.07===========================================</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">/*RFC 2461: Section 6.3.7 2nd Paragraph</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">       Before a host sends an initial solicitation, it SHOULD delay the</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">       transmission for a random amount of time between 0 and</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">       MAX_RTR_SOLICITATION_DELAY.  This serves to alleviate congestion when</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">       many hosts start up on a link at the same time, such as might happen</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">       after recovery from a power failure.*/</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// TODO Placing these operations here means fast router solicitation is</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// not adopted. Will relocate.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvSendAdvertisements() == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;creating router discovery message timer\n&quot;</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        cMessage *rtrDisMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;initiateRTRDIS&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#aadba1232289c7af8c42ae503b367f409">MK_INITIATE_RTRDIS</a>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        rtrDisMsg-&gt;setContextPointer(ie);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        simtime_t interval = uniform(0, ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRtrSolicitationDelay()); <span class="comment">// random delay</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        scheduleAfter(interval, rtrDisMsg);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">assignLinkLocalAddress()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">processDadTimeout()</a>.</p>

</div>
</div>
<a id="ae321b56ae012d739e84651811d247a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae321b56ae012d739e84651811d247a84">&#9670;&nbsp;</a></span>numInitStages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int inet::Ipv6NeighbourDiscovery::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="_init_stage_registry_8h.html#a6dec686281914f336c1b4dcafdbcf9df">NUM_INIT_STAGES</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a31d32a84a4bb0111c3f4216ba8c73bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31d32a84a4bb0111c3f4216ba8c73bbc">&#9670;&nbsp;</a></span>processArTimeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processArTimeout </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>arTimeoutMsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resends a NS packet to the address intended for address resolution. </p>
<p>TODO Not implemented yet! </p>
<div class="fragment"><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;{</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// AR timeouts are cancelled when a valid solicited NA is received.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce = (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *)arTimeoutMsg-&gt;getContextPointer();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    Ipv6Address nsTargetAddr = nceKey-&gt;<a class="code" href="structinet_1_1_ipv6_neighbour_cache_1_1_key.html#a2a6fb7a30d2bb9c05abb791fe46b072e">address</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Num Of NS Sent:&quot;</span> &lt;&lt; nce-&gt;numOfARNSSent &lt;&lt; endl;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Max Multicast Solicitation:&quot;</span> &lt;&lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxMulticastSolicit() &lt;&lt; endl;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> (nce-&gt;numOfARNSSent &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxMulticastSolicit()) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending another Address Resolution NS message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        Ipv6Address nsDestAddr = nsTargetAddr.formSolicitedNodeMulticastAddress();</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket</a>(nsTargetAddr, nsDestAddr, nce-&gt;nsSrcAddr, ie);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        nce-&gt;numOfARNSSent++;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getRetransTimer(), arTimeoutMsg);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    EV_WARN &lt;&lt; <span class="stringliteral">&quot;Address Resolution has failed.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">dropQueuedPacketsAwaitingAr</a>(nce);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Deleting AR timeout msg\n&quot;</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keyword">delete</span> arTimeoutMsg;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="a49ef5934320202c550ee03b2bea178b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49ef5934320202c550ee03b2bea178b0">&#9670;&nbsp;</a></span>processDadTimeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processDadTimeout </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends a scheduled DAD NS packet. </p>
<p>If number of sends is equals or more than dupAddrDetectTransmits, then permantly assign target link local address as permanent address for given interface entry. </p>
<div class="fragment"><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    DadEntry *dadEntry = (DadEntry *)msg-&gt;getContextPointer();</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(dadEntry-&gt;interfaceId);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    Ipv6Address tentativeAddr = dadEntry-&gt;address;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// Here, we need to check how many DAD messages for the interface entry were</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// sent vs. DupAddrDetectTransmits</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;numOfDADMessagesSent is: &quot;</span> &lt;&lt; dadEntry-&gt;numNSSent &lt;&lt; endl;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;dupAddrDetectTrans is: &quot;</span> &lt;&lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getDupAddrDetectTransmits() &lt;&lt; endl;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> (dadEntry-&gt;numNSSent &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getDupAddrDetectTransmits()) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        bubble(<span class="stringliteral">&quot;Sending another DAD NS message.&quot;</span>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        Ipv6Address destAddr = tentativeAddr.formSolicitedNodeMulticastAddress();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket</a>(dadEntry-&gt;address, destAddr, <a class="code" href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">Ipv6Address::UNSPECIFIED_ADDRESS</a>, ie);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        dadEntry-&gt;numNSSent++;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">// Reuse the received msg</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getRetransTimer(), msg);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        bubble(<span class="stringliteral">&quot;Max number of DAD messages for interface sent. Address is unique.&quot;</span>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aeed93f574978b74ed1468f72415cb9bc">dadList</a>.erase(dadEntry);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;delete dadEntry and msg\n&quot;</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keyword">delete</span> dadEntry;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ac49804b7936addaf44c498b28c2757fa">makeTentativeAddressPermanent</a>(tentativeAddr, ie);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="aae17f560536bd339bfccddc2623a9a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae17f560536bd339bfccddc2623a9a60">&#9670;&nbsp;</a></span>processIpv6Datagram()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processIpv6Datagram </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; msg = packet-&gt;peekAtFront&lt;Ipv6Header&gt;();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Packet &quot;</span> &lt;&lt; packet &lt;&lt; <span class="stringliteral">&quot; arrived from Ipv6 module.\n&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    Ipv6NdControlInfo *<a class="code" href="_i_udp-gates_8txt.html#a80b835d5558b3b3682ceadc046152f22">ctrl</a> = check_and_cast&lt;Ipv6NdControlInfo *&gt;(packet-&gt;getControlInfo());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">int</span> nextHopIfID = <a class="code" href="_i_udp-gates_8txt.html#a80b835d5558b3b3682ceadc046152f22">ctrl</a>-&gt;getInterfaceId();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    Ipv6Address nextHopAddr = <a class="code" href="_i_udp-gates_8txt.html#a80b835d5558b3b3682ceadc046152f22">ctrl</a>-&gt;getNextHop();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//    bool fromHL = ctrl-&gt;getFromHL();</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (nextHopIfID == -1 || nextHopAddr.isUnspecified()) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Determining Next Hop&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        nextHopAddr = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a58403829a82d8e16c1088f1a7d974e8a">determineNextHop</a>(msg-&gt;getDestAddress(), nextHopIfID);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="_i_udp-gates_8txt.html#a80b835d5558b3b3682ceadc046152f22">ctrl</a>-&gt;setInterfaceId(nextHopIfID);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="_i_udp-gates_8txt.html#a80b835d5558b3b3682ceadc046152f22">ctrl</a>-&gt;setNextHop(nextHopAddr);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (nextHopIfID == -1) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">// draft-ietf-ipv6-2461bis-04 has omitted on-link assumption.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">// draft-ietf-v6ops-onlinkassumption-03 explains why.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keyword">delete</span> packet-&gt;removeControlInfo();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a9ec34bce8a900f4950b15314399343ab">icmpv6</a>-&gt;sendErrorMessage(packet, <a class="code" href="namespaceinet.html#a38ad526702853fea4e883830f4279782ad2fe6e5a03c33df578a94e98d1258a0b">ICMPv6_DESTINATION_UNREACHABLE</a>, <a class="code" href="namespaceinet.html#ac63b650107e16ca12e43cff1e0577fbba59870ca178baa292ecb6bbdb3af95b9c">NO_ROUTE_TO_DEST</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Next Hop Address is: &quot;</span> &lt;&lt; nextHopAddr &lt;&lt; <span class="stringliteral">&quot; on interface: &quot;</span> &lt;&lt; nextHopIfID &lt;&lt; endl;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// RFC2461: Section 5.2 Conceptual Sending Algorithm</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// Once the IP address of the next-hop node is known, the sender examines the</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Neighbor Cache for link-layer information about that neighbor.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">lookup</a>(nextHopAddr, nextHopIfID);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span> (nce == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;No Entry exists in the Neighbour Cache.\n&quot;</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nextHopIfID);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (ie-&gt;isPointToPoint()) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">// the sender creates one, sets its state to STALE,</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Creating an STALE entry in the neighbour cache.\n&quot;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            nce = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a4a1b1cc46ca0c07a7e1dbb9607d0fd46">addNeighbour</a>(nextHopAddr, nextHopIfID, <a class="code" href="classinet_1_1_mac_address.html#a2bb1ac82ec10339520faa1a738881ec1">MacAddress::UNSPECIFIED_ADDRESS</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// the sender creates one, sets its state to INCOMPLETE,</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Creating an INCOMPLETE entry in the neighbour cache.\n&quot;</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            nce = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a4a1b1cc46ca0c07a7e1dbb9607d0fd46">addNeighbour</a>(nextHopAddr, nextHopIfID);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// initiates Address Resolution,</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Initiating Address Resolution for:&quot;</span> &lt;&lt; nextHopAddr</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; on Interface:&quot;</span> &lt;&lt; nextHopIfID &lt;&lt; endl;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a95ab88a9f54400a96e69c7197692d325">initiateAddressResolution</a>(msg-&gt;getSrcAddress(), nce);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">     * A host is capable of sending packets to a destination in all states except INCOMPLETE</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">     * or when there is no corresponding NC entry. In INCOMPLETE state the data packets are</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">     * queued pending completion of address resolution.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">switch</span> (nce-&gt;reachabilityState) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025">Ipv6NeighbourCache::INCOMPLETE</a>:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Reachability State is INCOMPLETE. Address Resolution already initiated.\n&quot;</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Add packet to entry&#39;s queue until Address Resolution is complete.\n&quot;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            bubble(<span class="stringliteral">&quot;Packet added to queue until Address Resolution is complete.&quot;</span>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            nce-&gt;pendingPackets.push_back(packet);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae56cb9501320961fdbecaa7091196f4e">pendingQueue</a>.insert(packet);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>:</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Reachability State is STALE.\n&quot;</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            send(packet, <span class="stringliteral">&quot;ipv6Out&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#afed4e9d56a44c338ea001e9211569588">initiateNeighbourUnreachabilityDetection</a>(nce);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">Ipv6NeighbourCache::REACHABLE</a>:</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Next hop is REACHABLE, sending packet to next-hop address.&quot;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            send(packet, <span class="stringliteral">&quot;ipv6Out&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a379487af3fd63c982388189ccb914f4b">Ipv6NeighbourCache::DELAY</a>:</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Next hop is in DELAY state, sending packet to next-hop address.&quot;</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            send(packet, <span class="stringliteral">&quot;ipv6Out&quot;</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a75ab0a402a584e25be2e8190562d5a45">Ipv6NeighbourCache::PROBE</a>:</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Next hop is in PROBE state, sending packet to next-hop address.&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            send(packet, <span class="stringliteral">&quot;ipv6Out&quot;</span>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unknown Neighbour cache entry state.&quot;</span>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="a8ac7db21bc55a5ea3575d4298a34238d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac7db21bc55a5ea3575d4298a34238d">&#9670;&nbsp;</a></span>processNaForIncompleteNceState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNaForIncompleteNceState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html">Ipv6NeighbourCache::Neighbour</a> *&#160;</td>
          <td class="paramname"><em>nce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;{</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    MacAddress naMacAddr;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> tla = check_and_cast_nullable&lt;const Ipv6NdTargetLinkLayerAddress *&gt;(na-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9adcab7d32c5717f65801555fe062eb972">IPv6ND_TARGET_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        naMacAddr = tla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordtype">bool</span> naRouterFlag = na-&gt;getRouterFlag();</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordtype">bool</span> naSolicitedFlag = na-&gt;getSolicitedFlag();</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="comment">/*If the target&#39;s neighbour Cache entry is in the INCOMPLETE state when the</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">       advertisement is received, one of two things happens.*/</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="keywordflow">if</span> (naMacAddr.isUnspecified()) {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        <span class="comment">/*If the link layer has addresses and no Target Link-Layer address option</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">           is included, the receiving node SHOULD silently discard the received</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">           advertisement.*/</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;No MAC Address specified in NA. Ignoring NA\n&quot;</span>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    }</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="comment">// Otherwise, the receiving node performs the following steps:</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        <span class="comment">// - It records the link-layer address in the neighbour Cache entry.</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;ND is updating Neighbour Cache Entry.\n&quot;</span>;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        nce-&gt;macAddress = naMacAddr;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="comment">// - If the advertisement&#39;s Solicited flag is set, the state of the</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        <span class="comment">// entry is set to REACHABLE, otherwise it is set to STALE.</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <span class="keywordflow">if</span> (naSolicitedFlag == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">Ipv6NeighbourCache::REACHABLE</a>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Reachability confirmed through successful Addr Resolution.\n&quot;</span>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            nce-&gt;reachabilityExpires = simTime() + ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getReachableTime();</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="comment">// - It sets the IsRouter flag in the cache entry based on the Router</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="comment">// flag in the received advertisement.</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        nce-&gt;isRouter = naRouterFlag;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        <span class="keywordflow">if</span> (nce-&gt;isDefaultRouter() &amp;&amp; !nce-&gt;isRouter)</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#add2cbfa1b575aa7726bd123ff16352cb">getDefaultRouterList</a>().<a class="code" href="classinet_1_1_ipv6_neighbour_cache_1_1_default_router_list.html#a2651b0bf4cd978f3caaebcac865bb53d">remove</a>(*nce);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="comment">// - It sends any packets queued for the neighbour awaiting address</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <span class="comment">// resolution.</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a68d77f1a5ed7ed3daf4e44d25e7c57d6">sendQueuedPacketsToIpv6Module</a>(nce);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        cancelAndDelete(nce-&gt;arTimer);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        nce-&gt;arTimer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket()</a>.</p>

</div>
</div>
<a id="ab5a196dc851cd900c43606a87aa4214a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5a196dc851cd900c43606a87aa4214a">&#9670;&nbsp;</a></span>processNaForOtherNceStates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNaForOtherNceStates </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html">Ipv6NeighbourCache::Neighbour</a> *&#160;</td>
          <td class="paramname"><em>nce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;{</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordtype">bool</span> naRouterFlag = na-&gt;getRouterFlag();</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="keywordtype">bool</span> naSolicitedFlag = na-&gt;getSolicitedFlag();</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordtype">bool</span> naOverrideFlag = na-&gt;getOverrideFlag();</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    MacAddress naMacAddr;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> tla = check_and_cast_nullable&lt;const Ipv6NdTargetLinkLayerAddress *&gt;(na-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9adcab7d32c5717f65801555fe062eb972">IPv6ND_TARGET_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        naMacAddr = tla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="comment">/*draft-ietf-ipv6-2461bis-04</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">       Section 7.2.5: Receipt of Neighbour Advertisements</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment">       If the target&#39;s Neighbor Cache entry is in any state other than INCOMPLETE</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">       when the advertisement is received, the following actions take place:*/</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keywordflow">if</span> (naOverrideFlag == <span class="keyword">false</span> &amp;&amp; !(naMacAddr.equals(nce-&gt;macAddress))</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        &amp;&amp; !(naMacAddr.isUnspecified()))</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA override is FALSE and NA MAC addr is different.\n&quot;</span>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="comment">// I. If the Override flag is clear and the supplied link-layer address</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        <span class="comment">// differs from that in the cache, then one of two actions takes place:</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="comment">// (Note: An unspecified MAC should not be compared with the NCE&#39;s mac!)</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <span class="comment">// a. If the state of the entry is REACHABLE,</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        <span class="keywordflow">if</span> (nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">Ipv6NeighbourCache::REACHABLE</a>) {</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA mac is different. Change NCE state from REACHABLE to STALE\n&quot;</span>;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="comment">// set it to STALE, but do not update the entry in any other way.</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        }</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            <span class="comment">// b. Otherwise, the received advertisement should be ignored and</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            <span class="comment">// MUST NOT update the cache.</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;NCE is not in REACHABLE state. Ignore NA.\n&quot;</span>;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (naOverrideFlag == <span class="keyword">true</span> || naMacAddr.equals(nce-&gt;macAddress)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;             || naMacAddr.isUnspecified())</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA override flag is TRUE. or Advertised MAC is same as NCE&#39;s. or&quot;</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; NA MAC is not specified.\n&quot;</span>;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="comment">/*II. If the Override flag is set, or the supplied link-layer address</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">           is the same as that in the cache, or no Target Link-layer address</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">           option was supplied, the received advertisement MUST update the</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment">           Neighbor Cache entry as follows:*/</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="comment">/*- The link-layer address in the Target Link-Layer Address option</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment">            MUST be inserted in the cache (if one is supplied and is</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">            Different than the already recorded address).*/</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <span class="keywordflow">if</span> (!(naMacAddr.isUnspecified()) &amp;&amp; !(naMacAddr.equals(nce-&gt;macAddress))) {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Updating NCE&#39;s MAC addr with NA&#39;s.\n&quot;</span>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            nce-&gt;macAddress = naMacAddr;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="comment">// - If the Solicited flag is set,</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        <span class="keywordflow">if</span> (naSolicitedFlag == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Solicited Flag is TRUE. Set NCE state to REACHABLE.\n&quot;</span>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <span class="comment">// the state of the entry MUST be set to REACHABLE.</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">Ipv6NeighbourCache::REACHABLE</a>;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            <span class="comment">// We have to cancel the NUD self timer message if there is one.</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;            cMessage *msg = nce-&gt;nudTimeoutEvent;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            <span class="keywordflow">if</span> (msg != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot;NUD in progress. Cancelling NUD Timer\n&quot;</span>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                bubble(<span class="stringliteral">&quot;Reachability Confirmed via NUD.&quot;</span>);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                nce-&gt;reachabilityExpires = simTime() + ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getReachableTime();</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                cancelAndDelete(msg);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                nce-&gt;nudTimeoutEvent = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        }</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;            <span class="comment">// If the Solicited flag is zero</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Solicited Flag is FALSE.\n&quot;</span>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            <span class="comment">// and the link layer address was updated with a different address</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            <span class="keywordflow">if</span> (!(naMacAddr.equals(nce-&gt;macAddress))) {</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA&#39;s MAC is different from NCE&#39;s.Set NCE state to STALE\n&quot;</span>;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                <span class="comment">// the state MUST be set to STALE.</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            }</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                <span class="comment">// Otherwise, the entry&#39;s state remains unchanged.</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA&#39;s MAC is the same as NCE&#39;s. State remains unchanged.\n&quot;</span>;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        }</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        <span class="comment">// (Next paragraph with explanation is omitted.-WEI)</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <span class="comment">/*- The IsRouter flag in the cache entry MUST be set based on the</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">           Router flag in the received advertisement.*/</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Updating NCE&#39;s router flag to &quot;</span> &lt;&lt; naRouterFlag &lt;&lt; endl;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        nce-&gt;isRouter = naRouterFlag;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="comment">/*In those cases where the IsRouter flag changes from TRUE to FALSE as a</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">           result of this update, the node MUST remove that router from the Default</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">           Router List and update the Destination Cache entries for all destinations</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment">           using that neighbor as a router as specified in Section 7.3.3. This is</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">           needed to detect when a node that is used as a router stops forwarding</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">           packets due to being configured as a host.*/</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordflow">if</span> (nce-&gt;isDefaultRouter() &amp;&amp; !nce-&gt;isRouter)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#add2cbfa1b575aa7726bd123ff16352cb">getDefaultRouterList</a>().<a class="code" href="classinet_1_1_ipv6_neighbour_cache_1_1_default_router_list.html#a2651b0bf4cd978f3caaebcac865bb53d">remove</a>(*nce);</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="comment">// TODO remove destination cache entries</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket()</a>.</p>

</div>
</div>
<a id="a1f72c7b83a0bc8a33a2ddbcb31f4754d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f72c7b83a0bc8a33a2ddbcb31f4754d">&#9670;&nbsp;</a></span>processNaPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNaPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>na</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;{</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a17981233c1189689062894b35f19cf7a">validateNaPacket</a>(packet, na) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">// Neighbour Advertisement Information</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    Ipv6Address naTargetAddr = na-&gt;getTargetAddress();</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">// First, we check if the target address in NA is found in the interface it</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">// was received on is tentative.</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(packet-&gt;getTag&lt;InterfaceInd&gt;()-&gt;getInterfaceId());</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;isTentativeAddress(naTargetAddr)) {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Duplicate Address Detected! Manual attention needed!&quot;</span>);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    }</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="comment">// Logic as defined in Section 7.2.5</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *neighbourEntry = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">lookup</a>(naTargetAddr, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordflow">if</span> (neighbourEntry == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA received. Target Address not found in Neighbour Cache\n&quot;</span>;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Dropping NA packet.\n&quot;</span>;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="comment">// Target Address has entry in Neighbour Cache</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;NA received. Target Address found in Neighbour Cache\n&quot;</span>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">if</span> (neighbourEntry-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025">Ipv6NeighbourCache::INCOMPLETE</a>)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8ac7db21bc55a5ea3575d4298a34238d">processNaForIncompleteNceState</a>(na, neighbourEntry);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab5a196dc851cd900c43606a87aa4214a">processNaForOtherNceStates</a>(na, neighbourEntry);</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage()</a>.</p>

</div>
</div>
<a id="a4ae11d641202039eb04a11cf497508cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae11d641202039eb04a11cf497508cc">&#9670;&nbsp;</a></span>processNDMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNDMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_icmpv6_header.html">Icmpv6Header</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> rs = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>Ipv6RouterSolicitation *<span class="keyword">&gt;</span>(icmpv6Header)) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a6545a821734516cb41b46ea3018768e6">processRsPacket</a>(packet, rs);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> ra = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>Ipv6RouterAdvertisement *<span class="keyword">&gt;</span>(icmpv6Header)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket</a>(packet, ra);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a> = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>Ipv6NeighbourSolicitation *<span class="keyword">&gt;</span>(icmpv6Header)) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">processNsPacket</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> na = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>Ipv6NeighbourAdvertisement *<span class="keyword">&gt;</span>(icmpv6Header)) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket</a>(packet, na);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> redirect = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>Ipv6Redirect *<span class="keyword">&gt;</span>(icmpv6Header)) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aba863f826a94e3cda5fe0530674f368c">processRedirectPacket</a>(redirect);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unrecognized ND message!&quot;</span>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="ac9f4663f98d7ead079225599d98ff0e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f4663f98d7ead079225599d98ff0e9">&#9670;&nbsp;</a></span>processNsForNonTentativeAddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNsForNonTentativeAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;{</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">// Neighbour Solicitation Information</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">//    MacAddress nsMacAddr = ns-&gt;getSourceLinkLayerAddress();</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// target addr is not tentative addr</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// solicitation processed as described in RFC2461:section 7.2.3</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6().isUnspecified()) {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Address is duplicate! Inform Sender of duplicate address!\n&quot;</span>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">sendSolicitedNa</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>, ie);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#af705b92b216d89adb9ecd0509c46c322">processNsWithSpecifiedSrcAddr</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>, ie);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">processNsPacket()</a>.</p>

</div>
</div>
<a id="a4f9a227416f64d7dd9c80182a0d9c07f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f9a227416f64d7dd9c80182a0d9c07f">&#9670;&nbsp;</a></span>processNsForTentativeAddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNsForTentativeAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;{</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="comment">// Control Information</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    Ipv6Address nsSrcAddr = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">//    Ipv6Address nsDestAddr = nsCtrlInfo-&gt;getDestAddr();</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    ASSERT(nsSrcAddr.isUnicast() || nsSrcAddr.isUnspecified());</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">// solicitation is processed as described in RFC2462:section 5.4.3</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">if</span> (nsSrcAddr.isUnspecified()) {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Source Address is UNSPECIFIED. Sender is performing DAD\n&quot;</span>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="comment">// Sender performing Duplicate Address Detection</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isLocalAddress(nsSrcAddr)) <span class="comment">// FIXME isLocalAddress(UNSPECIFIED) is always false!!! Must write another check for detecting source is myself/foreign node!!!</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;NS comes from myself. Ignoring NS\n&quot;</span>;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;NS comes from another node. Address is duplicate!\n&quot;</span>;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Duplicate Address Detected! Manual Attention Required!&quot;</span>);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nsSrcAddr.isUnicast()) {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">// Sender performing address resolution</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sender is performing Address Resolution\n&quot;</span>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Target Address is tentative. Ignoring NS.\n&quot;</span>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    }</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">processNsPacket()</a>.</p>

</div>
</div>
<a id="a77a3fdd591f0f9afdd924d561c0e71cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a3fdd591f0f9afdd924d561c0e71cb">&#9670;&nbsp;</a></span>processNsPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNsPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;{</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">// Control Information</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(packet-&gt;getTag&lt;InterfaceInd&gt;()-&gt;getInterfaceId());</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    Ipv6Address nsTargetAddr = <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getTargetAddress();</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; </div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// RFC 2461:Section 7.2.3</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// If target address is not a valid &quot;unicast&quot; or anycast address assigned to the</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">// receiving interface, we should silently discard the packet.</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a909f55a15fe0bdf6de9dd34664b1ab27">validateNsPacket</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>) == <span class="keyword">false</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        || ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;hasAddress(nsTargetAddr) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        bubble(<span class="stringliteral">&quot;NS validation failed\n&quot;</span>);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    bubble(<span class="stringliteral">&quot;NS validation passed.\n&quot;</span>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;isTentativeAddress(nsTargetAddr)) {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="comment">// If the Target Address is tentative, the Neighbor Solicitation should</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="comment">// be processed as described in [ADDRCONF].</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Process NS for Tentative target address.\n&quot;</span>;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a4f9a227416f64d7dd9c80182a0d9c07f">processNsForTentativeAddress</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    }</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="comment">// Otherwise, the following description applies.</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Process NS for Non-Tentative target address.\n&quot;</span>;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ac9f4663f98d7ead079225599d98ff0e9">processNsForNonTentativeAddress</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>, ie);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage()</a>.</p>

</div>
</div>
<a id="af705b92b216d89adb9ecd0509c46c322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af705b92b216d89adb9ecd0509c46c322">&#9670;&nbsp;</a></span>processNsWithSpecifiedSrcAddr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNsWithSpecifiedSrcAddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;{</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="comment">// RFC 2461, Section 7.2.3</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">/*If the Source Address is not the unspecified address and, on link layers</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">       that have addresses, the solicitation includes a Source Link-Layer Address</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">       option, then the recipient SHOULD create or update the Neighbor Cache entry</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">       for the IP Source Address of the solicitation.*/</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">// Neighbour Solicitation Information</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    MacAddress nsMacAddr;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> sla = check_and_cast_nullable&lt;const Ipv6NdSourceLinkLayerAddress *&gt;(<a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        nsMacAddr = sla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    Ipv6Address nsL3SrcAddr = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keywordtype">int</span> ifID = ie-&gt;getInterfaceId();</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">// Look for the Neighbour Cache Entry</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *entry = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">lookup</a>(nsL3SrcAddr, ifID);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">if</span> (entry == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">/*If an entry does not already exist, the node SHOULD create a new one</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">           and set its reachability state to STALE as specified in Section 7.3.3.*/</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Neighbour Entry not found. Create a Neighbour Cache Entry.\n&quot;</span>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a4a1b1cc46ca0c07a7e1dbb9607d0fd46">addNeighbour</a>(nsL3SrcAddr, ifID, nsMacAddr);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="comment">/*If an entry already exists, and the cached link-layer address differs from</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">           the one in the received Source Link-Layer option,*/</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">if</span> (!(entry-&gt;macAddress.equals(nsMacAddr)) &amp;&amp; !nsMacAddr.isUnspecified()) {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="comment">// the cached address should be replaced by the received address</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            entry-&gt;<a class="code" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html#ace7ac50e663437f499cc2ed2d86000fc">macAddress</a> = nsMacAddr;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="comment">// and the entry&#39;s reachability state MUST be set to STALE.</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            entry-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="comment">/*After any updates to the Neighbor Cache, the node sends a Neighbor</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">       Advertisement response as described in the next section.*/</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">sendSolicitedNa</a>(packet, <a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>, ie);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac9f4663f98d7ead079225599d98ff0e9">processNsForNonTentativeAddress()</a>.</p>

</div>
</div>
<a id="a974038ffaaefc3afe370f22e7deb4abb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a974038ffaaefc3afe370f22e7deb4abb">&#9670;&nbsp;</a></span>processNudTimeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processNudTimeout </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>timeoutMsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;NUD has timed out\n&quot;</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce = (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *)timeoutMsg-&gt;getContextPointer();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">const</span> <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">Key</a> *nceKey = nce-&gt;nceKey;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span> (nceKey == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;The nceKey is nullptr at nce-&gt;MAC=%s, isRouter=%d&quot;</span>,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                nce-&gt;macAddress.str().c_str(), nce-&gt;isRouter);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a379487af3fd63c982388189ccb914f4b">Ipv6NeighbourCache::DELAY</a>) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">/*If the entry is still in the DELAY state when the timer expires, the</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">           entry&#39;s state changes to PROBE. If reachability confirmation is received,</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">           the entry&#39;s state changes to REACHABLE.*/</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Neighbour Entry is still in DELAY state.\n&quot;</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Entering PROBE state. Sending NS probe.\n&quot;</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a75ab0a402a584e25be2e8190562d5a45">Ipv6NeighbourCache::PROBE</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        nce-&gt;numProbesSent = 0;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">/*If no response is received after waiting RetransTimer milliseconds</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">       after sending the MAX_UNICAST_SOLICIT solicitations, retransmissions cease</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">       and the entry SHOULD be deleted. Subsequent traffic to that neighbor will</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">       recreate the entry and performs address resolution again.*/</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (nce-&gt;numProbesSent == (<span class="keywordtype">int</span>)ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxUnicastSolicit()) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Max number of probes have been sent.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Neighbour is Unreachable, removing NCE.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#aa9b1ce87953f709ff8f15a1330360e51">remove</a>(nceKey-&gt;address, nceKey-&gt;interfaceID); <span class="comment">// remove nce from cache, cancel and delete timeoutMsg;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">/*Upon entering the PROBE state, a node sends a unicast Neighbor Solicitation</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">       message to the neighbor using the cached link-layer address.*/</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket</a>(nceKey-&gt;address, nceKey-&gt;address,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getPreferredAddress(), ie);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    nce-&gt;numProbesSent++;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">/*While in the PROBE state, a node retransmits Neighbor Solicitation messages</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">       every RetransTimer milliseconds until reachability confirmation is obtained.</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">       Probes are retransmitted even if no additional packets are sent to the</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">       neighbor.*/</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getRetransTimer(), timeoutMsg);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="a5f59bd32ca1ae82ee472c9aaf1250b5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f59bd32ca1ae82ee472c9aaf1250b5f">&#9670;&nbsp;</a></span>processRaForRouterUpdates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRaForRouterUpdates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>ra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;{</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Processing RA for Router Updates\n&quot;</span>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">// RFC2461: Section 6.3.4</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">// Paragraphs 1 and 2 omitted.</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">// On receipt of a valid Router Advertisement, a host extracts the source</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">// address of the packet and does the following:</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    Ipv6Address raSrcAddr = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(packet-&gt;getTag&lt;InterfaceInd&gt;()-&gt;getInterfaceId());</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordtype">int</span> ifID = ie-&gt;getInterfaceId();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    MacAddress sourceLinkLayerAddress;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> sla = check_and_cast_nullable&lt;const Ipv6NdSourceLinkLayerAddress *&gt;(ra-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        sourceLinkLayerAddress = sla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="comment">/*- If the address is not already present in the host&#39;s Default Router List,</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">       and the advertisement&#39;s Router Lifetime is non-zero, create a new entry in</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">       the list, and initialize its invalidation timer value from the advertisement&#39;s</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">       Router Lifetime field.*/</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *neighbour = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">lookup</a>(raSrcAddr, ifID);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">// update 3.9.07 - CB // if (neighbour == nullptr &amp;&amp; (ra-&gt;homeAgentFlag() == true)) //the RA is from a Router acting as a Home Agent as well</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">if</span> (neighbour == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Neighbour Cache Entry does not contain RA&#39;s source address\n&quot;</span>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordflow">if</span> (ra-&gt;getRouterLifetime() != 0) {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;RA&#39;s router lifetime is non-zero, creating an entry in the &quot;</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Host&#39;s default router list with lifetime=&quot;</span> &lt;&lt; ra-&gt;getRouterLifetime() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            <span class="comment">// initiate neighbour unreachability detection for existing routers and remove default route(r), 3.9.07 - CB</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <span class="comment">// TODO improve this code</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            routersUnreachabilityDetection(ie);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="comment">// If a Neighbor Cache entry is created for the router its reachability</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            <span class="comment">// state MUST be set to STALE as specified in Section 7.3.3.</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            neighbour = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a5cf494cfe748e2ad086aab32d50c93c0">addRouter</a>(raSrcAddr, ifID,</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                        sourceLinkLayerAddress, simTime() + ra-&gt;getRouterLifetime()</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;#ifdef <a class="code" href="features_8h.html#a859e989a926173a0259f5faf248f50fe">INET_WITH_xMIPv6</a></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                        , ra-&gt;getHomeAgentFlag()</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;#endif <span class="comment">/* INET_WITH_xMIPv6 */</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                        );</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            <span class="comment">// According to Greg, we should add a default route for hosts as well!</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;addDefaultRoute(raSrcAddr, ifID, simTime() + ra-&gt;getRouterLifetime());</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Router Lifetime is 0, adding NON-default router.\n&quot;</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="comment">// WEI-The router is advertising itself, BUT not as a default router.</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            <span class="keywordflow">if</span> (sourceLinkLayerAddress.isUnspecified())</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                neighbour = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a4a1b1cc46ca0c07a7e1dbb9607d0fd46">addNeighbour</a>(raSrcAddr, ifID);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                neighbour = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a4a1b1cc46ca0c07a7e1dbb9607d0fd46">addNeighbour</a>(raSrcAddr, ifID,</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                            sourceLinkLayerAddress);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            neighbour-&gt;<a class="code" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html#a0f81d59d1eb651494c180dfea2723185">isRouter</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="comment">// If no Source Link-Layer Address is included, but a corresponding Neighbor</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="comment">// Cache entry exists, its IsRouter flag MUST be set to TRUE.</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        neighbour-&gt;isRouter = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="comment">// If a cache entry already exists and is updated with a different link-</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="comment">// layer address the reachability state MUST also be set to STALE.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">if</span> (sourceLinkLayerAddress.isUnspecified() == <span class="keyword">false</span> &amp;&amp;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            neighbour-&gt;macAddress.equals(sourceLinkLayerAddress) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            neighbour-&gt;macAddress = sourceLinkLayerAddress;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="comment">/*- If the address is already present in the host&#39;s Default Router List</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">           as a result of a previously-received advertisement, reset its invalidation</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">           timer to the Router Lifetime value in the newly-received advertisement.*/</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        neighbour-&gt;routerExpiryTime = simTime() + ra-&gt;getRouterLifetime();</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="comment">/*- If the address is already present in the host&#39;s Default Router List</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">           and the received Router Lifetime value is zero, immediately time-out the</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">           entry as specified in Section 6.3.5.*/</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">if</span> (ra-&gt;getRouterLifetime() == 0) {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;RA&#39;s router lifetime is ZERO. Timing-out entry.\n&quot;</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a0b5d2ce626c1d5ebe787101eacfc97df">timeoutDefaultRouter</a>(raSrcAddr, ifID);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// Paragraph Omitted.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// If the received Cur Hop Limit value is non-zero the host SHOULD set</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">// its CurHopLimit variable to the received value.</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">if</span> (ra-&gt;getCurHopLimit() != 0) {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;RA&#39;s Cur Hop Limit is non-zero. Setting host&#39;s Cur Hop Limit to &quot;</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;received value.\n&quot;</span>;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setCurHopLimit(ra-&gt;getCurHopLimit());</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// If the received Reachable Time value is non-zero the host SHOULD set its</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">// BaseReachableTime variable to the received value.</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">if</span> (ra-&gt;getReachableTime() != 0) {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;RA&#39;s reachable time is non-zero &quot;</span>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">if</span> (ra-&gt;getReachableTime() != SIMTIME_DBL(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getReachableTime())) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot; and RA&#39;s and Host&#39;s reachable time differ, \nsetting host&#39;s base&quot;</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; reachable time to received value.\n&quot;</span>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setBaseReachableTime(ra-&gt;getReachableTime());</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="comment">// If the new value differs from the previous value, the host SHOULD</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="comment">// recompute a new random ReachableTime value.</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setReachableTime(ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;generateReachableTime());</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        EV_INFO &lt;&lt; endl;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// The RetransTimer variable SHOULD be copied from the Retrans Timer field,</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">// if the received value is non-zero.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> (ra-&gt;getRetransTimer() != 0) {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;RA&#39;s retrans timer is non-zero, copying retrans timer variable.\n&quot;</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;setRetransTimer(ra-&gt;getRetransTimer());</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">/*If the MTU option is present, hosts SHOULD copy the option&#39;s value into</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">       LinkMTU so long as the value is greater than or equal to the minimum link MTU</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">       [Ipv6] and does not exceed the default LinkMTU value specified in the link</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">       type specific document (e.g., [Ipv6-ETHER]).*/</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">// TODO not done yet</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a53e81888790f212685a2a3a483481dee">processRaPrefixInfo</a>(ra, ie);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket()</a>.</p>

</div>
</div>
<a id="ad0ab43456af51d304c3079313d0c834d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0ab43456af51d304c3079313d0c834d">&#9670;&nbsp;</a></span>processRaPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRaPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>ra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;{</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(packet-&gt;getTag&lt;InterfaceInd&gt;()-&gt;getInterfaceId());</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvSendAdvertisements()) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Interface is an advertising interface, dropping RA message.\n&quot;</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3f776f294e2d817343427ccef1479f1a">validateRaPacket</a>(packet, ra) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">if</span> (ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;isDadInProgress()) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            <span class="comment">// in case we are currently performing DAD we ignore this RA</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="comment">// TODO improve this procedure in order to allow reinitiating DAD</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            <span class="comment">// (which means cancel current DAD, start new DAD)</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#af725a09fc820f4212c28e9a057e3f1eb">cancelRouterDiscovery</a>(ie); <span class="comment">// Cancel router discovery if it is in progress.</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Interface is a host, processing RA.\n&quot;</span>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates</a>(packet, ra); <span class="comment">// See RFC2461: Section 6.3.4</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="comment">// Possible options</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">//        MacAddress macAddress = ra-&gt;getSourceLinkLayerAddress();</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">//        uint mtu = ra-&gt;getMTU();</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int)ra-&gt;getOptions().getOptionArraySize(); i++) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keyword">auto</span> option = ra-&gt;getOptions().getOption(i);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="keywordflow">if</span> (option-&gt;getType() != <a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9a34d0a70fa50aed20abb4c98cb1fd516b">IPv6ND_PREFIX_INFORMATION</a>)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="keyword">const</span> Ipv6NdPrefixInformation&amp; prefixInfo = *check_and_cast&lt;const Ipv6NdPrefixInformation *&gt;(option);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="keywordflow">if</span> (prefixInfo.getAutoAddressConfFlag() == <span class="keyword">true</span>) { <span class="comment">// If auto addr conf is set</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="preprocessor">#ifndef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a41970533db31303c76cd7929c9cbb87c">processRaPrefixInfoForAddrAutoConf</a>(prefixInfo, ie); <span class="comment">// We process prefix Info and form an addr</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a41970533db31303c76cd7929c9cbb87c">processRaPrefixInfoForAddrAutoConf</a>(prefixInfo, ie, ra-&gt;getHomeAgentFlag()); <span class="comment">// then calling the overloaded function for address configuration. The address conf for MN is different from other nodes as it needs to classify the newly formed address as HoA or CoA, depending on the status of the H-Flag. (Zarrar Yousaf 20.07.07)</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="comment">// When in foreign network(s), the MN needs info about its HA address and its own Home Address (HoA), when sending BU to HA and CN(s). Therefore while in the home network I intialise struct HomeNetworkInfo{} with HoA and HA address, which will eventually be used by the MN while sending BUs from within visit networks. (Zarrar Yousaf 12.07.07)</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="keywordflow">if</span> (ra-&gt;getHomeAgentFlag() &amp;&amp; (prefixInfo.getRouterAddressFlag() == <span class="keyword">true</span>)) { <span class="comment">// If R-Flag is set and RA is from HA</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="comment">// homeNetworkInfo now carries HoA, global unicast HA address and the home network prefix</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="comment">// update 4.9.07 - CB</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                Ipv6Address HoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(); <span class="comment">// MN&#39;s home address</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                Ipv6Address HA = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6().setPrefix(prefixInfo.getPrefix(), prefixInfo.getPrefixLength());</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;The HoA of MN is: &quot;</span> &lt;&lt; HoA &lt;&lt; <span class="stringliteral">&quot;, MN&#39;s HA Address is: &quot;</span> &lt;&lt; HA</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; and the home prefix is &quot;</span> &lt;&lt; prefixInfo.getPrefix() &lt;&lt; endl;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;updateHomeNetworkInfo(HoA, HA, prefixInfo.getPrefix(), prefixInfo.getPrefixLength()); <span class="comment">// populate the HoA of MN, the HA global scope address and the home network prefix</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            }</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage()</a>.</p>

</div>
</div>
<a id="a53e81888790f212685a2a3a483481dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53e81888790f212685a2a3a483481dee">&#9670;&nbsp;</a></span>processRaPrefixInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRaPrefixInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;{</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// Continued from section 6.3.4</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="comment">/*Prefix Information options that have the &quot;on-link&quot; (L) flag set indicate a</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">       prefix identifying a range of addresses that should be considered on-link.</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">       Note, however, that a Prefix Information option with the on-link flag set to</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">       zero conveys no information concerning on-link determination and MUST NOT be</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">       interpreted to mean that addresses covered by the prefix are off-link. The</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">       only way to cancel a previous on-link indication is to advertise that prefix</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">       with the L-bit set and the Lifetime set to zero. The default behavior (see</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">       Section 5.2) when sending a packet to an address for which no information is</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">       known about the on-link status of the address is to forward the packet to a</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">       default router; the reception of a Prefix Information option with the &quot;on-link &quot;</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">       (L) flag set to zero does not change this behavior. The reasons for an address</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">       being treated as on-link is specified in the definition of &quot;on-link&quot; in</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">       Section 2.1. Prefixes with the on-link flag set to zero would normally have</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">       the autonomous flag set and be used by [ADDRCONF].*/</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    Ipv6NdPrefixInformation prefixInfo;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// For each Prefix Information option</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int)ra-&gt;getOptions().getOptionArraySize(); i++) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="keyword">auto</span> option = ra-&gt;getOptions().getOption(i);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keywordflow">if</span> (option-&gt;getType() != <a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9a34d0a70fa50aed20abb4c98cb1fd516b">IPv6ND_PREFIX_INFORMATION</a>)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keyword">const</span> Ipv6NdPrefixInformation&amp; prefixInfo = *check_and_cast&lt;const Ipv6NdPrefixInformation *&gt;(option);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">if</span> (!prefixInfo.getOnlinkFlag())</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// skip to next prefix option</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="comment">// with the on-link flag set, a host does the following:</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Fetching Prefix Information: option &quot;</span> &lt;&lt; i + 1 &lt;&lt; <span class="stringliteral">&quot; of &quot;</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                &lt;&lt; ra-&gt;getOptions().getOptionArraySize() &lt;&lt; endl;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> prefixLength = prefixInfo.getPrefixLength();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        simtime_t validLifetime = prefixInfo.getValidLifetime();</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">//        uint preferredLifetime = prefixInfo.getPreferredLifetime();</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        Ipv6Address prefix = prefixInfo.getPrefix();</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <span class="comment">// - If the prefix is the link-local prefix, silently ignore the Prefix</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="comment">// Information option.</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">if</span> (prefix.isLinkLocal()) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Prefix is link-local, ignoring prefix.\n&quot;</span>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="comment">// - If the prefix is not already present in the Prefix List,</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isPrefixPresent(prefix)) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <span class="comment">// and the Prefix Information option&#39;s Valid Lifetime field is non-zero,</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <span class="keywordflow">if</span> (validLifetime != 0) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                <span class="comment">/*create a new entry for the prefix and initialize its invalidation</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">                   timer to the Valid Lifetime value in the Prefix Information option.*/</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;addOrUpdateOnLinkPrefix(prefix, prefixLength, ie-&gt;getInterfaceId(),</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                        simTime() + validLifetime);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="comment">/*- If the Prefix Information option&#39;s Valid Lifetime field is zero,</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">               and the prefix is not present in the host&#39;s Prefix List,</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">               silently ignore the option.*/</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="comment">/* If the new Lifetime value is zero, time-out the prefix immediately</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">               (see Section 6.3.5).*/</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordflow">if</span> (validLifetime == 0) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot;Prefix Info&#39;s valid lifetime is 0, time-out prefix\n&quot;</span>;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;deleteOnLinkPrefix(prefix, prefixLength);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="comment">/*- If the prefix is already present in the host&#39;s Prefix List as</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">               the result of a previously-received advertisement, reset its</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">               invalidation timer to the Valid Lifetime value in the Prefix</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">               Information option.*/</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;addOrUpdateOnLinkPrefix(prefix, prefixLength, ie-&gt;getInterfaceId(),</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                    simTime() + validLifetime);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="comment">/*Stateless address autoconfiguration [ADDRCONF] may in some</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">           circumstances increase the Valid Lifetime of a prefix or ignore it</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">           completely in order to prevent a particular denial of service attack.</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">           However, since the effect of the same denial of service targeted at</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">           the on-link prefix list is not catastrophic (hosts would send packets</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">           to a default router and receive a redirect rather than sending</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">           packets directly to a neighbor) the Neighbor Discovery protocol does</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">           not impose such a check on the prefix lifetime values.*/</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates()</a>.</p>

</div>
</div>
<a id="a41970533db31303c76cd7929c9cbb87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41970533db31303c76cd7929c9cbb87c">&#9670;&nbsp;</a></span>processRaPrefixInfoForAddrAutoConf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRaPrefixInfoForAddrAutoConf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_nd_prefix_information.html">Ipv6NdPrefixInformation</a> &amp;&#160;</td>
          <td class="paramname"><em>prefixInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;{</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Processing Prefix Info for address auto-configuration.\n&quot;</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    Ipv6Address prefix = prefixInfo.getPrefix();</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> prefixLength = prefixInfo.getPrefixLength();</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    simtime_t preferredLifetime = prefixInfo.getPreferredLifetime();</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    simtime_t validLifetime = prefixInfo.getValidLifetime();</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="comment">// RFC 2461: Section 5.5.3</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="comment">// First condition tested, the autonomous flag is already set</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// b) If the prefix is the link-local prefix, silently ignore the Prefix</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// Information option.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">if</span> (prefixInfo.getPrefix().isLinkLocal() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Prefix is link-local, ignore Prefix Information Option\n&quot;</span>;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    }</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">// c) If the preferred lifetime is greater than the valid lifetime, silently</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">// ignore the Prefix Information option. A node MAY wish to log a system</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">// management error in this case.</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (preferredLifetime &gt; validLifetime) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Preferred lifetime is greater than valid lifetime, ignore Prefix Information\n&quot;</span>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordtype">bool</span> isPrefixAssignedToInterface = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getNumAddresses(); i++) {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAddress(i).matches(prefix, prefixLength) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            isPrefixAssignedToInterface = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">/*d) If the prefix advertised does not match the prefix of an address already</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">         in the list, and the Valid Lifetime is not 0, form an address (and add</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">         it to the list) by combining the advertised prefix with the link�s</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">         interface identifier as follows:*/</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keywordflow">if</span> (isPrefixAssignedToInterface == <span class="keyword">false</span> &amp;&amp; validLifetime != 0) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        Ipv6Address linkLocalAddress = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getLinkLocalAddress();</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        ASSERT(linkLocalAddress.isUnspecified() == <span class="keyword">false</span>);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        Ipv6Address newAddr = linkLocalAddress.setPrefix(prefix, prefixLength);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="comment">// TODO for now we leave the newly formed address as not tentative,</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="comment">// according to Greg, we have to always perform DAD for a newly formed address.</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Assigning new address to: &quot;</span> &lt;&lt; ie-&gt;getInterfaceName() &lt;&lt; endl;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        ie-&gt;getProtocolDataForUpdate&lt;Ipv6InterfaceData&gt;()-&gt;assignAddress(newAddr, <span class="keyword">false</span>, simTime() + validLifetime,</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                simTime() + preferredLifetime);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">// TODO this is the simplified version.</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">/*e) If the advertised prefix matches the prefix of an autoconfigured</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">       address (i.e., one obtained via stateless or stateful address</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="comment">       autoconfiguration) in the list of addresses associated with the</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">       interface, the specific action to perform depends on the Valid</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">       Lifetime in the received advertisement and the Lifetime</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">       associated with the previously autoconfigured address (which we</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">       call StoredLifetime in the discussion that follows):</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">       1) If the received Lifetime is greater than 2 hours or greater</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">          than StoredLifetime, update the stored Lifetime of the</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">          corresponding address.</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">       2) If the StoredLifetime is less than or equal to 2 hours and the</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">          received Lifetime is less than or equal to StoredLifetime,</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">          ignore the prefix, unless the Router Advertisement from which</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">          this Prefix Information option was obtained has been</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">          authenticated (e.g., via IPSec [RFC2402]). If the Router</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">          Advertisment was authenticated, the StoredLifetime should be</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">          set to the Lifetime in the received option.</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">       3) Otherwise, reset the stored Lifetime in the corresponding</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">          address to two hours.*/</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket()</a>.</p>

</div>
</div>
<a id="ad7ee162e2bb2ddeb05382151def252fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ee162e2bb2ddeb05382151def252fa">&#9670;&nbsp;</a></span>processRdTimeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRdTimeout </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;{</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    NetworkInterface *ie = (NetworkInterface *)msg-&gt;getContextPointer();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    RdEntry *rdEntry = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ac781673fa35d079fc0569013a1543b72">fetchRdEntry</a>(ie);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">if</span> (rdEntry-&gt;numRSSent &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRtrSolicitations()) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        bubble(<span class="stringliteral">&quot;Sending another RS message.&quot;</span>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a0074c0980ba136204e92b58293c0768b">createAndSendRsPacket</a>(ie);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        rdEntry-&gt;numRSSent++;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">// Need to find out if this is the last RS we are sending out.</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">if</span> (rdEntry-&gt;numRSSent == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRtrSolicitations())</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRtrSolicitationDelay(), msg);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            scheduleAfter(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getRtrSolicitationInterval(), msg);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="comment">// RFC 2461, Section 6.3.7</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="comment">/*If a host sends MAX_RTR_SOLICITATIONS solicitations, and receives no Router</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">           Advertisements after having waited MAX_RTR_SOLICITATION_DELAY seconds after</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">           sending the last solicitation, the host concludes that there are no routers</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">           on the link for the purpose of [ADDRCONF]. However, the host continues to</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">           receive and process Router Advertisements messages in the event that routers</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">           appear on the link.*/</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        bubble(<span class="stringliteral">&quot;Max number of RS messages sent&quot;</span>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;No RA messages were received. Assume no routers are on-link&quot;</span>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">rdList</a>.erase(rdEntry);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keyword">delete</span> rdEntry;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="aba863f826a94e3cda5fe0530674f368c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba863f826a94e3cda5fe0530674f368c">&#9670;&nbsp;</a></span>processRedirectPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRedirectPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_redirect.html">Ipv6Redirect</a> *&#160;</td>
          <td class="paramname"><em>redirect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;{</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// FIXME incomplete code</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="comment">// First we need to extract information from the redirect message</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    Ipv6Address targetAddr = redirect-&gt;getTargetAddress(); <span class="comment">// Addressed to me</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    Ipv6Address destAddr = redirect-&gt;getDestinationAddress(); <span class="comment">// new dest addr</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="comment">// Optional</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    MacAddress macAddr = redirect-&gt;getTargetLinkLayerAddress();</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage()</a>.</p>

</div>
</div>
<a id="a6545a821734516cb41b46ea3018768e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6545a821734516cb41b46ea3018768e6">&#9670;&nbsp;</a></span>processRsPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::processRsPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_router_solicitation.html">Ipv6RouterSolicitation</a> *&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa5e577327ead9f3ba0c9165c6086f94b">validateRsPacket</a>(packet, rs) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">// Find out which interface the RS message arrived on.</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">ift</a>-&gt;getInterfaceById(packet-&gt;getTag&lt;InterfaceInd&gt;()-&gt;getInterfaceId());</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    AdvIfEntry *advIfEntry = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a69afa04d7f16597917a932346cd2dff7">fetchAdvIfEntry</a>(ie); <span class="comment">// fetch advertising interface entry.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">// RFC 2461: Section 6.2.6</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// A host MUST silently discard any received Router Solicitation messages.</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">if</span> (ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getAdvSendAdvertisements()) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;This is an advertising interface, processing RS\n&quot;</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa5e577327ead9f3ba0c9165c6086f94b">validateRsPacket</a>(packet, rs) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;RS message validated\n&quot;</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="comment">// First we extract RS specific information from the received message</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        MacAddress macAddr;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> sla = check_and_cast_nullable&lt;const Ipv6NdSourceLinkLayerAddress *&gt;(rs-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            macAddr = sla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;MAC Address &#39;&quot;</span> &lt;&lt; macAddr &lt;&lt; <span class="stringliteral">&quot;&#39; extracted\n&quot;</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="comment">/*A router MAY choose to unicast the response directly to the soliciting</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">           host&#39;s address (if the solicitation&#39;s source address is not the unspecified</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">           address), but the usual case is to multicast the response to the</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">           all-nodes group. In the latter case, the interface&#39;s interval timer is</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">           reset to a new random value, as if an unsolicited advertisement had just</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">           been sent(see Section 6.2.4).*/</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">/*In all cases, Router Advertisements sent in response to a Router</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">           Solicitation MUST be delayed by a random time between 0 and</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">           MAX_RA_DELAY_TIME seconds. (If a single advertisement is sent in</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">           response to multiple solicitations, the delay is relative to the</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">           first solicitation.)  In addition, consecutive Router Advertisements</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">           sent to the all-nodes multicast address MUST be rate limited to no</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">           more than one advertisement every MIN_DELAY_BETWEEN_RAS seconds.*/</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment">/*A router might process Router Solicitations as follows:</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">           - Upon receipt of a Router Solicitation, compute a random delay</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">           within the range 0 through MAX_RA_DELAY_TIME. If the computed</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">           value corresponds to a time later than the time the next multicast</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">           Router Advertisement is scheduled to be sent, ignore the random</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">           delay and send the advertisement at the already-scheduled time.*/</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;sendSolicitedRA&quot;</span>, <a class="code" href="_ipv6_neighbour_discovery_8cc.html#ab76c2fe672ed307b0a91f9efa35a7548">MK_SEND_SOL_RTRADV</a>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        msg-&gt;setContextPointer(ie);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        simtime_t interval = uniform(0, ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRaDelayTime());</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">if</span> (interval &lt; advIfEntry-&gt;nextScheduledRATime) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            scheduleAfter(interval, msg);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            advIfEntry-&gt;nextScheduledRATime = simTime() + interval;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="comment">// else we ignore the generate interval and send it at the next scheduled time.</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="comment">// We need to keep a log here each time an RA is sent. Not implemented yet.</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="comment">// Assume the first course of action.</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="comment">/*- If the router sent a multicast Router Advertisement (solicited or</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">           unsolicited) within the last MIN_DELAY_BETWEEN_RAS seconds,</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">           schedule the advertisement to be sent at a time corresponding to</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">           MIN_DELAY_BETWEEN_RAS plus the random value after the previous</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">           advertisement was sent. This ensures that the multicast Router</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">           Advertisements are rate limited.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">           - Otherwise, schedule the sending of a Router Advertisement at the</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">           time given by the random value.*/</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;This interface is a host, discarding RA message\n&quot;</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">processNDMessage()</a>.</p>

</div>
</div>
<a id="af637e15ac37dec83545e2e79bf4fca98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af637e15ac37dec83545e2e79bf4fca98">&#9670;&nbsp;</a></span>reachabilityConfirmed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::reachabilityConfirmed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>neighbour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Public method, it can be invoked from the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module or any other module to let Neighbour Discovery know that the reachability of the given neighbor has just been confirmed (e.g. </p>
<p>TCP received ACK of new data from it). Neighbour Discovery can then update the neighbour cache with this information, and cancel the Neighbour Unreachability Detection procedure if it is currently running. </p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;reachabilityConfirmed(%s,if=%d)&quot;</span>, neighbour.str().c_str(), interfaceId);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// hmmm... this should only be invoked if a TCP ACK was received and NUD is</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// currently being performed on the neighbour where the TCP ACK was received from.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">lookup</a>(neighbour, interfaceId);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (!nce)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Model error: not found in cache&quot;</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    cMessage *msg = nce-&gt;nudTimeoutEvent;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (msg != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;NUD in progress. Cancelling NUD Timer\n&quot;</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        bubble(<span class="stringliteral">&quot;Reachability Confirmed via NUD.&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        cancelAndDelete(msg);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        nce-&gt;nudTimeoutEvent = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// TODO (see header file for description)</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">/*A neighbor is considered reachable if the node has recently received</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">       a confirmation that packets sent recently to the neighbor were</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">       received by its IP layer.  Positive confirmation can be gathered in</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">       two ways: hints from upper layer protocols that indicate a connection</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">       is making &quot;forward progress&quot;, or receipt of a Neighbor Advertisement</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">       message that is a response to a Neighbor Solicitation message.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">       A connection makes &quot;forward progress&quot; if the packets received from a</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">       remote peer can only be arriving if recent packets sent to that peer</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">       are actually reaching it.  In TCP, for example, receipt of a (new)</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">       acknowledgement indicates that previously sent data reached the peer.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">       Likewise, the arrival of new (non-duplicate) data indicates that</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">       earlier acknowledgements are being delivered to the remote peer.  If</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">       packets are reaching the peer, they must also be reaching the</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">       sender&#39;s next-hop neighbor; thus &quot;forward progress&quot; is a confirmation</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">       that the next-hop neighbor is reachable.  For off-link destinations,</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">       forward progress implies that the first-hop router is reachable.</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">       When available, this upper-layer information SHOULD be used.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">       In some cases (e.g., UDP-based protocols and routers forwarding</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">       packets to hosts) such reachability information may not be readily</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">       available from upper-layer protocols.  When no hints are available</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">       and a node is sending packets to a neighbor, the node actively probes</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">       the neighbor using unicast Neighbor Solicitation messages to verify</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">       that the forward path is still working.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">       The receipt of a solicited Neighbor Advertisement serves as</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">       reachability confirmation, since advertisements with the Solicited</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">       flag set to one are sent only in response to a Neighbor Solicitation.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">       Receipt of other Neighbor Discovery messages such as Router</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">       Advertisements and Neighbor Advertisement with the Solicited flag set</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">       to zero MUST NOT be treated as a reachability confirmation.  Receipt</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">       of unsolicited messages only confirm the one-way path from the sender</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">       to the recipient node.  In contrast, Neighbor Unreachability</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">       Detection requires that a node keep track of the reachability of the</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">       forward path to a neighbor from the its perspective, not the</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">       neighbor&#39;s perspective.  Note that receipt of a solicited</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">       advertisement indicates that a path is working in both directions.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">       The solicitation must have reached the neighbor, prompting it to</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">       generate an advertisement.  Likewise, receipt of an advertisement</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">       indicates that the path from the sender to the recipient is working.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">       However, the latter fact is known only to the recipient; the</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">       advertisement&#39;s sender has no direct way of knowing that the</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">       advertisement it sent actually reached a neighbor.  From the</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">       perspective of Neighbor Unreachability Detection, only the</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">       reachability of the forward path is of interest.*/</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af7743dc27c4a5b6aa7bcb4ba295cdfac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7743dc27c4a5b6aa7bcb4ba295cdfac">&#9670;&nbsp;</a></span>resetRaTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::resetRaTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset the given interface entry's Router Advertisement timer. </p>
<p>This is usually done when a router interface responds (by replying with a Router Advertisement sent to the All-Node multicast group)to a router solicitation Also see: RFC 2461, Section 6.2.6 </p>
<div class="fragment"><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;{ <span class="comment">// Not used yet but could be useful later on.-WEI</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="comment">// Iterate through all RA timers within the Neighbour Discovery module.</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">    for (auto it =raTimerList.begin(); it != raTimerList.end(); it++)</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">        cMessage *msg = (*it);</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">        NetworkInterface *msgIE = (NetworkInterface *)msg-&gt;getContextPointer();</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="comment">        //Find the timer that matches the given Interface Entry.</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">        if (msgIE-&gt;outputPort() == ie-&gt;outputPort())</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">            EV &lt;&lt; &quot;Resetting RA timer for port: &quot; &lt;&lt; ie-&gt;outputPort();</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">            cancelEvent(msg); //Cancel the next scheduled msg.</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">            simtime_t interval</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">                = uniform(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMinRtrAdvInterval(),ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMaxRtrAdvInterval());</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">            scheduleAfter(interval, msg);</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac94a0f1736ad699faa4f2207a0b1b4a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac94a0f1736ad699faa4f2207a0b1b4a8">&#9670;&nbsp;</a></span>resolveNeighbour()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classinet_1_1_mac_address.html">MacAddress</a> &amp; inet::Ipv6NeighbourDiscovery::resolveNeighbour </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>nextHop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public method, to be invoked from the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module to determine link-layer address and the output interface of the next hop. </p>
<p>If the neighbor cache does not contain this address or it's in the state INCOMPLETE, this method will return the nullptr address, and the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module should then send the datagram here to <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html" title="Implements RFC 2461 Neighbor Discovery for Ipv6.">Ipv6NeighbourDiscovery</a> where it will be stored until neighbour resolution completes.</p>
<p>If the neighbour cache entry is STALE (or REACHABLE but more than reachableTime elapsed since reachability was last confirmed), the link-layer address is still returned and <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> can send the datagram, but simultaneously, this call should trigger the Neighbour Unreachability Detection procedure to start in the <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html" title="Implements RFC 2461 Neighbor Discovery for Ipv6.">Ipv6NeighbourDiscovery</a> module. </p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;resolveNeighbor(%s,if=%d)&quot;</span>, nextHop.str().c_str(), interfaceId);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *nce = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">lookup</a>(nextHop, interfaceId);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//    NetworkInterface *ie = ift-&gt;getInterfaceById(interfaceId);</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (!nce || nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025">Ipv6NeighbourCache::INCOMPLETE</a>)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classinet_1_1_mac_address.html#a2bb1ac82ec10339520faa1a738881ec1">MacAddress::UNSPECIFIED_ADDRESS</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#afed4e9d56a44c338ea001e9211569588">initiateNeighbourUnreachabilityDetection</a>(nce);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">Ipv6NeighbourCache::REACHABLE</a> &amp;&amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;             simTime() &gt; nce-&gt;reachabilityExpires)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        nce-&gt;reachabilityState = <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">Ipv6NeighbourCache::STALE</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#afed4e9d56a44c338ea001e9211569588">initiateNeighbourUnreachabilityDetection</a>(nce);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nce-&gt;reachabilityState != <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">Ipv6NeighbourCache::REACHABLE</a>) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">// reachability state must be either in DELAY or PROBE</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        ASSERT(nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a379487af3fd63c982388189ccb914f4b">Ipv6NeighbourCache::DELAY</a> ||</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                nce-&gt;reachabilityState == <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a75ab0a402a584e25be2e8190562d5a45">Ipv6NeighbourCache::PROBE</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;NUD in progress.\n&quot;</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// else the entry is REACHABLE and no further action is required here.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> nce-&gt;macAddress;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4354002e9435d6c52390575b79a26d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4354002e9435d6c52390575b79a26d0">&#9670;&nbsp;</a></span>selectDefaultRouter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> inet::Ipv6NeighbourDiscovery::selectDefaultRouter </td>
          <td>(</td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>outIfID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Selecting default router...\n&quot;</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// draft-ietf-ipv6-2461bis-04.txt Section 6.3.6</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">/*The algorithm for selecting a router depends in part on whether or not a</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">       router is known to be reachable. The exact details of how a node keeps track</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">       of a neighbor&#39;s reachability state are covered in Section 7.3.  The algorithm</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">       for selecting a default router is invoked during next-hop determination when</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">       no Destination Cache entry exists for an off-link destination or when</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">       communication through an existing router appears to be failing.  Under normal</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">       conditions, a router would be selected the first time traffic is sent to a</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">       destination, with subsequent traffic for that destination using the same router</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">       as indicated in the Destination Cache modulo any changes to the Destination</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">       Cache caused by Redirect messages.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">       The policy for selecting routers from the Default Router List is as</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">       follows:*/</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">/*1) Routers that are reachable or probably reachable (i.e., in any state</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">       other than INCOMPLETE) SHOULD be preferred over routers whose reachability</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">       is unknown or suspect (i.e., in the INCOMPLETE state, or for which no Neighbor</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">       Cache entry exists). An implementation may choose to always return the same</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">       router or cycle through the router list in a round-robin fashion as long as</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">       it always returns a reachable or a probably reachable router when one is</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">       available.*/</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ac731b180d5b32fcbedfaf4fb99795a7a">DefaultRouterList</a>&amp; defaultRouters = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#add2cbfa1b575aa7726bd123ff16352cb">getDefaultRouterList</a>();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = defaultRouters.begin(); it != defaultRouters.end();) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a>&amp; nce = *it;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">if</span> (simTime() &gt; nce.routerExpiryTime) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Found an expired default router. Deleting entry...\n&quot;</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            ++it;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#aa9b1ce87953f709ff8f15a1330360e51">remove</a>(nce.nceKey-&gt;address, nce.nceKey-&gt;interfaceID);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">if</span> (nce.reachabilityState != <a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025">Ipv6NeighbourCache::INCOMPLETE</a>) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Found a probably reachable router in the default router list.\n&quot;</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            defaultRouters.setHead(*nce.nextDefaultRouter);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            outIfID = nce.nceKey-&gt;interfaceID;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordflow">return</span> nce.nceKey-&gt;address;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        ++it;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">/*2) When no routers on the list are known to be reachable or probably</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">       reachable, routers SHOULD be selected in a round-robin fashion, so that</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">       subsequent requests for a default router do not return the same router until</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">       all other routers have been selected.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">       Cycling through the router list in this case ensures that all available</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">       routers are actively probed by the Neighbor Unreachability Detection algorithm.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">       A request for a default router is made in conjunction with the sending of a</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">       packet to a router, and the selected router will be probed for reachability</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">       as a side effect.*/</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *defaultRouter = defaultRouters.getHead();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (defaultRouter != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Found a router in the neighbour cache (default router list).\n&quot;</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        defaultRouters.setHead(*defaultRouter-&gt;nextDefaultRouter);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        outIfID = defaultRouter-&gt;<a class="code" href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html#a2781ba1ccbd480799d136ab83844a8ac">nceKey</a>-&gt;<a class="code" href="structinet_1_1_ipv6_neighbour_cache_1_1_key.html#adcc53c6d26db0fdbab43acc667989ee0">interfaceID</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">return</span> defaultRouter-&gt;nceKey-&gt;address;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;No suitable routers found.\n&quot;</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    outIfID = -1;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">Ipv6Address::UNSPECIFIED_ADDRESS</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a58403829a82d8e16c1088f1a7d974e8a">determineNextHop()</a>.</p>

</div>
</div>
<a id="aa719d2a80f993cd2091cdcb9e1e2ded8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa719d2a80f993cd2091cdcb9e1e2ded8">&#9670;&nbsp;</a></span>sendPacketToIpv6Module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::sendPacketToIpv6Module </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create control info and assigns it to a msg. </p>
<p>Returns a copy of the msg with the control info. </p>
<div class="fragment"><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    msg-&gt;removeTagIfPresent&lt;<a class="code" href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a>&gt;();</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    msg-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#a8d28e59a0d202e69c382d34ad7080937">InterfaceReq</a>&gt;()-&gt;setInterfaceId(interfaceId);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    msg-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a>&gt;()-&gt;setProtocol(&amp;<a class="code" href="classinet_1_1_protocol.html#a325be61ec7aa7b45c11ac87f5ac7258a">Protocol::icmpv6</a>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keyword">auto</span> addressReq = msg-&gt;addTagIfAbsent&lt;L3AddressReq&gt;();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    addressReq-&gt;setSrcAddress(srcAddr);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    addressReq-&gt;setDestAddress(destAddr);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    msg-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a>&gt;()-&gt;setHopLimit(255);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    send(msg, <span class="stringliteral">&quot;ipv6Out&quot;</span>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">createAndSendRaPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0074c0980ba136204e92b58293c0768b">createAndSendRsPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">sendSolicitedNa()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad69ece6c0328a87c63564034d620af19">sendUnsolicitedNa()</a>.</p>

</div>
</div>
<a id="a0a5eeceb530ef5ec54f5116e95b51b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a5eeceb530ef5ec54f5116e95b51b83">&#9670;&nbsp;</a></span>sendPeriodicRa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::sendPeriodicRa </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;{</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    NetworkInterface *ie = (NetworkInterface *)msg-&gt;getContextPointer();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    AdvIfEntry *advIfEntry = <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a69afa04d7f16597917a932346cd2dff7">fetchAdvIfEntry</a>(ie);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    Ipv6Address destAddr = Ipv6Address(<span class="stringliteral">&quot;FF02::1&quot;</span>);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">createAndSendRaPacket</a>(destAddr, ie);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    advIfEntry-&gt;numRASent++;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// RFC 2461, Section 6.2.4</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">/*Whenever a multicast advertisement is sent from an interface, the timer is</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">       reset to a uniformly-distributed random value between the interface&#39;s</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">       configured MinRtrAdvInterval and MaxRtrAdvInterval; expiration of the timer</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">       causes the next advertisement to be sent and a new random value to be chosen.*/</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    EV_DEBUG &lt;&lt; <span class="stringliteral">&quot;\n+=+=+= MIPv6 Feature: &quot;</span> &lt;&lt; <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;hasMipv6Support() &lt;&lt; <span class="stringliteral">&quot; +=+=+=\n&quot;</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    simtime_t interval = uniform(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMinRtrAdvInterval(), ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMaxRtrAdvInterval());</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;\n +=+=+= The random calculated interval is: &quot;</span> &lt;&lt; interval &lt;&lt; <span class="stringliteral">&quot; +=+=+=\n&quot;</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">/*For the first few advertisements (up to MAX_INITIAL_RTR_ADVERTISEMENTS)</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">       sent from an interface when it becomes an advertising interface,*/</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Num RA sent is: &quot;</span> &lt;&lt; advIfEntry-&gt;numRASent &lt;&lt; endl;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;maxInitialRtrAdvertisements is: &quot;</span> &lt;&lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxInitialRtrAdvertisements() &lt;&lt; endl;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">if</span> (advIfEntry-&gt;numRASent &lt;= ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxInitialRtrAdvertisements()) {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordflow">if</span> (interval &gt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxInitialRtrAdvertInterval()) {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <span class="comment">// if the randomly chosen interval is greater than MAX_INITIAL_RTR_ADVERT_INTERVAL,</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="comment">// the timer SHOULD be set to MAX_INITIAL_RTR_ADVERT_INTERVAL instead.</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            interval = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxInitialRtrAdvertInterval();</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending initial RA but interval is too long. Using default value.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending initial RA. Using randomly generated interval.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    simtime_t nextScheduledTime = simTime() + interval;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Next scheduled time: &quot;</span> &lt;&lt; nextScheduledTime &lt;&lt; endl;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    advIfEntry-&gt;nextScheduledRATime = nextScheduledTime;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    ASSERT(nextScheduledTime &gt; simTime());</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    scheduleAfter(interval, msg);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="a68d77f1a5ed7ed3daf4e44d25e7c57d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68d77f1a5ed7ed3daf4e44d25e7c57d6">&#9670;&nbsp;</a></span>sendQueuedPacketsToIpv6Module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::sendQueuedPacketsToIpv6Module </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">Neighbour</a> *&#160;</td>
          <td class="paramname"><em>nce</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send off any queued packets within the Neighbour Discovery module awaiting address resolution. </p>
<p>Not used yet-unsure if we really need it.</p>
<p>&ndash;DELETED, Andras </p>
<div class="fragment"><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;{</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a3fbd67788781a9d929cfbbd293be7716">MsgPtrVector</a>&amp; pendingPackets = nce-&gt;pendingPackets;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">while</span> (!pendingPackets.empty()) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keyword">auto</span> i = pendingPackets.begin();</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        cMessage *msg = (*i);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        pendingPackets.erase(i);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ae56cb9501320961fdbecaa7091196f4e">pendingQueue</a>.remove(msg);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending queued packet &quot;</span> &lt;&lt; msg &lt;&lt; endl;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        send(msg, <span class="stringliteral">&quot;ipv6Out&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8ac7db21bc55a5ea3575d4298a34238d">processNaForIncompleteNceState()</a>.</p>

</div>
</div>
<a id="a8f48d8c4cac324ccebd842b32c9e0465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f48d8c4cac324ccebd842b32c9e0465">&#9670;&nbsp;</a></span>sendSolicitedNa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::sendSolicitedNa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;{</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="keyword">auto</span> na = makeShared&lt;Ipv6NeighbourAdvertisement&gt;();</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="comment">// RFC 2461: Section 7.2.4</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">/*A node sends a Neighbor Advertisement in response to a valid Neighbor</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">       Solicitation targeting one of the node&#39;s assigned addresses.  The</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">       Target Address of the advertisement is copied from the Target Address</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">       of the solicitation.*/</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    na-&gt;setTargetAddress(<a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getTargetAddress());</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">/*If the solicitation&#39;s IP Destination Address is not a multicast address,</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">       the Target Link-Layer Address option MAY be omitted; the neighboring node&#39;s</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">       cached value must already be current in order for the solicitation to have</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">       been received. If the solicitation&#39;s IP Destination Address is a multicast</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">       address, the Target Link-Layer option MUST be included in the advertisement.*/</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keyword">auto</span> tla = <span class="keyword">new</span> Ipv6NdTargetLinkLayerAddress();</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    tla-&gt;setLinkLayerAddress(ie-&gt;getMacAddress());</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    na-&gt;getOptionsForUpdate().appendOption(tla);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    na-&gt;addChunkLength(<a class="code" href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="comment">/*Furthermore, if the node is a router, it MUST set the Router flag to one;</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">       otherwise it MUST set the flag to zero.*/</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    na-&gt;setRouterFlag(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isRouter());</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">/*If the (NS)Target Address is either an anycast address or a unicast</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">       address for which the node is providing proxy service, or the Target</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">       Link-Layer Address option is not included,*/</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">// TODOANYCAST will not be implemented here!</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    MacAddress sourceLinkLayerAddress;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> sla = check_and_cast_nullable&lt;const Ipv6NdSourceLinkLayerAddress *&gt;(<a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        sourceLinkLayerAddress = sla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">if</span> (sourceLinkLayerAddress.isUnspecified())</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="comment">// the Override flag SHOULD be set to zero.</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        na-&gt;setOverrideFlag(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        <span class="comment">// Otherwise, the Override flag SHOULD be set to one.</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        na-&gt;setOverrideFlag(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">/*Proper setting of the Override flag ensures that nodes give preference to</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">       non-proxy advertisements, even when received after proxy advertisements, and</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">       also ensures that the first advertisement for an anycast address &quot;wins&quot;.*/</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    Ipv6Address naDestAddr;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="comment">// If the source of the solicitation is the unspecified address,</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6().isUnspecified()) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        <span class="comment">/*the node MUST set the Solicited flag to zero and multicast the advertisement</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">           to the all-nodes address.*/</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        na-&gt;setSolicitedFlag(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        naDestAddr = <a class="code" href="classinet_1_1_ipv6_address.html#a184c74e24312c78247000e7241b5cc5c">Ipv6Address::ALL_NODES_2</a>;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="comment">/*Otherwise, the node MUST set the Solicited flag to one and unicast</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">           the advertisement to the Source Address of the solicitation.*/</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        na-&gt;setSolicitedFlag(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        naDestAddr = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="comment">/*If the Target Address is an anycast address the sender SHOULD delay sending</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">       a response for a random time between 0 and MAX_ANYCAST_DELAY_TIME seconds.*/</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="comment">/*TODO More associated complexity for this one. We will have to delay</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">       sending off the solicitation. Perhaps the self message could have a context</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">       pointer pointing to a struct with enough info to create and send a NA packet.*/</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="comment">/*Because unicast Neighbor Solicitations are not required to include a</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">       Source Link-Layer Address, it is possible that a node sending a</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">       solicited Neighbor Advertisement does not have a corresponding link-</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">       layer address for its neighbor in its Neighbor Cache.  In such</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">       situations, a node will first have to use Neighbor Discovery to</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">       determine the link-layer address of its neighbor (i.e, send out a</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">       multicast Neighbor Solicitation).*/</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="comment">// TODO if above mentioned happens, can addr resolution be performed for ND messages?</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="comment">// if no link-layer addr exists for unicast addr when sending solicited NA, we should</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="comment">// add the NA to the list of queued packets. What if we have a list of queued</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="comment">// packets for different unicast solicitations? each time addr resolution is</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="comment">// done we should check the destinations of the list of queued packets and send</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="comment">// off the respective ones.</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    Ipv6Address myIPv6Addr = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getPreferredAddress();</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keyword">auto</span> naPacket = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;NApacket&quot;</span>);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <a class="code" href="classinet_1_1_icmpv6.html#ac142d92cd12e9ebf7b63304205678f86">Icmpv6::insertCrc</a>(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a>, na, packet);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    naPacket-&gt;insertAtFront(na);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">sendPacketToIpv6Module</a>(naPacket, naDestAddr, myIPv6Addr, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac9f4663f98d7ead079225599d98ff0e9">processNsForNonTentativeAddress()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af705b92b216d89adb9ecd0509c46c322">processNsWithSpecifiedSrcAddr()</a>.</p>

</div>
</div>
<a id="ae66149131978353b4c56809f18035cfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66149131978353b4c56809f18035cfa">&#9670;&nbsp;</a></span>sendSolicitedRa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::sendSolicitedRa </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;{</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Send Solicited RA invoked!\n&quot;</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    NetworkInterface *ie = (NetworkInterface *)msg-&gt;getContextPointer();</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    Ipv6Address destAddr = Ipv6Address(<span class="stringliteral">&quot;FF02::1&quot;</span>);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Testing condition!\n&quot;</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">createAndSendRaPacket</a>(destAddr, ie);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keyword">delete</span> msg;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a60cb60d89f39802b186fa30cab992954">handleMessage()</a>.</p>

</div>
</div>
<a id="ad69ece6c0328a87c63564034d620af19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad69ece6c0328a87c63564034d620af19">&#9670;&nbsp;</a></span>sendUnsolicitedNa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::sendUnsolicitedNa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;{</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">// RFC 2461</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">// Section 7.2.6: Sending Unsolicited Neighbor Advertisements</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;sendUnsolicitedNa&quot;</span>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="preprocessor">#ifndef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="comment">// In some cases a node may be able to determine that its link-layer</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="comment">// address has changed (e.g., hot-swap of an interface card) and may</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="comment">// wish to inform its neighbors of the new link-layer address quickly.</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="comment">// In such cases a node MAY send up to MAX_NEIGHBOR_ADVERTISEMENT</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="comment">// unsolicited Neighbor Advertisement messages to the all-nodes</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="comment">// multicast address.  These advertisements MUST be separated by at</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="comment">// least RetransTimer seconds.</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keyword">auto</span> na = makeShared&lt;Ipv6NeighbourAdvertisement&gt;();</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    Ipv6Address myIPv6Addr = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getPreferredAddress();</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="comment">// The Target Address field in the unsolicited advertisement is set to</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="comment">// an IP address of the interface, and the Target Link-Layer Address</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="comment">// option is filled with the new link-layer address.</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    na-&gt;setTargetAddress(myIPv6Addr);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keyword">auto</span> sla = <span class="keyword">new</span> Ipv6NdTargetLinkLayerAddress();</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    sla-&gt;setLinkLayerAddress(ie-&gt;getMacAddress());</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    na-&gt;getOptionsForUpdate().appendOption(sla);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    na-&gt;addChunkLength(<a class="code" href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a>);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="comment">// The Solicited flag MUST be set to zero, in order to avoid confusing</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="comment">// the Neighbor Unreachability Detection algorithm.</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    na-&gt;setSolicitedFlag(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">// If the node is a router, it MUST set the Router flag to one;</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="comment">// otherwise it MUST set it to zero.</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    na-&gt;setRouterFlag(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;isRouter());</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="comment">// The Override flag MAY be set to either zero or one.  In either case,</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="comment">// neighboring nodes will immediately change the state of their Neighbor</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="comment">// Cache entries for the Target Address to STALE, prompting them to</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="comment">// verify the path for reachability.  If the Override flag is set to</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="comment">// one, neighboring nodes will install the new link-layer address in</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="comment">// their caches.  Otherwise, they will ignore the new link-layer</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">// address, choosing instead to probe the cached address.</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    na-&gt;setOverrideFlag(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="comment">// A node that has multiple IP addresses assigned to an interface MAY</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// multicast a separate Neighbor Advertisement for each address.  In</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="comment">// such a case the node SHOULD introduce a small delay between the</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="comment">// sending of each advertisement to reduce the probability of the</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="comment">// advertisements being lost due to congestion.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="comment">// A proxy MAY multicast Neighbor Advertisements when its link-layer</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="comment">// address changes or when it is configured (by system management or</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="comment">// other mechanisms) to proxy for an address.  If there are multiple</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">// nodes that are providing proxy services for the same set of addresses</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">// the proxies SHOULD provide a mechanism that prevents multiple proxies</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">// from multicasting advertisements for any one address, in order to</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">// reduce the risk of excessive multicast traffic.</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="comment">// Also, a node belonging to an anycast address MAY multicast</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="comment">// unsolicited Neighbor Advertisements for the anycast address when the</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">// node&#39;s link-layer address changes.</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="comment">// Note that because unsolicited Neighbor Advertisements do not reliably</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="comment">// update caches in all nodes (the advertisements might not be received</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">// by all nodes), they should only be viewed as a performance</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">// optimization to quickly update the caches in most neighbors.  The</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="comment">// Neighbor Unreachability Detection algorithm ensures that all nodes</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">// obtain a reachable link-layer address, though the delay may be</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="comment">// slightly longer.</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;NApacket&quot;</span>);</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <a class="code" href="classinet_1_1_icmpv6.html#ac142d92cd12e9ebf7b63304205678f86">Icmpv6::insertCrc</a>(<a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">crcMode</a>, na, packet);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    packet-&gt;insertAtFront(na);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">sendPacketToIpv6Module</a>(packet, <a class="code" href="classinet_1_1_ipv6_address.html#a184c74e24312c78247000e7241b5cc5c">Ipv6Address::ALL_NODES_2</a>, myIPv6Addr, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b5d2ce626c1d5ebe787101eacfc97df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b5d2ce626c1d5ebe787101eacfc97df">&#9670;&nbsp;</a></span>timeoutDefaultRouter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::timeoutDefaultRouter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RFC 2461: Section 6.3.5 Whenever the Lifetime of an entry in the Default Router List expires, that entry is discarded. </p>
<p>When removing a router from the Default Router list, the node MUST update the Destination Cache in such a way that all entries using the router perform next-hop determination again rather than continue sending traffic to the (deleted) router. </p>
<div class="fragment"><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// RFC 2461: Section 6.3.5</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">/*Whenever the Lifetime of an entry in the Default Router List expires,</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">       that entry is discarded.*/</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">neighbourCache</a>.<a class="code" href="classinet_1_1_ipv6_neighbour_cache.html#aa9b1ce87953f709ff8f15a1330360e51">remove</a>(addr, interfaceID);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">/*When removing a router from the Default Router list, the node MUST update</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">       the Destination Cache in such a way that all entries using the router perform</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">       next-hop determination again rather than continue sending traffic to the</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">       (deleted) router.*/</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;purgeDestCacheEntriesToNeighbour(addr, interfaceID);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates()</a>.</p>

</div>
</div>
<a id="a0952be7b9362cd542d795cd2d8af858e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0952be7b9362cd542d795cd2d8af858e">&#9670;&nbsp;</a></span>timeoutPrefixEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::Ipv6NeighbourDiscovery::timeoutPrefixEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>destPrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefixLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RFC 2461: Section 6.3.5 Whenever the invalidation timer expires for a Prefix List entry, that entry is discarded. </p>
<p>No existing Destination Cache entries need be updated, however. Should a reachability problem arise with an existing Neighbor Cache entry, Neighbor Unreachability Detection will perform any needed recovery. </p>
<div class="fragment"><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;{</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">// RFC 2461: Section 6.3.5</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">/*Whenever the invalidation timer expires for a Prefix List entry, that</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">       entry is discarded.*/</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">rt6</a>-&gt;deleteOnLinkPrefix(destPrefix, prefixLength);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// hmmm... should the unicast address associated with this prefix be deleted</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// as well?-TODO The address should be timeout/deleted as well!!</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">/*No existing Destination Cache entries need be updated, however. Should a</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">       reachability problem arise with an existing Neighbor Cache entry, Neighbor</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">       Unreachability Detection will perform any needed recovery.*/</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17981233c1189689062894b35f19cf7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17981233c1189689062894b35f19cf7a">&#9670;&nbsp;</a></span>validateNaPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::Ipv6NeighbourDiscovery::validateNaPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_advertisement.html">Ipv6NeighbourAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>na</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;{</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordtype">bool</span> result = <span class="keyword">true</span>; <span class="comment">// adopt optimistic approach</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="comment">// RFC 2461:7.1.2 Validation of Neighbor Advertisments(some checks are omitted)</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="comment">// A node MUST silently discard any received Neighbor Advertisment messages</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="comment">// that do not satisfy all of the following validity checks:</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="comment">// - The IP Hop Limit field has a value of 255, i.e., the packet</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="comment">// could not possibly have been forwarded by a router.</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;HopLimitInd&gt;()-&gt;getHopLimit() != 255) {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Hop Limit is not 255! NA validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="comment">// - Target Address is not a multicast address.</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="keywordflow">if</span> (na-&gt;getTargetAddress().isMulticast() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Target Address is a multicast address! NA validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    }</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; </div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="comment">// - If the IP Destination Address is a multicast address the Solicited flag</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="comment">// is zero.</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6().isMulticast()) {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <span class="keywordflow">if</span> (na-&gt;getSolicitedFlag() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot;Dest Address is multicast address but solicited flag is 0!\n&quot;</span>;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    }</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="keywordflow">if</span> (result == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        bubble(<span class="stringliteral">&quot;NA validation passed.&quot;</span>);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        bubble(<span class="stringliteral">&quot;NA validation failed.&quot;</span>);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket()</a>.</p>

</div>
</div>
<a id="a909f55a15fe0bdf6de9dd34664b1ab27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909f55a15fe0bdf6de9dd34664b1ab27">&#9670;&nbsp;</a></span>validateNsPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::Ipv6NeighbourDiscovery::validateNsPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_neighbour_solicitation.html">Ipv6NeighbourSolicitation</a> *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;{</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="comment">/*RFC 2461:7.1.1. Validation of Neighbor Solicitations(some checks are omitted)</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">       A node MUST silently discard any received Neighbor Solicitation</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">       messages that do not satisfy all of the following validity checks:*/</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="comment">// - The IP Hop Limit field has a value of 255, i.e., the packet</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">// could not possibly have been forwarded by a router.</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;HopLimitInd&gt;()-&gt;getHopLimit() != 255) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Hop limit is not 255! NS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">// - Target Address is not a multicast address.</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getTargetAddress().isMulticast() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Target address is a multicast address! NS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="comment">// - If the IP source address is the unspecified address,</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6().isUnspecified()) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Source Address is unspecified\n&quot;</span>;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">// the IP destination address is a solicited-node multicast address.</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6().matches(<a class="code" href="classinet_1_1_ipv6_address.html#a4a43ce20198471fc2a112d89ed64542b">Ipv6Address::SOLICITED_NODE_PREFIX</a>, 104) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot; but IP dest address is not a solicited-node multicast address! NS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <span class="comment">// there is no source link-layer address option in the message.</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            MacAddress sourceLinkLayerAddress;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">auto</span> sla = check_and_cast_nullable&lt;const Ipv6NdSourceLinkLayerAddress *&gt;(<a class="code" href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">ns</a>-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                sourceLinkLayerAddress = sla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            <span class="keywordflow">if</span> (sourceLinkLayerAddress.isUnspecified() == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                EV_WARN &lt;&lt; <span class="stringliteral">&quot; but Source link-layer address is not empty! NS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">processNsPacket()</a>.</p>

</div>
</div>
<a id="a3f776f294e2d817343427ccef1479f1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f776f294e2d817343427ccef1479f1a">&#9670;&nbsp;</a></span>validateRaPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::Ipv6NeighbourDiscovery::validateRaPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_router_advertisement.html">Ipv6RouterAdvertisement</a> *&#160;</td>
          <td class="paramname"><em>ra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;{</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">// RFC 2461: Section 6.1.2 Validation of Router Advertisement Messages</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="comment">/*A node MUST silently discard any received Router Advertisement</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">       messages that do not satisfy all of the following validity checks:*/</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    Ipv6Address srcAddr = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">// - IP Source Address is a link-local address.  Routers must use</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// their link-local address as the source for Router Advertisement</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// and Redirect messages so that hosts can uniquely identify</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// routers.</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordflow">if</span> (srcAddr.isLinkLocal() == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;RA source address is not link-local. RA validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="comment">// - The IP Hop Limit field has a value of 255, i.e., the packet</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="comment">// could not possibly have been forwarded by a router.</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;HopLimitInd&gt;()-&gt;getHopLimit() != 255) {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Hop limit is not 255! RA validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">// - ICMP Code is 0.</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a>&gt;()-&gt;getProtocol() != &amp;<a class="code" href="classinet_1_1_protocol.html#a325be61ec7aa7b45c11ac87f5ac7258a">Protocol::icmpv6</a>) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;ICMP Code is not 0! RA validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="preprocessor">#ifdef INET_WITH_xMIPv6</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// - All included options have a length that is greater than zero.</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">// CB</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordtype">bool</span> prefixInfoFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int)ra-&gt;getOptions().getOptionArraySize(); i++) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keyword">auto</span> option = ra-&gt;getOptions().getOption(i);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="keywordflow">if</span> (option-&gt;getType() == <a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9a34d0a70fa50aed20abb4c98cb1fd516b">IPv6ND_PREFIX_INFORMATION</a>) {</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            prefixInfoFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">if</span> (!prefixInfoFound) {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;No prefix information available! RA validation failed\n&quot;</span>;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* INET_WITH_xMIPv6 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket()</a>.</p>

</div>
</div>
<a id="aa5e577327ead9f3ba0c9165c6086f94b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e577327ead9f3ba0c9165c6086f94b">&#9670;&nbsp;</a></span>validateRsPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::Ipv6NeighbourDiscovery::validateRsPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_router_solicitation.html">Ipv6RouterSolicitation</a> *&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;{</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">/*6.1.1.  Validation of Router Solicitation Messages</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">       A router MUST silently discard any received Router Solicitation</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">       messages that do not satisfy all of the following validity checks:</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">       - The IP Hop Limit field has a value of 255, i.e., the packet</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">       could not possibly have been forwarded by a router.*/</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;HopLimitInd&gt;()-&gt;getHopLimit() != 255) {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Hop limit is not 255! RS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">// - ICMP Code is 0.</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a>&gt;()-&gt;getProtocol() != &amp;<a class="code" href="classinet_1_1_protocol.html#a325be61ec7aa7b45c11ac87f5ac7258a">Protocol::icmpv6</a>) {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;ICMP Code is not 0! RS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">// - If the IP source address is the unspecified address, there is no</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// source link-layer address option in the message.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6().isUnspecified()) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;IP source address is unspecified\n&quot;</span>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        MacAddress macAddr;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> sla = check_and_cast_nullable&lt;const Ipv6NdSourceLinkLayerAddress *&gt;(rs-&gt;getOptions().findOption(<a class="code" href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a>)))</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            macAddr = sla-&gt;getLinkLayerAddress();</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">if</span> (macAddr.isUnspecified() == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot; but source link layer address is provided. RS validation failed!\n&quot;</span>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a6545a821734516cb41b46ea3018768e6">processRsPacket()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae7698ec16351dd133fc0f6b1511bdadd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7698ec16351dd133fc0f6b1511bdadd">&#9670;&nbsp;</a></span>advIfList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a133a74558097ce3e1f58ee85350af2ee">AdvIfList</a> inet::Ipv6NeighbourDiscovery::advIfList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1bd8d8f8fb25e14520eebf1ffd3e8638">createRaTimer()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a69afa04d7f16597917a932346cd2dff7">fetchAdvIfEntry()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1fbdf352f9ee7ae5559dafc5d95f6153">~Ipv6NeighbourDiscovery()</a>.</p>

</div>
</div>
<a id="a96e74cfc876460fc5a5b9c452f6f1cb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96e74cfc876460fc5a5b9c452f6f1cb1">&#9670;&nbsp;</a></span>crcMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceinet.html#a8e064ca696c868d4b453ed29a327c268">CrcMode</a> inet::Ipv6NeighbourDiscovery::crcMode = <a class="el" href="namespaceinet.html#a8e064ca696c868d4b453ed29a327c268ac976c93f96267266fbe43cfd40f02bed">CRC_MODE_UNDEFINED</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">createAndSendNsPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">createAndSendRaPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0074c0980ba136204e92b58293c0768b">createAndSendRsPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">sendSolicitedNa()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad69ece6c0328a87c63564034d620af19">sendUnsolicitedNa()</a>.</p>

</div>
</div>
<a id="aeed93f574978b74ed1468f72415cb9bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed93f574978b74ed1468f72415cb9bc">&#9670;&nbsp;</a></span>dadList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af3bf14aa09cfc17052f2649f097a198f">DadList</a> inet::Ipv6NeighbourDiscovery::dadList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">initiateDad()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">processDadTimeout()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1fbdf352f9ee7ae5559dafc5d95f6153">~Ipv6NeighbourDiscovery()</a>.</p>

</div>
</div>
<a id="a9ec34bce8a900f4950b15314399343ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ec34bce8a900f4950b15314399343ab">&#9670;&nbsp;</a></span>icmpv6</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_icmpv6.html">Icmpv6</a>&gt; inet::Ipv6NeighbourDiscovery::icmpv6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">dropQueuedPacketsAwaitingAr()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>.</p>

</div>
</div>
<a id="a8e12213fbe33b3cb3a838d9148a5d843"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e12213fbe33b3cb3a838d9148a5d843">&#9670;&nbsp;</a></span>ift</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_i_interface_table.html">IInterfaceTable</a>&gt; inet::Ipv6NeighbourDiscovery::ift</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">assignLinkLocalAddress()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a95ab88a9f54400a96e69c7197692d325">initiateAddressResolution()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#afed4e9d56a44c338ea001e9211569588">initiateNeighbourUnreachabilityDetection()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">processArTimeout()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">processDadTimeout()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8ac7db21bc55a5ea3575d4298a34238d">processNaForIncompleteNceState()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ab5a196dc851cd900c43606a87aa4214a">processNaForOtherNceStates()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">processNsPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a974038ffaaefc3afe370f22e7deb4abb">processNudTimeout()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">processRaPacket()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a6545a821734516cb41b46ea3018768e6">processRsPacket()</a>.</p>

</div>
</div>
<a id="aa4e41e16cf0b9351675924c57b1e92e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4e41e16cf0b9351675924c57b1e92e6">&#9670;&nbsp;</a></span>neighbourCache</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_neighbour_cache.html">Ipv6NeighbourCache</a> inet::Ipv6NeighbourDiscovery::neighbourCache</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">dropQueuedPacketsAwaitingAr()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8ac7db21bc55a5ea3575d4298a34238d">processNaForIncompleteNceState()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ab5a196dc851cd900c43606a87aa4214a">processNaForOtherNceStates()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">processNaPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af705b92b216d89adb9ecd0509c46c322">processNsWithSpecifiedSrcAddr()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a974038ffaaefc3afe370f22e7deb4abb">processNudTimeout()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af637e15ac37dec83545e2e79bf4fca98">reachabilityConfirmed()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac94a0f1736ad699faa4f2207a0b1b4a8">resolveNeighbour()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad4354002e9435d6c52390575b79a26d0">selectDefaultRouter()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0b5d2ce626c1d5ebe787101eacfc97df">timeoutDefaultRouter()</a>.</p>

</div>
</div>
<a id="ae56cb9501320961fdbecaa7091196f4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae56cb9501320961fdbecaa7091196f4e">&#9670;&nbsp;</a></span>pendingQueue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cQueue inet::Ipv6NeighbourDiscovery::pendingQueue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">dropQueuedPacketsAwaitingAr()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">processIpv6Datagram()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a68d77f1a5ed7ed3daf4e44d25e7c57d6">sendQueuedPacketsToIpv6Module()</a>.</p>

</div>
</div>
<a id="a7c68a3688014e46919973b9658f76ad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c68a3688014e46919973b9658f76ad8">&#9670;&nbsp;</a></span>raTimerList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ae227a389fec9f2515d4ce65cf5b62828">RaTimerList</a> inet::Ipv6NeighbourDiscovery::raTimerList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1fbdf352f9ee7ae5559dafc5d95f6153">~Ipv6NeighbourDiscovery()</a>.</p>

</div>
</div>
<a id="a3e95b51db717607155679e42a61baa7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e95b51db717607155679e42a61baa7c">&#9670;&nbsp;</a></span>rdList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1de1796c8bccf6250c13f80500af4fc8">RdList</a> inet::Ipv6NeighbourDiscovery::rdList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#af725a09fc820f4212c28e9a057e3f1eb">cancelRouterDiscovery()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac781673fa35d079fc0569013a1543b72">fetchRdEntry()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ada0656767ed0fc44353b64524b681c3e">initiateRouterDiscovery()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad7ee162e2bb2ddeb05382151def252fa">processRdTimeout()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a1fbdf352f9ee7ae5559dafc5d95f6153">~Ipv6NeighbourDiscovery()</a>.</p>

</div>
</div>
<a id="ab81ba417b96f24a632816551b750116c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab81ba417b96f24a632816551b750116c">&#9670;&nbsp;</a></span>rt6</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_ipv6_routing_table.html">Ipv6RoutingTable</a>&gt; inet::Ipv6NeighbourDiscovery::rt6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">createAndSendRaPacket()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a58403829a82d8e16c1088f1a7d974e8a">determineNextHop()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad16a7053ca26034297580c0568ef48a4">initialize()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ac49804b7936addaf44c498b28c2757fa">makeTentativeAddressPermanent()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a4f9a227416f64d7dd9c80182a0d9c07f">processNsForTentativeAddress()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">processRaForRouterUpdates()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a53e81888790f212685a2a3a483481dee">processRaPrefixInfo()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0a5eeceb530ef5ec54f5116e95b51b83">sendPeriodicRa()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">sendSolicitedNa()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#ad69ece6c0328a87c63564034d620af19">sendUnsolicitedNa()</a>, <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0b5d2ce626c1d5ebe787101eacfc97df">timeoutDefaultRouter()</a>, and <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#a0952be7b9362cd542d795cd2d8af858e">timeoutPrefixEntry()</a>.</p>

</div>
</div>
<a id="a053e86d782629b4bca3b8efb826c158e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a053e86d782629b4bca3b8efb826c158e">&#9670;&nbsp;</a></span>startDadSignal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simsignal_t inet::Ipv6NeighbourDiscovery::startDadSignal = registerSignal(&quot;startDad&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">initiateDad()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_ipv6_neighbour_discovery_8h.html">Ipv6NeighbourDiscovery.h</a></li>
<li><a class="el" href="_ipv6_neighbour_discovery_8cc.html">Ipv6NeighbourDiscovery.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructinet_1_1_ipv6_neighbour_cache_1_1_key_html_adcc53c6d26db0fdbab43acc667989ee0"><div class="ttname"><a href="structinet_1_1_ipv6_neighbour_cache_1_1_key.html#adcc53c6d26db0fdbab43acc667989ee0">inet::Ipv6NeighbourCache::Key::interfaceID</a></div><div class="ttdeci">int interfaceID</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:50</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a053e86d782629b4bca3b8efb826c158e"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a053e86d782629b4bca3b8efb826c158e">inet::Ipv6NeighbourDiscovery::startDadSignal</a></div><div class="ttdeci">static simsignal_t startDadSignal</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:52</div></div>
<div class="ttc" id="anamespaceinet_html_acd0d847a7b6e0f156094fbdd101a00a6"><div class="ttname"><a href="namespaceinet.html#acd0d847a7b6e0f156094fbdd101a00a6">inet::findContainingNode</a></div><div class="ttdeci">cModule * findContainingNode(const cModule *from)</div><div class="ttdoc">Find the node containing the given module.</div><div class="ttdef"><b>Definition:</b> ModuleAccess.cc:31</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a95ab88a9f54400a96e69c7197692d325"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a95ab88a9f54400a96e69c7197692d325">inet::Ipv6NeighbourDiscovery::initiateAddressResolution</a></div><div class="ttdeci">virtual void initiateAddressResolution(const Ipv6Address &amp;dgSrcAddr, Neighbour *nce)</div><div class="ttdoc">This method attempts to resolve the given neighbour's link-layer address.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:630</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_address_html_a19baf4e67b98c19b998a7808bbe2c7b4"><div class="ttname"><a href="classinet_1_1_ipv6_address.html#a19baf4e67b98c19b998a7808bbe2c7b4">inet::Ipv6Address::ALL_ROUTERS_2</a></div><div class="ttdeci">static const Ipv6Address ALL_ROUTERS_2</div><div class="ttdoc">All-routers multicast address, scope 2 (link-local)</div><div class="ttdef"><b>Definition:</b> Ipv6Address.h:69</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ae7698ec16351dd133fc0f6b1511bdadd"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ae7698ec16351dd133fc0f6b1511bdadd">inet::Ipv6NeighbourDiscovery::advIfList</a></div><div class="ttdeci">AdvIfList advIfList</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:138</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a72f6e782255b8c0e61fa1c474d13cb27"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a72f6e782255b8c0e61fa1c474d13cb27">inet::Ipv6NeighbourDiscovery::Key</a></div><div class="ttdeci">Ipv6NeighbourCache::Key Key</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:43</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a77a3fdd591f0f9afdd924d561c0e71cb"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a77a3fdd591f0f9afdd924d561c0e71cb">inet::Ipv6NeighbourDiscovery::processNsPacket</a></div><div class="ttdeci">virtual void processNsPacket(Packet *packet, const Ipv6NeighbourSolicitation *ns)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1842</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ad0ab43456af51d304c3079313d0c834d"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ad0ab43456af51d304c3079313d0c834d">inet::Ipv6NeighbourDiscovery::processRaPacket</a></div><div class="ttdeci">virtual void processRaPacket(Packet *packet, const Ipv6RouterAdvertisement *ra)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1287</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ac731b180d5b32fcbedfaf4fb99795a7a"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ac731b180d5b32fcbedfaf4fb99795a7a">inet::Ipv6NeighbourDiscovery::DefaultRouterList</a></div><div class="ttdeci">Ipv6NeighbourCache::DefaultRouterList DefaultRouterList</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:45</div></div>
<div class="ttc" id="aclassinet_1_1_icmpv6_html_ac142d92cd12e9ebf7b63304205678f86"><div class="ttname"><a href="classinet_1_1_icmpv6.html#ac142d92cd12e9ebf7b63304205678f86">inet::Icmpv6::insertCrc</a></div><div class="ttdeci">static void insertCrc(CrcMode crcMode, const Ptr&lt; Icmpv6Header &gt; &amp;icmpHeader, Packet *packet)</div><div class="ttdef"><b>Definition:</b> Icmpv6.cc:333</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aa719d2a80f993cd2091cdcb9e1e2ded8"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aa719d2a80f993cd2091cdcb9e1e2ded8">inet::Ipv6NeighbourDiscovery::sendPacketToIpv6Module</a></div><div class="ttdeci">virtual void sendPacketToIpv6Module(Packet *msg, const Ipv6Address &amp;destAddr, const Ipv6Address &amp;srcAddr, int interfaceId)</div><div class="ttdoc">Create control info and assigns it to a msg.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:737</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a6803ba0bf881b22819a1193768cc5367"><div class="ttname"><a href="_i_udp-gates_8txt.html#a6803ba0bf881b22819a1193768cc5367">protocol</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down protocol</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_a81f972006a357c3ddda2dfcfd7469015"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#a81f972006a357c3ddda2dfcfd7469015">MK_DAD_TIMEOUT</a></div><div class="ttdeci">#define MK_DAD_TIMEOUT</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:32</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_a5cf494cfe748e2ad086aab32d50c93c0"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#a5cf494cfe748e2ad086aab32d50c93c0">inet::Ipv6NeighbourCache::addRouter</a></div><div class="ttdeci">virtual Neighbour * addRouter(const Ipv6Address &amp;addr, int interfaceID, MacAddress macAddress, simtime_t expiryTime, bool isHomeAgent=false)</div><div class="ttdoc">Creates and initializes a router entry (isRouter=isDefaultRouter=true), MAC address and state=STALE.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.cc:121</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a0b5d2ce626c1d5ebe787101eacfc97df"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a0b5d2ce626c1d5ebe787101eacfc97df">inet::Ipv6NeighbourDiscovery::timeoutDefaultRouter</a></div><div class="ttdeci">virtual void timeoutDefaultRouter(const Ipv6Address &amp;addr, int interfaceID)</div><div class="ttdoc">RFC 2461: Section 6.3.5 Whenever the Lifetime of an entry in the Default Router List expires,...</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:615</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_afed4e9d56a44c338ea001e9211569588"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#afed4e9d56a44c338ea001e9211569588">inet::Ipv6NeighbourDiscovery::initiateNeighbourUnreachabilityDetection</a></div><div class="ttdeci">virtual void initiateNeighbourUnreachabilityDetection(Neighbour *neighbour)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:471</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a9ec34bce8a900f4950b15314399343ab"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a9ec34bce8a900f4950b15314399343ab">inet::Ipv6NeighbourDiscovery::icmpv6</a></div><div class="ttdeci">ModuleRefByPar&lt; Icmpv6 &gt; icmpv6</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:91</div></div>
<div class="ttc" id="anamespaceinet_html_aaffaaf4c7fe91d1ccf6b620881927195"><div class="ttname"><a href="namespaceinet.html#aaffaaf4c7fe91d1ccf6b620881927195">inet::ICMPv6_HEADER_BYTES</a></div><div class="ttdeci">const B ICMPv6_HEADER_BYTES</div><div class="ttdef"><b>Definition:</b> Icmpv6Header_m.h:55</div></div>
<div class="ttc" id="astructinet_1_1_ipv6_neighbour_cache_1_1_neighbour_html_a2781ba1ccbd480799d136ab83844a8ac"><div class="ttname"><a href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html#a2781ba1ccbd480799d136ab83844a8ac">inet::Ipv6NeighbourCache::Neighbour::nceKey</a></div><div class="ttdeci">const Key * nceKey</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:61</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ad7ee162e2bb2ddeb05382151def252fa"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ad7ee162e2bb2ddeb05382151def252fa">inet::Ipv6NeighbourDiscovery::processRdTimeout</a></div><div class="ttdeci">virtual void processRdTimeout(cMessage *msg)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1030</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a58403829a82d8e16c1088f1a7d974e8a"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a58403829a82d8e16c1088f1a7d974e8a">inet::Ipv6NeighbourDiscovery::determineNextHop</a></div><div class="ttdeci">virtual Ipv6Address determineNextHop(const Ipv6Address &amp;destAddr, int &amp;outIfID)</div><div class="ttdoc">This function accepts the datagram's destination address and attempts to determine the destination's ...</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:422</div></div>
<div class="ttc" id="afeatures_8h_html_a859e989a926173a0259f5faf248f50fe"><div class="ttname"><a href="features_8h.html#a859e989a926173a0259f5faf248f50fe">INET_WITH_xMIPv6</a></div><div class="ttdeci">#define INET_WITH_xMIPv6</div><div class="ttdef"><b>Definition:</b> features.h:221</div></div>
<div class="ttc" id="anamespaceinet_html_a2190cf3791ba9c80b79859f3b7875ef0"><div class="ttname"><a href="namespaceinet.html#a2190cf3791ba9c80b79859f3b7875ef0">inet::IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</a></div><div class="ttdeci">const B IPv6ND_LINK_LAYER_ADDRESS_OPTION_LENGTH</div><div class="ttdef"><b>Definition:</b> Ipv6NdMessage_m.h:64</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a53e81888790f212685a2a3a483481dee"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a53e81888790f212685a2a3a483481dee">inet::Ipv6NeighbourDiscovery::processRaPrefixInfo</a></div><div class="ttdeci">virtual void processRaPrefixInfo(const Ipv6RouterAdvertisement *ra, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1477</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a1e0b078c7b87d8f58ad6e43de5c37089"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a1e0b078c7b87d8f58ad6e43de5c37089">inet::Ipv6NeighbourDiscovery::assignLinkLocalAddress</a></div><div class="ttdeci">virtual void assignLinkLocalAddress(cMessage *timerMsg)</div><div class="ttdoc">as it is not possbile to explicitly define RFC 2462.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:767</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a31d32a84a4bb0111c3f4216ba8c73bbc"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a31d32a84a4bb0111c3f4216ba8c73bbc">inet::Ipv6NeighbourDiscovery::processArTimeout</a></div><div class="ttdeci">virtual void processArTimeout(cMessage *arTimeoutMsg)</div><div class="ttdoc">Resends a NS packet to the address intended for address resolution.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:682</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a3f776f294e2d817343427ccef1479f1a"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a3f776f294e2d817343427ccef1479f1a">inet::Ipv6NeighbourDiscovery::validateRaPacket</a></div><div class="ttdeci">virtual bool validateRaPacket(Packet *packet, const Ipv6RouterAdvertisement *ra)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1758</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ad4354002e9435d6c52390575b79a26d0"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ad4354002e9435d6c52390575b79a26d0">inet::Ipv6NeighbourDiscovery::selectDefaultRouter</a></div><div class="ttdeci">virtual Ipv6Address selectDefaultRouter(int &amp;outIfID)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:535</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a974038ffaaefc3afe370f22e7deb4abb"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a974038ffaaefc3afe370f22e7deb4abb">inet::Ipv6NeighbourDiscovery::processNudTimeout</a></div><div class="ttdeci">virtual void processNudTimeout(cMessage *timeoutMsg)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:490</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_address_html_a184c74e24312c78247000e7241b5cc5c"><div class="ttname"><a href="classinet_1_1_ipv6_address.html#a184c74e24312c78247000e7241b5cc5c">inet::Ipv6Address::ALL_NODES_2</a></div><div class="ttdeci">static const Ipv6Address ALL_NODES_2</div><div class="ttdoc">All-nodes multicast address, scope 2 (link-local)</div><div class="ttdef"><b>Definition:</b> Ipv6Address.h:63</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_a817ccecd04135b6f9307b110598e476e"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#a817ccecd04135b6f9307b110598e476e">MK_NUD_TIMEOUT</a></div><div class="ttdeci">#define MK_NUD_TIMEOUT</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:34</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a8f48d8c4cac324ccebd842b32c9e0465"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a8f48d8c4cac324ccebd842b32c9e0465">inet::Ipv6NeighbourDiscovery::sendSolicitedNa</a></div><div class="ttdeci">virtual void sendSolicitedNa(Packet *packet, const Ipv6NeighbourSolicitation *ns, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:2004</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112afeec060c879ce86dbd7a7d9249a6b025">inet::Ipv6NeighbourCache::INCOMPLETE</a></div><div class="ttdeci">@ INCOMPLETE</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:41</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ab81ba417b96f24a632816551b750116c"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ab81ba417b96f24a632816551b750116c">inet::Ipv6NeighbourDiscovery::rt6</a></div><div class="ttdeci">ModuleRefByPar&lt; Ipv6RoutingTable &gt; rt6</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:90</div></div>
<div class="ttc" id="astructinet_1_1_ipv6_neighbour_cache_1_1_key_html_a2a6fb7a30d2bb9c05abb791fe46b072e"><div class="ttname"><a href="structinet_1_1_ipv6_neighbour_cache_1_1_key.html#a2a6fb7a30d2bb9c05abb791fe46b072e">inet::Ipv6NeighbourCache::Key::address</a></div><div class="ttdeci">Ipv6Address address</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:49</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_acd12e6cbbfe5b5232f3c506ee01b8112a75ab0a402a584e25be2e8190562d5a45"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a75ab0a402a584e25be2e8190562d5a45">inet::Ipv6NeighbourCache::PROBE</a></div><div class="ttdeci">@ PROBE</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:41</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a0a5eeceb530ef5ec54f5116e95b51b83"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a0a5eeceb530ef5ec54f5116e95b51b83">inet::Ipv6NeighbourDiscovery::sendPeriodicRa</a></div><div class="ttdeci">virtual void sendPeriodicRa(cMessage *msg)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1701</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a8d28e59a0d202e69c382d34ad7080937"><div class="ttname"><a href="_i_udp-gates_8txt.html#a8d28e59a0d202e69c382d34ad7080937">InterfaceReq</a></div><div class="ttdeci">removed InterfaceReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:11</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a0323ac93ca7b779d82d9fb23cd4c8681"><div class="ttname"><a href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down DispatchProtocolReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a34a7fa413a34f527bad65710de8f684d"><div class="ttname"><a href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd L3AddressInd</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:20</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a0074c0980ba136204e92b58293c0768b"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a0074c0980ba136204e92b58293c0768b">inet::Ipv6NeighbourDiscovery::createAndSendRsPacket</a></div><div class="ttdeci">virtual void createAndSendRsPacket(NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:947</div></div>
<div class="ttc" id="anamespaceinet_html_a16b0faa236f48c833c525c317934bb28"><div class="ttname"><a href="namespaceinet.html#a16b0faa236f48c833c525c317934bb28">inet::parseCrcMode</a></div><div class="ttdeci">CrcMode parseCrcMode(const char *crcModeString, bool allowDisable)</div><div class="ttdef"><b>Definition:</b> CrcMode.cc:14</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ab5a196dc851cd900c43606a87aa4214a"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ab5a196dc851cd900c43606a87aa4214a">inet::Ipv6NeighbourDiscovery::processNaForOtherNceStates</a></div><div class="ttdeci">virtual void processNaForOtherNceStates(const Ipv6NeighbourAdvertisement *na, Ipv6NeighbourCache::Neighbour *nce)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:2302</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aeed93f574978b74ed1468f72415cb9bc"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aeed93f574978b74ed1468f72415cb9bc">inet::Ipv6NeighbourDiscovery::dadList</a></div><div class="ttdeci">DadList dadList</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:132</div></div>
<div class="ttc" id="anamespaceinet_html_ab1d881229dc633b2857c9e2a25071be9a34d0a70fa50aed20abb4c98cb1fd516b"><div class="ttname"><a href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9a34d0a70fa50aed20abb4c98cb1fd516b">inet::IPv6ND_PREFIX_INFORMATION</a></div><div class="ttdeci">@ IPv6ND_PREFIX_INFORMATION</div><div class="ttdef"><b>Definition:</b> Ipv6NdMessage_m.h:91</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a42f495d6268186cb5616025bbe52901c"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a42f495d6268186cb5616025bbe52901c">inet::Ipv6NeighbourDiscovery::Neighbour</a></div><div class="ttdeci">Ipv6NeighbourCache::Neighbour Neighbour</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:44</div></div>
<div class="ttc" id="anamespaceinet_html_a0d17392bf005b0d3c27fb759dbd23e48"><div class="ttname"><a href="namespaceinet.html#a0d17392bf005b0d3c27fb759dbd23e48">inet::IPv6ND_PREFIX_INFORMATION_OPTION_LENGTH</a></div><div class="ttdeci">const B IPv6ND_PREFIX_INFORMATION_OPTION_LENGTH</div><div class="ttdef"><b>Definition:</b> Ipv6NdMessage_m.h:65</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ada0656767ed0fc44353b64524b681c3e"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ada0656767ed0fc44353b64524b681c3e">inet::Ipv6NeighbourDiscovery::initiateRouterDiscovery</a></div><div class="ttdeci">virtual void initiateRouterDiscovery(cMessage *msg)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:981</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_a3599ccb8ab8108c0d27c47561d6f93e3"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#a3599ccb8ab8108c0d27c47561d6f93e3">MK_AR_TIMEOUT</a></div><div class="ttdeci">#define MK_AR_TIMEOUT</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:35</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_afd36d0627e26925acd433b1dd1fdd2bc"><div class="ttname"><a href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down PacketProtocolTag</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_aa9b1ce87953f709ff8f15a1330360e51"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#aa9b1ce87953f709ff8f15a1330360e51">inet::Ipv6NeighbourCache::remove</a></div><div class="ttdeci">virtual void remove(const Ipv6Address &amp;addr, int interfaceID)</div><div class="ttdoc">Deletes the given neighbour from the cache.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.cc:140</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aba863f826a94e3cda5fe0530674f368c"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aba863f826a94e3cda5fe0530674f368c">inet::Ipv6NeighbourDiscovery::processRedirectPacket</a></div><div class="ttdeci">virtual void processRedirectPacket(const Ipv6Redirect *redirect)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:2422</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a3fbd67788781a9d929cfbbd293be7716"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a3fbd67788781a9d929cfbbd293be7716">inet::Ipv6NeighbourDiscovery::MsgPtrVector</a></div><div class="ttdeci">std::vector&lt; Packet * &gt; MsgPtrVector</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:42</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a41970533db31303c76cd7929c9cbb87c"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a41970533db31303c76cd7929c9cbb87c">inet::Ipv6NeighbourDiscovery::processRaPrefixInfoForAddrAutoConf</a></div><div class="ttdeci">virtual void processRaPrefixInfoForAddrAutoConf(const Ipv6NdPrefixInformation &amp;prefixInfo, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1561</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a80b835d5558b3b3682ceadc046152f22"><div class="ttname"><a href="_i_udp-gates_8txt.html#a80b835d5558b3b3682ceadc046152f22">ctrl</a></div><div class="ttdeci">removed ctrl</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:7</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_a9f894036bf61bbc51aa7a8560db5a30e"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#a9f894036bf61bbc51aa7a8560db5a30e">MK_RD_TIMEOUT</a></div><div class="ttdeci">#define MK_RD_TIMEOUT</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:33</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aed7ee5ee69631757e9439e54a7e7e980"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aed7ee5ee69631757e9439e54a7e7e980">inet::Ipv6NeighbourDiscovery::initiateDad</a></div><div class="ttdeci">virtual void initiateDad(const Ipv6Address &amp;tentativeAddr, NetworkInterface *ie)</div><div class="ttdoc">Initiating DAD means to send off a Neighbour Solicitation with its target address set as this node's ...</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:797</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a49ef5934320202c550ee03b2bea178b0"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a49ef5934320202c550ee03b2bea178b0">inet::Ipv6NeighbourDiscovery::processDadTimeout</a></div><div class="ttdeci">virtual void processDadTimeout(cMessage *msg)</div><div class="ttdoc">Sends a scheduled DAD NS packet.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:838</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_address_html_a591d8b5ba1dcdd5f3357ce0fbba834e8"><div class="ttname"><a href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">inet::Ipv6Address::UNSPECIFIED_ADDRESS</a></div><div class="ttdeci">static const Ipv6Address UNSPECIFIED_ADDRESS</div><div class="ttdoc">The unspecified address.</div><div class="ttdef"><b>Definition:</b> Ipv6Address.h:54</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a68d77f1a5ed7ed3daf4e44d25e7c57d6"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a68d77f1a5ed7ed3daf4e44d25e7c57d6">inet::Ipv6NeighbourDiscovery::sendQueuedPacketsToIpv6Module</a></div><div class="ttdeci">virtual void sendQueuedPacketsToIpv6Module(Neighbour *nce)</div><div class="ttdoc">Send off any queued packets within the Neighbour Discovery module awaiting address resolution.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:753</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a97507d15e79350be76e22ef7596e6ce9">inet::Ipv6NeighbourCache::STALE</a></div><div class="ttdeci">@ STALE</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:41</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a1bd8d8f8fb25e14520eebf1ffd3e8638"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a1bd8d8f8fb25e14520eebf1ffd3e8638">inet::Ipv6NeighbourDiscovery::createRaTimer</a></div><div class="ttdeci">virtual void createRaTimer(NetworkInterface *ie)</div><div class="ttdoc">Create a timer for the given interface entry that sends periodic Router Advertisements.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1636</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a97baf7787238d2dd281d18269006b451"><div class="ttname"><a href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a></div><div class="ttdeci">removed HopLimitReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:11</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a4e0fcf592fe394c5614522491abd845f"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a4e0fcf592fe394c5614522491abd845f">inet::Ipv6NeighbourDiscovery::dropQueuedPacketsAwaitingAr</a></div><div class="ttdeci">virtual void dropQueuedPacketsAwaitingAr(Neighbour *nce)</div><div class="ttdoc">Drops specific queued packets for a specific NCE AR-timeout.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:707</div></div>
<div class="ttc" id="anamespaceinet_html_ac63b650107e16ca12e43cff1e0577fbbab5608159f0aa1ba32c8174774d8884fc"><div class="ttname"><a href="namespaceinet.html#ac63b650107e16ca12e43cff1e0577fbbab5608159f0aa1ba32c8174774d8884fc">inet::ADDRESS_UNREACHABLE</a></div><div class="ttdeci">@ ADDRESS_UNREACHABLE</div><div class="ttdef"><b>Definition:</b> Icmpv6Header_m.h:125</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a3e95b51db717607155679e42a61baa7c"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a3e95b51db717607155679e42a61baa7c">inet::Ipv6NeighbourDiscovery::rdList</a></div><div class="ttdeci">RdList rdList</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:135</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a4e65363ef8f35b77fe9fe29f61c72f2b">inet::Ipv6NeighbourCache::REACHABLE</a></div><div class="ttdeci">@ REACHABLE</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:41</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a909f55a15fe0bdf6de9dd34664b1ab27"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a909f55a15fe0bdf6de9dd34664b1ab27">inet::Ipv6NeighbourDiscovery::validateNsPacket</a></div><div class="ttdeci">virtual bool validateNsPacket(Packet *packet, const Ipv6NeighbourSolicitation *ns)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1876</div></div>
<div class="ttc" id="anamespaceinet_html_a6be747ab6f195055e109f27f8462e52e"><div class="ttname"><a href="namespaceinet.html#a6be747ab6f195055e109f27f8462e52e">inet::INITSTAGE_LOCAL</a></div><div class="ttdeci">INET_API InitStage INITSTAGE_LOCAL</div><div class="ttdoc">Initialization of local state that don't use or affect other modules includes:</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a5c5a1874ba2a53bc3b1f6f12f7960595"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a5c5a1874ba2a53bc3b1f6f12f7960595">inet::Ipv6NeighbourDiscovery::createAndSendNsPacket</a></div><div class="ttdeci">virtual void createAndSendNsPacket(const Ipv6Address &amp;nsTargetAddr, const Ipv6Address &amp;dgDestAddr, const Ipv6Address &amp;dgSrcAddr, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1809</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_add2cbfa1b575aa7726bd123ff16352cb"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#add2cbfa1b575aa7726bd123ff16352cb">inet::Ipv6NeighbourCache::getDefaultRouterList</a></div><div class="ttdeci">DefaultRouterList &amp; getDefaultRouterList()</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:159</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_af705b92b216d89adb9ecd0509c46c322"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#af705b92b216d89adb9ecd0509c46c322">inet::Ipv6NeighbourDiscovery::processNsWithSpecifiedSrcAddr</a></div><div class="ttdeci">virtual void processNsWithSpecifiedSrcAddr(Packet *packet, const Ipv6NeighbourSolicitation *ns, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1963</div></div>
<div class="ttc" id="anamespaceinet_html_ac63b650107e16ca12e43cff1e0577fbba59870ca178baa292ecb6bbdb3af95b9c"><div class="ttname"><a href="namespaceinet.html#ac63b650107e16ca12e43cff1e0577fbba59870ca178baa292ecb6bbdb3af95b9c">inet::NO_ROUTE_TO_DEST</a></div><div class="ttdeci">@ NO_ROUTE_TO_DEST</div><div class="ttdef"><b>Definition:</b> Icmpv6Header_m.h:123</div></div>
<div class="ttc" id="a_init_stage_registry_8h_html_a6dec686281914f336c1b4dcafdbcf9df"><div class="ttname"><a href="_init_stage_registry_8h.html#a6dec686281914f336c1b4dcafdbcf9df">NUM_INIT_STAGES</a></div><div class="ttdeci">#define NUM_INIT_STAGES</div><div class="ttdef"><b>Definition:</b> InitStageRegistry.h:73</div></div>
<div class="ttc" id="astructinet_1_1_ipv6_neighbour_cache_1_1_neighbour_html_a0f81d59d1eb651494c180dfea2723185"><div class="ttname"><a href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html#a0f81d59d1eb651494c180dfea2723185">inet::Ipv6NeighbourCache::Neighbour::isRouter</a></div><div class="ttdeci">bool isRouter</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:63</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_aed4b9313083f229d6a498c6c337f931e"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#aed4b9313083f229d6a498c6c337f931e">MK_ASSIGN_LINKLOCAL_ADDRESS</a></div><div class="ttdeci">#define MK_ASSIGN_LINKLOCAL_ADDRESS</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:28</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_a7e39e0f81ea6de493d3912de3a259544"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#a7e39e0f81ea6de493d3912de3a259544">inet::Ipv6NeighbourCache::lookup</a></div><div class="ttdeci">virtual Neighbour * lookup(const Ipv6Address &amp;addr, int interfaceID)</div><div class="ttdoc">Returns a neighbour entry, or nullptr.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.cc:76</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_acd12e6cbbfe5b5232f3c506ee01b8112a379487af3fd63c982388189ccb914f4b"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#acd12e6cbbfe5b5232f3c506ee01b8112a379487af3fd63c982388189ccb914f4b">inet::Ipv6NeighbourCache::DELAY</a></div><div class="ttdeci">@ DELAY</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:41</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a17981233c1189689062894b35f19cf7a"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a17981233c1189689062894b35f19cf7a">inet::Ipv6NeighbourDiscovery::validateNaPacket</a></div><div class="ttdeci">virtual bool validateNaPacket(Packet *packet, const Ipv6NeighbourAdvertisement *na)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:2215</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_1_1_default_router_list_html_a2651b0bf4cd978f3caaebcac865bb53d"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache_1_1_default_router_list.html#a2651b0bf4cd978f3caaebcac865bb53d">inet::Ipv6NeighbourCache::DefaultRouterList::remove</a></div><div class="ttdeci">void remove(Neighbour &amp;router)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.cc:32</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a5f59bd32ca1ae82ee472c9aaf1250b5f"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a5f59bd32ca1ae82ee472c9aaf1250b5f">inet::Ipv6NeighbourDiscovery::processRaForRouterUpdates</a></div><div class="ttdeci">virtual void processRaForRouterUpdates(Packet *packet, const Ipv6RouterAdvertisement *ra)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1349</div></div>
<div class="ttc" id="aclassinet_1_1_protocol_html_a325be61ec7aa7b45c11ac87f5ac7258a"><div class="ttname"><a href="classinet_1_1_protocol.html#a325be61ec7aa7b45c11ac87f5ac7258a">inet::Protocol::icmpv6</a></div><div class="ttdeci">static const Protocol icmpv6</div><div class="ttdef"><b>Definition:</b> Protocol.h:72</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ae56cb9501320961fdbecaa7091196f4e"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ae56cb9501320961fdbecaa7091196f4e">inet::Ipv6NeighbourDiscovery::pendingQueue</a></div><div class="ttdeci">cQueue pendingQueue</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:87</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a69f8917e02b416330fd8fc446f548735"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a69f8917e02b416330fd8fc446f548735">inet::Ipv6NeighbourDiscovery::createAndSendRaPacket</a></div><div class="ttdeci">virtual void createAndSendRaPacket(const Ipv6Address &amp;destAddr, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1175</div></div>
<div class="ttc" id="aclassinet_1_1_node_status_html_a3623ef63233aec9ad2838030e3ce5bd3ab88e3292de0cb8bfb808d31864d404bc"><div class="ttname"><a href="classinet_1_1_node_status.html#a3623ef63233aec9ad2838030e3ce5bd3ab88e3292de0cb8bfb808d31864d404bc">inet::NodeStatus::UP</a></div><div class="ttdeci">@ UP</div><div class="ttdef"><b>Definition:</b> NodeStatus.h:28</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a1f72c7b83a0bc8a33a2ddbcb31f4754d"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a1f72c7b83a0bc8a33a2ddbcb31f4754d">inet::Ipv6NeighbourDiscovery::processNaPacket</a></div><div class="ttdeci">virtual void processNaPacket(Packet *packet, const Ipv6NeighbourAdvertisement *na)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:2179</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a96e74cfc876460fc5a5b9c452f6f1cb1"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a96e74cfc876460fc5a5b9c452f6f1cb1">inet::Ipv6NeighbourDiscovery::crcMode</a></div><div class="ttdeci">CrcMode crcMode</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:92</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ac781673fa35d079fc0569013a1543b72"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ac781673fa35d079fc0569013a1543b72">inet::Ipv6NeighbourDiscovery::fetchRdEntry</a></div><div class="ttdeci">virtual Ipv6NeighbourDiscovery::RdEntry * fetchRdEntry(NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:314</div></div>
<div class="ttc" id="a_self_doc_8h_html_a8e54030c665b5254da268db865fccdfc"><div class="ttname"><a href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a></div><div class="ttdeci">#define Enter_Method(...)</div><div class="ttdef"><b>Definition:</b> SelfDoc.h:71</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a69afa04d7f16597917a932346cd2dff7"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a69afa04d7f16597917a932346cd2dff7">inet::Ipv6NeighbourDiscovery::fetchAdvIfEntry</a></div><div class="ttdeci">virtual Ipv6NeighbourDiscovery::AdvIfEntry * fetchAdvIfEntry(NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:304</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_cache_html_a4a1b1cc46ca0c07a7e1dbb9607d0fd46"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_cache.html#a4a1b1cc46ca0c07a7e1dbb9607d0fd46">inet::Ipv6NeighbourCache::addNeighbour</a></div><div class="ttdeci">virtual Neighbour * addNeighbour(const Ipv6Address &amp;addr, int interfaceID)</div><div class="ttdoc">Creates and initializes a neighbour entry with isRouter=false, state=INCOMPLETE.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.cc:89</div></div>
<div class="ttc" id="anamespaceinet_html_ab1d881229dc633b2857c9e2a25071be9adcab7d32c5717f65801555fe062eb972"><div class="ttname"><a href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9adcab7d32c5717f65801555fe062eb972">inet::IPv6ND_TARGET_LINK_LAYER_ADDR_OPTION</a></div><div class="ttdeci">@ IPv6ND_TARGET_LINK_LAYER_ADDR_OPTION</div><div class="ttdef"><b>Definition:</b> Ipv6NdMessage_m.h:90</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_a810fd09c143fca097e7f2569c9f9b89c"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#a810fd09c143fca097e7f2569c9f9b89c">MK_SEND_PERIODIC_RTRADV</a></div><div class="ttdeci">#define MK_SEND_PERIODIC_RTRADV</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:29</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a4f9a227416f64d7dd9c80182a0d9c07f"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a4f9a227416f64d7dd9c80182a0d9c07f">inet::Ipv6NeighbourDiscovery::processNsForTentativeAddress</a></div><div class="ttdeci">virtual void processNsForTentativeAddress(Packet *packet, const Ipv6NeighbourSolicitation *ns)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1920</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_af725a09fc820f4212c28e9a057e3f1eb"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#af725a09fc820f4212c28e9a057e3f1eb">inet::Ipv6NeighbourDiscovery::cancelRouterDiscovery</a></div><div class="ttdeci">virtual void cancelRouterDiscovery(NetworkInterface *ie)</div><div class="ttdoc">RFC 2461: Section 6.3.7 4th paragraph Once the host sends a Router Solicitation, and receives a valid...</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1016</div></div>
<div class="ttc" id="aclassinet_1_1_mac_address_html_a2bb1ac82ec10339520faa1a738881ec1"><div class="ttname"><a href="classinet_1_1_mac_address.html#a2bb1ac82ec10339520faa1a738881ec1">inet::MacAddress::UNSPECIFIED_ADDRESS</a></div><div class="ttdeci">static const MacAddress UNSPECIFIED_ADDRESS</div><div class="ttdoc">The unspecified MAC address, 00:00:00:00:00:00.</div><div class="ttdef"><b>Definition:</b> MacAddress.h:31</div></div>
<div class="ttc" id="a_ipv6_interface_data_8h_html_a062efe990ca0b6b9de4742526b251a73"><div class="ttname"><a href="_ipv6_interface_data_8h.html#a062efe990ca0b6b9de4742526b251a73">IPv6_MAX_RTR_SOLICITATION_DELAY</a></div><div class="ttdeci">#define IPv6_MAX_RTR_SOLICITATION_DELAY</div><div class="ttdef"><b>Definition:</b> Ipv6InterfaceData.h:48</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ae66149131978353b4c56809f18035cfa"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ae66149131978353b4c56809f18035cfa">inet::Ipv6NeighbourDiscovery::sendSolicitedRa</a></div><div class="ttdeci">virtual void sendSolicitedRa(cMessage *msg)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1748</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ac49804b7936addaf44c498b28c2757fa"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ac49804b7936addaf44c498b28c2757fa">inet::Ipv6NeighbourDiscovery::makeTentativeAddressPermanent</a></div><div class="ttdeci">virtual void makeTentativeAddressPermanent(const Ipv6Address &amp;tentativeAddr, NetworkInterface *ie)</div><div class="ttdoc">Permanently assign the given address for the given interface entry.</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:867</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_aadba1232289c7af8c42ae503b367f409"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#aadba1232289c7af8c42ae503b367f409">MK_INITIATE_RTRDIS</a></div><div class="ttdeci">#define MK_INITIATE_RTRDIS</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:31</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aae17f560536bd339bfccddc2623a9a60"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aae17f560536bd339bfccddc2623a9a60">inet::Ipv6NeighbourDiscovery::processIpv6Datagram</a></div><div class="ttdeci">virtual void processIpv6Datagram(Packet *packet)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:215</div></div>
<div class="ttc" id="anamespaceinet_html_a9ad30be62e792f35add531d609e18d1f"><div class="ttname"><a href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">inet::uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> INETDefs.h:55</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a4ae11d641202039eb04a11cf497508cc"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a4ae11d641202039eb04a11cf497508cc">inet::Ipv6NeighbourDiscovery::processNDMessage</a></div><div class="ttdeci">virtual void processNDMessage(Packet *packet, const Icmpv6Header *msg)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:189</div></div>
<div class="ttc" id="a_ipv6_neighbour_discovery_8cc_html_ab76c2fe672ed307b0a91f9efa35a7548"><div class="ttname"><a href="_ipv6_neighbour_discovery_8cc.html#ab76c2fe672ed307b0a91f9efa35a7548">MK_SEND_SOL_RTRADV</a></div><div class="ttdeci">#define MK_SEND_SOL_RTRADV</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:30</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aa5e577327ead9f3ba0c9165c6086f94b"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aa5e577327ead9f3ba0c9165c6086f94b">inet::Ipv6NeighbourDiscovery::validateRsPacket</a></div><div class="ttdeci">virtual bool validateRsPacket(Packet *packet, const Ipv6RouterSolicitation *rs)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1139</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a7c68a3688014e46919973b9658f76ad8"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a7c68a3688014e46919973b9658f76ad8">inet::Ipv6NeighbourDiscovery::raTimerList</a></div><div class="ttdeci">RaTimerList raTimerList</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:129</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_address_html_a4a43ce20198471fc2a112d89ed64542b"><div class="ttname"><a href="classinet_1_1_ipv6_address.html#a4a43ce20198471fc2a112d89ed64542b">inet::Ipv6Address::SOLICITED_NODE_PREFIX</a></div><div class="ttdeci">static const Ipv6Address SOLICITED_NODE_PREFIX</div><div class="ttdoc">The solicited-node multicast address prefix (prefix length = 104)</div><div class="ttdef"><b>Definition:</b> Ipv6Address.h:75</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_ac9f4663f98d7ead079225599d98ff0e9"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#ac9f4663f98d7ead079225599d98ff0e9">inet::Ipv6NeighbourDiscovery::processNsForNonTentativeAddress</a></div><div class="ttdeci">virtual void processNsForNonTentativeAddress(Packet *packet, const Ipv6NeighbourSolicitation *ns, NetworkInterface *ie)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1947</div></div>
<div class="ttc" id="anamespaceinet_html_a38ad526702853fea4e883830f4279782ad2fe6e5a03c33df578a94e98d1258a0b"><div class="ttname"><a href="namespaceinet.html#a38ad526702853fea4e883830f4279782ad2fe6e5a03c33df578a94e98d1258a0b">inet::ICMPv6_DESTINATION_UNREACHABLE</a></div><div class="ttdeci">@ ICMPv6_DESTINATION_UNREACHABLE</div><div class="ttdef"><b>Definition:</b> Icmpv6Header_m.h:85</div></div>
<div class="ttc" id="anamespaceinet_html_a94d913e59c662fec2a321c6507315bad"><div class="ttname"><a href="namespaceinet.html#a94d913e59c662fec2a321c6507315bad">inet::INITSTAGE_NETWORK_LAYER_PROTOCOLS</a></div><div class="ttdeci">INET_API InitStage INITSTAGE_NETWORK_LAYER_PROTOCOLS</div><div class="ttdoc">Initialization of network layer protocols over IP.</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a6545a821734516cb41b46ea3018768e6"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a6545a821734516cb41b46ea3018768e6">inet::Ipv6NeighbourDiscovery::processRsPacket</a></div><div class="ttdeci">virtual void processRsPacket(Packet *packet, const Ipv6RouterSolicitation *rs)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:1062</div></div>
<div class="ttc" id="astructinet_1_1_ipv6_neighbour_cache_1_1_neighbour_html_ace7ac50e663437f499cc2ed2d86000fc"><div class="ttname"><a href="structinet_1_1_ipv6_neighbour_cache_1_1_neighbour.html#ace7ac50e663437f499cc2ed2d86000fc">inet::Ipv6NeighbourCache::Neighbour::macAddress</a></div><div class="ttdeci">MacAddress macAddress</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourCache.h:62</div></div>
<div class="ttc" id="anamespaceinet_1_1units_1_1units_html_a50b8f55044d201f3d156e080566431dc"><div class="ttname"><a href="namespaceinet_1_1units_1_1units.html#a50b8f55044d201f3d156e080566431dc">inet::units::units::ns</a></div><div class="ttdeci">nano&lt; s &gt;::type ns</div><div class="ttdef"><b>Definition:</b> Units.h:1074</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a8ac7db21bc55a5ea3575d4298a34238d"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a8ac7db21bc55a5ea3575d4298a34238d">inet::Ipv6NeighbourDiscovery::processNaForIncompleteNceState</a></div><div class="ttdeci">virtual void processNaForIncompleteNceState(const Ipv6NeighbourAdvertisement *na, Ipv6NeighbourCache::Neighbour *nce)</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.cc:2253</div></div>
<div class="ttc" id="anamespaceinet_html_ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf"><div class="ttname"><a href="namespaceinet.html#ab1d881229dc633b2857c9e2a25071be9aba09004f46d82ebd7bd9c396bdb0e7bf">inet::IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</a></div><div class="ttdeci">@ IPv6ND_SOURCE_LINK_LAYER_ADDR_OPTION</div><div class="ttdef"><b>Definition:</b> Ipv6NdMessage_m.h:89</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_a8e12213fbe33b3cb3a838d9148a5d843"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#a8e12213fbe33b3cb3a838d9148a5d843">inet::Ipv6NeighbourDiscovery::ift</a></div><div class="ttdeci">ModuleRefByPar&lt; IInterfaceTable &gt; ift</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:89</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_neighbour_discovery_html_aa4e41e16cf0b9351675924c57b1e92e6"><div class="ttname"><a href="classinet_1_1_ipv6_neighbour_discovery.html#aa4e41e16cf0b9351675924c57b1e92e6">inet::Ipv6NeighbourDiscovery::neighbourCache</a></div><div class="ttdeci">Ipv6NeighbourCache neighbourCache</div><div class="ttdef"><b>Definition:</b> Ipv6NeighbourDiscovery.h:98</div></div>
<div class="ttc" id="anamespaceinet_html_a06e5a464a4fc1eb79ca999d8df5a85fb"><div class="ttname"><a href="namespaceinet.html#a06e5a464a4fc1eb79ca999d8df5a85fb">inet::IPv6ND_MTU_OPTION_LENGTH</a></div><div class="ttdeci">const B IPv6ND_MTU_OPTION_LENGTH</div><div class="ttdef"><b>Definition:</b> Ipv6NdMessage_m.h:68</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceinet.html">inet</a></li><li class="navelem"><a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html">Ipv6NeighbourDiscovery</a></li>
    <li class="footer">Generated on Sun Apr 10 2022 21:00:22 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
