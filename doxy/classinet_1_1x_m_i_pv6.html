<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>INET Framework for OMNeT++/OMNEST: inet::xMIPv6 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="opp.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classinet_1_1x_m_i_pv6.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classinet_1_1x_m_i_pv6-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inet::xMIPv6 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements RFC 3775 Mobility Support in <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a>.  
 <a href="classinet_1_1x_m_i_pv6.html#details">More...</a></p>

<p><code>#include &lt;xMIPv6.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for inet::xMIPv6:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classinet_1_1x_m_i_pv6.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_bc_expiry_if_entry.html">BcExpiryIfEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_br_transmit_if_entry.html">BrTransmitIfEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_bul_expiry_if_entry.html">BulExpiryIfEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_bu_transmit_if_entry.html">BuTransmitIfEntry</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subclasses for the different timers.  <a href="classinet_1_1x_m_i_pv6_1_1_bu_transmit_if_entry.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinet_1_1x_m_i_pv6_1_1_key.html">Key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_test_init_transmit_if_entry.html">TestInitTransmitIfEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">TimerIfEntry</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The base class for all other timers that are used for retransmissions.  <a href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_token_expiry_if_entry.html">TokenExpiryIfEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac7c070267c8193527338a81f65288785"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ac7c070267c8193527338a81f65288785">~xMIPv6</a> ()</td></tr>
<tr class="memdesc:ac7c070267c8193527338a81f65288785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructur.  <a href="classinet_1_1x_m_i_pv6.html#ac7c070267c8193527338a81f65288785">More...</a><br /></td></tr>
<tr class="separator:ac7c070267c8193527338a81f65288785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ba3092ea3088e56f1fd80e2e5ddb038"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">initiateMipv6Protocol</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;CoA)</td></tr>
<tr class="memdesc:a7ba3092ea3088e56f1fd80e2e5ddb038"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates the Mobile IP protocol.  <a href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">More...</a><br /></td></tr>
<tr class="separator:a7ba3092ea3088e56f1fd80e2e5ddb038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ca9874936a1263019aa7b73a0573fb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;CoA, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:a8ca9874936a1263019aa7b73a0573fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method destroys all tunnels associated to the previous CoA and sends appropriate BU(s) to HA and CN(s).  <a href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">More...</a><br /></td></tr>
<tr class="separator:a8ca9874936a1263019aa7b73a0573fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adedabec47eb42340c1565ffc735b7798"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;destAddress, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;HoA, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:adedabec47eb42340c1565ffc735b7798"><td class="mdescLeft">&#160;</td><td class="mdescRight">The following method is used for triggering RO to a CN.  <a href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">More...</a><br /></td></tr>
<tr class="separator:adedabec47eb42340c1565ffc735b7798"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:a236f56f8cf9b803915087a0f520c7ac0"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="structinet_1_1x_m_i_pv6_1_1_key.html">Key</a>, <a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">TimerIfEntry</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a236f56f8cf9b803915087a0f520c7ac0">TransmitIfList</a></td></tr>
<tr class="separator:a236f56f8cf9b803915087a0f520c7ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61385548df7ee06f171c75775c271463"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; int, <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a61385548df7ee06f171c75775c271463">InterfaceCoAList</a></td></tr>
<tr class="memdesc:a61385548df7ee06f171c75775c271463"><td class="mdescLeft">&#160;</td><td class="mdescRight">holds the tuples of currently available {InterfaceID, CoA} pairs  <a href="classinet_1_1x_m_i_pv6.html#a61385548df7ee06f171c75775c271463">More...</a><br /></td></tr>
<tr class="separator:a61385548df7ee06f171c75775c271463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e82206fc313109ceab061cb035c3b42"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4e82206fc313109ceab061cb035c3b42">CnList</a></td></tr>
<tr class="separator:a4e82206fc313109ceab061cb035c3b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a05e33263c7c32c6f63518dd0f584d598"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a05e33263c7c32c6f63518dd0f584d598">numInitStages</a> () const override</td></tr>
<tr class="separator:a05e33263c7c32c6f63518dd0f584d598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb2922fe72da5551377c29bdc8264df"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize</a> (int stage) override</td></tr>
<tr class="separator:a0cb2922fe72da5551377c29bdc8264df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11cc72f90b08c18df3fdcedcc34cdc79"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage</a> (cMessage *msg) override</td></tr>
<tr class="separator:a11cc72f90b08c18df3fdcedcc34cdc79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d36c6a58a53a1b6ff97c90033c4ee49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket)</td></tr>
<tr class="memdesc:a4d36c6a58a53a1b6ff97c90033c4ee49"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is where all the mobility messages are sifted through and sent to appropriate functions for processing.  <a href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">More...</a><br /></td></tr>
<tr class="separator:a4d36c6a58a53a1b6ff97c90033c4ee49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d097cc1f15ca8f7e7dde3bf99f2948"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;buDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime, bool homeRegistration)</td></tr>
<tr class="memdesc:a07d097cc1f15ca8f7e7dde3bf99f2948"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method finally creates the timer structure and schedules the message for sending.  <a href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">More...</a><br /></td></tr>
<tr class="separator:a07d097cc1f15ca8f7e7dde3bf99f2948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66274da883fc2d9895e11caf712f5ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ae66274da883fc2d9895e11caf712f5ad">createDeregisterBUTimer</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;buDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:ae66274da883fc2d9895e11caf712f5ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similiar to the previous one, this method creates an BU timer with registration lifetime equal to 0.  <a href="classinet_1_1x_m_i_pv6.html#ae66274da883fc2d9895e11caf712f5ad">More...</a><br /></td></tr>
<tr class="separator:ae66274da883fc2d9895e11caf712f5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e6b3c651470bc1b377bcd5ccb04f27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a58e6b3c651470bc1b377bcd5ccb04f27">createBUTimer</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;buDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="separator:a58e6b3c651470bc1b377bcd5ccb04f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41dfe546eaa52dd2544407b80b044bec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a41dfe546eaa52dd2544407b80b044bec">sendPeriodicBU</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a41dfe546eaa52dd2544407b80b044bec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is called when the timer created in <a class="el" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948" title="This method finally creates the timer structure and schedules the message for sending.">createBUTimer()</a> has fired.  <a href="classinet_1_1x_m_i_pv6.html#a41dfe546eaa52dd2544407b80b044bec">More...</a><br /></td></tr>
<tr class="separator:a41dfe546eaa52dd2544407b80b044bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ab006c4ae9e1f254c9ad8ac45bcc71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">createAndSendBUMessage</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> buSeq, const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime, const int bindAuthData=0)</td></tr>
<tr class="memdesc:a50ab006c4ae9e1f254c9ad8ac45bcc71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method for creating and sending a BU by a MN.  <a href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">More...</a><br /></td></tr>
<tr class="separator:a50ab006c4ae9e1f254c9ad8ac45bcc71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654465e95bd0340136b7d9b4aa2b3b83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a654465e95bd0340136b7d9b4aa2b3b83">updateBUL</a> (<a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> *bu, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;CoA, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, const simtime_t sendTime)</td></tr>
<tr class="memdesc:a654465e95bd0340136b7d9b4aa2b3b83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the an entry of the BUL with the provided parameters.  <a href="classinet_1_1x_m_i_pv6.html#a654465e95bd0340136b7d9b4aa2b3b83">More...</a><br /></td></tr>
<tr class="separator:a654465e95bd0340136b7d9b4aa2b3b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7236c0fa0b79504eb59ac9d6281912c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_bu_transmit_if_entry.html">xMIPv6::BuTransmitIfEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ad7236c0fa0b79504eb59ac9d6281912c">fetchBUTransmitIfEntry</a> (<a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest)</td></tr>
<tr class="memdesc:ad7236c0fa0b79504eb59ac9d6281912c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method takes an interface and a destination address and returns the appropriate IfEntry for an BU.  <a href="classinet_1_1x_m_i_pv6.html#ad7236c0fa0b79504eb59ac9d6281912c">More...</a><br /></td></tr>
<tr class="separator:ad7236c0fa0b79504eb59ac9d6281912c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b551126d211603e24e951bd355923ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *msg, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;destAddr, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;srcAddr=<a class="el" href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">Ipv6Address::UNSPECIFIED_ADDRESS</a>, int interfaceId=-1, simtime_t sendTime=0)</td></tr>
<tr class="memdesc:a6b551126d211603e24e951bd355923ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append tags to the Mobility Messages (BU, BA etc) and send it out to the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> Module.  <a href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">More...</a><br /></td></tr>
<tr class="separator:a6b551126d211603e24e951bd355923ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c9e54de243910406aafc3553f6b9247"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> &gt; &amp;bu)</td></tr>
<tr class="memdesc:a4c9e54de243910406aafc3553f6b9247"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a BU - only applicable to HAs and CNs.  <a href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">More...</a><br /></td></tr>
<tr class="separator:a4c9e54de243910406aafc3553f6b9247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7952971db44389a9ec5fda211ea611"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611">validateBUMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> &gt; &amp;bu)</td></tr>
<tr class="memdesc:a4f7952971db44389a9ec5fda211ea611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a BU - only applicable to HAs and CNs.  <a href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611">More...</a><br /></td></tr>
<tr class="separator:a4f7952971db44389a9ec5fda211ea611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea27a7d716da8d2643cc08569b305e7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a1ea27a7d716da8d2643cc08569b305e7">validateBUderegisterMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> &gt; &amp;bu)</td></tr>
<tr class="memdesc:a1ea27a7d716da8d2643cc08569b305e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similiar to <a class="el" href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611" title="Validate a BU - only applicable to HAs and CNs.">validateBUMessage()</a>.  <a href="classinet_1_1x_m_i_pv6.html#a1ea27a7d716da8d2643cc08569b305e7">More...</a><br /></td></tr>
<tr class="separator:a1ea27a7d716da8d2643cc08569b305e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93efecffc166a0fab45479baa0604140"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;src, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, int interfaceId, const <a class="el" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996f">BaStatus</a> &amp;baStatus, const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> baSeq, const int bindingAuthorizationData, const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime, simtime_t sendTime=0)</td></tr>
<tr class="memdesc:a93efecffc166a0fab45479baa0604140"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs and send a BA to the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module.  <a href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">More...</a><br /></td></tr>
<tr class="separator:a93efecffc166a0fab45479baa0604140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee11505f04fbd42fba6714da2c4a7c4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_binding_acknowledgement.html">BindingAcknowledgement</a> &gt; &amp;ba)</td></tr>
<tr class="memdesc:aee11505f04fbd42fba6714da2c4a7c4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the received BA and creates tunnels or mobility header paths if appropriate.  <a href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">More...</a><br /></td></tr>
<tr class="separator:aee11505f04fbd42fba6714da2c4a7c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ea0a5a74761087a91035347e406773e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4ea0a5a74761087a91035347e406773e">validateBAck</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const <a class="el" href="classinet_1_1_binding_acknowledgement.html">BindingAcknowledgement</a> &amp;ba)</td></tr>
<tr class="memdesc:a4ea0a5a74761087a91035347e406773e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates a Binding Acknowledgement for a mobile node.  <a href="classinet_1_1x_m_i_pv6.html#a4ea0a5a74761087a91035347e406773e">More...</a><br /></td></tr>
<tr class="separator:a4ea0a5a74761087a91035347e406773e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80789234568c887c26c1c95cb51884f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aa80789234568c887c26c1c95cb51884f">createAndSendBEMessage</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, const <a class="el" href="namespaceinet.html#a0836489f866ddd35438d3bfe59438d4b">BeStatus</a> &amp;beStatus)</td></tr>
<tr class="memdesc:aa80789234568c887c26c1c95cb51884f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and sends Binding Error message.  <a href="classinet_1_1x_m_i_pv6.html#aa80789234568c887c26c1c95cb51884f">More...</a><br /></td></tr>
<tr class="separator:aa80789234568c887c26c1c95cb51884f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef82a8cb41eadd8263f9a1878a1b07c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;cnDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:afef82a8cb41eadd8263f9a1878a1b07c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates HoTI and CoTI messages and sends them to the CN if timers are not already existing.  <a href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">More...</a><br /></td></tr>
<tr class="separator:afef82a8cb41eadd8263f9a1878a1b07c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8846ee7ce22eeab2e24cd4f659634b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aa8846ee7ce22eeab2e24cd4f659634b7">createTestInitTimer</a> (const Ptr&lt; <a class="el" href="classinet_1_1_mobility_header.html">MobilityHeader</a> &gt; testInit, const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, simtime_t sendTime=0)</td></tr>
<tr class="memdesc:aa8846ee7ce22eeab2e24cd4f659634b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and schedules a timer for either a HoTI or a CoTI transmission.  <a href="classinet_1_1x_m_i_pv6.html#aa8846ee7ce22eeab2e24cd4f659634b7">More...</a><br /></td></tr>
<tr class="separator:aa8846ee7ce22eeab2e24cd4f659634b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259fe47417bf0168de80810b5137ca5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a259fe47417bf0168de80810b5137ca5c">sendTestInit</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a259fe47417bf0168de80810b5137ca5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">If a TestInit timer was fired, this method gets called.  <a href="classinet_1_1x_m_i_pv6.html#a259fe47417bf0168de80810b5137ca5c">More...</a><br /></td></tr>
<tr class="separator:a259fe47417bf0168de80810b5137ca5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413465c28f01387fe2f85f631d94fb1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a413465c28f01387fe2f85f631d94fb1f">resetBUIfEntry</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, int interfaceID, simtime_t retransmissionTime)</td></tr>
<tr class="memdesc:a413465c28f01387fe2f85f631d94fb1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels the current existing timer and reschedules it with initial values.  <a href="classinet_1_1x_m_i_pv6.html#a413465c28f01387fe2f85f631d94fb1f">More...</a><br /></td></tr>
<tr class="separator:a413465c28f01387fe2f85f631d94fb1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae250d75eb29b33e82c73d1b85cd184bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">createAndSendHoTIMessage</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;cnDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:ae250d75eb29b33e82c73d1b85cd184bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and sends a HoTI message to the specified destination.  <a href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">More...</a><br /></td></tr>
<tr class="separator:ae250d75eb29b33e82c73d1b85cd184bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08bef6eef2ae0e4b244148e8fa77f8b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">createAndSendCoTIMessage</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;cnDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:a08bef6eef2ae0e4b244148e8fa77f8b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and sends a CoTI message to the specified destination.  <a href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">More...</a><br /></td></tr>
<tr class="separator:a08bef6eef2ae0e4b244148e8fa77f8b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9464cca6b8db5cf370994bd4b37af21e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a9464cca6b8db5cf370994bd4b37af21e">processHoTIMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_home_test_init.html">HomeTestInit</a> &gt; &amp;HoTI)</td></tr>
<tr class="memdesc:a9464cca6b8db5cf370994bd4b37af21e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and send a HoT message.  <a href="classinet_1_1x_m_i_pv6.html#a9464cca6b8db5cf370994bd4b37af21e">More...</a><br /></td></tr>
<tr class="separator:a9464cca6b8db5cf370994bd4b37af21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d5963d559ada7fdf5e8f78deb3d110"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a51d5963d559ada7fdf5e8f78deb3d110">processCoTIMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_care_of_test_init.html">CareOfTestInit</a> &gt; &amp;CoTI)</td></tr>
<tr class="memdesc:a51d5963d559ada7fdf5e8f78deb3d110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and send a CoT message.  <a href="classinet_1_1x_m_i_pv6.html#a51d5963d559ada7fdf5e8f78deb3d110">More...</a><br /></td></tr>
<tr class="separator:a51d5963d559ada7fdf5e8f78deb3d110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa863e1b42062b5a06cc69af0f4af25d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_home_test.html">HomeTest</a> &gt; &amp;HoT)</td></tr>
<tr class="memdesc:aa863e1b42062b5a06cc69af0f4af25d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">First verifies a received HoT message and sends a BU to the CN if the care-of keygen token is available as well.  <a href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">More...</a><br /></td></tr>
<tr class="separator:aa863e1b42062b5a06cc69af0f4af25d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50116ffe3505669219e721a31040529a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a">validateHoTMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const <a class="el" href="classinet_1_1_home_test.html">HomeTest</a> &amp;HoT)</td></tr>
<tr class="memdesc:a50116ffe3505669219e721a31040529a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies a HoT according to the RFC, Section 11.6.2.  <a href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a">More...</a><br /></td></tr>
<tr class="separator:a50116ffe3505669219e721a31040529a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b830605dd4ddf75f737d66200bd7f21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_care_of_test.html">CareOfTest</a> &gt; &amp;CoT)</td></tr>
<tr class="memdesc:a9b830605dd4ddf75f737d66200bd7f21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Like <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4" title="First verifies a received HoT message and sends a BU to the CN if the care-of keygen token is availab...">processHoTMessage()</a>, but related to CoT.  <a href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">More...</a><br /></td></tr>
<tr class="separator:a9b830605dd4ddf75f737d66200bd7f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af014acd28edfaa0506809d36c1723385"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#af014acd28edfaa0506809d36c1723385">validateCoTMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const <a class="el" href="classinet_1_1_care_of_test.html">CareOfTest</a> &amp;CoT)</td></tr>
<tr class="memdesc:af014acd28edfaa0506809d36c1723385"><td class="mdescLeft">&#160;</td><td class="mdescRight">Like <a class="el" href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a" title="Verifies a HoT according to the RFC, Section 11.6.2.">validateHoTMessage()</a>, but related to CoT.  <a href="classinet_1_1x_m_i_pv6.html#af014acd28edfaa0506809d36c1723385">More...</a><br /></td></tr>
<tr class="separator:af014acd28edfaa0506809d36c1723385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa35090fe5ce065706e4c1449c12ae75f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN</a> (<a class="el" href="classinet_1_1_binding_update_list_1_1_binding_update_list_entry.html">BindingUpdateList::BindingUpdateListEntry</a> &amp;bulEntry, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:aa35090fe5ce065706e4c1449c12ae75f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a BU depending on current status of:  <a href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">More...</a><br /></td></tr>
<tr class="separator:aa35090fe5ce065706e4c1449c12ae75f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ea8a29978d35fe97e223faf86f042d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">sendBUtoCN</a> (<a class="el" href="classinet_1_1_binding_update_list_1_1_binding_update_list_entry.html">BindingUpdateList::BindingUpdateListEntry</a> &amp;bulEntry, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:aa3ea8a29978d35fe97e223faf86f042d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a timer for sending a BU.  <a href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">More...</a><br /></td></tr>
<tr class="separator:aa3ea8a29978d35fe97e223faf86f042d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74c931b057a65aac096b01ddfdf28450"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a74c931b057a65aac096b01ddfdf28450">processType2RH</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, <a class="el" href="classinet_1_1_ipv6_routing_header.html">Ipv6RoutingHeader</a> *rh)</td></tr>
<tr class="memdesc:a74c931b057a65aac096b01ddfdf28450"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the Type 2 Routing Header which belongs to the provided datagram.  <a href="classinet_1_1x_m_i_pv6.html#a74c931b057a65aac096b01ddfdf28450">More...</a><br /></td></tr>
<tr class="separator:a74c931b057a65aac096b01ddfdf28450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e839823650092fa089ab28fce4528a2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a1e839823650092fa089ab28fce4528a2">validateType2RH</a> (const <a class="el" href="classinet_1_1_ipv6_header.html">Ipv6Header</a> &amp;ipv6Header, const <a class="el" href="classinet_1_1_ipv6_routing_header.html">Ipv6RoutingHeader</a> &amp;rh)</td></tr>
<tr class="memdesc:a1e839823650092fa089ab28fce4528a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform validity checks according to RFC 3775 - Section 6.4.  <a href="classinet_1_1x_m_i_pv6.html#a1e839823650092fa089ab28fce4528a2">More...</a><br /></td></tr>
<tr class="separator:a1e839823650092fa089ab28fce4528a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c68a093ad4a7f05896c4393d23c5fe0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a3c68a093ad4a7f05896c4393d23c5fe0">processHoAOpt</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *packet, <a class="el" href="classinet_1_1_home_address_option.html">HomeAddressOption</a> *hoaOpt)</td></tr>
<tr class="memdesc:a3c68a093ad4a7f05896c4393d23c5fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the Home Address Option which belongs to the provided datagram.  <a href="classinet_1_1x_m_i_pv6.html#a3c68a093ad4a7f05896c4393d23c5fe0">More...</a><br /></td></tr>
<tr class="separator:a3c68a093ad4a7f05896c4393d23c5fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a569259d4846043449f7e9448dd5f5851"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a569259d4846043449f7e9448dd5f5851">createBRRTimer</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;brDest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> scheduledTime)</td></tr>
<tr class="memdesc:a569259d4846043449f7e9448dd5f5851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a timer for a Binding Refresh <a class="el" href="classinet_1_1_request.html">Request</a> message that is going to be fired in scheduledTime seconds.  <a href="classinet_1_1x_m_i_pv6.html#a569259d4846043449f7e9448dd5f5851">More...</a><br /></td></tr>
<tr class="separator:a569259d4846043449f7e9448dd5f5851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a746a045b4475430db6fb1ebcb7b7898b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a746a045b4475430db6fb1ebcb7b7898b">sendPeriodicBRR</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a746a045b4475430db6fb1ebcb7b7898b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles a fired BRR message transmission structure.  <a href="classinet_1_1x_m_i_pv6.html#a746a045b4475430db6fb1ebcb7b7898b">More...</a><br /></td></tr>
<tr class="separator:a746a045b4475430db6fb1ebcb7b7898b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8e171a71e44592936df60b6214ae5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a8e8e171a71e44592936df60b6214ae5a">createAndSendBRRMessage</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie)</td></tr>
<tr class="memdesc:a8e8e171a71e44592936df60b6214ae5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a Binding Refresh <a class="el" href="classinet_1_1_request.html">Request</a> and sends it to the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module.  <a href="classinet_1_1x_m_i_pv6.html#a8e8e171a71e44592936df60b6214ae5a">More...</a><br /></td></tr>
<tr class="separator:a8e8e171a71e44592936df60b6214ae5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30be4668a9f7a72be0723ea9052711b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">processBRRMessage</a> (<a class="el" href="classinet_1_1_packet.html">Packet</a> *inPacket, const Ptr&lt; const <a class="el" href="classinet_1_1_binding_refresh_request.html">BindingRefreshRequest</a> &gt; &amp;brr)</td></tr>
<tr class="memdesc:a30be4668a9f7a72be0723ea9052711b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the Binding Refresh <a class="el" href="classinet_1_1_message.html">Message</a>.  <a href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">More...</a><br /></td></tr>
<tr class="separator:a30be4668a9f7a72be0723ea9052711b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1aa90c3bed562838eb25ef6fee982f9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, int interfaceID, int msgType)</td></tr>
<tr class="memdesc:ac1aa90c3bed562838eb25ef6fee982f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes the appropriate entry from the transmitIfList and cancels the corresponding retransmission timer.  <a href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">More...</a><br /></td></tr>
<tr class="separator:ac1aa90c3bed562838eb25ef6fee982f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b83360b05ab5929bcb83d008b29a959"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a8b83360b05ab5929bcb83d008b29a959">pendingTimerIfEntry</a> (<a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, int interfaceID, int msgType)</td></tr>
<tr class="memdesc:a8b83360b05ab5929bcb83d008b29a959"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether there exists an TransmitIfEntry for the specified values.  <a href="classinet_1_1x_m_i_pv6.html#a8b83360b05ab5929bcb83d008b29a959">More...</a><br /></td></tr>
<tr class="separator:a8b83360b05ab5929bcb83d008b29a959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac12220d4e76973d65d6ec017082cccb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">TimerIfEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry</a> (<a class="el" href="structinet_1_1x_m_i_pv6_1_1_key.html">Key</a> &amp;key, int timerType)</td></tr>
<tr class="memdesc:aac12220d4e76973d65d6ec017082cccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a pointer to an <a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html" title="The base class for all other timers that are used for retransmissions.">TimerIfEntry</a> object identified by the provided key, which can be one of the possible polymorphic types.  <a href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">More...</a><br /></td></tr>
<tr class="separator:aac12220d4e76973d65d6ec017082cccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3d7b04dc134a664dac950e63948b92"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">TimerIfEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a7f3d7b04dc134a664dac950e63948b92">searchTimerIfEntry</a> (<a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, int timerType)</td></tr>
<tr class="memdesc:a7f3d7b04dc134a664dac950e63948b92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for a transmitEntry with the given destination address which is of type timerType.  <a href="classinet_1_1x_m_i_pv6.html#a7f3d7b04dc134a664dac950e63948b92">More...</a><br /></td></tr>
<tr class="separator:a7f3d7b04dc134a664dac950e63948b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece14f2aefee479e40b9cc3e3ee70fa4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;dest, int interfaceId)</td></tr>
<tr class="memdesc:aece14f2aefee479e40b9cc3e3ee70fa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes timers of all types for the specified destination address and interfaceId.  <a href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">More...</a><br /></td></tr>
<tr class="separator:aece14f2aefee479e40b9cc3e3ee70fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa84252f2ce271ac00187ea6dc2c9bb87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">cancelEntries</a> (int interfaceId, <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;CoA)</td></tr>
<tr class="memdesc:aa84252f2ce271ac00187ea6dc2c9bb87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel all timers (TransmitIf entities for HA and CNs) related to the provided interfaceId and CoA.  <a href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">More...</a><br /></td></tr>
<tr class="separator:aa84252f2ce271ac00187ea6dc2c9bb87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b6778cff1888b1f98f487f7a5ef4151"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a6b6778cff1888b1f98f487f7a5ef4151">removeCoAEntries</a> ()</td></tr>
<tr class="memdesc:a6b6778cff1888b1f98f487f7a5ef4151"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all entries from the interfaceCoAList.  <a href="classinet_1_1x_m_i_pv6.html#a6b6778cff1888b1f98f487f7a5ef4151">More...</a><br /></td></tr>
<tr class="separator:a6b6778cff1888b1f98f487f7a5ef4151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad7b618b1a010c573144042abf04d4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a3ad7b618b1a010c573144042abf04d4b">createBULEntryExpiryTimer</a> (<a class="el" href="classinet_1_1_binding_update_list_1_1_binding_update_list_entry.html">BindingUpdateList::BindingUpdateListEntry</a> *entry, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, simtime_t scheduledTime)</td></tr>
<tr class="memdesc:a3ad7b618b1a010c573144042abf04d4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates or overwrites a timer for BUL expiry that fires at provided scheduledTime.  <a href="classinet_1_1x_m_i_pv6.html#a3ad7b618b1a010c573144042abf04d4b">More...</a><br /></td></tr>
<tr class="separator:a3ad7b618b1a010c573144042abf04d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06985160c711bec7d2c91ff06a4574a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a06985160c711bec7d2c91ff06a4574a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the situation of a BUL expiry.  <a href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">More...</a><br /></td></tr>
<tr class="separator:a06985160c711bec7d2c91ff06a4574a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2d65f8a5b0013ea96df343a38c2ca9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a3b2d65f8a5b0013ea96df343a38c2ca9">createBCEntryExpiryTimer</a> (const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;HoA, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, simtime_t scheduledTime)</td></tr>
<tr class="memdesc:a3b2d65f8a5b0013ea96df343a38c2ca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates or overwrites a timer for BC expiry that fires at provided scheduledTime.  <a href="classinet_1_1x_m_i_pv6.html#a3b2d65f8a5b0013ea96df343a38c2ca9">More...</a><br /></td></tr>
<tr class="separator:a3b2d65f8a5b0013ea96df343a38c2ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89306a1cc392ba98bf0fc8f83806a7a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">handleBCExpiry</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a89306a1cc392ba98bf0fc8f83806a7a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the expiry of a BC entry.  <a href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">More...</a><br /></td></tr>
<tr class="separator:a89306a1cc392ba98bf0fc8f83806a7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f7319d98882b8ee35fd346a892a3ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a00f7319d98882b8ee35fd346a892a3ea">createHomeTokenEntryExpiryTimer</a> (<a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;cnAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, simtime_t scheduledTime)</td></tr>
<tr class="memdesc:a00f7319d98882b8ee35fd346a892a3ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates or overwrites a timer for home keygen token expiry that fires at provided scheduledTime.  <a href="classinet_1_1x_m_i_pv6.html#a00f7319d98882b8ee35fd346a892a3ea">More...</a><br /></td></tr>
<tr class="separator:a00f7319d98882b8ee35fd346a892a3ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4ded6f950e3baed74e157e01170a188"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ad4ded6f950e3baed74e157e01170a188">createCareOfTokenEntryExpiryTimer</a> (<a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;cnAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, simtime_t scheduledTime)</td></tr>
<tr class="memdesc:ad4ded6f950e3baed74e157e01170a188"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates or overwrites a timer for care-of keygen token expiry that fires at provided scheduledTime.  <a href="classinet_1_1x_m_i_pv6.html#ad4ded6f950e3baed74e157e01170a188">More...</a><br /></td></tr>
<tr class="separator:ad4ded6f950e3baed74e157e01170a188"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:afbd697045dcbb870067637a497a1d4b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_i_interface_table.html">IInterfaceTable</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a></td></tr>
<tr class="separator:afbd697045dcbb870067637a497a1d4b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e2da85c22ddd1da5442bb13d19c8af"><td class="memItemLeft" align="right" valign="top">opp_component_ptr&lt; <a class="el" href="classinet_1_1_ipv6_routing_table.html">Ipv6RoutingTable</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a></td></tr>
<tr class="separator:a86e2da85c22ddd1da5442bb13d19c8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b4704a9c3f214da125430daa5ccac90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_binding_update_list.html">BindingUpdateList</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a></td></tr>
<tr class="separator:a0b4704a9c3f214da125430daa5ccac90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaedd0e625db0006062acff0fe98419b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_binding_cache.html">BindingCache</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a></td></tr>
<tr class="separator:aaedd0e625db0006062acff0fe98419b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1279d6acb1593dd76e210197b33d3300"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_ipv6_tunneling.html">Ipv6Tunneling</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a></td></tr>
<tr class="separator:a1279d6acb1593dd76e210197b33d3300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df03c81b24aa899e6f71b02f997d3d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt; <a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html">Ipv6NeighbourDiscovery</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a1df03c81b24aa899e6f71b02f997d3d8">ipv6nd</a></td></tr>
<tr class="separator:a1df03c81b24aa899e6f71b02f997d3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1358e19a397fcf92ab6eb211feb29a0"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ae1358e19a397fcf92ab6eb211feb29a0">statVectorBUtoHA</a></td></tr>
<tr class="separator:ae1358e19a397fcf92ab6eb211feb29a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3530c9e0b9300865f35dfa4e8e0dbb2"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ac3530c9e0b9300865f35dfa4e8e0dbb2">statVectorBUtoCN</a></td></tr>
<tr class="separator:ac3530c9e0b9300865f35dfa4e8e0dbb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4c6a6a899062b7fcc3ff652bf2889f"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a3f4c6a6a899062b7fcc3ff652bf2889f">statVectorBUtoMN</a></td></tr>
<tr class="separator:a3f4c6a6a899062b7fcc3ff652bf2889f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7f4d1946d689b82a6262f573b4dff34"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ad7f4d1946d689b82a6262f573b4dff34">statVectorBAtoMN</a></td></tr>
<tr class="separator:ad7f4d1946d689b82a6262f573b4dff34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2968ab420d464333f6507777807e258c"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a2968ab420d464333f6507777807e258c">statVectorBAfromHA</a></td></tr>
<tr class="separator:a2968ab420d464333f6507777807e258c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54ce78a78600ff9cdc67cd3677b7f6c7"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a54ce78a78600ff9cdc67cd3677b7f6c7">statVectorBAfromCN</a></td></tr>
<tr class="separator:a54ce78a78600ff9cdc67cd3677b7f6c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b51180fdf6816df8f8c3b3ea38a856c"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a1b51180fdf6816df8f8c3b3ea38a856c">statVectorHoTItoCN</a></td></tr>
<tr class="separator:a1b51180fdf6816df8f8c3b3ea38a856c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba727d3d571dbf2bfa502f43347aa42"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a5ba727d3d571dbf2bfa502f43347aa42">statVectorCoTItoCN</a></td></tr>
<tr class="separator:a5ba727d3d571dbf2bfa502f43347aa42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85216c5121ada09d0546edca70230eaa"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a85216c5121ada09d0546edca70230eaa">statVectorHoTtoMN</a></td></tr>
<tr class="separator:a85216c5121ada09d0546edca70230eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab366c8aa68a9433b0a534418b947d196"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ab366c8aa68a9433b0a534418b947d196">statVectorCoTtoMN</a></td></tr>
<tr class="separator:ab366c8aa68a9433b0a534418b947d196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a3d32424201efff4545cff6ca270ec"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#ae6a3d32424201efff4545cff6ca270ec">statVectorHoTfromCN</a></td></tr>
<tr class="separator:ae6a3d32424201efff4545cff6ca270ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476bc4885f79353c96aad51c748a4ad2"><td class="memItemLeft" align="right" valign="top">cOutVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a476bc4885f79353c96aad51c748a4ad2">statVectorCoTfromCN</a></td></tr>
<tr class="separator:a476bc4885f79353c96aad51c748a4ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3073c578651b8e4272c86373ee96e2f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1x_m_i_pv6.html#a236f56f8cf9b803915087a0f520c7ac0">TransmitIfList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a></td></tr>
<tr class="separator:a3073c578651b8e4272c86373ee96e2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a026f43021a6cb4663eebbdf430a51a08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1x_m_i_pv6.html#a61385548df7ee06f171c75775c271463">InterfaceCoAList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a026f43021a6cb4663eebbdf430a51a08">interfaceCoAList</a></td></tr>
<tr class="separator:a026f43021a6cb4663eebbdf430a51a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ba2534b1c334718b71ca4fa2b6965d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4e82206fc313109ceab061cb035c3b42">CnList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a></td></tr>
<tr class="separator:a20ba2534b1c334718b71ca4fa2b6965d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca971cb70dd3d8468354d96ce504298"><td class="memItemLeft" align="right" valign="top">CnList::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a></td></tr>
<tr class="separator:a1ca971cb70dd3d8468354d96ce504298"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5e84b0c9d17cc2b04d68774f71b8e168"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a5e84b0c9d17cc2b04d68774f71b8e168">createTokenEntryExpiryTimer</a> (<a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;cnAddr, <a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *ie, simtime_t scheduledTime, int tokenType)</td></tr>
<tr class="memdesc:a5e84b0c9d17cc2b04d68774f71b8e168"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates or overwrites a timer for {home, care-of} keygen token expiry that fires at provided scheduledTime.  <a href="classinet_1_1x_m_i_pv6.html#a5e84b0c9d17cc2b04d68774f71b8e168">More...</a><br /></td></tr>
<tr class="separator:a5e84b0c9d17cc2b04d68774f71b8e168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a15750da5e4a84c0798ecc2b69a278b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">handleTokenExpiry</a> (cMessage *msg)</td></tr>
<tr class="memdesc:a6a15750da5e4a84c0798ecc2b69a278b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the event that indicates that a {care-of,home} keygen token has expired.  <a href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">More...</a><br /></td></tr>
<tr class="separator:a6a15750da5e4a84c0798ecc2b69a278b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements RFC 3775 Mobility Support in <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a>. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a4e82206fc313109ceab061cb035c3b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e82206fc313109ceab061cb035c3b42">&#9670;&nbsp;</a></span>CnList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a>&gt; <a class="el" href="classinet_1_1x_m_i_pv6.html#a4e82206fc313109ceab061cb035c3b42">inet::xMIPv6::CnList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a61385548df7ee06f171c75775c271463"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61385548df7ee06f171c75775c271463">&#9670;&nbsp;</a></span>InterfaceCoAList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;int, <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a>&gt; <a class="el" href="classinet_1_1x_m_i_pv6.html#a61385548df7ee06f171c75775c271463">inet::xMIPv6::InterfaceCoAList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>holds the tuples of currently available {InterfaceID, CoA} pairs </p>

</div>
</div>
<a id="a236f56f8cf9b803915087a0f520c7ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a236f56f8cf9b803915087a0f520c7ac0">&#9670;&nbsp;</a></span>TransmitIfList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;<a class="el" href="structinet_1_1x_m_i_pv6_1_1_key.html">Key</a>, <a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">TimerIfEntry</a> *&gt; <a class="el" href="classinet_1_1x_m_i_pv6.html#a236f56f8cf9b803915087a0f520c7ac0">inet::xMIPv6::TransmitIfList</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac7c070267c8193527338a81f65288785"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c070267c8193527338a81f65288785">&#9670;&nbsp;</a></span>~xMIPv6()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inet::xMIPv6::~xMIPv6 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructur. </p>
<p>Ensures that the memory from the list with all <a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html" title="The base class for all other timers that are used for retransmissions.">TimerIfEntry</a>'s gets properly released. </p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">auto</span> it = <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.begin();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">while</span> (it != <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.end()) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key = it-&gt;first;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">// advance pointer to make sure it does not become invalid</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">// after the cancel() call</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        ++it;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(key.dest, key.interfaceID, key.type);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa84252f2ce271ac00187ea6dc2c9bb87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa84252f2ce271ac00187ea6dc2c9bb87">&#9670;&nbsp;</a></span>cancelEntries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::cancelEntries </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>CoA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cancel all timers (TransmitIf entities for HA and CNs) related to the provided interfaceId and CoA. </p>
<p>In addition the tunnels to the Home Agent and the CNs are destroyed as well. 0 <br  />
 </p>
<div class="fragment"><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;{</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceId);</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="comment">// we have to cancel all existing timers</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="comment">// ...first for the HA</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    Ipv6Address HA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress();</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment">//    Ipv6Address HoA = ie-&gt;ipv6()-&gt;getMNHomeAddress();</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(HA, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a>);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnel(CoA, HA);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="comment">// ...and then for the CNs</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.begin(); it != <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.end();) {</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keywordflow">if</span> ((*it).first.interfaceID == interfaceId) {</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keyword">auto</span> oldIt = it++;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            <span class="comment">// destroy tunnel (if we have a BU entry here)</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <span class="keywordflow">if</span> ((*oldIt).first.type == <a class="code" href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a>)</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelForEntryAndTrigger(CoA, (*oldIt).first.dest);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160; </div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            <span class="comment">// then cancel the pending event</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>((*oldIt).first.dest, (*oldIt).first.interfaceID, (*oldIt).first.type);</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;            ++it;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a6b6778cff1888b1f98f487f7a5ef4151">removeCoAEntries()</a>.</p>

</div>
</div>
<a id="ac1aa90c3bed562838eb25ef6fee982f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1aa90c3bed562838eb25ef6fee982f9">&#9670;&nbsp;</a></span>cancelTimerIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::cancelTimerIfEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>msgType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deletes the appropriate entry from the transmitIfList and cancels the corresponding retransmission timer. </p>
<div class="fragment"><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;{</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(dest, interfaceID, msgType);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keyword">auto</span> pos = <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.find(key);</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="keywordflow">if</span> (pos == <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.end()) {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">//        EV &lt;&lt; &quot;### No corresponding TimerIfEntry found! ###\n&quot;;</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    TimerIfEntry *entry = (pos-&gt;second);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    cancelAndDelete(entry-&gt;timer); <span class="comment">// cancels the retransmission timer</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    entry-&gt;timer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.erase(key); <span class="comment">// remove entry from list</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keyword">delete</span> entry; <span class="comment">// free memory</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    EV_DEBUG &lt;&lt; <span class="stringliteral">&quot;Deleted TimerIfEntry and corresponding timer.\n&quot;</span>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">cancelEntries()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a58e6b3c651470bc1b377bcd5ccb04f27">createBUTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">handleBCExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">handleTokenExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a746a045b4475430db6fb1ebcb7b7898b">sendPeriodicBRR()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#ac7c070267c8193527338a81f65288785">~xMIPv6()</a>.</p>

</div>
</div>
<a id="aa35090fe5ce065706e4c1449c12ae75f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa35090fe5ce065706e4c1449c12ae75f">&#9670;&nbsp;</a></span>checkForBUtoCN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::checkForBUtoCN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_binding_update_list_1_1_binding_update_list_entry.html">BindingUpdateList::BindingUpdateListEntry</a> &amp;&#160;</td>
          <td class="paramname"><em>bulEntry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send a BU depending on current status of: </p>
<ul>
<li>Registration or Deregistration phase</li>
<li>Availability of tokens</li>
</ul>
<p>Return true or false depending on whether a BU has been sent or not. </p>
<div class="fragment"><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;{</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Checking whether a new BU has to be sent to CN.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordflow">if</span> (bulEntry.state == <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">BindingUpdateList::DEREGISTER</a>) {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">// we are supposed to send a deregistration BU</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isValidBinding(bulEntry.destAddress)) {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            <span class="comment">// no valid binding existing; nothing to do</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            <span class="comment">// TODO cleanup operations?</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="comment">// we need a valid home keygen token for deregistration</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isHomeTokenAvailable(bulEntry.destAddress, ie)) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">sendBUtoCN</a>(bulEntry, ie);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="comment">// no token available</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <span class="comment">// send HoTI</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">createAndSendHoTIMessage</a>(bulEntry.destAddress, ie);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">// case REGISTER, REGISTERED and anything else</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;           <span class="comment">// for a registration BU we need both valid care-of and home keygen tokens</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isCareOfTokenAvailable(bulEntry.destAddress, ie)) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;recentlySentCOTI(bulEntry.destAddress, ie))</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">createAndSendCoTIMessage</a>(bulEntry.destAddress, ie);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isHomeTokenAvailable(bulEntry.destAddress, ie)) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;recentlySentHOTI(bulEntry.destAddress, ie))</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">createAndSendHoTIMessage</a>(bulEntry.destAddress, ie);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        bulEntry.state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa46341e593269699821a9c10251bedd0f">BindingUpdateList::RR_COMPLETE</a>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="comment">// tokens are available: now we also need the case that the binding is about to expire or we have no valid binding at all</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isBindingAboutToExpire(bulEntry.destAddress)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;             || !<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isValidBinding(bulEntry.destAddress))</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            &amp;&amp; bulEntry.state != <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aac6a4bd549b4bca51f53eedcafdc3684d">BindingUpdateList::REGISTER</a></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            &amp;&amp; bulEntry.state != <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa84718d3bdca6a089024544c71a52f10a">BindingUpdateList::NONE</a>)</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">sendBUtoCN</a>(bulEntry, ie);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>.</p>

</div>
</div>
<a id="a93efecffc166a0fab45479baa0604140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93efecffc166a0fab45479baa0604140">&#9670;&nbsp;</a></span>createAndSendBAMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createAndSendBAMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996f">BaStatus</a> &amp;&#160;</td>
          <td class="paramname"><em>baStatus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a>&#160;</td>
          <td class="paramname"><em>baSeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bindingAuthorizationData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a>&#160;</td>
          <td class="paramname"><em>lifeTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>sendTime</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs and send a BA to the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module. </p>
<p>Only applicable to HAs and CNs. </p>
<div class="fragment"><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;{</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    EV_TRACE &lt;&lt; <span class="stringliteral">&quot;Entered createAndSendBAMessage() method&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceId); <span class="comment">// To find the interface on which the BU was received</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">// swapping src and destination for the ack packet</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">//    Ipv6Address source = ie-&gt;ipv6()-&gt;linkLocalAddress();</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">//    Ipv6Address destination = src;</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">//    Ipv6Address src = ie -&gt;ipv6()-&gt;linkLocalAddress();</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">// uncommented the code above - we can use the swapped original src and</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// dest from the ctrlInfo as it is provided in the first two arguments</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;Binding Acknowledgement&quot;</span>);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ba = makeShared&lt;BindingAcknowledgement&gt;();</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    ba-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0a8b4d7c73d97089a7415beea141c8463f">BINDING_ACKNOWLEDGEMENT</a>);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    ba-&gt;setStatus(baStatus);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    ba-&gt;setSequenceNumber(baSeq); <span class="comment">// this sequence number will correspond to the ACKed BU</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">// we are providing lifetime as a parameter</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    ba-&gt;setLifetime(lifeTime / 4); <span class="comment">/* 6.1.8 ...in time units of 4 seconds... */</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">/*9.5.4</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">       If the Status field in the Binding Acknowledgement contains the value</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">       136 (expired home nonce index), 137 (expired care-of nonce index), or</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">       138 (expired nonces) then the message MUST NOT include the Binding</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">       Authorization Data mobility option.  Otherwise, the Binding</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">       Authorization Data mobility option MUST be included, and MUST meet</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">       the specific authentication requirements for Binding Acknowledgements</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">       as defined in Section 5.2.*/</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">if</span> (ba-&gt;getStatus() != <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa76f16a8872a649f7f026da540398bb50">EXPIRED_HOME_NONCE_INDEX</a> &amp;&amp;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        ba-&gt;getStatus() != <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996faf8341e3e8b2b2e45948f0a1b55f7e01d">EXPIRED_CARE_OF_NONCE_INDEX</a> &amp;&amp;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        ba-&gt;getStatus() != <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa67b29973a629637f7c9cfa9782459a34">EXPIRED_NONCES</a>)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        ba-&gt;setBindingAuthorizationData(bindingAuthorizationData);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordtype">int</span> bindAuthSize = 0;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (bindingAuthorizationData != <a class="code" href="_binding_update_list_8h.html#a0770994de63505f39900396055458bf9">UNDEFINED_BIND_AUTH_DATA</a>)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        bindAuthSize = <a class="code" href="x_m_i_pv6_8cc.html#af49ffb464649fc08a3a0f413961472e5">SIZE_BIND_AUTH_DATA</a> + 2; <span class="comment">// Binding Auth. Data + 6.2.3 PadN = 16 bit</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    ba-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#a60631c4c24bf52df8ed3d83be2a49556">SIZE_BACK</a> + bindAuthSize));</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    packet-&gt;insertAtFront(ba);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">/*The rules for selecting the Destination IP address (and, if required,</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">       routing header construction) for the Binding Acknowledgement to the</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">       mobile node are the same as in the previous section.  When the Status</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">       field in the Binding Acknowledgement is greater than or equal to 128</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">       and the Source Address of the Binding Update is on the home link, the</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">       home agent MUST send it to the mobile node&#39;s link layer address</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">       (retrieved either from the Binding Update or through Neighbor</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">       Solicitation).*/</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// TODO</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(packet, dest, src, ie-&gt;getInterfaceId(), sendTime);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">/*if (rt6-&gt;isHomeAgent())</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">        statVectorBAtoMN.record(1);</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">       else</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">        statVectorBAtoMN.record(2);*/</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611">validateBUMessage()</a>.</p>

</div>
</div>
<a id="aa80789234568c887c26c1c95cb51884f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa80789234568c887c26c1c95cb51884f">&#9670;&nbsp;</a></span>createAndSendBEMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createAndSendBEMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a0836489f866ddd35438d3bfe59438d4b">BeStatus</a> &amp;&#160;</td>
          <td class="paramname"><em>beStatus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and sends Binding Error message. </p>
<div class="fragment"><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;{</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    EV_TRACE &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Entered createAndSendBEMessage() Function&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;BError&quot;</span>);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; be = makeShared&lt;BindingError&gt;();</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    be-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0a0cb12dbd2feed355e078600b9ef1e32b">BINDING_ERROR</a>);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    be-&gt;setStatus(beStatus);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    be-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#a273bc5eeb718938cd4da6e7f61fe3dd1">SIZE_BE</a>));</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    packet-&gt;insertAtFront(be);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(packet, dest);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a3c68a093ad4a7f05896c4393d23c5fe0">processHoAOpt()</a>.</p>

</div>
</div>
<a id="a8e8e171a71e44592936df60b6214ae5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e8e171a71e44592936df60b6214ae5a">&#9670;&nbsp;</a></span>createAndSendBRRMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createAndSendBRRMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a Binding Refresh <a class="el" href="classinet_1_1_request.html">Request</a> and sends it to the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> module. </p>
<div class="fragment"><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;{</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    EV_TRACE &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;======THIS IS THE ROUTINE FOR CREATING AND SENDING BRR MESSAGE =====&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keyword">auto</span> outPacket = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;Binding Refresh Request&quot;</span>);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; brr = makeShared&lt;BindingRefreshRequest&gt;();</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="comment">/*6.1.2</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">       The Binding Refresh Request message uses the MH Type value 0.  When</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">       this value is indicated in the MH Type field, the format of the</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">       Message Data field in the Mobility Header is as follows:*/</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    brr-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0afbc2526005b21a68dbaacb79c7e85480">BINDING_REFRESH_REQUEST</a>);</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    brr-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#a236c732f14005bd11f696dcceca3e5e1">SIZE_BRR</a>));</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    outPacket-&gt;insertAtFront(brr);</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;======BRR MESSAGE FORMED; APPENDING CONTROL INFO=====&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    Ipv6Address CoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::CoA);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    ASSERT(!CoA.isUnspecified());</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(outPacket, dest, CoA, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a746a045b4475430db6fb1ebcb7b7898b">sendPeriodicBRR()</a>.</p>

</div>
</div>
<a id="a50ab006c4ae9e1f254c9ad8ac45bcc71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50ab006c4ae9e1f254c9ad8ac45bcc71">&#9670;&nbsp;</a></span>createAndSendBUMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createAndSendBUMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a>&#160;</td>
          <td class="paramname"><em>buSeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a>&#160;</td>
          <td class="paramname"><em>lifeTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bindAuthData</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method for creating and sending a BU by a MN. </p>
<div class="fragment"><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Creating and sending Binding Update&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// TODO use the globalAddress(Ipv6InterfaceData::CoA) in the address selection somewhere above (caller)</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    Ipv6Address CoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::CoA); <span class="comment">// source address of MN</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (CoA.isUnspecified())</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        CoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getPreferredAddress(); <span class="comment">// in case a CoA is not availabile (e.g. returning home)</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">auto</span> packet = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;Binding Update&quot;</span>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bu = makeShared&lt;BindingUpdate&gt;();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">       To register a care-of address or to extend the lifetime of an</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">       existing registration, the mobile node sends a packet to its home</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">       agent containing a Binding Update, with the packet constructed as</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">       follows:*/</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">/*11.7.2</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">       A Binding Update is created as follows:*/</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    bu-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0a7032ca76891b78d59d7b0e4655174568">BINDING_UPDATE</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">       o  The value specified in the Lifetime field MUST be non-zero and</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">         SHOULD be less than or equal to the remaining valid lifetime of</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">         the home address and the care-of address specified for the</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">         binding.*/</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">/*6.1.7</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">       Lifetime</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">       16-bit unsigned integer.  The number of time units remaining</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">       before the binding MUST be considered expired.  A value of zero</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">       indicates that the Binding Cache entry for the mobile node MUST be</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">       deleted.  (In this case the specified care-of address MUST also be</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">       set equal to the home address.)  One time unit is 4 seconds.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    bu-&gt;setLifetime(lifeTime / 4);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    bu-&gt;setSequence(buSeq);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">       o  The Acknowledge (A) bit MUST be set in the Binding Update.*/</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    bu-&gt;setAckFlag(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/*o  The Home Registration (H) bit MUST be set in the Binding Update.*/</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// set flag depending on whether the BU goes to HA or not - CB</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    bu-&gt;setHomeRegistrationFlag(dest == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress());</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">       o  If the mobile node&#39;s link-local address has the same interface</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">         identifier as the home address for which it is supplying a new</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">         care-of address, then the mobile node SHOULD set the Link-Local</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">         Address Compatibility (L) bit.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">       o  If the home address was generated using RFC 3041 [18], then the</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">         link local address is unlikely to have a compatible interface</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">         identifier.  In this case, the mobile node MUST clear the Link-</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">         Local Address Compatibility (L) bit.*/</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// The link identifiers are always the same in our simulations. As</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// long as this is not changing, we can stick to the value &quot;true&quot;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    bu-&gt;setLinkLocalAddressCompatibilityFlag(<span class="keyword">true</span>); <span class="comment">// fine for now</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    bu-&gt;setKeyManagementFlag(<span class="keyword">false</span>); <span class="comment">// no IKE/IPsec available anyway</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">       o  The packet MUST contain a Home Address destination option, giving</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">         the mobile node&#39;s home address for the binding.*/</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">/*11.7.2</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">       o  The home address of the mobile node MUST be added to the packet in</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">         a Home Address destination option, unless the Source Address is</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">         the home address.*/</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    Ipv6Address HoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::HoA);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    ASSERT(!HoA.isUnspecified());</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// As every Ipv6 Datagram sending the BU has to have the Home Address Option, I have</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// made this field a part of BU message to ease my task of simulation...</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// this can be accessed from the InterfaceTable of the MN.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    bu-&gt;setHomeAddressMN(HoA); <span class="comment">// HoA of MN</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">/*11.7.2</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">       o  The Mobility Header is constructed according to rules in Section</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">         6.1.7 and Section 5.2.6, including the Binding Authorization Data</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">         (calculated as defined in Section 6.2.7) and possibly the Nonce</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">         Indices mobility options.*/</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    bu-&gt;setBindingAuthorizationData(bindAuthData); <span class="comment">// added for BU to CN</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">int</span> nonceIndicesSize = 0;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (!bu-&gt;getHomeRegistrationFlag())</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        nonceIndicesSize = <a class="code" href="x_m_i_pv6_8cc.html#ae232f747c44b844277d7a7b6a9fe4054">SIZE_NONCE_INDICES</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">int</span> bindAuthSize = 0;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">if</span> (bindAuthData != <a class="code" href="_binding_update_list_8h.html#a0770994de63505f39900396055458bf9">UNDEFINED_BIND_AUTH_DATA</a>)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        bindAuthSize = <a class="code" href="x_m_i_pv6_8cc.html#af49ffb464649fc08a3a0f413961472e5">SIZE_BIND_AUTH_DATA</a>; <span class="comment">// (6.2.3 PadN = 16 bit) -&gt; no padding required if nonces provided // TODO check whether nonces valid</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    bu-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#a909c538cb3db668a9317892683fb7078">SIZE_BU</a> + <a class="code" href="x_m_i_pv6_8cc.html#a2a87f0f44824cd5a8bee81353adbbc7c">SIZE_HOA_OPTION</a> + bindAuthSize + nonceIndicesSize));</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">       When sending a Binding Update to its home agent, the mobile node MUST</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">       also create or update the corresponding Binding Update List entry, as</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">       specified in Section 11.7.2.*/</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a654465e95bd0340136b7d9b4aa2b3b83">updateBUL</a>(bu.get(), dest, CoA, ie, simTime());</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    packet-&gt;insertAtFront(bu);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">       o  The care-of address for the binding MUST be used as the Source</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">         Address in the packet&#39;s Ipv6 header, unless an Alternate Care-of</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">         Address mobility option is included in the Binding Update.  This</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">         option MUST be included in all home registrations, as the ESP</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">         protocol will not be able to protect care-of addresses in the Ipv6</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">         header.  (Mobile Ipv6 implementations that know they are using</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">         IPsec AH to protect a particular message might avoid this option.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">         For brevity the usage of AH is not discussed in this document.)*/</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">/*11.7.2</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">       o  The current care-of address of the mobile node MUST be sent either</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">         in the Source Address of the Ipv6 header, or in the Alternate</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">         Care-of Address mobility option.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">       o  The Destination Address of the Ipv6 header MUST contain the</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">         address of the correspondent node.*/</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(packet, dest, CoA, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">//    sendMobilityMessageToIPv6Module(bu, dest);</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a41dfe546eaa52dd2544407b80b044bec">sendPeriodicBU()</a>.</p>

</div>
</div>
<a id="a08bef6eef2ae0e4b244148e8fa77f8b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08bef6eef2ae0e4b244148e8fa77f8b5">&#9670;&nbsp;</a></span>createAndSendCoTIMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createAndSendCoTIMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>cnDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and sends a CoTI message to the specified destination. </p>
<div class="fragment"><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;{</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; CoTI = makeShared&lt;CareOfTestInit&gt;();</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    CoTI-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0ac49358ac49b4e3a7932c8c8b6b4fe612">CARE_OF_TEST_INIT</a>);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    CoTI-&gt;setCareOfInitCookie(<a class="code" href="_binding_update_list_8h.html#ad81571eaf4714ac9fef4c4bcdd378619">CO_COOKIE</a>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    CoTI-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#aeefd0c073b8a6c065f08269e6bcb9db6">SIZE_COTI</a>));</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#aa8846ee7ce22eeab2e24cd4f659634b7">createTestInitTimer</a>(CoTI, cnDest, ie);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">handleTokenExpiry()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability()</a>.</p>

</div>
</div>
<a id="ae250d75eb29b33e82c73d1b85cd184bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae250d75eb29b33e82c73d1b85cd184bf">&#9670;&nbsp;</a></span>createAndSendHoTIMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createAndSendHoTIMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>cnDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and sends a HoTI message to the specified destination. </p>
<div class="fragment"><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;{</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; HoTI = makeShared&lt;HomeTestInit&gt;();</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    HoTI-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0af819ce0f0b930b63bd62eede16d26df3">HOME_TEST_INIT</a>);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    HoTI-&gt;setHomeInitCookie(<a class="code" href="_binding_update_list_8h.html#a4bb4091e6bbb177010a02c7ae61fb387">HO_COOKIE</a>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    HoTI-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#a61a94eac72de688b6107fe7e2e31595f">SIZE_HOTI</a>));</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#aa8846ee7ce22eeab2e24cd4f659634b7">createTestInitTimer</a>(HoTI, cnDest, ie);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">handleTokenExpiry()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability()</a>.</p>

</div>
</div>
<a id="a3b2d65f8a5b0013ea96df343a38c2ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b2d65f8a5b0013ea96df343a38c2ca9">&#9670;&nbsp;</a></span>createBCEntryExpiryTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createBCEntryExpiryTimer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>HoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>scheduledTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates or overwrites a timer for BC expiry that fires at provided scheduledTime. </p>
<div class="fragment"><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;{</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    cMessage *bcExpiryMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;BCEntryExpiry&quot;</span>, <a class="code" href="x_m_i_pv6_8cc.html#a2c62677bd8273d2af6b5c1fee292a11c">MK_BC_EXPIRY</a>);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(HoA, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a809adcc4f8be4ebac2a6467d645e79cc">KEY_BC_EXP</a>);</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="comment">// fetch a valid TimerIfEntry obect</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    BcExpiryIfEntry *bcExpIfEntry = check_and_cast&lt;BcExpiryIfEntry *&gt;(<a class="code" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry</a>(key, <a class="code" href="x_m_i_pv6_8h.html#a87382a94f6c41d4075454d079de8cb8b">EXPIRY_TYPE_BC</a>));</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160; </div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    bcExpIfEntry-&gt;dest = HoA;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    bcExpIfEntry-&gt;HoA = HoA;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    bcExpIfEntry-&gt;ifEntry = ie;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    bcExpIfEntry-&gt;timer = bcExpiryMsg;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160; </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    bcExpiryMsg-&gt;setContextPointer(bcExpIfEntry); <span class="comment">// information in the bulExpIfEntry is required for handler when message fires</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160; </div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    scheduleAt(scheduledTime, bcExpiryMsg);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Scheduled BC expiry for time &quot;</span> &lt;&lt; scheduledTime &lt;&lt; <span class="stringliteral">&quot;s&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>.</p>

</div>
</div>
<a id="a569259d4846043449f7e9448dd5f5851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a569259d4846043449f7e9448dd5f5851">&#9670;&nbsp;</a></span>createBRRTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createBRRTimer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>brDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a>&#160;</td>
          <td class="paramname"><em>scheduledTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a timer for a Binding Refresh <a class="el" href="classinet_1_1_request.html">Request</a> message that is going to be fired in scheduledTime seconds. </p>
<div class="fragment"><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;{</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="comment">/*9.5.5</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">       If the sender knows that the Binding Cache entry is still in active</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">       use, it MAY send a Binding Refresh Request message to the mobile node</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">       in an attempt to avoid this overhead and latency due to deleting and</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">       recreating the Binding Cache entry.  This message is always sent to</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">       the home address of the mobile node.*/</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;createBRRTimer()&quot;</span>);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="comment">// check if there already exists a BRTimer entry for this key</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(brDest, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a12b4df7d7c310249eb01a4d0b0189b3b">KEY_BR</a>);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    BrTransmitIfEntry *brIfEntry;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="keyword">auto</span> pos = <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.find(key);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">if</span> (pos != <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.end()) {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <span class="comment">// there already exists an unACKed retransmission timer for that entry</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="comment">// -&gt; overwrite the old with the new one</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        <span class="keywordflow">if</span> ((brIfEntry = <span class="keyword">dynamic_cast&lt;</span>BrTransmitIfEntry *<span class="keyword">&gt;</span>(pos-&gt;second))) {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;            cancelAndDelete(brIfEntry-&gt;timer); <span class="comment">// delete the corresponding timer</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Expected BrTransmitIfEntry* !&quot;</span>);</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <span class="comment">// we do not yet have an entry -&gt; create a new one</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        brIfEntry = <span class="keyword">new</span> BrTransmitIfEntry();</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.insert(std::make_pair(key, brIfEntry));</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    brIfEntry-&gt;dest = brDest;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    brIfEntry-&gt;ifEntry = ie;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    brIfEntry-&gt;retries = 0;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; </div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    cMessage *brTriggerMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;sendPeriodicBRR&quot;</span>, <a class="code" href="x_m_i_pv6_8cc.html#aaec02cdb37c69443949e6e975dbf7d6b">MK_SEND_PERIODIC_BR</a>);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    brIfEntry-&gt;timer = brTriggerMsg;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    brTriggerMsg-&gt;setContextPointer(brIfEntry); <span class="comment">// attaching the brIfEntry info corresponding to a particular address ith message</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="comment">// Scheduling a message which will trigger a BRR towards brIfEntry-&gt;dest</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    scheduleAfter(scheduledTime, brTriggerMsg);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;\n++++++++++BRR TIMER CREATED FOR SIM TIME: &quot;</span> &lt;&lt; simTime() + scheduledTime</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; seconds+++++++++++++++++ \n&quot;</span>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ad7b618b1a010c573144042abf04d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad7b618b1a010c573144042abf04d4b">&#9670;&nbsp;</a></span>createBULEntryExpiryTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createBULEntryExpiryTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_binding_update_list_1_1_binding_update_list_entry.html">BindingUpdateList::BindingUpdateListEntry</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>scheduledTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates or overwrites a timer for BUL expiry that fires at provided scheduledTime. </p>
<div class="fragment"><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;{</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="comment">//    Enter_Method(&quot;createBULEntryExpiryTimer()&quot;);</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="comment">//    EV &lt;&lt; &quot;Creating BUL entry expiry timer for sim time: &quot; &lt;&lt; entry-&gt;bindingExpiry &lt;&lt; &quot; seconds.&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    cMessage *bulExpiryMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;BULEntryExpiry&quot;</span>, <a class="code" href="x_m_i_pv6_8cc.html#a6d95ac743e8277891cc1093a62ab9f18">MK_BUL_EXPIRY</a>);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="comment">// we are able to associate the BUL entry later on based on HoA, CoA and destination (=HA address)</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    Ipv6Address&amp; HoA = entry-&gt;homeAddress;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    Ipv6Address&amp; CoA = entry-&gt;careOfAddress;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    Ipv6Address&amp; HA = entry-&gt;destAddress;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; </div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(HA, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a2e23b242b95346bc5d29584bd925bc05">KEY_BUL_EXP</a>);</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="comment">// fetch a valid TimerIfEntry obect</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    BulExpiryIfEntry *bulExpIfEntry = check_and_cast&lt;BulExpiryIfEntry *&gt;(<a class="code" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry</a>(key, <a class="code" href="x_m_i_pv6_8h.html#a98fdcdc01bf5f67610cbd3fcd05537e4">EXPIRY_TYPE_BUL</a>));</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    bulExpIfEntry-&gt;dest = HA;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    bulExpIfEntry-&gt;HoA = HoA;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    bulExpIfEntry-&gt;CoA = CoA;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    bulExpIfEntry-&gt;ifEntry = ie;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    bulExpIfEntry-&gt;timer = bulExpiryMsg;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    bulExpiryMsg-&gt;setContextPointer(bulExpIfEntry); <span class="comment">// information in the bulExpIfEntry is required for handler when message fires</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="comment">/*BulExpiryIfEntry* bulExpIfEntry = createBULEntryExpiryTimer(key, HA, HoA, CoA, ie);*/</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160; </div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    scheduleAt(scheduledTime, bulExpiryMsg);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Scheduled BUL expiry (&quot;</span> &lt;&lt; entry-&gt;bindingExpiry &lt;&lt; <span class="stringliteral">&quot;s) for time &quot;</span> &lt;&lt; scheduledTime &lt;&lt; <span class="stringliteral">&quot;s&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="comment">// WAS SCHEDULED FOR EXPIRY, NOT 2 SECONDS BEFORE!?!?!?</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>.</p>

</div>
</div>
<a id="a58e6b3c651470bc1b377bcd5ccb04f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e6b3c651470bc1b377bcd5ccb04f27">&#9670;&nbsp;</a></span>createBUTimer() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createBUTimer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>buDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// if we send a new BU we can delete any potential existing BUL expiry timer for this destination</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(buDest, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a2e23b242b95346bc5d29584bd925bc05">KEY_BUL_EXP</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;fetch(buDest);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    ASSERT(bulEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (bulEntry-&gt;state != <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">BindingUpdateList::DEREGISTER</a>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        bulEntry-&gt;state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aac6a4bd549b4bca51f53eedcafdc3684d">BindingUpdateList::REGISTER</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// update lifetime, 14.9.07</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//if (homeRegistration)</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (buDest == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress())</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a>(buDest, ie, ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxHaBindingLifeTime(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span> (bulEntry-&gt;state == <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">BindingUpdateList::DEREGISTER</a>)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#ae66274da883fc2d9895e11caf712f5ad">createDeregisterBUTimer</a>(buDest, ie);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a>(buDest, ie, ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxRrBindingLifeTime(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07d097cc1f15ca8f7e7dde3bf99f2948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d097cc1f15ca8f7e7dde3bf99f2948">&#9670;&nbsp;</a></span>createBUTimer() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createBUTimer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>buDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a>&#160;</td>
          <td class="paramname"><em>lifeTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homeRegistration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method finally creates the timer structure and schedules the message for sending. </p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;createBUTimer()&quot;</span>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Creating BU timer at sim time: &quot;</span> &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    cMessage *buTriggerMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;sendPeriodicBU&quot;</span>, <a class="code" href="x_m_i_pv6_8cc.html#a8af2291e8f5d6f16d0aec604205421be">MK_SEND_PERIODIC_BU</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// check if there already exists a BUTimer entry for this key</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(buDest, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// fetch a valid TimerIfEntry obect</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    BuTransmitIfEntry *buIfEntry = check_and_cast&lt;BuTransmitIfEntry *&gt;(<a class="code" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry</a>(key, <a class="code" href="x_m_i_pv6_8h.html#a0d624c2f873e2272de302d17053f4604">TRANSMIT_TYPE_BU</a>));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// TODO Investigate problem witht he following line. : runtime error because of attempted message rescheduling</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//    cancelAndDelete(buIfEntry-&gt;timer);</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    buIfEntry-&gt;dest = buDest;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    buIfEntry-&gt;ifEntry = ie;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    buIfEntry-&gt;timer = buTriggerMsg;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// retrieve sequence number from BUL</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// if no entry exists, the method will return 0</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    buIfEntry-&gt;buSequenceNumber = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getSequenceNumber(buDest); <span class="comment">// the sequence number gets initialized and stored here</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    buIfEntry-&gt;lifeTime = lifeTime;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">/*11.8</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">       If the mobile node is sending a Binding Update and does not have</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">       an existing binding at the home agent, it SHOULD use</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">       InitialBindackTimeoutFirstReg (see Section 13) as a value for the</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">       initial retransmission timer.*/</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isInBindingUpdateList(buDest))</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        buIfEntry-&gt;ackTimeout = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getInitialBindAckTimeoutFirst(); <span class="comment">// the backoff constant gets initialised here</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">/*Otherwise, the mobile node should use the specified value of</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">       INITIAL_BINDACK_TIMEOUT for the initial retransmission timer.*/</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        buIfEntry-&gt;ackTimeout = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getInitialBindAckTimeout(); <span class="comment">// if there&#39;s an entry in the BUL, use different value</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    buIfEntry-&gt;homeRegistration = homeRegistration;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    buTriggerMsg-&gt;setContextPointer(buIfEntry); <span class="comment">// attaching the buIfEntry info corresponding to a particular address ith message</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// send BU now</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">//    scheduleAt(buIfEntry-&gt;initScheduledBUTime, buTriggerMsg); //Scheduling a message which will trigger a BU towards buIfEntry-&gt;dest</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    scheduleAfter(SIMTIME_ZERO, buTriggerMsg); <span class="comment">// Scheduling a message which will trigger a BU towards buIfEntry-&gt;dest</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a58e6b3c651470bc1b377bcd5ccb04f27">createBUTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#ae66274da883fc2d9895e11caf712f5ad">createDeregisterBUTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">initiateMipv6Protocol()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">sendBUtoCN()</a>.</p>

</div>
</div>
<a id="ad4ded6f950e3baed74e157e01170a188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4ded6f950e3baed74e157e01170a188">&#9670;&nbsp;</a></span>createCareOfTokenEntryExpiryTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createCareOfTokenEntryExpiryTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>cnAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>scheduledTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates or overwrites a timer for care-of keygen token expiry that fires at provided scheduledTime. </p>
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a5e84b0c9d17cc2b04d68774f71b8e168">createTokenEntryExpiryTimer</a>(cnAddr, ie, scheduledTime, <a class="code" href="x_m_i_pv6_8h.html#a5cf5e9f044204fd03467f018a646d2bc">KEY_CTOKEN_EXP</a>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage()</a>.</p>

</div>
</div>
<a id="ae66274da883fc2d9895e11caf712f5ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66274da883fc2d9895e11caf712f5ad">&#9670;&nbsp;</a></span>createDeregisterBUTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createDeregisterBUTimer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>buDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Similiar to the previous one, this method creates an BU timer with registration lifetime equal to 0. </p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">/*11.5.4</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">       The mobile node SHOULD then send a Binding Update to its home agent,</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">       to instruct its home agent to no longer intercept or tunnel packets</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">       for it. In this home registration, the mobile node MUST set the</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">       Acknowledge (A) and Home Registration (H) bits, set the Lifetime</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">       field to zero, and set the care-of address for the binding to the</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">       mobile node&#39;s own home address.  The mobile node MUST use its home</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">       address as the source address in the Binding Update.*/</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">/*11.7.2</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">       If the Binding Update is sent to the correspondent node, requesting</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">       the deletion of any existing Binding Cache entry it has for the</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">       mobile node, the care-of address is set to the mobile node&#39;s home</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">       address and the Lifetime field set to zero.*/</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//    createBUTimer(buDest, ie, 0, homeRegistration);</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a>(buDest, ie, 0, buDest == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress());</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a58e6b3c651470bc1b377bcd5ccb04f27">createBUTimer()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>.</p>

</div>
</div>
<a id="a00f7319d98882b8ee35fd346a892a3ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f7319d98882b8ee35fd346a892a3ea">&#9670;&nbsp;</a></span>createHomeTokenEntryExpiryTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createHomeTokenEntryExpiryTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>cnAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>scheduledTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates or overwrites a timer for home keygen token expiry that fires at provided scheduledTime. </p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a5e84b0c9d17cc2b04d68774f71b8e168">createTokenEntryExpiryTimer</a>(cnAddr, ie, scheduledTime, <a class="code" href="x_m_i_pv6_8h.html#aff85ca708ac4d725a050c595514f9a5e">KEY_HTOKEN_EXP</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage()</a>.</p>

</div>
</div>
<a id="aa8846ee7ce22eeab2e24cd4f659634b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8846ee7ce22eeab2e24cd4f659634b7">&#9670;&nbsp;</a></span>createTestInitTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createTestInitTimer </td>
          <td>(</td>
          <td class="paramtype">const Ptr&lt; <a class="el" href="classinet_1_1_mobility_header.html">MobilityHeader</a> &gt;&#160;</td>
          <td class="paramname"><em>testInit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>sendTime</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and schedules a timer for either a HoTI or a CoTI transmission. </p>
<div class="fragment"><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;{</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;\n++++++++++TEST INIT TIMER CREATED AT SIM TIME: &quot;</span> &lt;&lt; simTime()</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; seconds+++++++++++++++++ \n&quot;</span>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    cMessage *testInitTriggerMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;sendTestInit&quot;</span>, <a class="code" href="x_m_i_pv6_8cc.html#af382622c53488bb0595890e966927e4b">MK_SEND_TEST_INIT</a>);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="comment">/*11.8</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">       When the mobile node sends a Mobile Prefix Solicitation, Home Test</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">       Init, Care-of Test Init or Binding Update for which it expects a</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">       response, the mobile node has to determine a value for the initial</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">       retransmission timer:*/</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// check if there already exists a testInitTimer entry for this key</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordtype">int</span> msgType;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span> (dynamicPtrCast&lt;HomeTestInit&gt;(testInit))</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        msgType = <a class="code" href="x_m_i_pv6_8h.html#adcada2b7eb8c57d6d0bc54652ebcab60">KEY_HI</a>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        msgType = <a class="code" href="x_m_i_pv6_8h.html#a9df5bb95d260beb5f652e9402cac9297">KEY_CI</a>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="comment">// TODO refactor the code below, as it is also used in createBUTimer</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(dest, ie-&gt;getInterfaceId(), msgType);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// fetch a valid TimerIfEntry object</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    TestInitTransmitIfEntry *tiIfEntry = check_and_cast&lt;TestInitTransmitIfEntry *&gt;(<a class="code" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry</a>(key, <a class="code" href="x_m_i_pv6_8h.html#a20b9fca9c2e9560c3645aab624763b6a">TRANSMIT_TYPE_TI</a>));</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">//    delete tiIfEntry-&gt;testInitMsg;</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    cancelAndDelete(tiIfEntry-&gt;timer);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    tiIfEntry-&gt;timer = testInitTriggerMsg;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    tiIfEntry-&gt;dest = dest;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    tiIfEntry-&gt;ifEntry = ie;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    tiIfEntry-&gt;testInitMsg = testInit;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">/*o  Otherwise, the mobile node should use the specified value of</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">           INITIAL_BINDACK_TIMEOUT for the initial retransmission timer.*/</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    tiIfEntry-&gt;ackTimeout = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getInitialBindAckTimeout();</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    tiIfEntry-&gt;nextScheduledTime = simTime(); <span class="comment">// we send the HoTI/CoTI now</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    testInitTriggerMsg-&gt;setContextPointer(tiIfEntry); <span class="comment">// attach the Test Init If Entry to this message</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// scheduling a message which will trigger the Test Init for sendTime seconds</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// if not called with a parameter for sendTime, the message will be scheduled for NOW</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    scheduleAfter(sendTime, testInitTriggerMsg);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">createAndSendCoTIMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">createAndSendHoTIMessage()</a>.</p>

</div>
</div>
<a id="a5e84b0c9d17cc2b04d68774f71b8e168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e84b0c9d17cc2b04d68774f71b8e168">&#9670;&nbsp;</a></span>createTokenEntryExpiryTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::createTokenEntryExpiryTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>cnAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>scheduledTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tokenType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates or overwrites a timer for {home, care-of} keygen token expiry that fires at provided scheduledTime. </p>
<p>Parameter tokenType is provided as KEY_XTOKEN_EXP </p>
<div class="fragment"><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;{</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    cMessage *tokenExpiryMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;TokenEntryExpiry&quot;</span>, <a class="code" href="x_m_i_pv6_8cc.html#a7ddbba5f6ade92d237a18c29e3cc37a5">MK_TOKEN_EXPIRY</a>);</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160; </div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(cnAddr, ie-&gt;getInterfaceId(), tokenType);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="comment">// fetch a valid TimerIfEntry obect</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    TokenExpiryIfEntry *tokenExpIfEntry = check_and_cast&lt;TokenExpiryIfEntry *&gt;(<a class="code" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry</a>(key, <a class="code" href="x_m_i_pv6_8h.html#a7df6fa8bbe83e775550d6f56a3508480">EXPIRY_TYPE_TOKEN</a>));</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160; </div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    tokenExpIfEntry-&gt;cnAddr = cnAddr;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    tokenExpIfEntry-&gt;ifEntry = ie;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    tokenExpIfEntry-&gt;timer = tokenExpiryMsg;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160; </div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    tokenExpIfEntry-&gt;tokenType = tokenType;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    tokenExpiryMsg-&gt;setContextPointer(tokenExpIfEntry);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    scheduleAt(scheduledTime, tokenExpiryMsg);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Scheduled token expiry for time &quot;</span> &lt;&lt; scheduledTime &lt;&lt; <span class="stringliteral">&quot;s&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7236c0fa0b79504eb59ac9d6281912c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7236c0fa0b79504eb59ac9d6281912c">&#9670;&nbsp;</a></span>fetchBUTransmitIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_bu_transmit_if_entry.html">xMIPv6::BuTransmitIfEntry</a> * inet::xMIPv6::fetchBUTransmitIfEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method takes an interface and a destination address and returns the appropriate IfEntry for an BU. </p>
<p>Is supposed to be used until the valid BA is received for the respective BU. </p>
<div class="fragment"><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;{</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// TODO use STL search algorithm</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (BuTransmitIfEntry *buIfEntry = <span class="keyword">dynamic_cast&lt;</span>BuTransmitIfEntry *<span class="keyword">&gt;</span>(elem.second)) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">if</span> (buIfEntry-&gt;ifEntry-&gt;getInterfaceId() == ie-&gt;getInterfaceId() &amp;&amp; buIfEntry-&gt;dest == dest)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="keywordflow">return</span> buIfEntry;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a654465e95bd0340136b7d9b4aa2b3b83">updateBUL()</a>.</p>

</div>
</div>
<a id="aac12220d4e76973d65d6ec017082cccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac12220d4e76973d65d6ec017082cccb">&#9670;&nbsp;</a></span>getTimerIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">xMIPv6::TimerIfEntry</a> * inet::xMIPv6::getTimerIfEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinet_1_1x_m_i_pv6_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timerType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a pointer to an <a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html" title="The base class for all other timers that are used for retransmissions.">TimerIfEntry</a> object identified by the provided key, which can be one of the possible polymorphic types. </p>
<p>In case there does not yet exist such an entry, a new one is created. The type of the <a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html" title="The base class for all other timers that are used for retransmissions.">TimerIfEntry</a> is specified with the provided timerType. </p>
<div class="fragment"><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;{</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    TimerIfEntry *ifEntry;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keyword">auto</span> pos = <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.find(key);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keywordflow">if</span> (pos != <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.end()) {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        <span class="comment">// there already exists an unACKed retransmission timer for that entry</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        <span class="comment">// -&gt; overwrite the old with the new one</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">if</span> (TestInitTransmitIfEntry *testInitIfEntry = <span class="keyword">dynamic_cast&lt;</span>TestInitTransmitIfEntry *<span class="keyword">&gt;</span>(pos-&gt;second)) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            cancelAndDelete(testInitIfEntry-&gt;timer); <span class="comment">// delete the corresponding timer</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            testInitIfEntry-&gt;testInitMsg = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; </div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            ifEntry = testInitIfEntry;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        }</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (BuTransmitIfEntry *buIfEntry = <span class="keyword">dynamic_cast&lt;</span>BuTransmitIfEntry *<span class="keyword">&gt;</span>(pos-&gt;second)) {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            cancelAndDelete(buIfEntry-&gt;timer); <span class="comment">// delete the corresponding timer</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            ifEntry = buIfEntry;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (BulExpiryIfEntry *bulExpIfEntry = <span class="keyword">dynamic_cast&lt;</span>BulExpiryIfEntry *<span class="keyword">&gt;</span>(pos-&gt;second)) {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            cancelAndDelete(bulExpIfEntry-&gt;timer); <span class="comment">// delete the corresponding timer</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            ifEntry = bulExpIfEntry;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (BcExpiryIfEntry *bcExpIfEntry = <span class="keyword">dynamic_cast&lt;</span>BcExpiryIfEntry *<span class="keyword">&gt;</span>(pos-&gt;second)) {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            cancelAndDelete(bcExpIfEntry-&gt;timer); <span class="comment">// delete the corresponding timer</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            ifEntry = bcExpIfEntry;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        }</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TokenExpiryIfEntry *tokenExpIfEntry = <span class="keyword">dynamic_cast&lt;</span>TokenExpiryIfEntry *<span class="keyword">&gt;</span>(pos-&gt;second)) {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            cancelAndDelete(tokenExpIfEntry-&gt;timer); <span class="comment">// delete the corresponding timer</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            tokenExpIfEntry-&gt;timer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            ifEntry = tokenExpIfEntry;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Expected a subclass of TimerIfEntry!&quot;</span>);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        ifEntry-&gt;timer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    }</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="comment">// we do not yet have an entry -&gt; create a new one</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        <span class="keywordflow">switch</span> (timerType) {</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="x_m_i_pv6_8h.html#a0d624c2f873e2272de302d17053f4604">TRANSMIT_TYPE_BU</a>:</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                ifEntry = <span class="keyword">new</span> BuTransmitIfEntry();</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="x_m_i_pv6_8h.html#a20b9fca9c2e9560c3645aab624763b6a">TRANSMIT_TYPE_TI</a>:</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                ifEntry = <span class="keyword">new</span> TestInitTransmitIfEntry();</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="x_m_i_pv6_8h.html#a98fdcdc01bf5f67610cbd3fcd05537e4">EXPIRY_TYPE_BUL</a>:</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                ifEntry = <span class="keyword">new</span> BulExpiryIfEntry();</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="x_m_i_pv6_8h.html#a87382a94f6c41d4075454d079de8cb8b">EXPIRY_TYPE_BC</a>:</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                ifEntry = <span class="keyword">new</span> BcExpiryIfEntry();</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="x_m_i_pv6_8h.html#a7df6fa8bbe83e775550d6f56a3508480">EXPIRY_TYPE_TOKEN</a>:</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                ifEntry = <span class="keyword">new</span> TokenExpiryIfEntry();</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Expected a valid TimerIfEntry type!&quot;</span>);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        }</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        ifEntry-&gt;timer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        ifEntry-&gt;ifEntry = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.insert(std::make_pair(key, ifEntry));</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160; </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordflow">return</span> ifEntry;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a3b2d65f8a5b0013ea96df343a38c2ca9">createBCEntryExpiryTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a3ad7b618b1a010c573144042abf04d4b">createBULEntryExpiryTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aa8846ee7ce22eeab2e24cd4f659634b7">createTestInitTimer()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a5e84b0c9d17cc2b04d68774f71b8e168">createTokenEntryExpiryTimer()</a>.</p>

</div>
</div>
<a id="a89306a1cc392ba98bf0fc8f83806a7a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89306a1cc392ba98bf0fc8f83806a7a8">&#9670;&nbsp;</a></span>handleBCExpiry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::handleBCExpiry </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles the expiry of a BC entry. </p>
<p>Entry is removed from BC and tunnels/routing paths are destroyed. </p>
<div class="fragment"><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;{</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="comment">/*10.3.1</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">       The home agent MAY further decrease the specified lifetime for the</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">       binding, for example based on a local policy.  The resulting</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">       lifetime is stored by the home agent in the Binding Cache entry,</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment">       and this Binding Cache entry MUST be deleted by the home agent</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment">       after the expiration of this lifetime.*/</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <span class="comment">/*9.5.2</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment">       Any Binding Cache entry MUST be deleted after the expiration of its lifetime.*/</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;BC entry has expired - removing entry and associated structures...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    BcExpiryIfEntry *bcExpIfEntry = (BcExpiryIfEntry *)msg-&gt;getContextPointer(); <span class="comment">// detaching the corresponding bulExpIfEntry pointer</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    ASSERT(bcExpIfEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="comment">// remove binding from BC</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;deleteEntry(bcExpIfEntry-&gt;HoA);</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160; </div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="comment">// and remove the tunnel</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelFromTrigger(bcExpIfEntry-&gt;HoA);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="comment">// and remove entry from list</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(bcExpIfEntry-&gt;dest, bcExpIfEntry-&gt;ifEntry-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a809adcc4f8be4ebac2a6467d645e79cc">KEY_BC_EXP</a>);</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <span class="comment">// deletion of the message already takes place in the cancelTimerIfEntry(.., KEY_BC_EXP);</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160; </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="comment">// TODO</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <span class="comment">// in the future we might send a Binding Refresh Request shortly before the expiration of the BCE</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a06985160c711bec7d2c91ff06a4574a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06985160c711bec7d2c91ff06a4574a0">&#9670;&nbsp;</a></span>handleBULExpiry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::handleBULExpiry </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles the situation of a BUL expiry. </p>
<p>Either a BU is sent in advance for renewal or the BUL entry is removed. </p>
<div class="fragment"><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;{</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">       Also, if the mobile node wants the services of the home agent beyond</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment">       the current registration period, the mobile node should send a new</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment">       Binding Update to it well before the expiration of this period, even</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">       if it is not changing its primary care-of address.*/</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    BulExpiryIfEntry *bulExpIfEntry = (BulExpiryIfEntry *)msg-&gt;getContextPointer(); <span class="comment">// detaching the corresponding bulExpIfEntry pointer</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    ASSERT(bulExpIfEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160; </div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="comment">// we fetch the BUL entry that belongs to this expiration timer</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    BindingUpdateList::BindingUpdateListEntry *entry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(bulExpIfEntry-&gt;dest);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    ASSERT(entry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160; </div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="comment">// A timer usually can appear for two times:</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="comment">// 1. Entry is shortly before expiration -&gt; send new BU</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="comment">// 2. Entry expired -&gt; remove</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="keywordflow">if</span> (simTime() &lt; entry-&gt;bindingExpiry) {</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;BUL entry about to expire - creating new BU timer...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        <span class="comment">// we have to store the pointer to the InterfaceIdentifier as the BUL expiry timer</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="comment">// will be canceled/deleted by createBUTimer(...)</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        NetworkInterface *ie = bulExpIfEntry-&gt;ifEntry;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160; </div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="comment">// send new BU</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        <span class="comment">// we immediately create a new BU transmission timer for BU to HA</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="comment">// but we only trigger BU creation for transmission to CN</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        <span class="keywordflow">if</span> (bulExpIfEntry-&gt;dest == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress())</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a>(bulExpIfEntry-&gt;dest, bulExpIfEntry-&gt;ifEntry);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            BindingUpdateList::BindingUpdateListEntry *entry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(bulExpIfEntry-&gt;dest);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN</a>(*entry, ie);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        }</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160; </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="comment">// we reschedule the expiration timer for expiry time</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Resetting expiry timer... &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a3ad7b618b1a010c573144042abf04d4b">createBULEntryExpiryTimer</a>(entry, ie, entry-&gt;bindingExpiry);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <span class="comment">// ...and that&#39;s it.</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        <span class="comment">// createBUTimer will take care of cancelling/overwriting the current BU timer.</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        <span class="comment">// As soon as we receive a valid BA to this BU the BUL expiry timer will be reset.</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    }</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;BUL entry has expired - removing entry and associated structures...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        <span class="comment">// TODO group everything from below in a purgeMobilityState() method</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160; </div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        entry-&gt;state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa84718d3bdca6a089024544c71a52f10a">BindingUpdateList::NONE</a>;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        <span class="comment">// remove binding</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;removeBinding(bulExpIfEntry-&gt;dest);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; </div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <span class="comment">// remove all timers</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="keywordtype">int</span> interfaceID = bulExpIfEntry-&gt;ifEntry-&gt;getInterfaceId();</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries</a>(bulExpIfEntry-&gt;dest, interfaceID);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <span class="comment">// destroy tunnel</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnel(bulExpIfEntry-&gt;CoA, bulExpIfEntry-&gt;dest);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; </div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <span class="comment">// and remove entry from list</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(bulExpIfEntry-&gt;dest, interfaceID, <a class="code" href="x_m_i_pv6_8h.html#a2e23b242b95346bc5d29584bd925bc05">KEY_BUL_EXP</a>);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160; </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="comment">// deletion of the message already takes place in the cancelTimerIfEntry(.., KEY_BUL_EXP);</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">//        delete msg;</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    }</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a11cc72f90b08c18df3fdcedcc34cdc79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11cc72f90b08c18df3fdcedcc34cdc79">&#9670;&nbsp;</a></span>handleMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;isSelfMessage()) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Self message received!\n&quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="x_m_i_pv6_8cc.html#a8af2291e8f5d6f16d0aec604205421be">MK_SEND_PERIODIC_BU</a>) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Periodic BU Timeout Message Received\n&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a41dfe546eaa52dd2544407b80b044bec">sendPeriodicBU</a>(msg);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="x_m_i_pv6_8cc.html#aaec02cdb37c69443949e6e975dbf7d6b">MK_SEND_PERIODIC_BR</a>) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Periodic BRR Timeout Message Received\n&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a746a045b4475430db6fb1ebcb7b7898b">sendPeriodicBRR</a>(msg);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="x_m_i_pv6_8cc.html#af382622c53488bb0595890e966927e4b">MK_SEND_TEST_INIT</a>) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;HoTI/CoTI Timeout Message Received\n&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a259fe47417bf0168de80810b5137ca5c">sendTestInit</a>(msg);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="x_m_i_pv6_8cc.html#a6d95ac743e8277891cc1093a62ab9f18">MK_BUL_EXPIRY</a>) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;BUL Expiry Timeout Message Received\n&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry</a>(msg);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="x_m_i_pv6_8cc.html#a2c62677bd8273d2af6b5c1fee292a11c">MK_BC_EXPIRY</a>) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;BUL Expiry Timeout Message Received\n&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">handleBCExpiry</a>(msg);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="x_m_i_pv6_8cc.html#a7ddbba5f6ade92d237a18c29e3cc37a5">MK_TOKEN_EXPIRY</a>) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;RR token expired&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">handleTokenExpiry</a>(msg);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unrecognized Timer&quot;</span>); <span class="comment">// stops sim w/ error msg.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// if its a MIPv6 related mobility message</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keyword">auto</span> packet = check_and_cast&lt;Packet *&gt;(msg);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a>&gt;()-&gt;getProtocol() == &amp;<a class="code" href="classinet_1_1_protocol.html#a707bff4e89896d905d9f65b25554219a">Protocol::mobileipv6</a>) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot; Received MIPv6 related message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage</a>(packet);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">// CB on 29.08.07</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// normal datagram with an extension header</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> packet = <span class="keyword">dynamic_cast&lt;</span>Packet *<span class="keyword">&gt;</span>(msg)) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            Ipv6ExtensionHeader *eh = (Ipv6ExtensionHeader *)packet-&gt;getContextPointer();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">auto</span> rh = <span class="keyword">dynamic_cast&lt;</span>Ipv6RoutingHeader *<span class="keyword">&gt;</span>(eh))</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a74c931b057a65aac096b01ddfdf28450">processType2RH</a>(packet, rh);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> hao = <span class="keyword">dynamic_cast&lt;</span>HomeAddressOption *<span class="keyword">&gt;</span>(eh))</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a3c68a093ad4a7f05896c4393d23c5fe0">processHoAOpt</a>(packet, hao);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unknown Extension Header.&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unknown message type received.&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a15750da5e4a84c0798ecc2b69a278b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a15750da5e4a84c0798ecc2b69a278b">&#9670;&nbsp;</a></span>handleTokenExpiry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::handleTokenExpiry </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles the event that indicates that a {care-of,home} keygen token has expired. </p>
<div class="fragment"><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;{</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    TokenExpiryIfEntry *tokenExpIfEntry = (TokenExpiryIfEntry *)msg-&gt;getContextPointer(); <span class="comment">// detaching the corresponding tokenExpIfEntry pointer</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    ASSERT(tokenExpIfEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160; </div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    <span class="keywordflow">if</span> (tokenExpIfEntry-&gt;tokenType == <a class="code" href="x_m_i_pv6_8h.html#a5cf5e9f044204fd03467f018a646d2bc">KEY_CTOKEN_EXP</a>) {</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Care-of keygen token for CN=&quot;</span> &lt;&lt; tokenExpIfEntry-&gt;cnAddr &lt;&lt; <span class="stringliteral">&quot; expired&quot;</span>;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;resetCareOfToken(tokenExpIfEntry-&gt;cnAddr, tokenExpIfEntry-&gt;ifEntry-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMNHomeAddress());</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    }</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tokenExpIfEntry-&gt;tokenType == <a class="code" href="x_m_i_pv6_8h.html#aff85ca708ac4d725a050c595514f9a5e">KEY_HTOKEN_EXP</a>) {</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Home keygen token for CN=&quot;</span> &lt;&lt; tokenExpIfEntry-&gt;cnAddr &lt;&lt; <span class="stringliteral">&quot; expired&quot;</span>;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;resetHomeToken(tokenExpIfEntry-&gt;cnAddr, tokenExpIfEntry-&gt;ifEntry-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMNHomeAddress());</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    }</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unkown value for tokenType!&quot;</span>);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;...removed token from BUL.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160; </div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getMobilityState(tokenExpIfEntry-&gt;cnAddr) == <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa46341e593269699821a9c10251bedd0f">BindingUpdateList::RR_COMPLETE</a>)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;setMobilityState(tokenExpIfEntry-&gt;cnAddr, <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa053a5e941d65556e86631a96d25b24c8">BindingUpdateList::RR</a>);</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(tokenExpIfEntry-&gt;cnAddr, tokenExpIfEntry-&gt;ifEntry-&gt;getInterfaceId(), tokenExpIfEntry-&gt;tokenType);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <span class="comment">// and now send a Test Init message to retrieve a new token</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <span class="keywordflow">if</span> (tokenExpIfEntry-&gt;tokenType == <a class="code" href="x_m_i_pv6_8h.html#a5cf5e9f044204fd03467f018a646d2bc">KEY_CTOKEN_EXP</a>)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">createAndSendCoTIMessage</a>(tokenExpIfEntry-&gt;cnAddr, tokenExpIfEntry-&gt;ifEntry);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">createAndSendHoTIMessage</a>(tokenExpIfEntry-&gt;cnAddr, tokenExpIfEntry-&gt;ifEntry);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="comment">//    delete msg;</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a0cb2922fe72da5551377c29bdc8264df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb2922fe72da5551377c29bdc8264df">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    cSimpleModule::initialize(stage);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (stage == <a class="code" href="namespaceinet.html#a6be747ab6f195055e109f27f8462e52e">INITSTAGE_LOCAL</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        EV_TRACE &lt;&lt; <span class="stringliteral">&quot;Initializing xMIPv6 module&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">/*statVectorBUtoHA.setName(&quot;BU to HA&quot;);</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">           statVectorBUtoCN.setName(&quot;BU to CN&quot;);</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">           statVectorBUtoMN.setName(&quot;BU to MN&quot;);</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">           statVectorBAtoMN.setName(&quot;BA to MN&quot;);</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">           statVectorBAfromHA.setName(&quot;BA from HA&quot;);</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">           statVectorBAfromCN.setName(&quot;BA from CN&quot;);</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">           statVectorHoTItoCN.setName(&quot;HoTI to CN&quot;);</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">           statVectorCoTItoCN.setName(&quot;CoTI to CN&quot;);</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">           statVectorHoTtoMN.setName(&quot;HoT to MN&quot;);</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">           statVectorCoTtoMN.setName(&quot;CoT to MN&quot;);</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">           statVectorHoTfromCN.setName(&quot;HoT from CN&quot;);</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">           statVectorCoTfromCN.setName(&quot;CoT from CN&quot;);*/</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;ipv6TunnelingModule&quot;</span>, <span class="keyword">true</span>); <span class="comment">// access to tunneling module</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// moved rt6 initialization to here, as we should</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">// set the MIPv6 flag as soon as possible for use</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">// with other modules.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        cModule *host = <a class="code" href="namespaceinet.html#a066c281a0963fccbbe766aac35a28ad6">getContainingNode</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a> = L3AddressResolver().getIpv6RoutingTableOf(host);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;setIsMobileNode(par(<span class="stringliteral">&quot;isMobileNode&quot;</span>));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;setMipv6Support(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;setIsHomeAgent(par(<span class="stringliteral">&quot;isHomeAgent&quot;</span>));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage == <a class="code" href="namespaceinet.html#aab979c9efb63d1d231bf289a119eb88e">INITSTAGE_NETWORK_LAYER</a>) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;interfaceTableModule&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a1df03c81b24aa899e6f71b02f997d3d8">ipv6nd</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;ipv6NeighbourDiscoveryModule&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isMobileNode()) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;bindingUpdateListModule&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>.reference(<span class="keyword">this</span>, <span class="stringliteral">&quot;bindingCacheModule&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        WATCH_VECTOR(<a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        WATCH_MAP(<a class="code" href="classinet_1_1x_m_i_pv6.html#a026f43021a6cb4663eebbdf430a51a08">interfaceCoAList</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ba3092ea3088e56f1fd80e2e5ddb038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ba3092ea3088e56f1fd80e2e5ddb038">&#9670;&nbsp;</a></span>initiateMipv6Protocol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::initiateMipv6Protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>CoA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates the Mobile IP protocol. </p>
<p>Method to be used when we have moved to a new access network and the new CoA is available for that interface. </p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;initiateMipv6Protocol&quot;</span>); <span class="comment">// can be called by NeighborDiscovery module</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (!(ie-&gt;isLoopback()) &amp;&amp; <a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isMobileNode()) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Initiating Mobile Ipv6 protocol...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// The MN is supposed to send a BU to the HA after forming a CoA</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        Ipv6Address haDest = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress(); <span class="comment">// HA address for use in the BU for Home Registration</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a>(haDest, ie);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">// RO with CNs is triggered after receiving a valid BA from the HA</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// a movement occured -&gt; BUL entries for CNs not valid anymore</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    Ipv6Address HoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMNHomeAddress();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> cn : <a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>) { <span class="comment">// run an iterator through the CN map</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;fetch(cn);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        ASSERT(bulEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//        bul-&gt;resetBindingCacheEntry(*bulEntry, HoA);</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;removeBinding(cn); <span class="comment">//FIXME need revision: this function sometimes remove the entry from bul, and bul-&gt;resetCareOfToken(cn, HoA) creates assert</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// care-of token becomes invalid with new CoA</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;resetCareOfToken(cn, HoA);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelForExitAndTrigger(HoA, cn);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afef82a8cb41eadd8263f9a1878a1b07c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef82a8cb41eadd8263f9a1878a1b07c">&#9670;&nbsp;</a></span>initReturnRoutability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::initReturnRoutability </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>cnDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates HoTI and CoTI messages and sends them to the CN if timers are not already existing. </p>
<p>If home and care-of tokens are already available a BU is directly sent to the CN. </p>
<div class="fragment"><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;{</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    EV_TRACE &lt;&lt; <span class="stringliteral">&quot;Initiating Return Routability...\n&quot;</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;initReturnRoutability()&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordtype">bool</span> sendHoTI = <span class="keyword">true</span>, sendCoTI = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">/*11.6.1</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">       A mobile node that initiates a return routability procedure MUST send</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">       (in parallel) a Home Test Init message and a Care-of Test Init</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">       messages. However, if the mobile node has recently received (see</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">       Section 5.2.7) one or both home or care-of keygen tokens, and</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">       associated nonce indices for the desired addresses, it MAY reuse</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">       them.  Therefore, the return routability procedure may in some cases</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">       be completed with only one message pair.  It may even be completed</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">       without any messages at all, if the mobile node has a recent home</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">       keygen token and has previously visited the same care-of address so</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">       that it also has a recent care-of keygen token.*/</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    BindingUpdateList::BindingUpdateListEntry *cnEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;fetch(cnDest);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    ASSERT(cnEntry);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    cnEntry-&gt;state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa053a5e941d65556e86631a96d25b24c8">BindingUpdateList::RR</a>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">/*A Home Test Init message MUST be created as described in Section</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">       6.1.3.*/</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">//if (cnEntry != nullptr)</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">//{</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">// if there exists an entry in the BUL, check whether we already</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">// have valid home and care-of tokens</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// check whether the last received home token is still valid</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">//if ((cnEntry-&gt;tokenH != UNDEFINED_TOKEN) &amp;&amp; (cnEntry-&gt;sentHoTI + ie-&gt;ipv6()-&gt;_maxTokenLifeTime() &gt; simTime()))</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isHomeTokenAvailable(cnDest, ie)) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Valid home token available - sending HoTI later.\n&quot;</span>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        sendHoTI = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">//else</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">//       delete HoTI;</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">/*if ((cnEntry-&gt;tokenC != UNDEFINED_TOKEN) &amp;&amp; (cnEntry-&gt;sentCoTI + ie-&gt;ipv6()-&gt;_maxTokenLifeTime() &gt; simTime()))*/</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isCareOfTokenAvailable(cnDest, ie)) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Valid care-of token available - sending CoTI later.\n&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="comment">// we already have a care-of token</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        sendCoTI = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">//else</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">//       delete CoTI;</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> (!sendHoTI &amp;&amp; !sendCoTI) { <span class="comment">// cnEntry can not be nullptr as a consequence of the other two flag&#39;s values</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="comment">// we already had a valid home and care-of token</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="comment">// -&gt; no need for sending HoTI/CoTI; we can</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="comment">// immediately continue with sending a BU</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        cnEntry-&gt;state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa46341e593269699821a9c10251bedd0f">BindingUpdateList::RR_COMPLETE</a>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">sendBUtoCN</a>(*cnEntry, ie);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> (sendHoTI &amp;&amp; !<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;recentlySentHOTI(cnDest, ie)) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="comment">// no entry for this CN available: create Home Test Init message to be sent via HA</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">createAndSendHoTIMessage</a>(cnDest, ie);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">if</span> (sendCoTI &amp;&amp; !<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;recentlySentCOTI(cnDest, ie)) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="comment">/*A Care-of Test Init message MUST be created as described in Section</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">           6.1.4.*/</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="comment">// Care-of Test Init Message to CN</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">createAndSendCoTIMessage</a>(cnDest, ie);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">processBRRMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization()</a>.</p>

</div>
</div>
<a id="a05e33263c7c32c6f63518dd0f584d598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e33263c7c32c6f63518dd0f584d598">&#9670;&nbsp;</a></span>numInitStages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int inet::xMIPv6::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="_init_stage_registry_8h.html#a6dec686281914f336c1b4dcafdbcf9df">NUM_INIT_STAGES</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b83360b05ab5929bcb83d008b29a959"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b83360b05ab5929bcb83d008b29a959">&#9670;&nbsp;</a></span>pendingTimerIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::pendingTimerIfEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>msgType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether there exists an TransmitIfEntry for the specified values. </p>
<p>In case a new TODOTimerIfEntry is added, this method has to be appropriately extended in order to cover the new data structure. Returns true on success and false otherwise. </p>
<div class="fragment"><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;{</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(dest, interfaceID, msgType);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="comment">// return true if there is an entry</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="comment">// and false otherwise</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceinet.html#afa2cbc698a7f3cbd0f837d5b97a82733">containsKey</a>(<a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>, key);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aee11505f04fbd42fba6714da2c4a7c4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee11505f04fbd42fba6714da2c4a7c4d">&#9670;&nbsp;</a></span>processBAMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processBAMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_binding_acknowledgement.html">BindingAcknowledgement</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ba</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the received BA and creates tunnels or mobility header paths if appropriate. </p>
<p>11.5.1 After updating its home registration, the mobile node then updates associated mobility bindings in correspondent nodes that it is performing route optimization with as specified in Section 11.7.2.</p>
<div class="fragment"><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;{</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    EV_TRACE &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;This is where BA gets processed&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">//    bool retransmitBU = false;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    Ipv6Address baSource = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keyword">auto</span> ifTag = inPacket-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(ifTag-&gt;getInterfaceId()); <span class="comment">// the interface on which the BAck was received</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isMobileNode()) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a4ea0a5a74761087a91035347e406773e">validateBAck</a>(inPacket, *ba)) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Discarding invalid BAck...\n&quot;</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="comment">/*if (baSource == ie-&gt;ipv6()-&gt;getHomeAgentAddress())</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">                statVectorBAfromHA.record(3);</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">               else</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">                statVectorBAfromCN.record(3);*/</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">/*11.7.3</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">           When a mobile node receives a packet carrying a valid Binding</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">           Acknowledgement, the mobile node MUST examine the Status field as</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">           follows:</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">           o  If the Status field indicates that the Binding Update was accepted</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">             (the Status field is less than 128), then the mobile node MUST</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">             update the corresponding entry in its Binding Update List to</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">             indicate that the Binding Update has been acknowledged; the mobile</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">             node MUST then stop retransmitting the Binding Update.*/</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">if</span> (ba-&gt;getStatus() &lt; 128) {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Binding was accepted.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="comment">// As the BU is obviously valid, we can remove the transmission timer for BU</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(baSource, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a>);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordflow">if</span> (ba-&gt;getLifetime() == 0) { <span class="comment">// BAck to deregistration BU</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                <span class="keywordflow">if</span> (baSource == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress()) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    <span class="comment">/*11.5.4</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">                       After receiving the Binding Acknowledgement for its Binding Update to</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">                         its home agent, the mobile node MUST multicast onto the home link (to</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">                         the all-nodes multicast address) a Neighbor Advertisement [12], to</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">                         advertise the mobile node&#39;s own link-layer address for its own home</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">                         address.*/</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1df03c81b24aa899e6f71b02f997d3d8">ipv6nd</a>-&gt;sendUnsolicitedNa(ie);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    <span class="comment">/*statVectorBAfromHA.record(2);*/</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                <span class="comment">/*else</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">                    statVectorBAfromCN.record(2);*/</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <span class="comment">// delete the entry from the BUL</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;removeBinding(baSource);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                <span class="comment">// remove all timers related to this BA address</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries</a>(baSource, ifTag-&gt;getInterfaceId());</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            }</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                <span class="comment">// binding with lifeTime &gt;0 was accepted</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                <span class="comment">// moved the code below from sendBU()</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                <span class="comment">// retrieve the appropriate BUL entry</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                BindingUpdateList::BindingUpdateListEntry *entry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(baSource);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                ASSERT(entry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                <span class="comment">// establish tunnel, but only if we have not already acked the BU before</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                <span class="keywordflow">if</span> (entry-&gt;BAck == <span class="keyword">false</span> &amp;&amp; entry-&gt;destAddress == ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress()) { <span class="comment">// BA from HA</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b6778cff1888b1f98f487f7a5ef4151">removeCoAEntries</a>(); <span class="comment">// TODO would be better if this is done somewhere else or in a comletely different way</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a026f43021a6cb4663eebbdf430a51a08">interfaceCoAList</a>[ie-&gt;getInterfaceId()] = entry-&gt;careOfAddress;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;createTunnel(<a class="code" href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653aff5a78e380abfeeab2394d344a4893d0">Ipv6Tunneling::NORMAL</a>, entry-&gt;careOfAddress, entry-&gt;destAddress);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">//                    bubble(&quot;Established tunnel to home agent.&quot;);</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    <span class="comment">// initiate RR for the CNs</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a> = <a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>.begin(); <a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a> != <a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>.end(); <a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>++) { <span class="comment">// run an iterator through the CN map</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        Ipv6Address&amp; cnDest = *(<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">//                        entry-&gt;state = BindingUpdateList::RR;</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                        <span class="comment">//if (!bul-&gt;isValidBinding(cnDest)) // to initiate HoTI/CoTI resending</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                        <a class="code" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization</a>(cnDest, ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMNHomeAddress(), ie);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                    <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                    <span class="comment">/*statVectorBAfromHA.record(1);*/</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry-&gt;BAck == <span class="keyword">false</span>) { <span class="comment">// BA from CN</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelForExitAndTrigger(entry-&gt;homeAddress, baSource);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;createTunnel(<a class="code" href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653a36bfb1806cc6b7f8c874ad8e066ec584">Ipv6Tunneling::HA_OPT</a>, entry-&gt;careOfAddress, entry-&gt;homeAddress, baSource);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">//                    tunneling-&gt;createPseudoTunnel(CoA, bu-&gt;getHomeAddressMN(), dest, TUNNEL_HA_OPT);</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">//                    bubble(&quot;Established Type 2 Routing Header path to CN.&quot;);</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                    <span class="comment">/*statVectorBAfromCN.record(1);*/</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                    <span class="comment">// fire event to MIH subscribers</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    emit(<a class="code" href="namespaceinet.html#a67ee3c1bb8f0b645969c7c67fd8da444">mipv6RoCompletedSignal</a>, (cObject *)<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                <span class="comment">// set BAck flag in BUL</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                entry-&gt;BAck = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                <span class="comment">// set mobility state in BUL</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                entry-&gt;state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa3e433ee51f9bf8834c7af27ce5614fe4">BindingUpdateList::REGISTERED</a>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                <span class="comment">/*11.7.3</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">                   In addition, if the value specified in the Lifetime field in the</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">                    Binding Acknowledgement is less than the Lifetime value sent in</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">                    the Binding Update being acknowledged, the mobile node MUST</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">                    subtract the difference between these two Lifetime values from the</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">                    remaining lifetime for the binding as maintained in the</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">                    corresponding Binding Update List entry (with a minimum value for</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">                    the Binding Update List entry lifetime of 0).  That is, if the</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">                    Lifetime value sent in the Binding Update was L_update, the</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">                    Lifetime value received in the Binding Acknowledgement was L_ack,</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">                    and the current remaining lifetime of the Binding Update List</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">                    entry is L_remain, then the new value for the remaining lifetime</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">                    of the Binding Update List entry should be</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">                      max((L_remain - (L_update - L_ack)), 0)</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">                    where max(X, Y) is the maximum of X and Y.*/</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                <span class="keywordtype">int</span> l_ack = ba-&gt;getLifetime() * 4; <span class="comment">/* 6.1.7 One time unit is 4 seconds. */</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                <span class="keywordtype">int</span> l_update = entry-&gt;bindingLifetime;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                <span class="keywordtype">int</span> l_remain = entry-&gt;bindingLifetime - (SIMTIME_DBL(simTime() - entry-&gt;sentTime));</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                <span class="keywordtype">int</span> x = l_remain - (l_update - l_ack);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                entry-&gt;bindingLifetime = x &gt; 0 ? x : 0;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                entry-&gt;bindingExpiry = simTime() + entry-&gt;bindingLifetime;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                <span class="comment">// we schedule the timer that manages the BUL entry expiration</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                <span class="comment">// TODO currently we schedule the expiry message some seconds (PRE_BINDING_EXPIRY)</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                <span class="comment">// before the actual expiration. Can be improved.</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                simtime_t scheduledTime = entry-&gt;bindingExpiry - <a class="code" href="_binding_update_list_8h.html#ad49473dc2c4ab3735385007aff5510ec">PRE_BINDING_EXPIRY</a>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                scheduledTime = scheduledTime &gt; 0 ? scheduledTime : 0;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                <span class="comment">/*EV &lt;&lt; &quot;l_ack=&quot; &lt;&lt; l_ack &lt;&lt; &quot;, l_update=&quot; &lt;&lt; l_update &lt;&lt; &quot;, l_remain=&quot; &lt;&lt; l_remain &lt;&lt; &quot;, x=&quot; &lt;&lt; x &lt;&lt; endl;</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">                   EV &lt;&lt; &quot;entry-&gt;bindingLifetime=&quot; &lt;&lt; entry-&gt;bindingLifetime &lt;&lt; &quot; and entry-&gt;bindingExpiry=&quot; &lt;&lt; entry-&gt;bindingExpiry &lt;&lt; endl;*/</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Scheduling BULEntryExpiryTimer for &quot;</span> &lt;&lt; scheduledTime &lt;&lt; endl;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a3ad7b618b1a010c573144042abf04d4b">createBULEntryExpiryTimer</a>(entry, ie, scheduledTime);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                <span class="comment">// 11.06.08 - CB: rescheduling changed. Handled by BUL entry expiry.</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="comment">/*// reschedule the message if the BA is from a CN and not from the HA</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">                   retransmitBU = (entry-&gt;destAddress != ie-&gt;ipv6()-&gt;getHomeAgentAddress());*/</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="comment">/*if (baSource == ie-&gt;ipv6()-&gt;getHomeAgentAddress())</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">                   {</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">                    // initiate RR for CNs moved to above</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">                   }*/</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="comment">/*o  If the Status field indicates that the Binding Update was rejected</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">             (the Status field is greater than or equal to 128), then the</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">             mobile node can take steps to correct the cause of the error and</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">             retransmit the Binding Update (with a new Sequence Number value),</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">             subject to the rate limiting restriction specified in Section</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">             11.8.  If this is not done or it fails, then the mobile node</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">             SHOULD record in its Binding Update List that future Binding</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">             Updates SHOULD NOT be sent to this destination.*/</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Binding was rejected.\n&quot;</span>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="comment">/*11.7.1</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">               If the home agent rejects the value, it sends back a</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">               Binding Acknowledgement with a status code 135, and the last accepted</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">               sequence number in the Sequence Number field of the Binding</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">               Acknowledgement.  The mobile node MUST store this information and use</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">               the next Sequence Number value for the next Binding Update it sends.*/</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="comment">// retransmission is performed anyway as timers are not deleted</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            <span class="comment">// TODO store DO_NOT_SEND_BU in BUL</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">// update 11.6.08 - CB: rescheduling of BU is now handled by BUL entry expiry</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">// for now, we delete the BU transmission timer irrelevant of the status of the BA</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">// TODO catch BA failure case</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">       int interfaceID = ctrlInfo-&gt;interfaceId();</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">       if (retransmitBU)</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">        resetBUIfEntry(baSource, interfaceID, retransmissionTime); // add bindingLifetime</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">       else</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">        cancelTransmitIfEntry(baSource, interfaceID, KEY_BU);</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="a30be4668a9f7a72be0723ea9052711b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30be4668a9f7a72be0723ea9052711b8">&#9670;&nbsp;</a></span>processBRRMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processBRRMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_binding_refresh_request.html">BindingRefreshRequest</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>brr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the Binding Refresh <a class="el" href="classinet_1_1_message.html">Message</a>. </p>
<div class="fragment"><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">/*11.7.4</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="comment">       When a mobile node receives a packet containing a Binding Refresh</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="comment">       Request message, the mobile node has a Binding Update List entry for</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment">       the source of the Binding Refresh Request, and the mobile node wants</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">       to retain its binding cache entry at the correspondent node, then the</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">       mobile node should start a return routability procedure.*/</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    Ipv6Address cnAddress = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    Ipv6Address HoA = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; </div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isInBindingUpdateList(cnAddress, HoA)) {</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;BRR not accepted - no binding for this CN. Dropping message.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, inPacket, &amp;details);</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        <span class="keyword">auto</span> ifTag = inPacket-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(ifTag-&gt;getInterfaceId());</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability</a>(cnAddress, ie);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    }</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160; </div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="a4c9e54de243910406aafc3553f6b9247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c9e54de243910406aafc3553f6b9247">&#9670;&nbsp;</a></span>processBUMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processBUMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>bu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process a BU - only applicable to HAs and CNs. </p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Entered BU processing method&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">/*if ((!rt6-&gt;isMobileNode() &amp;&amp; !rt6-&gt;isRouter() &amp;&amp; !rt6-&gt;isHomeAgent()) ||</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">         (rt6-&gt;isRouter() &amp;&amp; rt6-&gt;isHomeAgent() &amp;&amp; !rt6-&gt;isMobileNode())</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">       ) // if node is either HA or CN, only then a BA is sent otherwise not.</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// BA is not sent when node is a mobile node and not a HA at the same time</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isMobileNode() &amp;&amp; !<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent()) { <span class="comment">// rewrote condition to make it more clear - CB</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Wrong Node: not HA or CN&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">if</span> (hasGUI())</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            bubble(<span class="stringliteral">&quot;Wrong Node: not HA or CN&quot;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996f">BaStatus</a> status;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordtype">bool</span> validBUMessage = <a class="code" href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611">validateBUMessage</a>(inPacket, bu);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span> (validBUMessage) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keyword">auto</span> ifTag = inPacket-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keyword">auto</span> addrTag = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;();</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keyword">const</span> Ipv6Address&amp; HoA = bu-&gt;getHomeAddressMN();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        Ipv6Address CoA = addrTag-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        Ipv6Address destAddress = addrTag-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> buLifetime = bu-&gt;getLifetime() * 4; <span class="comment">/* 6.1.7 One time unit is 4 seconds. */</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> buSequence = bu-&gt;getSequence();</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordtype">bool</span> homeRegistration = bu-&gt;getHomeRegistrationFlag();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">// handling for binding de-registration</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">/*9.5.1</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">           If the Lifetime specified in the Binding Update is zero or the</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">           specified care-of address matches the home address for the</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">           binding, then this is a request to delete the cached binding for</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">           the home address. [...] If the Home Registration (H) bit is set</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">           in the Binding Update, the Binding Update is processed according</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">           to the procedure specified in Section 10.3.2; otherwise, it is</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">           processed according to the procedure specified in Section 9.5.3.*/</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">if</span> ((buLifetime == 0) || (CoA == HoA)) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="comment">// Check home registration flag -&gt; not much difference in Section 10.3.2 and 9.5.3 for our purpose</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="comment">// de-register binding</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent() &amp;&amp; !<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ea27a7d716da8d2643cc08569b305e7">validateBUderegisterMessage</a>(inPacket, bu)) { <span class="comment">// HAs have to validate the BU</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="comment">/* If the receiving node has no entry marked as a home registration</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">                   in its Binding Cache for this mobile node, then this node MUST</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">                   reject the Binding Update and SHOULD return a Binding</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">                   Acknowledgement to the mobile node, in which the Status field is</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">                   set to 133 (not home agent for this mobile node).*/</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                status = <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa8d4bba16bb8a54df72df11c34e67f4df">NOT_HA_FOR_THIS_MN</a>; <span class="comment">// enum defined in MobilityHeader.msg file</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> baSeqNumber = bu-&gt;getSequence(); <span class="comment">// the sequence number from Rxed BU is copied into BA.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(destAddress, CoA, ifTag-&gt;getInterfaceId(), status,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        bu-&gt;getBindingAuthorizationData(), baSeqNumber, buLifetime); <span class="comment">// swapped src and dest, update lifeTime</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                EV_ERROR &lt;&lt; <span class="stringliteral">&quot;Not HA for this MN. Responding with appropirate BA...\n&quot;</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="comment">/*9.5.3</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">               Any existing binding for the given home address MUST be deleted.  A</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">                 Binding Cache entry for the home address MUST NOT be created in</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">                 response to receiving the Binding Update.*/</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="comment">/*10.3.2</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">               If the home agent does not reject the Binding Update as described</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">                 above, then it MUST delete any existing entry in its Binding Cache</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">                 for this mobile node.*/</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;deleteEntry(HoA);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="comment">/*In addition, the home agent MUST stop intercepting packets on the</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">               mobile node&#39;s home link that are addressed to the mobile node*/</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="comment">// of course this is also true for CNs</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelFromTrigger(HoA);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="comment">// kill BC expiry timer</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(HoA, ifTag-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a809adcc4f8be4ebac2a6467d645e79cc">KEY_BC_EXP</a>);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="comment">/*10.3.2</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">               Then, the home agent MUST return a Binding Acknowledgement to the mobile node */</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="comment">/*9.5.4</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">               o  If the Acknowledge (A) bit set is set in the Binding Update, a</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">                Binding Acknowledgement MUST be sent.*/</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent() || bu-&gt;getAckFlag()) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                <span class="comment">/*constructed as follows:</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">                   o  The Status field MUST be set to a value 0, indicating success.*/</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                status = <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fad0939b5cde09ba00559e47c22e86ac02">BINDING_UPDATE_ACCEPTED</a>; <span class="comment">// enum defined in MobilityHeader.msg file</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="comment">/*o  The Sequence Number field MUST be copied from the Sequence Number</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">                    given in the Binding Update.*/</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> baSeqNumber = bu-&gt;getSequence();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="comment">/*o  The Lifetime field MUST be set to zero.*/</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime = 0;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="comment">/*//The following was omitted://</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">                   o  The Key Management Mobility Capability (K) bit is set or cleared</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">                    and actions based on its value are performed as described in the</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">                    previous section.  The mobile node&#39;s home address is used as its</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">                    new care-of address for the purposes of moving the key management</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">                    connection to a new endpoint.</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">                   o  The Binding Refresh Advice mobility option MUST be omitted.*/</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(destAddress, CoA, ifTag-&gt;getInterfaceId(), status, baSeqNumber,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        bu-&gt;getBindingAuthorizationData(), lifeTime); <span class="comment">// swapped src and dest</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent()) { <span class="comment">// this is a CN</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <span class="comment">// cancel existing Binding Refresh Request timer</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <span class="comment">// (if there exists one)</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="keywordtype">int</span> interfaceID = ifTag-&gt;getInterfaceId();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(HoA, interfaceID, <a class="code" href="x_m_i_pv6_8h.html#a12b4df7d7c310249eb01a4d0b0189b3b">KEY_BR</a>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Deregistered binding\n&quot;</span>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            bubble(<span class="stringliteral">&quot;Deregistered binding!&quot;</span>);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="comment">// binding lifetime is nonzero</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="comment">/*9.5.1</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">               If the Lifetime specified in the Binding Update is nonzero and the</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">               specified care-of address is not equal to the home address for the</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">               binding, then this is a request to cache a binding for the home</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">               address. If the Home Registration (H) bit is set in the Binding</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">               Update, the Binding Update is processed according to the procedure</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">               specified in Section 10.3.1; otherwise, it is processed according</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">               to the procedure specified in Section 9.5.2.*/</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="keywordflow">if</span> (homeRegistration) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="comment">/* 10.3.1</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">                   o  If the node implements only correspondent node functionality, or</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">                      has not been configured to act as a home agent, then the node MUST</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">                      reject the Binding Update.  The node MUST also return a Binding</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">                      Acknowledgement to the mobile node, in which the Status field is</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">                      set to 131 (home registration not supported).*/</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent()) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    status = <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996facc67630a2e7a36aae407bc4775cdaab2">HOME_REGISTRATION_NOT_SUPPORTED</a>; <span class="comment">// enum defined in MobilityHeader.msg file</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> baSeqNumber = bu-&gt;getSequence();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime = 0;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(destAddress, CoA, ifTag-&gt;getInterfaceId(), status, baSeqNumber,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                            bu-&gt;getBindingAuthorizationData(), lifeTime);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isOnLinkAddress(HoA)) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    <span class="comment">/*Else, if the home address for the binding (the Home Address field</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">                       in the packet&#39;s Home Address option) is not an on-link Ipv6</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">                       address with respect to the home agent&#39;s current Prefix List, then</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">                       the home agent MUST reject the Binding Update and SHOULD return a</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">                       Binding Acknowledgement to the mobile node, in which the Status</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">                       field is set to 132 (not home subnet).*/</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    status = <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa43b1bd4e64befbfb671272c812283134">NOT_HOME_SUBNET</a>; <span class="comment">// enum defined in MobilityHeader.msg file</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> baSeqNumber = bu-&gt;getSequence();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime = 0;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(destAddress, CoA, ifTag-&gt;getInterfaceId(), status, baSeqNumber,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                            bu-&gt;getBindingAuthorizationData(), lifeTime);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordtype">bool</span> existingBinding = <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;isInBindingCache(HoA);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;addOrUpdateBC(HoA, CoA, buLifetime, buSequence, homeRegistration);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="comment">// for both HA and CN we create a BCE expiry timer</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a3b2d65f8a5b0013ea96df343a38c2ca9">createBCEntryExpiryTimer</a>(HoA, <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(ifTag-&gt;getInterfaceId()), simTime() + buLifetime);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="comment">/*10.3.1</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">               Regardless of the setting of the Acknowledge (A) bit in the Binding</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">               Update, the home agent MUST return a Binding Acknowledgement to the</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">               mobile node*/</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="comment">/*9.5.4</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">               If the Acknowledge (A) bit set is set in the Binding Update, a</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">                Binding Acknowledgement MUST be sent.  Otherwise, the treatment</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">                depends on the below rule.*/</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">if</span> (bu-&gt;getAckFlag() || <a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent()) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="comment">/*10.3.1</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">                   The Status field MUST be set to a value indicating success.  The</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">                    value 1 (accepted but prefix discovery necessary) MUST be used if</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">                    the subnet prefix of the specified home address is deprecated, or</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">                    becomes deprecated during the lifetime of the binding, or becomes</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">                    invalid at the end of the lifetime.  The value 0 MUST be used</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">                    otherwise.  For the purposes of comparing the binding and prefix</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">                    lifetimes, the prefix lifetimes are first converted into units of</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">                    four seconds by ignoring the two least significant bits.*/</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                status = <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fad0939b5cde09ba00559e47c22e86ac02">BINDING_UPDATE_ACCEPTED</a>; <span class="comment">// enum defined in MobilityHeader.msg file</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <span class="comment">/*The Sequence Number field MUST be copied from the Sequence Number</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">                    given in the Binding Update.*/</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> baSeqNumber = bu-&gt;getSequence();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="comment">/*The Lifetime field MUST be set to the remaining lifetime for the</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">                   binding as set by the home agent in its home registration Binding</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">                   Cache entry for the mobile node, as described above.*/</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> lifeTime = <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;getLifetime(HoA);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <span class="comment">/* 10.3.1</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">                   Unless this home agent already has a binding for the given home</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">                   address, the home agent MUST perform Duplicate Address Detection [13]</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">                   on the mobile node&#39;s home link before returning the Binding</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">                   Acknowledgement.*/</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                simtime_t sendTime;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent())</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                    <span class="comment">// HA has to do DAD in case this is a new binding for this HoA</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                    sendTime = existingBinding ? 0 : 1;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                    sendTime = 0;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(destAddress, CoA, ifTag-&gt;getInterfaceId(), status, baSeqNumber,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">//                        bu-&gt;getBindingAuthorizationData(), 15, sendTime); // swapped src and dest</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                        bu-&gt;getBindingAuthorizationData(), lifeTime, sendTime); <span class="comment">// swapped src and dest, corrected lifetime value</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <span class="comment">/*If this Duplicate Address Detection fails for the given</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">                   home address or an associated link local address, then the home agent</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">                   MUST reject the complete Binding Update and MUST return a Binding</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">                   Acknowledgement to the mobile node, in which the Status field is set</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">                   to 134 (Duplicate Address Detection failed).*/</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="comment">// TODO</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">else</span> { <span class="comment">// condition: ! bu-&gt;getAckFlag()</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                EV_INFO &lt;&lt; <span class="stringliteral">&quot;BU Validated as OK: ACK FLAG NOT SET&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                bubble(<span class="stringliteral">&quot;!!!BU VALID --- ACK FLAG = False !!!&quot;</span>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent()) { <span class="comment">// establish tunnel to MN</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                Ipv6Address&amp; HA = destAddress;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="comment">// we first destroy the already existing tunnel if</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="comment">// there exists one</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelForEntryAndTrigger(HA, HoA);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;createTunnel(<a class="code" href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653aff5a78e380abfeeab2394d344a4893d0">Ipv6Tunneling::NORMAL</a>, HA, CoA, HoA);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">//                bubble(&quot;Established tunnel to mobile node.&quot;);</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="comment">// we first destroy the already existing RH2 path if</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                <span class="comment">// there exists one</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                Ipv6Address&amp; CNAddress = destAddress;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelForEntryAndTrigger(CNAddress, HoA);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="comment">// establish RH2 pseudo-tunnel at correspondent node</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;createTunnel(<a class="code" href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653ac290af69c78b64b01b3679d9ec76799c">Ipv6Tunneling::T2RH</a>, CNAddress, CoA, HoA);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="comment">// cancel existing Binding Refresh Request timer</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="comment">// (if there exists one)</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                <span class="keywordtype">int</span> interfaceID = ifTag-&gt;getInterfaceId();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(HoA, interfaceID, <a class="code" href="x_m_i_pv6_8h.html#a12b4df7d7c310249eb01a4d0b0189b3b">KEY_BR</a>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                <span class="comment">// and then we initialize a (new) BRR timer that gets</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <span class="comment">// fired as soon as the BU lifetime is closing to 0.</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="comment">// Then we send Binding Refresh Requests once again</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="comment">// until we receive a valid BU.</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <span class="comment">// FOX uncommented BRR below</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">//                NetworkInterface *ie = ift-&gt;interfaceAt(interfaceID);</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">//                createBRRTimer(HoA, ie, buLifetime - BRR_TIMEOUT_THRESHOLD);</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">//                createBRRTimer(HoA, ie, BRR_TIMEOUT_THRESHOLD);</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: Dropping message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        bubble(<span class="stringliteral">&quot;BU Validation Failed: Dropping Packet&quot;</span>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="a51d5963d559ada7fdf5e8f78deb3d110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d5963d559ada7fdf5e8f78deb3d110">&#9670;&nbsp;</a></span>processCoTIMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processCoTIMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_care_of_test_init.html">CareOfTestInit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>CoTI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create and send a CoT message. </p>
<div class="fragment"><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;{</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="comment">// 9.4.2 &amp; 9.4.4</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    Ipv6Address srcAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    Ipv6Address coa = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keyword">auto</span> outPacket = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;CoT&quot;</span>);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cot = makeShared&lt;CareOfTest&gt;();</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    cot-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0ab8c8a5d3127033d17a8401c63d98c1b6">CARE_OF_TEST</a>);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    cot-&gt;setCareOfInitCookie(coti-&gt;getCareOfInitCookie());</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    cot-&gt;setCareOfKeyGenToken(<a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;generateCareOfToken(coa, 0)); <span class="comment">// TODO nonce</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    cot-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#a598fa868b1f1f70074ec8d64550c10eb">SIZE_COT</a>));</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    outPacket-&gt;insertAtFront(cot);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;======CoT MESSAGE FORMED; APPENDING CONTROL INFO=====&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(outPacket, srcAddr, coa);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">/*statVectorCoTtoMN.record(1);*/</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="a9b830605dd4ddf75f737d66200bd7f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b830605dd4ddf75f737d66200bd7f21">&#9670;&nbsp;</a></span>processCoTMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processCoTMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_care_of_test.html">CareOfTest</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>CoT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Like <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4" title="First verifies a received HoT message and sends a BU to the CN if the care-of keygen token is availab...">processHoTMessage()</a>, but related to CoT. </p>
<div class="fragment"><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;{</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#af014acd28edfaa0506809d36c1723385">validateCoTMessage</a>(inPacket, *CoT)) {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;CoT validation not passed: dropping message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, inPacket, &amp;details);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    }</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;CoT validation passed: updating BUL&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        Ipv6Address srcAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">//        Ipv6Address&amp; destAddr = ctrlInfo-&gt;destAddr();</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="keyword">auto</span> ifTag = inPacket-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        <span class="keywordtype">int</span> interfaceID = ifTag-&gt;getInterfaceId();</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceID);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(srcAddr);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        ASSERT(bulEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="comment">// cancel the existing CoTI retransmission timer</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(srcAddr, interfaceID, <a class="code" href="x_m_i_pv6_8h.html#a9df5bb95d260beb5f652e9402cac9297">KEY_CI</a>);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <span class="comment">// set the care-of keygen token</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        bulEntry-&gt;tokenC = CoT-&gt;getCareOfKeyGenToken();</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="comment">// set token expiry appropriately</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ad4ded6f950e3baed74e157e01170a188">createCareOfTokenEntryExpiryTimer</a>(srcAddr, <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceID),</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                simTime() + ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxTokenLifeTime());</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="comment">// if we have the home token as well, we can send the BU to the CN now</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="comment">// but only if we have already sent or are about to send a BU</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="comment">// call method that potentially sends BU now</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN</a>(*bulEntry, ie);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <span class="comment">// reset the CoTI timer for the time the token expires</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">//        resetTestInitIfEntry(srcAddr, interfaceID, KEY_CI);</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="comment">/*// delete the CoT retransmission timer</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">           cancelTimerIfEntry(srcAddr, interfaceID, KEY_CI);*/</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="comment">// gather statistics</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="comment">/*statVectorCoTfromCN.record(1);*/</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="a3c68a093ad4a7f05896c4393d23c5fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c68a093ad4a7f05896c4393d23c5fe0">&#9670;&nbsp;</a></span>processHoAOpt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processHoAOpt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_home_address_option.html">HomeAddressOption</a> *&#160;</td>
          <td class="paramname"><em>hoaOpt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the Home Address Option which belongs to the provided datagram. </p>
<p>Swaps the addresses between the original source address of the datagram and the field in the option. </p>
<div class="fragment"><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;{</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="keyword">auto</span> ipv6Header = packet-&gt;peekAtFront&lt;Ipv6Header&gt;();</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="comment">// datagram from MN to CN</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordtype">bool</span> validHoAOpt = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keyword">const</span> Ipv6Address&amp; HoA = hoaOpt-&gt;getHomeAddress();</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keyword">const</span> Ipv6Address&amp; CoA = ipv6Header-&gt;getSrcAddress();</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="comment">/*9.3.1</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">       Packets containing a</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">       Home Address option MUST be dropped if there is no corresponding</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">       Binding Cache entry.  A corresponding Binding Cache entry MUST have</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">       the same home address as appears in the Home Address destination</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">       option, and the currently registered care-of address MUST be equal to</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">       the source address of the packet.*/</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    ASSERT(<a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;isInBindingCache(HoA, CoA)) {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        ipv6Header = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        packet-&gt;trimFront();</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        <span class="keyword">auto</span> newIpv6Header = packet-&gt;removeAtFront&lt;Ipv6Header&gt;();</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        newIpv6Header-&gt;setSrcAddress(HoA);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <a class="code" href="namespaceinet.html#ad0e3c01e474727e9f73920bf7f8ed3ba">insertNetworkProtocolHeader</a>(packet, <a class="code" href="classinet_1_1_protocol.html#a48a5edce148938073a2e901e1d776382">Protocol::ipv6</a>, newIpv6Header);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        validHoAOpt = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    }</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid RH2 destination - no entry in binding cache. Dropping packet.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <span class="comment">/*If the packet is dropped due the above tests, the correspondent node</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment">           MUST send the Binding Error message as described in Section 9.3.3.</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">           The Status field in this message should be set to 1 (unknown binding</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">           for Home Address destination option).*/</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <span class="comment">// previous code was erroneous, as destination from packet is probably</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="comment">// not a valid address of the interfaces of this node</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <a class="code" href="namespaceinet.html#a0836489f866ddd35438d3bfe59438d4b">BeStatus</a> status = <a class="code" href="namespaceinet.html#a0836489f866ddd35438d3bfe59438d4ba3467f54f97f29cb1ea8d08e935bf8046">UNKNOWN_BINDING_FOR_HOME_ADDRESS_DEST_OPTION</a>;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aa80789234568c887c26c1c95cb51884f">createAndSendBEMessage</a>(CoA, status);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    packet-&gt;setContextPointer(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keyword">delete</span> hoaOpt;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="keywordflow">if</span> (validHoAOpt) {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Valid HoA Option - copied address from HoA Option to datagram&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        send(packet, <span class="stringliteral">&quot;toIPv6&quot;</span>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    }</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, packet, &amp;details);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a9464cca6b8db5cf370994bd4b37af21e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9464cca6b8db5cf370994bd4b37af21e">&#9670;&nbsp;</a></span>processHoTIMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processHoTIMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_home_test_init.html">HomeTestInit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>HoTI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create and send a HoT message. </p>
<div class="fragment"><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;{</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">// 9.4.1 &amp; 9.4.3</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    Ipv6Address srcAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    Ipv6Address HoA = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keyword">auto</span> outPacket = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;HoT&quot;</span>);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; homeTest = makeShared&lt;HomeTest&gt;();</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    homeTest-&gt;setMobilityHeaderType(<a class="code" href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0abb44e95ebab40fe474b06a556815ddd1">HOME_TEST</a>);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    homeTest-&gt;setHomeInitCookie(homeTestInit-&gt;getHomeInitCookie());</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    homeTest-&gt;setHomeKeyGenToken(<a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;generateHomeToken(HoA, 0)); <span class="comment">// TODO nonce</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="comment">// setting message size</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    homeTest-&gt;setChunkLength(<a class="code" href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">B</a>(<a class="code" href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a> + <a class="code" href="x_m_i_pv6_8cc.html#aa954b7b9e57b4e3fe036ed1422537044">SIZE_HOT</a>));</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    outPacket-&gt;insertAtFront(homeTest);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;======HoT MESSAGE FORMED; APPENDING CONTROL INFO=====&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(outPacket, srcAddr, HoA);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">/*statVectorHoTtoMN.record(1);*/</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="aa863e1b42062b5a06cc69af0f4af25d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa863e1b42062b5a06cc69af0f4af25d4">&#9670;&nbsp;</a></span>processHoTMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processHoTMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_home_test.html">HomeTest</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>HoT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First verifies a received HoT message and sends a BU to the CN if the care-of keygen token is available as well. </p>
<p>Retransmission of HoTI message is rescheduled. </p>
<div class="fragment"><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;{</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a">validateHoTMessage</a>(inPacket, *homeTest)) {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;HoT validation not passed: dropping message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, inPacket, &amp;details);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;HoT validation passed: updating BUL&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        Ipv6Address srcAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">//        Ipv6Address&amp; destAddr = ctrlInfo-&gt;destAddr();</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordtype">int</span> interfaceID = inPacket-&gt;getTag&lt;InterfaceInd&gt;()-&gt;getInterfaceId();</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceID);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; </div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(srcAddr);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        ASSERT(bulEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="comment">// cancel the existing HoTI retransmission timer</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(srcAddr, interfaceID, <a class="code" href="x_m_i_pv6_8h.html#adcada2b7eb8c57d6d0bc54652ebcab60">KEY_HI</a>);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <span class="comment">// set the home keygen token</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        bulEntry-&gt;tokenH = homeTest-&gt;getHomeKeyGenToken();</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <span class="comment">// set token expiry appropriately</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a00f7319d98882b8ee35fd346a892a3ea">createHomeTokenEntryExpiryTimer</a>(srcAddr, <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceID),</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                simTime() + ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxTokenLifeTime());</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="comment">// if we have the care-of token as well, we can send the BU to the CN now</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="comment">// but only if we have not already sent or are about to send a BU</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <span class="comment">// call method that potentially sends a BU now</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN</a>(*bulEntry, ie);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="comment">// gather statistics</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <span class="comment">/*statVectorHoTfromCN.record(1);*/</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    }</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">processMobilityMessage()</a>.</p>

</div>
</div>
<a id="a4d36c6a58a53a1b6ff97c90033c4ee49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d36c6a58a53a1b6ff97c90033c4ee49">&#9670;&nbsp;</a></span>processMobilityMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processMobilityMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is where all the mobility messages are sifted through and sent to appropriate functions for processing. </p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mipv6Msg = inPacket-&gt;peekAtFront&lt;MobilityHeader&gt;();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Processing of MIPv6 related mobility message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; bu = dynamicPtrCast&lt;const BindingUpdate&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as BINDING UPDATE (BU)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">//        EV &lt;&lt; &quot;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;Giving Control to processBUMessage()&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage</a>(inPacket, bu);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ba = dynamicPtrCast&lt;const BindingAcknowledgement&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as BINDING ACKNOWLEDGEMENT (BA)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//        EV &lt;&lt; &quot;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;Giving Control to processBAMessage()&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage</a>(inPacket, ba);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// 28.08.07 - CB</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; hoti = dynamicPtrCast&lt;const HomeTestInit&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as HOME TEST INIT (HoTI)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a9464cca6b8db5cf370994bd4b37af21e">processHoTIMessage</a>(inPacket, hoti);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; coti = dynamicPtrCast&lt;const CareOfTestInit&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as CARE-OF TEST INIT (CoTI)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a51d5963d559ada7fdf5e8f78deb3d110">processCoTIMessage</a>(inPacket, coti);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ht = dynamicPtrCast&lt;const HomeTest&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as HOME TEST (HoT)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage</a>(inPacket, ht);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; cot = dynamicPtrCast&lt;const CareOfTest&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as CARE-OF TEST (CoT)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage</a>(inPacket, cot);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; brr = dynamicPtrCast&lt;const BindingRefreshRequest&gt;(mipv6Msg)) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Message recognised as Binding Refresh Request&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">processBRRMessage</a>(inPacket, brr);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Unrecognised mobility message... Dropping&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, inPacket, &amp;details);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keyword">delete</span> inPacket;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a74c931b057a65aac096b01ddfdf28450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74c931b057a65aac096b01ddfdf28450">&#9670;&nbsp;</a></span>processType2RH()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::processType2RH </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_routing_header.html">Ipv6RoutingHeader</a> *&#160;</td>
          <td class="paramname"><em>rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the Type 2 Routing Header which belongs to the provided datagram. </p>
<p>Swaps the addresses between the original destination address of the datagram and the field in the routing header. </p>
<div class="fragment"><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;{</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keyword">auto</span> ipv6Header = packet-&gt;peekAtFront&lt;Ipv6Header&gt;();</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">//    EV &lt;&lt; &quot;Processing RH2...&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a1e839823650092fa089ab28fce4528a2">validateType2RH</a>(*ipv6Header.get(), *rh)) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, packet, &amp;details);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordtype">bool</span> validRH2 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keyword">const</span> Ipv6Address&amp; HoA = rh-&gt;getAddress(0);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">/*11.3.3</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">       A node receiving a packet addressed to itself (i.e., one of the</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">       node&#39;s addresses is in the Ipv6 destination field) follows the next</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">       header chain of headers and processes them.  When it encounters a</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">       type 2 routing header during this processing, it performs the</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">       following checks.  If any of these checks fail, the node MUST</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">       silently discard the packet.*/</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="comment">/*The length field in the routing header is exactly 2.*/</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">// omitted</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">/*The segments left field in the routing header is 1 on the wire.*/</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keywordflow">if</span> (rh-&gt;getSegmentsLeft() != 1) {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid RH2 - segments left field must be 1. Dropping packet.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, packet, &amp;details);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="comment">// probably datagram from CN to MN</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="comment">/*The Home Address field in the routing header is one of the node&#39;s</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">       home addresses, if the segments left field was 1.  Thus, in</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">       particular the address field is required to be a unicast routable</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">       address.*/</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAddress(HoA)) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="comment">/*Once the above checks have been performed, the node swaps the Ipv6</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">           destination field with the Home Address field in the routing header,</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">           decrements segments left by one from the value it had on the wire,</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">           and resubmits the packet to IP for processing the next header.*/</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        ipv6Header = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        packet-&gt;trimFront();</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keyword">auto</span> newIpv6Header = packet-&gt;removeAtFront&lt;Ipv6Header&gt;();</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        newIpv6Header-&gt;setDestAddress(HoA);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <a class="code" href="namespaceinet.html#ad0e3c01e474727e9f73920bf7f8ed3ba">insertNetworkProtocolHeader</a>(packet, <a class="code" href="classinet_1_1_protocol.html#a48a5edce148938073a2e901e1d776382">Protocol::ipv6</a>, newIpv6Header);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        validRH2 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    }</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="comment">/*If any of these checks fail, the node MUST</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">           silently discard the packet.*/</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">//        delete datagram;</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid RH2 - not a HoA. Dropping packet.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    }</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    packet-&gt;setContextPointer(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keywordflow">if</span> (validRH2) {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Valid RH2 - copied address from RH2 to datagram&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        send(packet, <span class="stringliteral">&quot;toIPv6&quot;</span>);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        PacketDropDetails details;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        details.setReason(<a class="code" href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">OTHER_PACKET_DROP</a>);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        emit(<a class="code" href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">packetDroppedSignal</a>, packet, &amp;details);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keyword">delete</span> packet;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a6b6778cff1888b1f98f487f7a5ef4151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b6778cff1888b1f98f487f7a5ef4151">&#9670;&nbsp;</a></span>removeCoAEntries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::removeCoAEntries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove all entries from the interfaceCoAList. </p>
<div class="fragment"><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;{</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1x_m_i_pv6.html#a026f43021a6cb4663eebbdf430a51a08">interfaceCoAList</a>) {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        <span class="comment">//if (it-&gt;first == ie-&gt;interfaceId())</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        EV_DEBUG &lt;&lt; <span class="stringliteral">&quot;Cancelling timers for ifID=&quot;</span> &lt;&lt; elem.first &lt;&lt; <span class="stringliteral">&quot; and CoA=&quot;</span> &lt;&lt; elem.second &lt;&lt; endl;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">cancelEntries</a>(elem.first, elem.second);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="comment">// delete all entries after cleanup</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a026f43021a6cb4663eebbdf430a51a08">interfaceCoAList</a>.clear();</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>.</p>

</div>
</div>
<a id="aece14f2aefee479e40b9cc3e3ee70fa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece14f2aefee479e40b9cc3e3ee70fa4">&#9670;&nbsp;</a></span>removeTimerEntries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::removeTimerEntries </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes timers of all types for the specified destination address and interfaceId. </p>
<p>Whenever a new mobility related timer is added, is MUST be added within this method to ensure proper removal. </p>
<div class="fragment"><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;{</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isMobileNode()) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        <span class="comment">// HoTI</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#adcada2b7eb8c57d6d0bc54652ebcab60">KEY_HI</a>);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        <span class="comment">// CoTI</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#a9df5bb95d260beb5f652e9402cac9297">KEY_CI</a>);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="comment">// BU</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        <span class="comment">// BRR</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#a12b4df7d7c310249eb01a4d0b0189b3b">KEY_BR</a>);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="comment">// BUL expiry</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#a2e23b242b95346bc5d29584bd925bc05">KEY_BUL_EXP</a>);</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        <span class="comment">// BC expiry</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">//        cancelTimerIfEntry(dest, interfaceId, KEY_BC_EXP);</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <span class="comment">// token expiry</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#aff85ca708ac4d725a050c595514f9a5e">KEY_HTOKEN_EXP</a>);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#a5cf5e9f044204fd03467f018a646d2bc">KEY_CTOKEN_EXP</a>);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAgent()) {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#a809adcc4f8be4ebac2a6467d645e79cc">KEY_BC_EXP</a>);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">// CN</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(dest, interfaceId, <a class="code" href="x_m_i_pv6_8h.html#a809adcc4f8be4ebac2a6467d645e79cc">KEY_BC_EXP</a>);</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>.</p>

</div>
</div>
<a id="a413465c28f01387fe2f85f631d94fb1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a413465c28f01387fe2f85f631d94fb1f">&#9670;&nbsp;</a></span>resetBUIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::resetBUIfEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>retransmissionTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cancels the current existing timer and reschedules it with initial values. </p>
<p>Similiar to the other resetTestInitIfEntry() method, but this one searches for the appropriate transmission structure first as the interfaceID is not known but needed as lookup key. Reset the transmission structure for a BU and reschedule it for the provided time. </p>
<div class="fragment"><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;{</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="comment">/*ASSERT(msgType == KEY_BU);</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">       Key key(dest, interfaceID, msgType);*/</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">Key</a> key(dest, interfaceID, <a class="code" href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a>);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keyword">auto</span> pos = <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.find(key);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">if</span> (pos == <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>.end()) {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">//        EV &lt;&lt; &quot;### No corresponding TimerIfEntry found! ###\n&quot;;</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    TimerIfEntry *entry = (pos-&gt;second);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    ASSERT(entry);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="comment">// reset the timeout value to the initial value</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    entry-&gt;ackTimeout = entry-&gt;ifEntry-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getInitialBindAckTimeout();</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="comment">// and then we reschedule again for BU expiry time</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="comment">// (with correct offset for scheduling)</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    entry-&gt;nextScheduledTime = retransmissionTime;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    rescheduleAt(entry-&gt;nextScheduledTime, entry-&gt;timer);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Updated BuTransmitIfEntry and corresponding timer.\n&quot;</span>;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ca9874936a1263019aa7b73a0573fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ca9874936a1263019aa7b73a0573fb9">&#9670;&nbsp;</a></span>returningHome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::returningHome </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>CoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method destroys all tunnels associated to the previous CoA and sends appropriate BU(s) to HA and CN(s). </p>
<p>This method destroys the HA tunnel associated to the previous CoA and sends an appropriate BU to the HA. </p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a>(<span class="stringliteral">&quot;returningHome&quot;</span>); <span class="comment">// can be called by NeighborDiscovery module</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">/*11.5.4</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">       A mobile node detects that it has returned to its home link through</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">       the movement detection algorithm in use (Section 11.5.1), when the</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">       mobile node detects that its home subnet prefix is again on-link.*/</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;MIPv6 Returning home procedure...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// cancel timers</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// eventually we could have some unacknowledged BUs</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// we have to cancel these: first the one for the Home Agent...</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">const</span> Ipv6Address&amp; HA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries</a>(HA, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// destroy tunnel to HA</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnel(CoA, HA);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// unregister binding from HA..</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#ae66274da883fc2d9895e11caf712f5ad">createDeregisterBUTimer</a>(HA, ie);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;setMobilityState(HA, <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">BindingUpdateList::DEREGISTER</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// ...and then the messages for CNs</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a> = <a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>.begin(); <a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a> != <a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>.end(); <a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>++) { <span class="comment">// run an iterator through the CN map</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">// we first cancel potential timers for the respective CN</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries</a>(*(<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>), ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// then we send the BU for deregistration</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isValidBinding(*(<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>))) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            Ipv6Address cn = *(<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//            createDeregisterBUTimer(*(itCNList), ie);</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(cn);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            ASSERT(bulEntry != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            bulEntry-&gt;state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">BindingUpdateList::DEREGISTER</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN</a>(*bulEntry, ie);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// destroy the tunnel now</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">// we have to as it is invalid (bound to old CoA that is not available anymore)</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;destroyTunnelForExitAndTrigger(ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getMNHomeAddress(), *(<a class="code" href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">itCNList</a>));</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f3d7b04dc134a664dac950e63948b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3d7b04dc134a664dac950e63948b92">&#9670;&nbsp;</a></span>searchTimerIfEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1x_m_i_pv6_1_1_timer_if_entry.html">xMIPv6::TimerIfEntry</a> * inet::xMIPv6::searchTimerIfEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timerType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Searches for a transmitEntry with the given destination address which is of type timerType. </p>
<p>Returns nullptr if no such entry exists. </p>
<div class="fragment"><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;{</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; elem : <a class="code" href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">transmitIfList</a>) {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="keywordflow">if</span> (elem.first.type == timerType &amp;&amp; elem.first.dest == dest)</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            <span class="keywordflow">return</span> elem.second;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3ea8a29978d35fe97e223faf86f042d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3ea8a29978d35fe97e223faf86f042d">&#9670;&nbsp;</a></span>sendBUtoCN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::sendBUtoCN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_binding_update_list_1_1_binding_update_list_entry.html">BindingUpdateList::BindingUpdateListEntry</a> &amp;&#160;</td>
          <td class="paramname"><em>bulEntry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a timer for sending a BU. </p>
<div class="fragment"><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;{</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="comment">/*11.7.2</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">       Upon successfully completing the return routability procedure, and</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment">       after receiving a successful Binding Acknowledgement from the Home</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">       Agent, a Binding Update MAY be sent to the correspondent node.*/</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending BU to CN&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">       // The createBU method requires information on the interface. This is not available in the</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">       // bul entry though. Hence we just fetch a token expiry timer to retrieve this information.</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">       TimerIfEntry* transmitEntry = searchTimerIfEntry(bulEntry.destAddress,     KEY_HTOKEN_EXP); // we could also use a care-of keygen token of course...</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">       ASSERT(transmitEntry!=nullptr);</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">       NetworkInterface* ie = transmitEntry-&gt;ifEntry;*/</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="keywordflow">if</span> (bulEntry.state != <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">BindingUpdateList::DEREGISTER</a>)</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        bulEntry.state = <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aac6a4bd549b4bca51f53eedcafdc3684d">BindingUpdateList::REGISTER</a>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">createBUTimer</a>(bulEntry.destAddress, ie);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">//    createBUTimer(bulEntry.destAddress, ie, false);</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability()</a>.</p>

</div>
</div>
<a id="a6b551126d211603e24e951bd355923ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b551126d211603e24e951bd355923ae">&#9670;&nbsp;</a></span>sendMobilityMessageToIPv6Module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::sendMobilityMessageToIPv6Module </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>srcAddr</em> = <code><a class="el" href="classinet_1_1_ipv6_address.html#a591d8b5ba1dcdd5f3357ce0fbba834e8">Ipv6Address::UNSPECIFIED_ADDRESS</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interfaceId</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>sendTime</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Append tags to the Mobility Messages (BU, BA etc) and send it out to the <a class="el" href="classinet_1_1_ipv6.html" title="Ipv6 implementation.">Ipv6</a> Module. </p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Appending ControlInfo to mobility message\n&quot;</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    msg-&gt;removeTagIfPresent&lt;<a class="code" href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a>&gt;();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    msg-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a>&gt;()-&gt;setProtocol(&amp;<a class="code" href="classinet_1_1_protocol.html#a707bff4e89896d905d9f65b25554219a">Protocol::mobileipv6</a>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (interfaceId != -1)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        msg-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#a8d28e59a0d202e69c382d34ad7080937">InterfaceReq</a>&gt;()-&gt;setInterfaceId(interfaceId);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    msg-&gt;addTagIfAbsent&lt;L3AddressReq&gt;()-&gt;setSrcAddress(srcAddr);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    msg-&gt;addTagIfAbsent&lt;L3AddressReq&gt;()-&gt;setDestAddress(destAddr);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    msg-&gt;addTagIfAbsent&lt;<a class="code" href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a>&gt;()-&gt;setHopLimit(255);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;ControlInfo appended successfully. Sending mobility message to Ipv6 module\n&quot;</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;controlInfo: DestAddr=&quot;</span> &lt;&lt; destAddr</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; SrcAddr=&quot;</span> &lt;&lt; srcAddr</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; InterfaceId=&quot;</span> &lt;&lt; interfaceId &lt;&lt; endl;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// TODO solve the HA DAD problem in a different way</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// (delay currently specified via the sendTime parameter)</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span> (sendTime &gt; 0)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        sendDelayed(msg, sendTime, <span class="stringliteral">&quot;toIPv6&quot;</span>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        send(msg, <span class="stringliteral">&quot;toIPv6&quot;</span>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aa80789234568c887c26c1c95cb51884f">createAndSendBEMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a8e8e171a71e44592936df60b6214ae5a">createAndSendBRRMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">createAndSendBUMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a51d5963d559ada7fdf5e8f78deb3d110">processCoTIMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a9464cca6b8db5cf370994bd4b37af21e">processHoTIMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a259fe47417bf0168de80810b5137ca5c">sendTestInit()</a>.</p>

</div>
</div>
<a id="a746a045b4475430db6fb1ebcb7b7898b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a746a045b4475430db6fb1ebcb7b7898b">&#9670;&nbsp;</a></span>sendPeriodicBRR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::sendPeriodicBRR </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles a fired BRR message transmission structure. </p>
<p>Creates and sends and appropriate Binding Refresh <a class="el" href="classinet_1_1_request.html">Request</a>. Transmission structure is rescheduled afterwards. </p>
<div class="fragment"><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;{</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;====== Periodic BRR MESSAGE at time: &quot;</span> &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">&quot; seconds =====&gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    BrTransmitIfEntry *brIfEntry = (BrTransmitIfEntry *)msg-&gt;getContextPointer(); <span class="comment">// detaching the corresponding brIfEntry pointer</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    NetworkInterface *ie = brIfEntry-&gt;ifEntry;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    Ipv6Address&amp; brDest = brIfEntry-&gt;dest;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="comment">/*9.5.5</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">       The correspondent node MAY retransmit Binding Refresh Request</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">       messages as long as the rate limitation is applied.  The</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">       correspondent node MUST stop retransmitting when it receives a</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">       Binding Update.*/</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="keywordflow">if</span> (brIfEntry-&gt;retries &lt; <a class="code" href="x_m_i_pv6_8cc.html#a32607edcc9ac8e905183b104328921e5">BRR_RETRIES</a>) { <span class="comment">// we&#39;ll not retransmit infinite times</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        brIfEntry-&gt;retries++;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a8e8e171a71e44592936df60b6214ae5a">createAndSendBRRMessage</a>(brDest, ie);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <span class="comment">// retransmit the Binding Refresh Message</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        scheduleAfter(<a class="code" href="x_m_i_pv6_8cc.html#a9d86571db17029d80fa8bcb0979ecaea">BRR_TIMEOUT_THRESHOLD</a>, msg);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <span class="comment">// we&#39;ve tried often enough - remove the timer</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry</a>(brDest, ie-&gt;getInterfaceId(), <a class="code" href="x_m_i_pv6_8h.html#a12b4df7d7c310249eb01a4d0b0189b3b">KEY_BR</a>);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a41dfe546eaa52dd2544407b80b044bec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41dfe546eaa52dd2544407b80b044bec">&#9670;&nbsp;</a></span>sendPeriodicBU()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::sendPeriodicBU </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is called when the timer created in <a class="el" href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948" title="This method finally creates the timer structure and schedules the message for sending.">createBUTimer()</a> has fired. </p>
<p>The BU is created and the appropriate method for sending it called. The timer structure is updated and rescheduled. </p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Sending periodic BU message at time: &quot;</span> &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    BuTransmitIfEntry *buIfEntry = (BuTransmitIfEntry *)msg-&gt;getContextPointer(); <span class="comment">// detaching the corresponding buIfEntry pointer</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">//    EV &lt;&lt; &quot;### lifetime of buIfEntry=&quot; &lt;&lt; buIfEntry-&gt;lifeTime &lt;&lt; &quot; and seq#= &quot; &lt;&lt; buIfEntry-&gt;buSequenceNumber &lt;&lt; endl;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    NetworkInterface *ie = buIfEntry-&gt;ifEntry; <span class="comment">// copy the ie info</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    Ipv6Address&amp; buDest = buIfEntry-&gt;dest;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    buIfEntry-&gt;presentSentTimeBU = simTime(); <span class="comment">// records the present time at which BU is sent</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    buIfEntry-&gt;nextScheduledTime = buIfEntry-&gt;presentSentTimeBU + buIfEntry-&gt;ackTimeout;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">/*11.8</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">       The retransmissions by the mobile node MUST use an exponential back-</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">       off process in which the timeout period is doubled upon each</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">       retransmission*/</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    buIfEntry-&gt;ackTimeout = (buIfEntry-&gt;ackTimeout) * 2;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">/*Each Binding Update MUST have a Sequence Number greater than the</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">       Sequence Number value sent in the previous Binding Update to the same</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">       destination address (if any). The sequence numbers are compared</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">       modulo 2**16, as described in Section 9.5.1.*/</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    buIfEntry-&gt;buSequenceNumber = (buIfEntry-&gt;buSequenceNumber + 1) % 65536;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// Added by CB, 28.08.07</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//    Ipv6Address CoA = ie-&gt;ipv6()-&gt;globalAddress();</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (!buIfEntry-&gt;homeRegistration) { <span class="comment">// this BU goes to a CN</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        Ipv6Address CoA = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getCoA(buDest); <span class="comment">// 24.9.07 - CB</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// TODO think of a good mechanism to obtain the appropriate/correct CoA</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">// Problem 1: ie-&gt;ipv6()-&gt;globalAddress() retrieves the HoA</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="comment">// Problem 2: bul-&gt;getCoA(buDest) becomes a problem in case of Multihoming</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">// Solution: globalAddress(TYPE_COA) ?</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordtype">int</span> bindingAuthorizationData = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;generateBAuthData(buDest, CoA);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">createAndSendBUMessage</a>(buDest, ie, buIfEntry-&gt;buSequenceNumber, buIfEntry-&gt;lifeTime, bindingAuthorizationData);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">/*statVectorBUtoCN.record(1);*/</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">createAndSendBUMessage</a>(buDest, ie, buIfEntry-&gt;buSequenceNumber, buIfEntry-&gt;lifeTime);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">/*statVectorBUtoHA.record(1);*/</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">/*if (buIfEntry-&gt;ackTimeout &lt; ie-&gt;ipv6()-&gt;_maxBindAckTimeout())</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">       {</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">        //buIfEntry-&gt;presentBindAckTimeout = buIfEntry-&gt;nextBindAckTimeout; //reassign the timeout value</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">//        scheduleAt(buIfEntry-&gt;nextScheduledTime, msg);</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">       }</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">       else*/</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (!(buIfEntry-&gt;ackTimeout &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxBindAckTimeout())) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Crossed maximum BINDACK timeout...resetting to predefined maximum.&quot;</span> &lt;&lt; endl; <span class="comment">// buIfEntry-&gt;nextBindAckTimeout &lt;&lt; &quot; ++++++\n&quot;;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">//        ev &lt;&lt; &quot;\n++++Present Sent Time: &quot; &lt;&lt; buIfEntry-&gt;presentSentTimeBU &lt;&lt; &quot; Present TimeOut: &quot; &lt;&lt; buIfEntry-&gt;ackTimeout &lt;&lt; endl;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">//        buIfEntry-&gt;nextScheduledTime = buIfEntry-&gt;presentSentTimeBU + buIfEntry-&gt;maxBindAckTimeout;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        buIfEntry-&gt;ackTimeout = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxBindAckTimeout();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">//        buIfEntry-&gt;nextScheduledTime = ie-&gt;ipv6()-&gt;_maxBindAckTimeout();</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//        ev &lt;&lt; &quot;\n++++Next Sent Time: &quot; &lt;&lt; buIfEntry-&gt;nextScheduledTime &lt;&lt; endl;//&quot; Next TimeOut: &quot; &lt;&lt; buIfEntry-&gt;nextBindAckTimeout &lt;&lt; endl;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">//        scheduleAt(buIfEntry-&gt;nextScheduledTime, msg);</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Present Sent Time: &quot;</span> &lt;&lt; buIfEntry-&gt;presentSentTimeBU &lt;&lt; <span class="stringliteral">&quot;, Present TimeOut: &quot;</span> &lt;&lt; buIfEntry-&gt;ackTimeout &lt;&lt; endl;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;Next Sent Time: &quot;</span> &lt;&lt; buIfEntry-&gt;nextScheduledTime &lt;&lt; endl; <span class="comment">// &lt;&lt; &quot; Next TimeOut: &quot; &lt;&lt; buIfEntry-&gt;nextBindAckTimeout &lt;&lt; endl;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    scheduleAt(buIfEntry-&gt;nextScheduledTime, msg);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="a259fe47417bf0168de80810b5137ca5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259fe47417bf0168de80810b5137ca5c">&#9670;&nbsp;</a></span>sendTestInit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::sendTestInit </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If a TestInit timer was fired, this method gets called. </p>
<p>The message is sent and the Binding Update List accordingly updated. Afterwards the transmission timer is rescheduled. </p>
<div class="fragment"><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;{</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">// FIXME the following line is unsafe, rewrite it</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    TestInitTransmitIfEntry *tiIfEntry = (TestInitTransmitIfEntry *)msg-&gt;getContextPointer(); <span class="comment">// check_and_cast&lt;TestInitTransmitIfEntry*&gt;((TestInitTransmitIfEntry*) msg-&gt;contextPointer());</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    NetworkInterface *ie = tiIfEntry-&gt;ifEntry;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="comment">/*11.6.1</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">       When sending a Home Test Init or Care-of Test Init message</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">       the mobile node MUST record in its Binding Update List the following</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">       fields from the messages:</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">       o  The IP address of the node to which the message was sent.</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">       o  The home address of the mobile node.  This value will appear in</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">          the Source Address field of the Home Test Init message.  When</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">          sending the Care-of Test Init message, this address does not</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">          appear in the message, but represents the home address for which</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">          the binding is desired.</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">       o  The time at which each of these messages was sent.</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">       o  The cookies used in the messages.</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">       Note that a single Care-of Test Init message may be sufficient even</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">       when there are multiple home addresses.  In this case the mobile node</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">       MAY record the same information in multiple Binding Update List</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">       entries.*/</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">// retrieve the cookie from the Test Init message</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> homeTestInit = dynamicPtrCast&lt;HomeTestInit&gt;(tiIfEntry-&gt;testInitMsg)) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">// moved the following two lines to here</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        Ipv6Address HoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::HoA);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        ASSERT(!HoA.isUnspecified());</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="keyword">auto</span> outPacket = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;HoTI&quot;</span>);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">// update cache</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;addOrUpdateBUL(tiIfEntry-&gt;dest, HoA, simTime(), homeTestInit-&gt;getHomeInitCookie(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="comment">// mark the current home token as invalid</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;resetHomeToken(tiIfEntry-&gt;dest, HoA);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="comment">// and send message</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        outPacket-&gt;insertAtFront(homeTestInit);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(outPacket, tiIfEntry-&gt;dest, HoA);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="comment">/*statVectorHoTItoCN.record(1);*/</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="comment">// must be of type CareOfTestInit</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keyword">auto</span> careOfTestInit = <a class="code" href="_i_n_e_t_defs_8h.html#af3e4d5321e837cae974ef2a2871d9e0e">CHK</a>(dynamicPtrCast&lt;CareOfTestInit&gt;(tiIfEntry-&gt;testInitMsg));</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="comment">// moved the following two lines to here</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        Ipv6Address CoA = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::CoA);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        ASSERT(!CoA.isUnspecified());</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keyword">auto</span> outPacket = <span class="keyword">new</span> Packet(<span class="stringliteral">&quot;CoTI&quot;</span>);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="comment">// update cache</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;addOrUpdateBUL(tiIfEntry-&gt;dest, CoA, simTime(), careOfTestInit-&gt;getCareOfInitCookie(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="comment">// mark the current care-of token as invalid</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;resetCareOfToken(tiIfEntry-&gt;dest, CoA);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="comment">// and send message</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        outPacket-&gt;insertAtFront(careOfTestInit);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">sendMobilityMessageToIPv6Module</a>(outPacket, tiIfEntry-&gt;dest, CoA, ie-&gt;getInterfaceId());</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="comment">// statistic collection</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        <span class="comment">/*statVectorCoTItoCN.record(1);*/</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">/*11.8</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">       If the mobile node fails to receive a valid matching response within</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">         the selected initial retransmission interval, the mobile node SHOULD</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">        retransmit the message until a response is received.*/</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    tiIfEntry-&gt;nextScheduledTime = tiIfEntry-&gt;ackTimeout + simTime();</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="comment">/*The retransmissions by the mobile node MUST use an exponential back-</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">         off process in which the timeout period is doubled upon each</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">         retransmission, until either the node receives a response or the</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">         timeout period reaches the value MAX_BINDACK_TIMEOUT. The mobile</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">         node MAY continue to send these messages at this slower rate</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">         indefinitely.*/</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    tiIfEntry-&gt;ackTimeout = tiIfEntry-&gt;ackTimeout * 2;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span> (!(tiIfEntry-&gt;ackTimeout &lt; ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxBindAckTimeout()))</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        tiIfEntry-&gt;ackTimeout = ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;_getMaxBindAckTimeout();</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    msg-&gt;setContextPointer(tiIfEntry);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    scheduleAt(tiIfEntry-&gt;nextScheduledTime, msg);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; </div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;Scheduled next HoTI/CoTI for time=&quot;</span> &lt;&lt; tiIfEntry-&gt;nextScheduledTime</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; with timeout=&quot;</span> &lt;&lt; tiIfEntry-&gt;ackTimeout &lt;&lt; <span class="stringliteral">&quot; for dest=&quot;</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            &lt;&lt; tiIfEntry-&gt;dest &lt;&lt; endl;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">//    delete tiIfEntry;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">//    delete msg;</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a11cc72f90b08c18df3fdcedcc34cdc79">handleMessage()</a>.</p>

</div>
</div>
<a id="adedabec47eb42340c1565ffc735b7798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adedabec47eb42340c1565ffc735b7798">&#9670;&nbsp;</a></span>triggerRouteOptimization()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::triggerRouteOptimization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>destAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>HoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The following method is used for triggering RO to a CN. </p>
<p>Alain Tigyo, 21.03.2008 The following code is used for triggering RO to a CN. </p>
<div class="fragment"><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;{</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getMobilityState(destAddress) == <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa84718d3bdca6a089024544c71a52f10a">BindingUpdateList::NONE</a>)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;setMobilityState(destAddress, <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa053a5e941d65556e86631a96d25b24c8">BindingUpdateList::RR</a>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordtype">int</span> vIndex = <a class="code" href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">tunneling</a>-&gt;getVIfIndexForDest(destAddress, <a class="code" href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653a9413423f3c98a13bb329e1a870938ee5">Ipv6Tunneling::MOBILITY</a>);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span> (vIndex &gt; <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getNumInterfaces()) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        EV_INFO &lt;&lt; <span class="stringliteral">&quot;Route Optimization for: &quot;</span> &lt;&lt; destAddress &lt;&lt; <span class="stringliteral">&quot; already triggered&quot;</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="comment">// we have to check whether our current CoA is different from the one saved in the BUL</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="comment">// (this would mean we have moved to a new access network on this interface)</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getCoA(destAddress) != ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::CoA))</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            || <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getMobilityState(destAddress) == <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa84718d3bdca6a089024544c71a52f10a">BindingUpdateList::NONE</a>)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="comment">// we have a new CoA compared to BUL entry -&gt; redo RO</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability</a>(destAddress, ie);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot; ...moved to new network. Initializing RO.&quot;</span>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        EV_INFO &lt;&lt; endl;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <span class="keywordflow">if</span> ((!<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;isInBindingUpdateList(destAddress, HoA))</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            || (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getMobilityState(destAddress) == <a class="code" href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa053a5e941d65556e86631a96d25b24c8">BindingUpdateList::RR</a>))</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            EV_INFO &lt;&lt; <span class="stringliteral">&quot;Initialise Route Optimization for: &quot;</span> &lt;&lt; destAddress &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability</a>(destAddress, ie);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="namespaceinet.html#ab4f59162a287d7a85fde3ca104470c6e">contains</a>(<a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>, destAddress))</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                <a class="code" href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">cnList</a>.push_back(destAddress);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1_ipv6_tunneling.html#af29e0d28a7635369670b30db65fbd1e8">inet::Ipv6Tunneling::decapsulateDatagram()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>.</p>

</div>
</div>
<a id="a654465e95bd0340136b7d9b4aa2b3b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654465e95bd0340136b7d9b4aa2b3b83">&#9670;&nbsp;</a></span>updateBUL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inet::xMIPv6::updateBUL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> *&#160;</td>
          <td class="paramname"><em>bu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_address.html">Ipv6Address</a> &amp;&#160;</td>
          <td class="paramname"><em>CoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinet_1_1_network_interface.html">NetworkInterface</a> *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const simtime_t&#160;</td>
          <td class="paramname"><em>sendTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the an entry of the BUL with the provided parameters. </p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> buLife = 4 * bu-&gt;getLifetime(); <span class="comment">/* 6.1.7 One time unit is 4 seconds. */</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> buSeq = bu-&gt;getSequence();</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    Ipv6Address HoA = bu-&gt;getHomeAddressMN();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// to point to the struct where i am globally recording the startisitcs for sent time and next sent time for the BU:</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    BuTransmitIfEntry *buIfEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#ad7236c0fa0b79504eb59ac9d6281912c">fetchBUTransmitIfEntry</a>(ie, dest);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (buIfEntry == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;No scheduled BU entry available!\n&quot;</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">//    simtime_t sentTime = buIfEntry-&gt;presentSentTimeBU;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">//    simtime_t nextSentTime = buIfEntry-&gt;nextScheduledTime;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">//    ASSERT(bul);</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;addOrUpdateBUL(dest, HoA, CoA, buLife, buSeq, sendTime); <span class="comment">// , nextSentTime); //updates the binding Update List</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">//    EV &lt;&lt; &quot;#### Updated BUL with lifetime=&quot; &lt;&lt; buLife &lt;&lt; &quot;and sentTime=&quot; &lt;&lt; sentTime &lt;&lt; endl;</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">createAndSendBUMessage()</a>.</p>

</div>
</div>
<a id="a4ea0a5a74761087a91035347e406773e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ea0a5a74761087a91035347e406773e">&#9670;&nbsp;</a></span>validateBAck()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::validateBAck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_binding_acknowledgement.html">BindingAcknowledgement</a> &amp;&#160;</td>
          <td class="paramname"><em>ba</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validates a Binding Acknowledgement for a mobile node. </p>
<div class="fragment"><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;{</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">/*11.7.3</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">       Upon receiving a packet carrying a Binding Acknowledgement, a mobile</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">       node MUST validate the packet according to the following tests:</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">       o  The packet meets the authentication requirements for Binding</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">         Acknowledgements defined in Section 6.1.8 and Section 5.  That is,</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">         if the Binding Update was sent to the home agent, underlying IPsec</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">         protection is used.  If the Binding Update was sent to the</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">         correspondent node, the Binding Authorization Data mobility option</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">         MUST be present and have a valid value.*/</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    Ipv6Address cnAddress = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keyword">auto</span> ifTag = packet-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(ifTag-&gt;getInterfaceId());</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">if</span> (cnAddress != ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getHomeAgentAddress()) { <span class="comment">// BAck comes from a CN and not from the HA</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordflow">if</span> (ba.getBindingAuthorizationData() == <a class="code" href="_binding_update_list_8h.html#a0770994de63505f39900396055458bf9">UNDEFINED_BIND_AUTH_DATA</a>) {</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot;BA Validation Failed: Binding Authorization Data invalid !&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">/*o  The Sequence Number field matches the Sequence Number sent by the</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">         mobile node to this destination address in an outstanding Binding</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">         Update.*/</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;getSequenceNumber(cnAddress) != ba.getSequenceNumber()) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;BA Validation Failed: Sequence number from BA does not match the one from the BUL!!\n&quot;</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    }</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>.</p>

</div>
</div>
<a id="a1ea27a7d716da8d2643cc08569b305e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ea27a7d716da8d2643cc08569b305e7">&#9670;&nbsp;</a></span>validateBUderegisterMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::validateBUderegisterMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>bu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Similiar to <a class="el" href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611" title="Validate a BU - only applicable to HAs and CNs.">validateBUMessage()</a>. </p>
<p>However, this one is used only by HA to verify deregistration BU. </p>
<div class="fragment"><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;{</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">/*To begin processing the Binding Update, the home agent MUST perform</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">       the following test:</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">         o  If the receiving node has no entry marked as a home registration</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">       in its Binding Cache for this mobile node, then this node MUST</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">       reject the Binding Update and SHOULD return a Binding</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">       Acknowledgement to the mobile node, in which the Status field is</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">       set to 133 (not home agent for this mobile node).*/</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;isInBindingCache(bu-&gt;getHomeAddressMN())</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;           &amp;&amp; <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;getHomeRegistration(bu-&gt;getHomeAddressMN());</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>.</p>

</div>
</div>
<a id="a4f7952971db44389a9ec5fda211ea611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f7952971db44389a9ec5fda211ea611">&#9670;&nbsp;</a></span>validateBUMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::validateBUMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr&lt; const <a class="el" href="classinet_1_1_binding_update.html">BindingUpdate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>bu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate a BU - only applicable to HAs and CNs. </p>
<div class="fragment"><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;{</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keyword">auto</span> ifTag = packet-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// Performs BU Validation according to RFC3775 Sec 9.5.1</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;ROUTINE WHERE BU GETS VALIDATED&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;\n&quot;</span>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    Ipv6Address src = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    Ipv6Address homeAddress = bu-&gt;getHomeAddressMN(); <span class="comment">// confirm whether it is getHomeAddressMN() or simply homeAddress()</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> seqNumber = bu-&gt;getSequence(); <span class="comment">// The seq Number of the recieved BU</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">uint</a> bcSeqNumber = <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;readBCSequenceNumber(homeAddress); <span class="comment">// The seq Number of the last recieved BU in the Binding cache</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// restructured the following and removed &quot;delete bu&quot;</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (!(src.isGlobal() &amp;&amp; src.isUnicast())) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: SrcAdress is not unicast Global !&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Dropping unvalidated BU message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        bubble(<span class="stringliteral">&quot;!! BU Validation Failed !!&quot;</span>);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// result = false;</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span> (!(homeAddress.isGlobal() &amp;&amp; homeAddress.isUnicast())) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: Home Adress of MN is not unicast Global !&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        bubble(<span class="stringliteral">&quot;!! BU Validation Failed !!&quot;</span>);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Dropping unvalidated BU message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// result = false;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">/*9.5.1</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">       This Sequence Number comparison MUST be performed modulo 2**16, i.e.,</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">       the number is a free running counter represented modulo 65536.  A</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">       Sequence Number in a received Binding Update is considered less than</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">       or equal to the last received number if its value lies in the range</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">       of the last received number and the preceding 32768 values, inclusive.*/</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((bcSeqNumber % 65536) &gt; seqNumber) || ((32768 + bcSeqNumber) % 65536 &lt; seqNumber)) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: Received Seq#: &quot;</span> &lt;&lt; seqNumber &lt;&lt; <span class="stringliteral">&quot; is LESS THAN in BC: &quot;</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                &lt;&lt; bcSeqNumber &lt;&lt; endl;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        bubble(<span class="stringliteral">&quot;!! BU Validation Failed !!&quot;</span>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Dropping unvalidated BU message&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="comment">/*9.5.1</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">           If the mobile node sends a sequence number which is not greater than</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">             the sequence number from the last valid Binding Update for this home</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">           address, then the receiving node MUST send back a Binding</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">           Acknowledgement with status code 135, and the last accepted sequence</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">           number in the Sequence Number field of the Binding Acknowledgement.*/</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        Ipv6Address destAddress = packet-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(destAddress, homeAddress, ifTag-&gt;getInterfaceId(), <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa48fe0050c2dc5c3369918c524bdb1ef4">REGISTRATION_TYPE_CHANGE_DISALLOWED</a>,</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                bu-&gt;getBindingAuthorizationData(), bcSeqNumber, 0);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// this is the CN validation part</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (!bu-&gt;getHomeRegistrationFlag()) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;getHomeRegistration(homeAddress) != bu-&gt;getHomeRegistrationFlag()) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="comment">/*9.5.1</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">               If a binding already exists for the given home address and the home</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">                 registration flag has a different value than the Home Registration</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">                 (H) bit in the Binding Update, then the receiving node MUST send back</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">                 a Binding Acknowledgement with status code 139 (registration type</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">                 change disallowed).  The home registration flag stored in the Binding</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">                 Cache entry MUST NOT be changed.*/</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: home registration flag in binding cache has different value than in the binding update&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <a class="code" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage</a>(src, homeAddress, ifTag-&gt;getInterfaceId(), <a class="code" href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa48fe0050c2dc5c3369918c524bdb1ef4">REGISTRATION_TYPE_CHANGE_DISALLOWED</a>,</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    bu-&gt;getBindingAuthorizationData(), bcSeqNumber, 0);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordtype">int</span> homeToken = <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;generateHomeToken(homeAddress, 0); <span class="comment">// TODO nonce</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordtype">int</span> careOfToken = <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;generateCareOfToken(src, 0); <span class="comment">// TODO nonce</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordtype">int</span> bindAuthData = <a class="code" href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">bc</a>-&gt;generateKey(homeToken, careOfToken, src);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">if</span> (bu-&gt;getLifetime() == 0) { <span class="comment">// deregistration BU</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            EV_DETAIL &lt;&lt; <span class="stringliteral">&quot;homeToken=&quot;</span> &lt;&lt; homeToken &lt;&lt; <span class="stringliteral">&quot;, careOfToken=&quot;</span> &lt;&lt; careOfToken</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; , bindAuthData=&quot;</span> &lt;&lt; bindAuthData</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, BU data=&quot;</span> &lt;&lt; bu-&gt;getBindingAuthorizationData() &lt;&lt; endl;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="keywordflow">if</span> ((bu-&gt;getBindingAuthorizationData() != bindAuthData)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                &amp;&amp; (bu-&gt;getBindingAuthorizationData() != homeToken)) <span class="comment">// this is quick and dirty -&gt; TODO</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: Binding Authorization Data invalid!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordflow">else</span> { <span class="comment">// registration BU</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordflow">if</span> (bu-&gt;getBindingAuthorizationData() != bindAuthData) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                EV_WARN &lt;&lt; <span class="stringliteral">&quot;BU Validation Failed: Binding Authorization Data invalid!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">// If all the above tests are passed the Received BU is valid</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    EV_INFO &lt;&lt; <span class="stringliteral">&quot;BU validation passed&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">if</span> (hasGUI())</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        bubble(<span class="stringliteral">&quot;BU Validated&quot;</span>);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// result;</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>.</p>

</div>
</div>
<a id="af014acd28edfaa0506809d36c1723385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af014acd28edfaa0506809d36c1723385">&#9670;&nbsp;</a></span>validateCoTMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::validateCoTMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_care_of_test.html">CareOfTest</a> &amp;&#160;</td>
          <td class="paramname"><em>CoT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Like <a class="el" href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a" title="Verifies a HoT according to the RFC, Section 11.6.2.">validateHoTMessage()</a>, but related to CoT. </p>
<div class="fragment"><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;{</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">// RFC - 11.6.2</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    Ipv6Address srcAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    Ipv6Address destAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keyword">auto</span> ifTag = inPacket-&gt;getTag&lt;InterfaceInd&gt;();</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordtype">int</span> interfaceID = ifTag-&gt;getInterfaceId();</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">/* The Source Address of the packet belongs to a correspondent node</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">       for which the mobile node has a Binding Update List entry with a</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">       state indicating that return routability procedure is in progress.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">       Note that there may be multiple such entries. */</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(srcAddr);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">if</span> (bulEntry == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid CoT: No entry in BUL&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no entry in BUL</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span> (bulEntry-&gt;sentHoTI == 0 &amp;&amp; bulEntry-&gt;sentCoTI == 0) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid CoT: No RR procedure initialized for this CN.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no RR procedure started for this entry</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="comment">/* The Binding Update List indicates that no care-of keygen token has</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">       been received yet.. */</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="comment">// TODO reactive this code as soon as token expiry is available in the BUL</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">/*if (bulEntry-&gt;tokenC != UNDEFINED_TOKEN)</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">       {</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">        EV &lt;&lt; &quot;Invalid CoT: Already received a care-of keygen token.&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">        return false; // 0 is expected to indicate &quot;undefined&quot;</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">       }*/</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="comment">/* The Destination Address of the packet is the current care-of</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">       address of the mobile node. */</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    NetworkInterface *ie = <a class="code" href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">ift</a>-&gt;getInterfaceById(interfaceID);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordflow">if</span> (destAddr != ie-&gt;getProtocolData&lt;Ipv6InterfaceData&gt;()-&gt;getGlobalAddress(Ipv6InterfaceData::CoA)) {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid CoT: CoA not valid anymore.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    }</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">/* The Care-of Init Cookie field in the message matches the value</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">       stored in the Binding Update List. */</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="keywordflow">if</span> (bulEntry-&gt;cookieCoTI != (<span class="keywordtype">int</span>)CoT.getCareOfInitCookie()) {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid CoT: Cookie value different from the stored one.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">// if we have come that far, the CoT is valid</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage()</a>.</p>

</div>
</div>
<a id="a50116ffe3505669219e721a31040529a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50116ffe3505669219e721a31040529a">&#9670;&nbsp;</a></span>validateHoTMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::validateHoTMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinet_1_1_packet.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>inPacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_home_test.html">HomeTest</a> &amp;&#160;</td>
          <td class="paramname"><em>HoT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verifies a HoT according to the RFC, Section 11.6.2. </p>
<div class="fragment"><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;{</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// RFC - 11.6.2</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    Ipv6Address srcAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getSrcAddress().toIpv6();</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    Ipv6Address destAddr = inPacket-&gt;getTag&lt;<a class="code" href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a>&gt;()-&gt;getDestAddress().toIpv6();</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">//    int interfaceID = ctrlInfo-&gt;interfaceId();</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">/* The Source Address of the packet belongs to a correspondent node</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">       for which the mobile node has a Binding Update List entry with a</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">       state indicating that return routability procedure is in progress.</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">       Note that there may be multiple such entries. */</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    BindingUpdateList::BindingUpdateListEntry *bulEntry = <a class="code" href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">bul</a>-&gt;lookup(srcAddr);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">if</span> (bulEntry == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid HoT: No entry in BUL&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no entry in BUL</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">/* The Binding Update List indicates that no home keygen token has</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment">       been received yet. */</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">// TODO reactivate this code as soon as token expiry is available in the BUL</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">/*if (bulEntry-&gt;tokenH != UNDEFINED_TOKEN)</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment">       {</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">        EV &lt;&lt; &quot;Invalid HoT: Home keygen token already exists.&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">        return false; // 0 is expected to indicate &quot;undefined&quot;</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">       }*/</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">/* The Destination Address of the packet has the home address of the</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">       mobile node, and the packet has been received in a tunnel from the</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">       home agent. */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">// TODO check whether it is necessary to check HoA exlusively for the</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="comment">// interface the message was received on.</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">rt6</a>-&gt;isHomeAddress(destAddr)) {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid HoT: Destination Address not HoA.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// TODO check whether packet was received from HA tunnel</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="comment">/* The Home Init Cookie field in the message matches the value stored</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">       in the Binding Update List. */</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordflow">if</span> (bulEntry-&gt;cookieHoTI != (<span class="keywordtype">int</span>)homeTest.getHomeInitCookie()) {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid HoT: Cookie value different from the stored one.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">// if we have come that far, the HoT is valid</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage()</a>.</p>

</div>
</div>
<a id="a1e839823650092fa089ab28fce4528a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e839823650092fa089ab28fce4528a2">&#9670;&nbsp;</a></span>validateType2RH()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool inet::xMIPv6::validateType2RH </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_header.html">Ipv6Header</a> &amp;&#160;</td>
          <td class="paramname"><em>ipv6Header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinet_1_1_ipv6_routing_header.html">Ipv6RoutingHeader</a> &amp;&#160;</td>
          <td class="paramname"><em>rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform validity checks according to RFC 3775 - Section 6.4. </p>
<div class="fragment"><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;{</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">// cf. RFC 3775 - 6.4</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="keywordflow">if</span> (rh.getAddressArraySize() != 1) {</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid RH2 header: no HoA provided!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    }</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; </div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    Ipv6Address CoA = ipv6Header.getSrcAddress();</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    Ipv6Address HoA = rh.getAddress(0);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="comment">/* The IP address contained in the routing header, since it is the mobile</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">       node&#39;s home address, MUST be a unicast routable address. */</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordflow">if</span> (!HoA.isUnicast()) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid RH2 header: address in RH2 is not a unicast routable address!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    }</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="comment">/* Furthermore, if the scope of the home address is smaller than the</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">       scope of the care-of address, the mobile node MUST discard the packet */</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordflow">if</span> (HoA.getScope() &lt; CoA.getScope()) {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        EV_WARN &lt;&lt; <span class="stringliteral">&quot;Invalid RH2 header: scope of Address in RH2 is smaller than the source address of the datagram!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a74c931b057a65aac096b01ddfdf28450">processType2RH()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aaedd0e625db0006062acff0fe98419b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaedd0e625db0006062acff0fe98419b3">&#9670;&nbsp;</a></span>bc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_binding_cache.html">BindingCache</a>&gt; inet::xMIPv6::bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">handleBCExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a51d5963d559ada7fdf5e8f78deb3d110">processCoTIMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a3c68a093ad4a7f05896c4393d23c5fe0">processHoAOpt()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a9464cca6b8db5cf370994bd4b37af21e">processHoTIMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a1ea27a7d716da8d2643cc08569b305e7">validateBUderegisterMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611">validateBUMessage()</a>.</p>

</div>
</div>
<a id="a0b4704a9c3f214da125430daa5ccac90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b4704a9c3f214da125430daa5ccac90">&#9670;&nbsp;</a></span>bul</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_binding_update_list.html">BindingUpdateList</a>&gt; inet::xMIPv6::bul</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">checkForBUtoCN()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a58e6b3c651470bc1b377bcd5ccb04f27">createBUTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">handleTokenExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">initiateMipv6Protocol()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">initReturnRoutability()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">processBRRMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a41dfe546eaa52dd2544407b80b044bec">sendPeriodicBU()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a259fe47417bf0168de80810b5137ca5c">sendTestInit()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a654465e95bd0340136b7d9b4aa2b3b83">updateBUL()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4ea0a5a74761087a91035347e406773e">validateBAck()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#af014acd28edfaa0506809d36c1723385">validateCoTMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a">validateHoTMessage()</a>.</p>

</div>
</div>
<a id="a20ba2534b1c334718b71ca4fa2b6965d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ba2534b1c334718b71ca4fa2b6965d">&#9670;&nbsp;</a></span>cnList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1x_m_i_pv6.html#a4e82206fc313109ceab061cb035c3b42">CnList</a> inet::xMIPv6::cnList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">initiateMipv6Protocol()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization()</a>.</p>

</div>
</div>
<a id="afbd697045dcbb870067637a497a1d4b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbd697045dcbb870067637a497a1d4b9">&#9670;&nbsp;</a></span>ift</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_i_interface_table.html">IInterfaceTable</a>&gt; inet::xMIPv6::ift</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">cancelEntries()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">createAndSendBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">processBRRMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">processCoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">processHoTMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4ea0a5a74761087a91035347e406773e">validateBAck()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#af014acd28edfaa0506809d36c1723385">validateCoTMessage()</a>.</p>

</div>
</div>
<a id="a026f43021a6cb4663eebbdf430a51a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a026f43021a6cb4663eebbdf430a51a08">&#9670;&nbsp;</a></span>interfaceCoAList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1x_m_i_pv6.html#a61385548df7ee06f171c75775c271463">InterfaceCoAList</a> inet::xMIPv6::interfaceCoAList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a6b6778cff1888b1f98f487f7a5ef4151">removeCoAEntries()</a>.</p>

</div>
</div>
<a id="a1df03c81b24aa899e6f71b02f997d3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1df03c81b24aa899e6f71b02f997d3d8">&#9670;&nbsp;</a></span>ipv6nd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_ipv6_neighbour_discovery.html">Ipv6NeighbourDiscovery</a>&gt; inet::xMIPv6::ipv6nd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>.</p>

</div>
</div>
<a id="a1ca971cb70dd3d8468354d96ce504298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca971cb70dd3d8468354d96ce504298">&#9670;&nbsp;</a></span>itCNList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CnList::iterator inet::xMIPv6::itCNList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>.</p>

</div>
</div>
<a id="a86e2da85c22ddd1da5442bb13d19c8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e2da85c22ddd1da5442bb13d19c8af">&#9670;&nbsp;</a></span>rt6</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">opp_component_ptr&lt;<a class="el" href="classinet_1_1_ipv6_routing_table.html">Ipv6RoutingTable</a>&gt; inet::xMIPv6::rt6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">initiateMipv6Protocol()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a74c931b057a65aac096b01ddfdf28450">processType2RH()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">removeTimerEntries()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a">validateHoTMessage()</a>.</p>

</div>
</div>
<a id="a54ce78a78600ff9cdc67cd3677b7f6c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54ce78a78600ff9cdc67cd3677b7f6c7">&#9670;&nbsp;</a></span>statVectorBAfromCN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorBAfromCN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2968ab420d464333f6507777807e258c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2968ab420d464333f6507777807e258c">&#9670;&nbsp;</a></span>statVectorBAfromHA</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorBAfromHA</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad7f4d1946d689b82a6262f573b4dff34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7f4d1946d689b82a6262f573b4dff34">&#9670;&nbsp;</a></span>statVectorBAtoMN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorBAtoMN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac3530c9e0b9300865f35dfa4e8e0dbb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3530c9e0b9300865f35dfa4e8e0dbb2">&#9670;&nbsp;</a></span>statVectorBUtoCN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorBUtoCN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae1358e19a397fcf92ab6eb211feb29a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1358e19a397fcf92ab6eb211feb29a0">&#9670;&nbsp;</a></span>statVectorBUtoHA</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorBUtoHA</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3f4c6a6a899062b7fcc3ff652bf2889f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f4c6a6a899062b7fcc3ff652bf2889f">&#9670;&nbsp;</a></span>statVectorBUtoMN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorBUtoMN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a476bc4885f79353c96aad51c748a4ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a476bc4885f79353c96aad51c748a4ad2">&#9670;&nbsp;</a></span>statVectorCoTfromCN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorCoTfromCN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5ba727d3d571dbf2bfa502f43347aa42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba727d3d571dbf2bfa502f43347aa42">&#9670;&nbsp;</a></span>statVectorCoTItoCN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorCoTItoCN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab366c8aa68a9433b0a534418b947d196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab366c8aa68a9433b0a534418b947d196">&#9670;&nbsp;</a></span>statVectorCoTtoMN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorCoTtoMN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6a3d32424201efff4545cff6ca270ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a3d32424201efff4545cff6ca270ec">&#9670;&nbsp;</a></span>statVectorHoTfromCN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorHoTfromCN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1b51180fdf6816df8f8c3b3ea38a856c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b51180fdf6816df8f8c3b3ea38a856c">&#9670;&nbsp;</a></span>statVectorHoTItoCN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorHoTItoCN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a85216c5121ada09d0546edca70230eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85216c5121ada09d0546edca70230eaa">&#9670;&nbsp;</a></span>statVectorHoTtoMN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector inet::xMIPv6::statVectorHoTtoMN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3073c578651b8e4272c86373ee96e2f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3073c578651b8e4272c86373ee96e2f2">&#9670;&nbsp;</a></span>transmitIfList</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1x_m_i_pv6.html#a236f56f8cf9b803915087a0f520c7ac0">TransmitIfList</a> inet::xMIPv6::transmitIfList</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">cancelEntries()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">cancelTimerIfEntry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a569259d4846043449f7e9448dd5f5851">createBRRTimer()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#ad7236c0fa0b79504eb59ac9d6281912c">fetchBUTransmitIfEntry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">getTimerIfEntry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a8b83360b05ab5929bcb83d008b29a959">pendingTimerIfEntry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a413465c28f01387fe2f85f631d94fb1f">resetBUIfEntry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a7f3d7b04dc134a664dac950e63948b92">searchTimerIfEntry()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#ac7c070267c8193527338a81f65288785">~xMIPv6()</a>.</p>

</div>
</div>
<a id="a1279d6acb1593dd76e210197b33d3300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1279d6acb1593dd76e210197b33d3300">&#9670;&nbsp;</a></span>tunneling</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinet_1_1_module_ref_by_par.html">ModuleRefByPar</a>&lt;<a class="el" href="classinet_1_1_ipv6_tunneling.html">Ipv6Tunneling</a>&gt; inet::xMIPv6::tunneling</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">cancelEntries()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">handleBCExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">handleBULExpiry()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a0cb2922fe72da5551377c29bdc8264df">initialize()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a7ba3092ea3088e56f1fd80e2e5ddb038">initiateMipv6Protocol()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">processBAMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">processBUMessage()</a>, <a class="el" href="classinet_1_1x_m_i_pv6.html#a8ca9874936a1263019aa7b73a0573fb9">returningHome()</a>, and <a class="el" href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">triggerRouteOptimization()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="x_m_i_pv6_8h.html">xMIPv6.h</a></li>
<li><a class="el" href="x_m_i_pv6_8cc.html">xMIPv6.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996faf8341e3e8b2b2e45948f0a1b55f7e01d"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996faf8341e3e8b2b2e45948f0a1b55f7e01d">inet::EXPIRED_CARE_OF_NONCE_INDEX</a></div><div class="ttdeci">@ EXPIRED_CARE_OF_NONCE_INDEX</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:235</div></div>
<div class="ttc" id="a_i_n_e_t_defs_8h_html_af3e4d5321e837cae974ef2a2871d9e0e"><div class="ttname"><a href="_i_n_e_t_defs_8h.html#af3e4d5321e837cae974ef2a2871d9e0e">CHK</a></div><div class="ttdeci">#define CHK(x)</div><div class="ttdef"><b>Definition:</b> INETDefs.h:87</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a6b6778cff1888b1f98f487f7a5ef4151"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a6b6778cff1888b1f98f487f7a5ef4151">inet::xMIPv6::removeCoAEntries</a></div><div class="ttdeci">void removeCoAEntries()</div><div class="ttdoc">Remove all entries from the interfaceCoAList.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2368</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a6d95ac743e8277891cc1093a62ab9f18"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a6d95ac743e8277891cc1093a62ab9f18">MK_BUL_EXPIRY</a></div><div class="ttdeci">#define MK_BUL_EXPIRY</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:38</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a07d097cc1f15ca8f7e7dde3bf99f2948"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a07d097cc1f15ca8f7e7dde3bf99f2948">inet::xMIPv6::createBUTimer</a></div><div class="ttdeci">void createBUTimer(const Ipv6Address &amp;buDest, NetworkInterface *ie, const uint lifeTime, bool homeRegistration)</div><div class="ttdoc">This method finally creates the timer structure and schedules the message for sending.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:354</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a4f7952971db44389a9ec5fda211ea611"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a4f7952971db44389a9ec5fda211ea611">inet::xMIPv6::validateBUMessage</a></div><div class="ttdeci">bool validateBUMessage(Packet *inPacket, const Ptr&lt; const BindingUpdate &gt; &amp;bu)</div><div class="ttdoc">Validate a BU - only applicable to HAs and CNs.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:942</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0ab8c8a5d3127033d17a8401c63d98c1b6"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0ab8c8a5d3127033d17a8401c63d98c1b6">inet::CARE_OF_TEST</a></div><div class="ttdeci">@ CARE_OF_TEST</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:80</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a41dfe546eaa52dd2544407b80b044bec"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a41dfe546eaa52dd2544407b80b044bec">inet::xMIPv6::sendPeriodicBU</a></div><div class="ttdeci">void sendPeriodicBU(cMessage *msg)</div><div class="ttdoc">This method is called when the timer created in createBUTimer() has fired.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:399</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0ac49358ac49b4e3a7932c8c8b6b4fe612"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0ac49358ac49b4e3a7932c8c8b6b4fe612">inet::CARE_OF_TEST_INIT</a></div><div class="ttdeci">@ CARE_OF_TEST_INIT</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:78</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a08bef6eef2ae0e4b244148e8fa77f8b5"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a08bef6eef2ae0e4b244148e8fa77f8b5">inet::xMIPv6::createAndSendCoTIMessage</a></div><div class="ttdeci">void createAndSendCoTIMessage(const Ipv6Address &amp;cnDest, NetworkInterface *ie)</div><div class="ttdoc">Creates and sends a CoTI message to the specified destination.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1689</div></div>
<div class="ttc" id="aclassinet_1_1_binding_update_list_html_aff0f712d36063a6b38c224fa0dd1fd1aa46341e593269699821a9c10251bedd0f"><div class="ttname"><a href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa46341e593269699821a9c10251bedd0f">inet::BindingUpdateList::RR_COMPLETE</a></div><div class="ttdeci">@ RR_COMPLETE</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:42</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a51d5963d559ada7fdf5e8f78deb3d110"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a51d5963d559ada7fdf5e8f78deb3d110">inet::xMIPv6::processCoTIMessage</a></div><div class="ttdeci">void processCoTIMessage(Packet *inPacket, const Ptr&lt; const CareOfTestInit &gt; &amp;CoTI)</div><div class="ttdoc">Create and send a CoT message.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1724</div></div>
<div class="ttc" id="aclassinet_1_1_binding_update_list_html_aff0f712d36063a6b38c224fa0dd1fd1aa84718d3bdca6a089024544c71a52f10a"><div class="ttname"><a href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa84718d3bdca6a089024544c71a52f10a">inet::BindingUpdateList::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:40</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996fad0939b5cde09ba00559e47c22e86ac02"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fad0939b5cde09ba00559e47c22e86ac02">inet::BINDING_UPDATE_ACCEPTED</a></div><div class="ttdeci">@ BINDING_UPDATE_ACCEPTED</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:224</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0a0cb12dbd2feed355e078600b9ef1e32b"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0a0cb12dbd2feed355e078600b9ef1e32b">inet::BINDING_ERROR</a></div><div class="ttdeci">@ BINDING_ERROR</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:83</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996fa48fe0050c2dc5c3369918c524bdb1ef4"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa48fe0050c2dc5c3369918c524bdb1ef4">inet::REGISTRATION_TYPE_CHANGE_DISALLOWED</a></div><div class="ttdeci">@ REGISTRATION_TYPE_CHANGE_DISALLOWED</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:237</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aac12220d4e76973d65d6ec017082cccb"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aac12220d4e76973d65d6ec017082cccb">inet::xMIPv6::getTimerIfEntry</a></div><div class="ttdeci">TimerIfEntry * getTimerIfEntry(Key &amp;key, int timerType)</div><div class="ttdoc">Returns a pointer to an TimerIfEntry object identified by the provided key, which can be one of the p...</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2224</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aa35090fe5ce065706e4c1449c12ae75f"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aa35090fe5ce065706e4c1449c12ae75f">inet::xMIPv6::checkForBUtoCN</a></div><div class="ttdeci">bool checkForBUtoCN(BindingUpdateList::BindingUpdateListEntry &amp;bulEntry, NetworkInterface *ie)</div><div class="ttdoc">Send a BU depending on current status of:</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1936</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a0d624c2f873e2272de302d17053f4604"><div class="ttname"><a href="x_m_i_pv6_8h.html#a0d624c2f873e2272de302d17053f4604">TRANSMIT_TYPE_BU</a></div><div class="ttdeci">#define TRANSMIT_TYPE_BU</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:44</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_ac1aa90c3bed562838eb25ef6fee982f9"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#ac1aa90c3bed562838eb25ef6fee982f9">inet::xMIPv6::cancelTimerIfEntry</a></div><div class="ttdeci">bool cancelTimerIfEntry(const Ipv6Address &amp;dest, int interfaceID, int msgType)</div><div class="ttdoc">Deletes the appropriate entry from the transmitIfList and cancels the corresponding retransmission ti...</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2192</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996fa8d4bba16bb8a54df72df11c34e67f4df"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa8d4bba16bb8a54df72df11c34e67f4df">inet::NOT_HA_FOR_THIS_MN</a></div><div class="ttdeci">@ NOT_HA_FOR_THIS_MN</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:231</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aa80789234568c887c26c1c95cb51884f"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aa80789234568c887c26c1c95cb51884f">inet::xMIPv6::createAndSendBEMessage</a></div><div class="ttdeci">void createAndSendBEMessage(const Ipv6Address &amp;dest, const BeStatus &amp;beStatus)</div><div class="ttdoc">Creates and sends Binding Error message.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2176</div></div>
<div class="ttc" id="aclassinet_1_1_protocol_html_a48a5edce148938073a2e901e1d776382"><div class="ttname"><a href="classinet_1_1_protocol.html#a48a5edce148938073a2e901e1d776382">inet::Protocol::ipv6</a></div><div class="ttdeci">static const Protocol ipv6</div><div class="ttdef"><b>Definition:</b> Protocol.h:94</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_ad7236c0fa0b79504eb59ac9d6281912c"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#ad7236c0fa0b79504eb59ac9d6281912c">inet::xMIPv6::fetchBUTransmitIfEntry</a></div><div class="ttdeci">xMIPv6::BuTransmitIfEntry * fetchBUTransmitIfEntry(NetworkInterface *ie, const Ipv6Address &amp;dest)</div><div class="ttdoc">This method takes an interface and a destination address and returns the appropriate IfEntry for an B...</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:610</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_tunneling_html_a95e9426d5d66ba8d43ea1afb3ee6b653a9413423f3c98a13bb329e1a870938ee5"><div class="ttname"><a href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653a9413423f3c98a13bb329e1a870938ee5">inet::Ipv6Tunneling::MOBILITY</a></div><div class="ttdeci">@ MOBILITY</div><div class="ttdef"><b>Definition:</b> Ipv6Tunneling.h:47</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a50116ffe3505669219e721a31040529a"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a50116ffe3505669219e721a31040529a">inet::xMIPv6::validateHoTMessage</a></div><div class="ttdeci">bool validateHoTMessage(Packet *inPacket, const HomeTest &amp;HoT)</div><div class="ttdoc">Verifies a HoT according to the RFC, Section 11.6.2.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1788</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aa3ea8a29978d35fe97e223faf86f042d"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aa3ea8a29978d35fe97e223faf86f042d">inet::xMIPv6::sendBUtoCN</a></div><div class="ttdeci">void sendBUtoCN(BindingUpdateList::BindingUpdateListEntry &amp;bulEntry, NetworkInterface *ie)</div><div class="ttdoc">Creates a timer for sending a BU.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1995</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a9464cca6b8db5cf370994bd4b37af21e"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a9464cca6b8db5cf370994bd4b37af21e">inet::xMIPv6::processHoTIMessage</a></div><div class="ttdeci">void processHoTIMessage(Packet *inPacket, const Ptr&lt; const HomeTestInit &gt; &amp;HoTI)</div><div class="ttdoc">Create and send a HoT message.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1700</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a86e2da85c22ddd1da5442bb13d19c8af"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a86e2da85c22ddd1da5442bb13d19c8af">inet::xMIPv6::rt6</a></div><div class="ttdeci">opp_component_ptr&lt; Ipv6RoutingTable &gt; rt6</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:62</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0afbc2526005b21a68dbaacb79c7e85480"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0afbc2526005b21a68dbaacb79c7e85480">inet::BINDING_REFRESH_REQUEST</a></div><div class="ttdeci">@ BINDING_REFRESH_REQUEST</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:76</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a273bc5eeb718938cd4da6e7f61fe3dd1"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a273bc5eeb718938cd4da6e7f61fe3dd1">SIZE_BE</a></div><div class="ttdeci">#define SIZE_BE</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:58</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a9d86571db17029d80fa8bcb0979ecaea"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a9d86571db17029d80fa8bcb0979ecaea">BRR_TIMEOUT_THRESHOLD</a></div><div class="ttdeci">#define BRR_TIMEOUT_THRESHOLD</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:41</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a6a15750da5e4a84c0798ecc2b69a278b"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a6a15750da5e4a84c0798ecc2b69a278b">inet::xMIPv6::handleTokenExpiry</a></div><div class="ttdeci">void handleTokenExpiry(cMessage *msg)</div><div class="ttdoc">Handles the event that indicates that a {care-of,home} keygen token has expired.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2677</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a5e84b0c9d17cc2b04d68774f71b8e168"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a5e84b0c9d17cc2b04d68774f71b8e168">inet::xMIPv6::createTokenEntryExpiryTimer</a></div><div class="ttdeci">void createTokenEntryExpiryTimer(Ipv6Address &amp;cnAddr, NetworkInterface *ie, simtime_t scheduledTime, int tokenType)</div><div class="ttdoc">Creates or overwrites a timer for {home, care-of} keygen token expiry that fires at provided schedule...</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2656</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a06985160c711bec7d2c91ff06a4574a0"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a06985160c711bec7d2c91ff06a4574a0">inet::xMIPv6::handleBULExpiry</a></div><div class="ttdeci">void handleBULExpiry(cMessage *msg)</div><div class="ttdoc">Handles the situation of a BUL expiry.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2543</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a1e839823650092fa089ab28fce4528a2"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a1e839823650092fa089ab28fce4528a2">inet::xMIPv6::validateType2RH</a></div><div class="ttdeci">bool validateType2RH(const Ipv6Header &amp;ipv6Header, const Ipv6RoutingHeader &amp;rh)</div><div class="ttdoc">Perform validity checks according to RFC 3775 - Section 6.4.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2093</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a026f43021a6cb4663eebbdf430a51a08"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a026f43021a6cb4663eebbdf430a51a08">inet::xMIPv6::interfaceCoAList</a></div><div class="ttdeci">InterfaceCoAList interfaceCoAList</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:120</div></div>
<div class="ttc" id="anamespaceinet_html_a066c281a0963fccbbe766aac35a28ad6"><div class="ttname"><a href="namespaceinet.html#a066c281a0963fccbbe766aac35a28ad6">inet::getContainingNode</a></div><div class="ttdeci">cModule * getContainingNode(const cModule *from)</div><div class="ttdoc">Find the node containing the given module.</div><div class="ttdef"><b>Definition:</b> ModuleAccess.cc:40</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a7ddbba5f6ade92d237a18c29e3cc37a5"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a7ddbba5f6ade92d237a18c29e3cc37a5">MK_TOKEN_EXPIRY</a></div><div class="ttdeci">#define MK_TOKEN_EXPIRY</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:40</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a3073c578651b8e4272c86373ee96e2f2"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a3073c578651b8e4272c86373ee96e2f2">inet::xMIPv6::transmitIfList</a></div><div class="ttdeci">TransmitIfList transmitIfList</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:116</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a98fdcdc01bf5f67610cbd3fcd05537e4"><div class="ttname"><a href="x_m_i_pv6_8h.html#a98fdcdc01bf5f67610cbd3fcd05537e4">EXPIRY_TYPE_BUL</a></div><div class="ttdeci">#define EXPIRY_TYPE_BUL</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:47</div></div>
<div class="ttc" id="a_binding_update_list_8h_html_ad81571eaf4714ac9fef4c4bcdd378619"><div class="ttname"><a href="_binding_update_list_8h.html#ad81571eaf4714ac9fef4c4bcdd378619">CO_COOKIE</a></div><div class="ttdeci">#define CO_COOKIE</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:28</div></div>
<div class="ttc" id="anamespaceinet_html_a0836489f866ddd35438d3bfe59438d4ba3467f54f97f29cb1ea8d08e935bf8046"><div class="ttname"><a href="namespaceinet.html#a0836489f866ddd35438d3bfe59438d4ba3467f54f97f29cb1ea8d08e935bf8046">inet::UNKNOWN_BINDING_FOR_HOME_ADDRESS_DEST_OPTION</a></div><div class="ttdeci">@ UNKNOWN_BINDING_FOR_HOME_ADDRESS_DEST_OPTION</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:315</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a8d28e59a0d202e69c382d34ad7080937"><div class="ttname"><a href="_i_udp-gates_8txt.html#a8d28e59a0d202e69c382d34ad7080937">InterfaceReq</a></div><div class="ttdeci">removed InterfaceReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:11</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a0323ac93ca7b779d82d9fb23cd4c8681"><div class="ttname"><a href="_i_udp-gates_8txt.html#a0323ac93ca7b779d82d9fb23cd4c8681">DispatchProtocolReq</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down DispatchProtocolReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="anamespaceinet_html_aab979c9efb63d1d231bf289a119eb88e"><div class="ttname"><a href="namespaceinet.html#aab979c9efb63d1d231bf289a119eb88e">inet::INITSTAGE_NETWORK_LAYER</a></div><div class="ttdeci">INET_API InitStage INITSTAGE_NETWORK_LAYER</div><div class="ttdoc">Initialization of network layer protocols.</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a20ba2534b1c334718b71ca4fa2b6965d"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a20ba2534b1c334718b71ca4fa2b6965d">inet::xMIPv6::cnList</a></div><div class="ttdeci">CnList cnList</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:124</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a87382a94f6c41d4075454d079de8cb8b"><div class="ttname"><a href="x_m_i_pv6_8h.html#a87382a94f6c41d4075454d079de8cb8b">EXPIRY_TYPE_BC</a></div><div class="ttdeci">#define EXPIRY_TYPE_BC</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:48</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a34a7fa413a34f527bad65710de8f684d"><div class="ttname"><a href="_i_udp-gates_8txt.html#a34a7fa413a34f527bad65710de8f684d">L3AddressInd</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd L3AddressInd</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:20</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aece14f2aefee479e40b9cc3e3ee70fa4"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aece14f2aefee479e40b9cc3e3ee70fa4">inet::xMIPv6::removeTimerEntries</a></div><div class="ttdeci">void removeTimerEntries(const Ipv6Address &amp;dest, int interfaceId)</div><div class="ttdoc">Removes timers of all types for the specified destination address and interfaceId.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2311</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a880ca9c77a441cd3772ffaec528ea4a7"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a880ca9c77a441cd3772ffaec528ea4a7">SIZE_MOBILITY_HEADER</a></div><div class="ttdeci">#define SIZE_MOBILITY_HEADER</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:48</div></div>
<div class="ttc" id="a_binding_update_list_8h_html_a4bb4091e6bbb177010a02c7ae61fb387"><div class="ttname"><a href="_binding_update_list_8h.html#a4bb4091e6bbb177010a02c7ae61fb387">HO_COOKIE</a></div><div class="ttdeci">#define HO_COOKIE</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:26</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a60631c4c24bf52df8ed3d83be2a49556"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a60631c4c24bf52df8ed3d83be2a49556">SIZE_BACK</a></div><div class="ttdeci">#define SIZE_BACK</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:52</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0af819ce0f0b930b63bd62eede16d26df3"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0af819ce0f0b930b63bd62eede16d26df3">inet::HOME_TEST_INIT</a></div><div class="ttdeci">@ HOME_TEST_INIT</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:77</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_tunneling_html_a95e9426d5d66ba8d43ea1afb3ee6b653ac290af69c78b64b01b3679d9ec76799c"><div class="ttname"><a href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653ac290af69c78b64b01b3679d9ec76799c">inet::Ipv6Tunneling::T2RH</a></div><div class="ttdeci">@ T2RH</div><div class="ttdef"><b>Definition:</b> Ipv6Tunneling.h:45</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a259fe47417bf0168de80810b5137ca5c"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a259fe47417bf0168de80810b5137ca5c">inet::xMIPv6::sendTestInit</a></div><div class="ttdeci">void sendTestInit(cMessage *msg)</div><div class="ttdoc">If a TestInit timer was fired, this method gets called.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1501</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a809adcc4f8be4ebac2a6467d645e79cc"><div class="ttname"><a href="x_m_i_pv6_8h.html#a809adcc4f8be4ebac2a6467d645e79cc">KEY_BC_EXP</a></div><div class="ttdeci">#define KEY_BC_EXP</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:40</div></div>
<div class="ttc" id="anamespaceinet_html_a67ee3c1bb8f0b645969c7c67fd8da444"><div class="ttname"><a href="namespaceinet.html#a67ee3c1bb8f0b645969c7c67fd8da444">inet::mipv6RoCompletedSignal</a></div><div class="ttdeci">simsignal_t mipv6RoCompletedSignal</div><div class="ttdef"><b>Definition:</b> Simsignals.cc:66</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a20b9fca9c2e9560c3645aab624763b6a"><div class="ttname"><a href="x_m_i_pv6_8h.html#a20b9fca9c2e9560c3645aab624763b6a">TRANSMIT_TYPE_TI</a></div><div class="ttdeci">#define TRANSMIT_TYPE_TI</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:45</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a9df5bb95d260beb5f652e9402cac9297"><div class="ttname"><a href="x_m_i_pv6_8h.html#a9df5bb95d260beb5f652e9402cac9297">KEY_CI</a></div><div class="ttdeci">#define KEY_CI</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:37</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a93efecffc166a0fab45479baa0604140"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a93efecffc166a0fab45479baa0604140">inet::xMIPv6::createAndSendBAMessage</a></div><div class="ttdeci">void createAndSendBAMessage(const Ipv6Address &amp;src, const Ipv6Address &amp;dest, int interfaceId, const BaStatus &amp;baStatus, const uint baSeq, const int bindingAuthorizationData, const uint lifeTime, simtime_t sendTime=0)</div><div class="ttdoc">Constructs and send a BA to the Ipv6 module.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1056</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_af49ffb464649fc08a3a0f413961472e5"><div class="ttname"><a href="x_m_i_pv6_8cc.html#af49ffb464649fc08a3a0f413961472e5">SIZE_BIND_AUTH_DATA</a></div><div class="ttdeci">#define SIZE_BIND_AUTH_DATA</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:51</div></div>
<div class="ttc" id="aclassinet_1_1_binding_update_list_html_aff0f712d36063a6b38c224fa0dd1fd1aa053a5e941d65556e86631a96d25b24c8"><div class="ttname"><a href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa053a5e941d65556e86631a96d25b24c8">inet::BindingUpdateList::RR</a></div><div class="ttdeci">@ RR</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:41</div></div>
<div class="ttc" id="anamespaceinet_html_ad0e3c01e474727e9f73920bf7f8ed3ba"><div class="ttname"><a href="namespaceinet.html#ad0e3c01e474727e9f73920bf7f8ed3ba">inet::insertNetworkProtocolHeader</a></div><div class="ttdeci">void insertNetworkProtocolHeader(Packet *packet, const Protocol &amp;protocol, const Ptr&lt; NetworkHeaderBase &gt; &amp;header)</div><div class="ttdef"><b>Definition:</b> L3Tools.cc:70</div></div>
<div class="ttc" id="anamespaceinet_html_a8b3e6258ad8d45309159a6bb395946f7"><div class="ttname"><a href="namespaceinet.html#a8b3e6258ad8d45309159a6bb395946f7">inet::packetDroppedSignal</a></div><div class="ttdeci">simsignal_t packetDroppedSignal</div><div class="ttdef"><b>Definition:</b> Simsignals.cc:85</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0a8b4d7c73d97089a7415beea141c8463f"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0a8b4d7c73d97089a7415beea141c8463f">inet::BINDING_ACKNOWLEDGEMENT</a></div><div class="ttdeci">@ BINDING_ACKNOWLEDGEMENT</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:82</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a30be4668a9f7a72be0723ea9052711b8"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a30be4668a9f7a72be0723ea9052711b8">inet::xMIPv6::processBRRMessage</a></div><div class="ttdeci">void processBRRMessage(Packet *inPacket, const Ptr&lt; const BindingRefreshRequest &gt; &amp;brr)</div><div class="ttdoc">Processes the Binding Refresh Message.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2472</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996fa76f16a8872a649f7f026da540398bb50"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa76f16a8872a649f7f026da540398bb50">inet::EXPIRED_HOME_NONCE_INDEX</a></div><div class="ttdeci">@ EXPIRED_HOME_NONCE_INDEX</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:234</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_afd36d0627e26925acd433b1dd1fdd2bc"><div class="ttname"><a href="_i_udp-gates_8txt.html#afd36d0627e26925acd433b1dd1fdd2bc">PacketProtocolTag</a></div><div class="ttdeci">removed DscpReq Ipv4ControlInfo Ipv6ControlInfo up L3AddressInd DispatchProtocolReq L4PortInd Ipv4ControlInfo Ipv6ControlInfo down PacketProtocolTag</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:25</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0abb44e95ebab40fe474b06a556815ddd1"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0abb44e95ebab40fe474b06a556815ddd1">inet::HOME_TEST</a></div><div class="ttdeci">@ HOME_TEST</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:79</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_ae250d75eb29b33e82c73d1b85cd184bf"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#ae250d75eb29b33e82c73d1b85cd184bf">inet::xMIPv6::createAndSendHoTIMessage</a></div><div class="ttdeci">void createAndSendHoTIMessage(const Ipv6Address &amp;cnDest, NetworkInterface *ie)</div><div class="ttdoc">Creates and sends a HoTI message to the specified destination.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1678</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a1df03c81b24aa899e6f71b02f997d3d8"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a1df03c81b24aa899e6f71b02f997d3d8">inet::xMIPv6::ipv6nd</a></div><div class="ttdeci">ModuleRefByPar&lt; Ipv6NeighbourDiscovery &gt; ipv6nd</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:66</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aaedd0e625db0006062acff0fe98419b3"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aaedd0e625db0006062acff0fe98419b3">inet::xMIPv6::bc</a></div><div class="ttdeci">ModuleRefByPar&lt; BindingCache &gt; bc</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:64</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a50ab006c4ae9e1f254c9ad8ac45bcc71"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a50ab006c4ae9e1f254c9ad8ac45bcc71">inet::xMIPv6::createAndSendBUMessage</a></div><div class="ttdeci">void createAndSendBUMessage(const Ipv6Address &amp;dest, NetworkInterface *ie, const uint buSeq, const uint lifeTime, const int bindAuthData=0)</div><div class="ttdoc">Method for creating and sending a BU by a MN.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:463</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996fa43b1bd4e64befbfb671272c812283134"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa43b1bd4e64befbfb671272c812283134">inet::NOT_HOME_SUBNET</a></div><div class="ttdeci">@ NOT_HOME_SUBNET</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:230</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_tunneling_html_a95e9426d5d66ba8d43ea1afb3ee6b653a36bfb1806cc6b7f8c874ad8e066ec584"><div class="ttname"><a href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653a36bfb1806cc6b7f8c874ad8e066ec584">inet::Ipv6Tunneling::HA_OPT</a></div><div class="ttdeci">@ HA_OPT</div><div class="ttdef"><b>Definition:</b> Ipv6Tunneling.h:46</div></div>
<div class="ttc" id="anamespaceinet_1_1units_1_1units_html_af52f6a778cd03659324d02848f8aaa33"><div class="ttname"><a href="namespaceinet_1_1units_1_1units.html#af52f6a778cd03659324d02848f8aaa33">inet::units::units::B</a></div><div class="ttdeci">intscale&lt; b, 1, 8 &gt; B</div><div class="ttdef"><b>Definition:</b> Units.h:1168</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a3ad7b618b1a010c573144042abf04d4b"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a3ad7b618b1a010c573144042abf04d4b">inet::xMIPv6::createBULEntryExpiryTimer</a></div><div class="ttdeci">void createBULEntryExpiryTimer(BindingUpdateList::BindingUpdateListEntry *entry, NetworkInterface *ie, simtime_t scheduledTime)</div><div class="ttdoc">Creates or overwrites a timer for BUL expiry that fires at provided scheduledTime.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2498</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a654465e95bd0340136b7d9b4aa2b3b83"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a654465e95bd0340136b7d9b4aa2b3b83">inet::xMIPv6::updateBUL</a></div><div class="ttdeci">void updateBUL(BindingUpdate *bu, const Ipv6Address &amp;dest, const Ipv6Address &amp;CoA, NetworkInterface *ie, const simtime_t sendTime)</div><div class="ttdoc">Update the an entry of the BUL with the provided parameters.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:586</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a746a045b4475430db6fb1ebcb7b7898b"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a746a045b4475430db6fb1ebcb7b7898b">inet::xMIPv6::sendPeriodicBRR</a></div><div class="ttdeci">void sendPeriodicBRR(cMessage *msg)</div><div class="ttdoc">Handles a fired BRR message transmission structure.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2425</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_aa954b7b9e57b4e3fe036ed1422537044"><div class="ttname"><a href="x_m_i_pv6_8cc.html#aa954b7b9e57b4e3fe036ed1422537044">SIZE_HOT</a></div><div class="ttdeci">#define SIZE_HOT</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:56</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_adedabec47eb42340c1565ffc735b7798"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#adedabec47eb42340c1565ffc735b7798">inet::xMIPv6::triggerRouteOptimization</a></div><div class="ttdeci">virtual void triggerRouteOptimization(const Ipv6Address &amp;destAddress, const Ipv6Address &amp;HoA, NetworkInterface *ie)</div><div class="ttdoc">The following method is used for triggering RO to a CN.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1351</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aa863e1b42062b5a06cc69af0f4af25d4"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aa863e1b42062b5a06cc69af0f4af25d4">inet::xMIPv6::processHoTMessage</a></div><div class="ttdeci">void processHoTMessage(Packet *inPacket, const Ptr&lt; const HomeTest &gt; &amp;HoT)</div><div class="ttdoc">First verifies a received HoT message and sends a BU to the CN if the care-of keygen token is availab...</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1748</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_ae66274da883fc2d9895e11caf712f5ad"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#ae66274da883fc2d9895e11caf712f5ad">inet::xMIPv6::createDeregisterBUTimer</a></div><div class="ttdeci">void createDeregisterBUTimer(const Ipv6Address &amp;buDest, NetworkInterface *ie)</div><div class="ttdoc">Similiar to the previous one, this method creates an BU timer with registration lifetime equal to 0.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:333</div></div>
<div class="ttc" id="anamespaceinet_html_ab4f59162a287d7a85fde3ca104470c6e"><div class="ttname"><a href="namespaceinet.html#ab4f59162a287d7a85fde3ca104470c6e">inet::contains</a></div><div class="ttdeci">bool contains(const std::vector&lt; T &gt; &amp;v, const Tk &amp;a)</div><div class="ttdef"><b>Definition:</b> stlutils.h:65</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a3b2d65f8a5b0013ea96df343a38c2ca9"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a3b2d65f8a5b0013ea96df343a38c2ca9">inet::xMIPv6::createBCEntryExpiryTimer</a></div><div class="ttdeci">void createBCEntryExpiryTimer(const Ipv6Address &amp;HoA, NetworkInterface *ie, simtime_t scheduledTime)</div><div class="ttdoc">Creates or overwrites a timer for BC expiry that fires at provided scheduledTime.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2608</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a5cf5e9f044204fd03467f018a646d2bc"><div class="ttname"><a href="x_m_i_pv6_8h.html#a5cf5e9f044204fd03467f018a646d2bc">KEY_CTOKEN_EXP</a></div><div class="ttdeci">#define KEY_CTOKEN_EXP</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:42</div></div>
<div class="ttc" id="a_i_udp-gates_8txt_html_a97baf7787238d2dd281d18269006b451"><div class="ttname"><a href="_i_udp-gates_8txt.html#a97baf7787238d2dd281d18269006b451">HopLimitReq</a></div><div class="ttdeci">removed HopLimitReq</div><div class="ttdef"><b>Definition:</b> IUdp-gates.txt:11</div></div>
<div class="ttc" id="aclassinet_1_1_binding_update_list_html_aff0f712d36063a6b38c224fa0dd1fd1aac6a4bd549b4bca51f53eedcafdc3684d"><div class="ttname"><a href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aac6a4bd549b4bca51f53eedcafdc3684d">inet::BindingUpdateList::REGISTER</a></div><div class="ttdeci">@ REGISTER</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:43</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aa8846ee7ce22eeab2e24cd4f659634b7"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aa8846ee7ce22eeab2e24cd4f659634b7">inet::xMIPv6::createTestInitTimer</a></div><div class="ttdeci">void createTestInitTimer(const Ptr&lt; MobilityHeader &gt; testInit, const Ipv6Address &amp;dest, NetworkInterface *ie, simtime_t sendTime=0)</div><div class="ttdoc">Creates and schedules a timer for either a HoTI or a CoTI transmission.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1457</div></div>
<div class="ttc" id="a_binding_update_list_8h_html_a0770994de63505f39900396055458bf9"><div class="ttname"><a href="_binding_update_list_8h.html#a0770994de63505f39900396055458bf9">UNDEFINED_BIND_AUTH_DATA</a></div><div class="ttdeci">#define UNDEFINED_BIND_AUTH_DATA</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:25</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a89306a1cc392ba98bf0fc8f83806a7a8"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a89306a1cc392ba98bf0fc8f83806a7a8">inet::xMIPv6::handleBCExpiry</a></div><div class="ttdeci">void handleBCExpiry(cMessage *msg)</div><div class="ttdoc">Handles the expiry of a BC entry.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2627</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a598fa868b1f1f70074ec8d64550c10eb"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a598fa868b1f1f70074ec8d64550c10eb">SIZE_COT</a></div><div class="ttdeci">#define SIZE_COT</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:57</div></div>
<div class="ttc" id="anamespaceinet_html_ac50e4f1707494e7ef4a9f21cc2fa96b0a7032ca76891b78d59d7b0e4655174568"><div class="ttname"><a href="namespaceinet.html#ac50e4f1707494e7ef4a9f21cc2fa96b0a7032ca76891b78d59d7b0e4655174568">inet::BINDING_UPDATE</a></div><div class="ttdeci">@ BINDING_UPDATE</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:81</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a8af2291e8f5d6f16d0aec604205421be"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a8af2291e8f5d6f16d0aec604205421be">MK_SEND_PERIODIC_BU</a></div><div class="ttdeci">#define MK_SEND_PERIODIC_BU</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:35</div></div>
<div class="ttc" id="anamespaceinet_html_a6be747ab6f195055e109f27f8462e52e"><div class="ttname"><a href="namespaceinet.html#a6be747ab6f195055e109f27f8462e52e">inet::INITSTAGE_LOCAL</a></div><div class="ttdeci">INET_API InitStage INITSTAGE_LOCAL</div><div class="ttdoc">Initialization of local state that don't use or affect other modules includes:</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a1ea27a7d716da8d2643cc08569b305e7"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a1ea27a7d716da8d2643cc08569b305e7">inet::xMIPv6::validateBUderegisterMessage</a></div><div class="ttdeci">bool validateBUderegisterMessage(Packet *inPacket, const Ptr&lt; const BindingUpdate &gt; &amp;bu)</div><div class="ttdoc">Similiar to validateBUMessage().</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1042</div></div>
<div class="ttc" id="a_binding_update_list_8h_html_ad49473dc2c4ab3735385007aff5510ec"><div class="ttname"><a href="_binding_update_list_8h.html#ad49473dc2c4ab3735385007aff5510ec">PRE_BINDING_EXPIRY</a></div><div class="ttdeci">#define PRE_BINDING_EXPIRY</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:31</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a909c538cb3db668a9317892683fb7078"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a909c538cb3db668a9317892683fb7078">SIZE_BU</a></div><div class="ttdeci">#define SIZE_BU</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:49</div></div>
<div class="ttc" id="anamespaceinet_html_a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6"><div class="ttname"><a href="namespaceinet.html#a9c0ecf85d82481d6058caaee2e4a41d9ab65a2838ba28695bd491de776eb71cc6">inet::OTHER_PACKET_DROP</a></div><div class="ttdeci">@ OTHER_PACKET_DROP</div><div class="ttdef"><b>Definition:</b> Simsignals_m.h:84</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a6b551126d211603e24e951bd355923ae"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a6b551126d211603e24e951bd355923ae">inet::xMIPv6::sendMobilityMessageToIPv6Module</a></div><div class="ttdeci">void sendMobilityMessageToIPv6Module(Packet *msg, const Ipv6Address &amp;destAddr, const Ipv6Address &amp;srcAddr=Ipv6Address::UNSPECIFIED_ADDRESS, int interfaceId=-1, simtime_t sendTime=0)</div><div class="ttdoc">Append tags to the Mobility Messages (BU, BA etc) and send it out to the Ipv6 Module.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:622</div></div>
<div class="ttc" id="a_init_stage_registry_8h_html_a6dec686281914f336c1b4dcafdbcf9df"><div class="ttname"><a href="_init_stage_registry_8h.html#a6dec686281914f336c1b4dcafdbcf9df">NUM_INIT_STAGES</a></div><div class="ttdeci">#define NUM_INIT_STAGES</div><div class="ttdef"><b>Definition:</b> InitStageRegistry.h:73</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a61a94eac72de688b6107fe7e2e31595f"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a61a94eac72de688b6107fe7e2e31595f">SIZE_HOTI</a></div><div class="ttdeci">#define SIZE_HOTI</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:54</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a2a87f0f44824cd5a8bee81353adbbc7c"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a2a87f0f44824cd5a8bee81353adbbc7c">SIZE_HOA_OPTION</a></div><div class="ttdeci">#define SIZE_HOA_OPTION</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:50</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aa84252f2ce271ac00187ea6dc2c9bb87"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aa84252f2ce271ac00187ea6dc2c9bb87">inet::xMIPv6::cancelEntries</a></div><div class="ttdeci">void cancelEntries(int interfaceId, Ipv6Address &amp;CoA)</div><div class="ttdoc">Cancel all timers (TransmitIf entities for HA and CNs) related to the provided interfaceId and CoA.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2338</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_af382622c53488bb0595890e966927e4b"><div class="ttname"><a href="x_m_i_pv6_8cc.html#af382622c53488bb0595890e966927e4b">MK_SEND_TEST_INIT</a></div><div class="ttdeci">#define MK_SEND_TEST_INIT</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:37</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_adcada2b7eb8c57d6d0bc54652ebcab60"><div class="ttname"><a href="x_m_i_pv6_8h.html#adcada2b7eb8c57d6d0bc54652ebcab60">KEY_HI</a></div><div class="ttdeci">#define KEY_HI</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:36</div></div>
<div class="ttc" id="aclassinet_1_1_protocol_html_a707bff4e89896d905d9f65b25554219a"><div class="ttname"><a href="classinet_1_1_protocol.html#a707bff4e89896d905d9f65b25554219a">inet::Protocol::mobileipv6</a></div><div class="ttdeci">static const Protocol mobileipv6</div><div class="ttdef"><b>Definition:</b> Protocol.h:100</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_afbd697045dcbb870067637a497a1d4b9"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#afbd697045dcbb870067637a497a1d4b9">inet::xMIPv6::ift</a></div><div class="ttdeci">ModuleRefByPar&lt; IInterfaceTable &gt; ift</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:61</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996f"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996f">inet::BaStatus</a></div><div class="ttdeci">BaStatus</div><div class="ttdoc">Enum generated from inet/networklayer/xmipv6/MobilityHeader.msg:54 by opp_msgtool.</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:223</div></div>
<div class="ttc" id="aclassinet_1_1_binding_update_list_html_aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182"><div class="ttname"><a href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa370cf597edaf8e621ca569fcf76af182">inet::BindingUpdateList::DEREGISTER</a></div><div class="ttdeci">@ DEREGISTER</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:45</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a2e23b242b95346bc5d29584bd925bc05"><div class="ttname"><a href="x_m_i_pv6_8h.html#a2e23b242b95346bc5d29584bd925bc05">KEY_BUL_EXP</a></div><div class="ttdeci">#define KEY_BUL_EXP</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:39</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a3c68a093ad4a7f05896c4393d23c5fe0"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a3c68a093ad4a7f05896c4393d23c5fe0">inet::xMIPv6::processHoAOpt</a></div><div class="ttdeci">void processHoAOpt(Packet *packet, HomeAddressOption *hoaOpt)</div><div class="ttdoc">Process the Home Address Option which belongs to the provided datagram.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2122</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_ac869cf4c98fc5b27384d943b0ea3c3c3"><div class="ttname"><a href="x_m_i_pv6_8h.html#ac869cf4c98fc5b27384d943b0ea3c3c3">KEY_BU</a></div><div class="ttdeci">#define KEY_BU</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:35</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a0b4704a9c3f214da125430daa5ccac90"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a0b4704a9c3f214da125430daa5ccac90">inet::xMIPv6::bul</a></div><div class="ttdeci">ModuleRefByPar&lt; BindingUpdateList &gt; bul</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:63</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_af014acd28edfaa0506809d36c1723385"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#af014acd28edfaa0506809d36c1723385">inet::xMIPv6::validateCoTMessage</a></div><div class="ttdeci">bool validateCoTMessage(Packet *inPacket, const CareOfTest &amp;CoT)</div><div class="ttdoc">Like validateHoTMessage(), but related to CoT.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1885</div></div>
<div class="ttc" id="a_self_doc_8h_html_a8e54030c665b5254da268db865fccdfc"><div class="ttname"><a href="_self_doc_8h.html#a8e54030c665b5254da268db865fccdfc">Enter_Method</a></div><div class="ttdeci">#define Enter_Method(...)</div><div class="ttdef"><b>Definition:</b> SelfDoc.h:71</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a4ea0a5a74761087a91035347e406773e"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a4ea0a5a74761087a91035347e406773e">inet::xMIPv6::validateBAck</a></div><div class="ttdeci">bool validateBAck(Packet *inPacket, const BindingAcknowledgement &amp;ba)</div><div class="ttdoc">Validates a Binding Acknowledgement for a mobile node.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1313</div></div>
<div class="ttc" id="aclassinet_1_1_ipv6_tunneling_html_a95e9426d5d66ba8d43ea1afb3ee6b653aff5a78e380abfeeab2394d344a4893d0"><div class="ttname"><a href="classinet_1_1_ipv6_tunneling.html#a95e9426d5d66ba8d43ea1afb3ee6b653aff5a78e380abfeeab2394d344a4893d0">inet::Ipv6Tunneling::NORMAL</a></div><div class="ttdeci">@ NORMAL</div><div class="ttdef"><b>Definition:</b> Ipv6Tunneling.h:44</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_ad4ded6f950e3baed74e157e01170a188"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#ad4ded6f950e3baed74e157e01170a188">inet::xMIPv6::createCareOfTokenEntryExpiryTimer</a></div><div class="ttdeci">void createCareOfTokenEntryExpiryTimer(Ipv6Address &amp;cnAddr, NetworkInterface *ie, simtime_t scheduledTime)</div><div class="ttdoc">Creates or overwrites a timer for care-of keygen token expiry that fires at provided scheduledTime.</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:512</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a8e8e171a71e44592936df60b6214ae5a"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a8e8e171a71e44592936df60b6214ae5a">inet::xMIPv6::createAndSendBRRMessage</a></div><div class="ttdeci">void createAndSendBRRMessage(const Ipv6Address &amp;dest, NetworkInterface *ie)</div><div class="ttdoc">Creates a Binding Refresh Request and sends it to the Ipv6 module.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2451</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a00f7319d98882b8ee35fd346a892a3ea"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a00f7319d98882b8ee35fd346a892a3ea">inet::xMIPv6::createHomeTokenEntryExpiryTimer</a></div><div class="ttdeci">void createHomeTokenEntryExpiryTimer(Ipv6Address &amp;cnAddr, NetworkInterface *ie, simtime_t scheduledTime)</div><div class="ttdoc">Creates or overwrites a timer for home keygen token expiry that fires at provided scheduledTime.</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:504</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_ae232f747c44b844277d7a7b6a9fe4054"><div class="ttname"><a href="x_m_i_pv6_8cc.html#ae232f747c44b844277d7a7b6a9fe4054">SIZE_NONCE_INDICES</a></div><div class="ttdeci">#define SIZE_NONCE_INDICES</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:53</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a9b830605dd4ddf75f737d66200bd7f21"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a9b830605dd4ddf75f737d66200bd7f21">inet::xMIPv6::processCoTMessage</a></div><div class="ttdeci">void processCoTMessage(Packet *inPacket, const Ptr&lt; const CareOfTest &gt; &amp;CoT)</div><div class="ttdoc">Like processHoTMessage(), but related to CoT.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1835</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996facc67630a2e7a36aae407bc4775cdaab2"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996facc67630a2e7a36aae407bc4775cdaab2">inet::HOME_REGISTRATION_NOT_SUPPORTED</a></div><div class="ttdeci">@ HOME_REGISTRATION_NOT_SUPPORTED</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:229</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_aee11505f04fbd42fba6714da2c4a7c4d"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#aee11505f04fbd42fba6714da2c4a7c4d">inet::xMIPv6::processBAMessage</a></div><div class="ttdeci">void processBAMessage(Packet *inPacket, const Ptr&lt; const BindingAcknowledgement &gt; &amp;ba)</div><div class="ttdoc">Processes the received BA and creates tunnels or mobility header paths if appropriate.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1124</div></div>
<div class="ttc" id="anamespaceinet_1_1_macho_html_ac0b4adbaa6cada33ed6bd595f8057b5c"><div class="ttname"><a href="namespaceinet_1_1_macho.html#ac0b4adbaa6cada33ed6bd595f8057b5c">inet::Macho::Key</a></div><div class="ttdeci">void * Key</div><div class="ttdef"><b>Definition:</b> Macho.h:327</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_aff85ca708ac4d725a050c595514f9a5e"><div class="ttname"><a href="x_m_i_pv6_8h.html#aff85ca708ac4d725a050c595514f9a5e">KEY_HTOKEN_EXP</a></div><div class="ttdeci">#define KEY_HTOKEN_EXP</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:41</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a1279d6acb1593dd76e210197b33d3300"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a1279d6acb1593dd76e210197b33d3300">inet::xMIPv6::tunneling</a></div><div class="ttdeci">ModuleRefByPar&lt; Ipv6Tunneling &gt; tunneling</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:65</div></div>
<div class="ttc" id="anamespaceinet_html_a9ad30be62e792f35add531d609e18d1f"><div class="ttname"><a href="namespaceinet.html#a9ad30be62e792f35add531d609e18d1f">inet::uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> INETDefs.h:55</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a4d36c6a58a53a1b6ff97c90033c4ee49"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a4d36c6a58a53a1b6ff97c90033c4ee49">inet::xMIPv6::processMobilityMessage</a></div><div class="ttdeci">void processMobilityMessage(Packet *inPacket)</div><div class="ttdoc">This is where all the mobility messages are sifted through and sent to appropriate functions for proc...</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:187</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a1ca971cb70dd3d8468354d96ce504298"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a1ca971cb70dd3d8468354d96ce504298">inet::xMIPv6::itCNList</a></div><div class="ttdeci">CnList::iterator itCNList</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:125</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a12b4df7d7c310249eb01a4d0b0189b3b"><div class="ttname"><a href="x_m_i_pv6_8h.html#a12b4df7d7c310249eb01a4d0b0189b3b">KEY_BR</a></div><div class="ttdeci">#define KEY_BR</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:38</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a4c9e54de243910406aafc3553f6b9247"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a4c9e54de243910406aafc3553f6b9247">inet::xMIPv6::processBUMessage</a></div><div class="ttdeci">void processBUMessage(Packet *inPacket, const Ptr&lt; const BindingUpdate &gt; &amp;bu)</div><div class="ttdoc">Process a BU - only applicable to HAs and CNs.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:680</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_a74c931b057a65aac096b01ddfdf28450"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#a74c931b057a65aac096b01ddfdf28450">inet::xMIPv6::processType2RH</a></div><div class="ttdeci">void processType2RH(Packet *packet, Ipv6RoutingHeader *rh)</div><div class="ttdoc">Process the Type 2 Routing Header which belongs to the provided datagram.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:2017</div></div>
<div class="ttc" id="anamespaceinet_html_a0836489f866ddd35438d3bfe59438d4b"><div class="ttname"><a href="namespaceinet.html#a0836489f866ddd35438d3bfe59438d4b">inet::BeStatus</a></div><div class="ttdeci">BeStatus</div><div class="ttdoc">Enum generated from inet/networklayer/xmipv6/MobilityHeader.msg:86 by opp_msgtool.</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:314</div></div>
<div class="ttc" id="aclassinet_1_1x_m_i_pv6_html_afef82a8cb41eadd8263f9a1878a1b07c"><div class="ttname"><a href="classinet_1_1x_m_i_pv6.html#afef82a8cb41eadd8263f9a1878a1b07c">inet::xMIPv6::initReturnRoutability</a></div><div class="ttdeci">virtual void initReturnRoutability(const Ipv6Address &amp;cnDest, NetworkInterface *ie)</div><div class="ttdoc">Creates HoTI and CoTI messages and sends them to the CN if timers are not already existing.</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:1386</div></div>
<div class="ttc" id="aclassinet_1_1_binding_update_list_html_aff0f712d36063a6b38c224fa0dd1fd1aa3e433ee51f9bf8834c7af27ce5614fe4"><div class="ttname"><a href="classinet_1_1_binding_update_list.html#aff0f712d36063a6b38c224fa0dd1fd1aa3e433ee51f9bf8834c7af27ce5614fe4">inet::BindingUpdateList::REGISTERED</a></div><div class="ttdeci">@ REGISTERED</div><div class="ttdef"><b>Definition:</b> BindingUpdateList.h:44</div></div>
<div class="ttc" id="anamespaceinet_html_afa2cbc698a7f3cbd0f837d5b97a82733"><div class="ttname"><a href="namespaceinet.html#afa2cbc698a7f3cbd0f837d5b97a82733">inet::containsKey</a></div><div class="ttdeci">bool containsKey(const std::map&lt; K, V, _C &gt; &amp;m, const Tk &amp;a)</div><div class="ttdef"><b>Definition:</b> stlutils.h:80</div></div>
<div class="ttc" id="anamespaceinet_html_a6ef98f8974c34c14b3beb2ccf4c0996fa67b29973a629637f7c9cfa9782459a34"><div class="ttname"><a href="namespaceinet.html#a6ef98f8974c34c14b3beb2ccf4c0996fa67b29973a629637f7c9cfa9782459a34">inet::EXPIRED_NONCES</a></div><div class="ttdeci">@ EXPIRED_NONCES</div><div class="ttdef"><b>Definition:</b> MobilityHeader_m.h:236</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a2c62677bd8273d2af6b5c1fee292a11c"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a2c62677bd8273d2af6b5c1fee292a11c">MK_BC_EXPIRY</a></div><div class="ttdeci">#define MK_BC_EXPIRY</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:39</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a32607edcc9ac8e905183b104328921e5"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a32607edcc9ac8e905183b104328921e5">BRR_RETRIES</a></div><div class="ttdeci">#define BRR_RETRIES</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:42</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_aaec02cdb37c69443949e6e975dbf7d6b"><div class="ttname"><a href="x_m_i_pv6_8cc.html#aaec02cdb37c69443949e6e975dbf7d6b">MK_SEND_PERIODIC_BR</a></div><div class="ttdeci">#define MK_SEND_PERIODIC_BR</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:36</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_a236c732f14005bd11f696dcceca3e5e1"><div class="ttname"><a href="x_m_i_pv6_8cc.html#a236c732f14005bd11f696dcceca3e5e1">SIZE_BRR</a></div><div class="ttdeci">#define SIZE_BRR</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:59</div></div>
<div class="ttc" id="ax_m_i_pv6_8h_html_a7df6fa8bbe83e775550d6f56a3508480"><div class="ttname"><a href="x_m_i_pv6_8h.html#a7df6fa8bbe83e775550d6f56a3508480">EXPIRY_TYPE_TOKEN</a></div><div class="ttdeci">#define EXPIRY_TYPE_TOKEN</div><div class="ttdef"><b>Definition:</b> xMIPv6.h:50</div></div>
<div class="ttc" id="ax_m_i_pv6_8cc_html_aeefd0c073b8a6c065f08269e6bcb9db6"><div class="ttname"><a href="x_m_i_pv6_8cc.html#aeefd0c073b8a6c065f08269e6bcb9db6">SIZE_COTI</a></div><div class="ttdeci">#define SIZE_COTI</div><div class="ttdef"><b>Definition:</b> xMIPv6.cc:55</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceinet.html">inet</a></li><li class="navelem"><a class="el" href="classinet_1_1x_m_i_pv6.html">xMIPv6</a></li>
    <li class="footer">Generated on Sun Apr 10 2022 21:00:29 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
